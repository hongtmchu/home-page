<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Hong T.M. Chu">
<meta name="description" content="Learn how to use R to load and clean and play with all the location history data Google keeps about you and look at some neat plots and tables about our 5,000-mile summer road trip along the way">
<title>Road trip analysis! How to use and play with Google Location History in R | Hong T.M. Chu – Hong T.M. Chu</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../..//files/favicon-512.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-17c909d5fd25ae21b861c0c7a49b2096.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-5cd0811f461c8271ae6bab49df9501be.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../../../../site_libs/quarto-contrib/iconify-2.0.0/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-527449-5', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><style>

      .quarto-title-block .quarto-title-banner {
        background: #170C3A;
      }
</style>
<script src="../../../../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="../../../../../site_libs/jquery-1.12.4/jquery.min.js"></script><link href="../../../../../site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="../../../../../site_libs/leaflet-1.3.1/leaflet.js"></script><link href="../../../../../site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="../../../../../site_libs/proj4-2.6.2/proj4.min.js"></script><script src="../../../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="../../../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="../../../../../site_libs/leaflet-binding-2.1.2/leaflet.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Road trip analysis! How to use and play with Google Location History in R | Hong T.M. Chu">
<meta property="og:description" content="Learn how to use R to load and clean and play with all the location history data Google keeps about you and look at some neat plots and tables about our 5,000-mile summer road trip along the way">
<meta property="og:image" content="https://www.andrewheiss.com/blog/2023/07/03/using-google-location-history-with-r-roadtrip/index_files/figure-html/fig-map-with-dates-1.png">
<meta property="og:site_name" content="Hong T.M. Chu">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="1728">
<meta property="og:image:width" content="2592">
<meta name="twitter:title" content="Road trip analysis! How to use and play with Google Location History in R | Hong T.M. Chu">
<meta name="twitter:description" content="Learn how to use R to load and clean and play with all the location history data Google keeps about you and look at some neat plots and tables about our 5,000-mile summer road trip along the way">
<meta name="twitter:image" content="https://www.andrewheiss.com/blog/2023/07/03/using-google-location-history-with-r-roadtrip/index_files/figure-html/fig-map-with-dates-1.png">
<meta name="twitter:creator" content="@andrewheiss">
<meta name="twitter:site" content="@andrewheiss">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="1728">
<meta name="twitter:image-width" content="2592">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Hong T.M. Chu</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="mailto:hong.ctm@vinuni.edu.vn"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:envelope" style="font-size: 1.1em;" aria-label="Icon envelope from bi Iconify.design set." title="E-mail"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/andrewheiss" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:github" style="font-size: 1.1em;" aria-label="Icon github from bi Iconify.design set." title="GitHub"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/hongtmchu" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:linkedin" style="font-size: 1.1em;" aria-label="Icon linkedin from bi Iconify.design set." title="LinkedIn"></iconify-icon></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default blog-post page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Road trip analysis! How to use and play with Google Location History in R</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Learn how to use R to load and clean and play with all the location history data Google keeps about you and look at some neat plots and tables about our 5,000-mile summer road trip along the way
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">r</div>
                <div class="quarto-category">tidyverse</div>
                <div class="quarto-category">ggplot</div>
                <div class="quarto-category">gis</div>
                <div class="quarto-category">maps</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.andrewheiss.com/">Andrew Heiss</a> <a href="https://orcid.org/0000-0002-3948-3914" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Monday, July 3, 2023</p>
      </div>
    </div>
    
      
      <div>
      <div class="quarto-title-meta-heading">Doi</div>
      <div class="quarto-title-meta-contents">
        <p class="doi">
          <a href="https://doi.org/10.59350/24rwv-k9n62">10.59350/24rwv-k9n62</a>
        </p>
      </div>
    </div>
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#packages-and-functions" id="toc-packages-and-functions" class="nav-link active" data-scroll-target="#packages-and-functions">Packages and functions</a></li>
  <li>
<a href="#anatomy-of-google-takeout-location-history-data" id="toc-anatomy-of-google-takeout-location-history-data" class="nav-link" data-scroll-target="#anatomy-of-google-takeout-location-history-data">Anatomy of Google Takeout Location History data</a>
  <ul class="collapse">
<li><a href="#settings" id="toc-settings" class="nav-link" data-scroll-target="#settings">Settings</a></li>
  <li><a href="#records" id="toc-records" class="nav-link" data-scroll-target="#records">Records</a></li>
  <li><a href="#semantic-location-history" id="toc-semantic-location-history" class="nav-link" data-scroll-target="#semantic-location-history">Semantic location history</a></li>
  </ul>
</li>
  <li>
<a href="#loading-and-playing-with-your-location-history-in-r" id="toc-loading-and-playing-with-your-location-history-in-r" class="nav-link" data-scroll-target="#loading-and-playing-with-your-location-history-in-r">Loading and playing with your location history in R</a>
  <ul class="collapse">
<li>
<a href="#records.json" id="toc-records.json" class="nav-link" data-scroll-target="#records.json"><code>Records.json</code></a>
  <ul class="collapse">
<li><a href="#loading-and-cleaning-data" id="toc-loading-and-cleaning-data" class="nav-link" data-scroll-target="#loading-and-cleaning-data">Loading and cleaning data</a></li>
  <li><a href="#basic-maps" id="toc-basic-maps" class="nav-link" data-scroll-target="#basic-maps">Basic maps</a></li>
  </ul>
</li>
  <li>
<a href="#semantic-location-history-1" id="toc-semantic-location-history-1" class="nav-link" data-scroll-target="#semantic-location-history-1">Semantic location history</a>
  <ul class="collapse">
<li><a href="#placevisits" id="toc-placevisits" class="nav-link" data-scroll-target="#placevisits"><code>placeVisit</code>s</a></li>
  <li><a href="#activitysegments" id="toc-activitysegments" class="nav-link" data-scroll-target="#activitysegments"><code>activitySegment</code>s</a></li>
  <li><a href="#both-combined" id="toc-both-combined" class="nav-link" data-scroll-target="#both-combined">Both combined</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#road-trip-analysis" id="toc-road-trip-analysis" class="nav-link" data-scroll-target="#road-trip-analysis">Road trip analysis</a>
  <ul class="collapse">
<li><a href="#maps" id="toc-maps" class="nav-link" data-scroll-target="#maps">Maps</a></li>
  <li><a href="#distance-and-time" id="toc-distance-and-time" class="nav-link" data-scroll-target="#distance-and-time">Distance and time</a></li>
  <li><a href="#driving-and-breaks" id="toc-driving-and-breaks" class="nav-link" data-scroll-target="#driving-and-breaks">Driving and breaks</a></li>
  <li><a href="#elevation-over-time" id="toc-elevation-over-time" class="nav-link" data-scroll-target="#elevation-over-time">Elevation over time</a></li>
  </ul>
</li>
  <li><a href="#the-end" id="toc-the-end" class="nav-link" data-scroll-target="#the-end">The end</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><p>As I explained <a href="https://www.andrewheiss.com/blog/2023/06/01/geocoding-routing-openstreetmap-r/">in my previous blog post</a>, in June 2023 I drove my family across the country in a 5,000-mile roundtrip odyssey from Atlanta, Georgia to just-south-of-Salt Lake City, Utah, and back again. Instead of taking a direct path through the middle the United States, we decided to hit as many tourist-y stops along the way, making a big circle along the southern US on the way out and along the northern US on the way back, stopping at a dozen really neat places, including:</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/French_Quarter">The French Quarter</a> in New Orleans, Louisiana</li>
<li>
<a href="https://en.wikipedia.org/wiki/Alamo_Mission">The Alamo</a> in San Antonio, Texas</li>
<li>
<a href="https://en.wikipedia.org/wiki/Carlsbad_Caverns_National_Park">Carlsbad Caverns National Park</a> in New Mexico</li>
<li>
<a href="https://en.wikipedia.org/wiki/Grand_Canyon">Grand Canyon National Park</a> in Arizona</li>
<li>
<a href="https://en.wikipedia.org/wiki/Capitol_Reef_National_Park">Capitol Reef National Park</a> in southern Utah (staying at <a href="https://www.heissatopia.com/search?q=Grover">my aunt’s cabin</a> in Grover, Utah)</li>
<li>
<a href="https://en.wikipedia.org/wiki/Goblin_Valley_State_Park">Goblin Valley</a> in southern Utah</li>
<li>
<a href="https://en.wikipedia.org/wiki/Yellowstone_National_Park">Yellowstone National Park</a> in Wyoming</li>
<li>
<a href="https://en.wikipedia.org/wiki/Devils_Tower">Devil’s Tower National Monument</a> in Wyoming</li>
<li>
<a href="https://en.wikipedia.org/wiki/Mount_Rushmore">Mount Rushmore National Memorial</a> in South Dakota</li>
<li>
<a href="https://en.wikipedia.org/wiki/Nauvoo,_Illinois">Nauvoo, Illinois</a> and other <a href="https://www.churchofjesuschrist.org/learn/locations/historic-nauvoo">LDS history</a> locations like the <a href="https://en.wikipedia.org/wiki/Smith_Family_Cemetery">Smith Family Cemetery</a>, <a href="https://en.wikipedia.org/wiki/Winter_Quarters_(North_Omaha,_Nebraska)">Winter Quarters</a>, and <a href="https://en.wikipedia.org/wiki/Carthage_Jail">Carthage Jail</a>
</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pictures!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Check out the <a href="https://www.heissatopia.com/search/label/%23Roadtrip2023">#Roadtrip2023 tag on our blog</a> for photos and details of all these places.</p>
</div>
</div>
<p>In an effort to stay On Brand™, I wanted to keep a log of all our stops so I could go back and analyze the trip. How many miles would we drive? How much time would we spend in the car? How long would each gas stop and bathroom break be? Could I make some sort of map showing our journey?</p>
<p>So, at the first gas station we stopped at in Alabama, I started a new file in my phone’s Notes app and dutifully wrote down the arrival time, name and address of the gas station, and departure time. I had a nascent data file and was ready to use it through the trip.</p>
<p>About an hour after leaving our second gas station stop just outside Mississippi, I realized that I forgot to write down anything about the second gas station stop. My data collection process died after a single entry.</p>
<p>I was initially disappointed that I wouldn’t have any sort of data to work with at the end of the trip, but then I remembered that my phone was tracking every part of the whole trip through Google Maps. When we got to the first hotel, I searched Google to see if it was possible to export your location history from Google Maps and saw that it was, so I gave up on trying to keep my own log and outsourced all that to Google instead. I didn’t know what exactly Google was tracking, but I figured it would at least have the date, time, and location of where we went, so that was good enough.</p>
<p>Right after we got home from our trip last week, I exported my data and was shocked by how much detail Google actually had. The exported JSON files contained 100,000+ location entries going all the back to 2013 (!!!). Parsing and sifting through and working with all this data initially seemed overwhelming (especially since Google doesn’t actually provide any formal documentation for these files!), but once I worked through a few tricky issues, it was surprisingly straightforward to make maps, calculate distances and times, and do all sorts of other fun things with the data.</p>
<p>So in this post I do three things:</p>
<ol type="1">
<li>
<a href="#anatomy-of-google-takeout-location-history-data">Give a basic overview</a> of what exactly Google tracks in your Location History and how they store it across dozens of JSON files</li>
<li>
<a href="#loading-and-playing-with-your-location-history-in-r">Show</a> how to load, process, and clean this data using R</li>
<li>
<a href="#road-trip-analysis">Create</a> some neat plots and tables with details from our mega summer road trip around the US</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Who this post is for
</div>
</div>
<div class="callout-body-container callout-body">
<p>Here’s what I assume you know:</p>
<ul>
<li>You’re familiar with <a href="https://www.r-project.org/">R</a> and the <a href="https://www.tidyverse.org/">tidyverse</a> (particularly <a href="https://dplyr.tidyverse.org/">{dplyr}</a> and <a href="https://ggplot2.tidyverse.org/">{ggplot2}</a>).</li>
<li>You’re somewhat familiar with <a href="https://r-spatial.github.io/sf/">{sf}</a> for working with geographic data. I have a <a href="https://datavizs23.classes.andrewheiss.com/example/12-example.html">whole tutorial here</a> and a <a href="https://www.andrewheiss.com/blog/2023/04/26/middle-earth-mapping-sf-r-gis/#lightning-quick-overview-of-sf-and-shapefiles">simplified one here</a> and the <a href="https://r-spatial.github.io/sf/">{sf} documentation has a ton of helpful vignettes and blog posts</a>, and there are also two free books about it: <a href="https://r-spatial.org/book/"><em>Spatial Data Science</em></a> and <a href="https://r.geocompx.org/"><em>Geocomputation with R</em></a>. Also <a href="https://www.jessesadler.com/post/simple-feature-objects/">check this fantastic post out</a> to learn more about the anatomy of a <code>geometry</code> column with {sf}.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Follow along!
</div>
</div>
<div class="callout-body-container callout-body">
<p>If you want to follow along with this post, I’ve created mostly-anonymized excerpts of the main JSON files for the first four days of this road trip that you can download:</p>
<ul>
<li><a href="data.zip"><i class="fa-solid fa-file-zipper" aria-label="file-zipper"></i> <code>data.zip</code></a></li>
</ul>
</div>
</div>
<section id="packages-and-functions" class="level1"><h1>Packages and functions</h1>
<p>Before officially getting started, let’s load all the packages we need and create some helpful functions and variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>     <span class="co"># ggplot, dplyr, and friends</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://jeroen.r-universe.dev/jsonlite">jsonlite</a></span><span class="op">)</span>      <span class="co"># Read JSON files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/">sf</a></span><span class="op">)</span>            <span class="co"># Handle spatial data in a tidy way</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/walkerke/tigris">tigris</a></span><span class="op">)</span>        <span class="co"># Access deographic data from the US Census</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggrepel.slowkow.com/">ggrepel</a></span><span class="op">)</span>       <span class="co"># Nicer non-overlapping labels</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://glue.tidyverse.org/">glue</a></span><span class="op">)</span>          <span class="co"># Easier string interpolation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>        <span class="co"># Nicer labeling functions</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>     <span class="co"># Combine plots nicely</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/">ggspatial</a></span><span class="op">)</span>     <span class="co"># Nicer map features like scale bars</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/">leaflet</a></span><span class="op">)</span>       <span class="co"># Make interactive maps</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://andyteucher.ca/lutz/">lutz</a></span><span class="op">)</span>          <span class="co"># Look up time zones for lat/lon coordinates</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com">gt</a></span><span class="op">)</span>            <span class="co"># Make fancy tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Nowosad/rcartocolor">rcartocolor</a></span><span class="op">)</span>   <span class="co"># Use CARTO colors (https://carto.com/carto-colors/)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://eliocamp.github.io/ggnewscale/">ggnewscale</a></span><span class="op">)</span>    <span class="co"># Use multiple scales for the same aesthetic in ggplot</span></span>
<span></span>
<span><span class="co"># Custom ggplot themes to make pretty plots</span></span>
<span><span class="co"># Get the font at https://fonts.google.com/specimen/Overpass</span></span>
<span><span class="va">theme_roadtrip</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Overpass Light"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass Medium"</span><span class="op">)</span>,</span>
<span>      axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span></span>
<span>        family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span>, face <span class="op">=</span> <span class="st">"plain"</span>,</span>
<span>        size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey90"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">theme_roadtrip_map</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">theme_void</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Overpass Light"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span></span>
<span>        family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span>, face <span class="op">=</span> <span class="st">"plain"</span>,</span>
<span>        size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.1</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Make labels use Overpass by default</span></span>
<span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"label_repel"</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>,</span>
<span>                          fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"label"</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>,</span>
<span>                          fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"text_repel"</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>,</span>
<span>                          fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"text"</span>, </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Overpass"</span>,</span>
<span>                          fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CARTO Prism palette</span></span>
<span><span class="co"># https://carto.com/carto-colors/</span></span>
<span><span class="va">clrs</span> <span class="op">&lt;-</span> <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu">carto_pal</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Prism"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">us_states</span> <span class="op">&lt;-</span> <span class="fu">states</span><span class="op">(</span>resolution <span class="op">=</span> <span class="st">"20m"</span>, year <span class="op">=</span> <span class="fl">2022</span>, cb <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lower_48</span> <span class="op">&lt;-</span> <span class="va">us_states</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">NAME</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Alaska"</span>, <span class="st">"Hawaii"</span>, <span class="st">"Puerto Rico"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>A bunch of helper functions that I’ve hidden because this chunk is long</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#' Format difftime in minutes and hours</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' This function takes a difftime input \code{x} and formats the result as a </span></span>
<span><span class="co">#' string indicating the number of hours and minutes in the duration.</span></span>
<span><span class="co">#'</span></span>
<span><span class="co">#' @param x A difftime input.</span></span>
<span><span class="co">#' @return A character vector of formatted duration strings.</span></span>
<span><span class="co">#' @examples</span></span>
<span><span class="co">#' x &lt;- as.difftime(c(93, 1007, 3056), units = "secs")</span></span>
<span><span class="co">#' fmt_duration(x)</span></span>
<span><span class="va">fmt_difftime</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n_seconds</span> <span class="op">&lt;-</span> <span class="fu">seconds</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html">as.double</a></span><span class="op">(</span><span class="va">x</span>, units <span class="op">=</span> <span class="st">"secs"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">n_seconds</span> <span class="op">&lt;-</span> <span class="fu">seconds_to_period</span><span class="op">(</span><span class="va">n_seconds</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">map_chr</span><span class="op">(</span><span class="va">n_seconds</span>, \<span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">3600</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># If this is less than an hour, don't format anything with hours</span></span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{MM} minutes"</span>, MM <span class="op">=</span> <span class="fu">minute</span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="co"># I only want to format this as a number of hours. If the duration is</span></span>
<span>      <span class="co"># longer than 24 hours, seconds_to_period() rolls over into days (i.e.</span></span>
<span>      <span class="co"># seconds_to_period(60 * 60 * 24) returns "1d 0H 0M 0S"), and it shows</span></span>
<span>      <span class="co"># zero hours. So we extract the day part of the period, multiply it by 24,</span></span>
<span>      <span class="co"># and add it to the hour component that we want to display</span></span>
<span>      <span class="va">extra_day_hours</span> <span class="op">&lt;-</span> <span class="fu">day</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">*</span> <span class="fl">24</span></span>
<span>      </span>
<span>      <span class="fu">glue</span><span class="fu">::</span><span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">"{HH} hour{s} {MM} minutes"</span>,</span>
<span>        HH <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">label_comma</span><span class="op">(</span><span class="op">)</span><span class="op">(</span><span class="fu">hour</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">+</span> <span class="va">extra_day_hours</span><span class="op">)</span>,</span>
<span>        MM <span class="op">=</span> <span class="fu">minute</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>        s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">hour</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">""</span>, <span class="st">"s"</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">fmt_miles</span> <span class="op">&lt;-</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">label_number</span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">10</span>, suffix <span class="op">=</span> <span class="st">" miles"</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span></span>
<span></span>
<span><span class="va">miles_to_meters</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">*</span> <span class="fl">1609.344</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">meters_to_miles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">/</span> <span class="fl">1609.344</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">meters_to_feet</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">*</span> <span class="fl">3.28084</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">km_to_miles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">meters_to_miles</span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="anatomy-of-google-takeout-location-history-data" class="level1 page-columns page-full"><h1>Anatomy of Google Takeout Location History data</h1>
<p>You can use <a href="https://takeout.google.com/">Google Takeout</a> to export your personal location history if you have it enabled in Google Maps, which you probably do—it’s the default. (Though after looking at this post you might be tempted to disable it—it’s surprising to see how much fine-grained data Google has about your location over time!)</p>
<p>Go to <a href="https://takeout.google.com/">Google Takeout</a> and create a new export. You can select data from any number of Google’s different services, but here we only want Location History, so scroll all the way down to it, check its box, and then select “Next Step”:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/google-takeout.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Location History in Google Takeout</figcaption></figure>
</div>
<p>Tell it to e-mail you a link to a one-time .zip export and then wait a couple minutes to get the link. Download it, unzip it, and you’re ready to go!</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/google-takeout-options.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Location History export options in Google Takeout</figcaption></figure>
</div>
<p>Your Location History data includes a bunch of JSON files:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>.</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>├── Settings.json</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>├── Records.json</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>└── Semantic Location History</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    ├── 2013</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    ├── ...</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    ├── 2022</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    │   ├── 2022_APRIL.json</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    │   ├── ...</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    │   └── ...</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    └── 2023</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>        ├── 2023_APRIL.json</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        ├── ...</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>        └── ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For whatever reason, Google doesn’t provide any documentation for these files and their contents! Lots of the data and JSON entries are self-explanatory and fairly straightforward, but lots are not!. Fortunately <a href="https://locationhistoryformat.com/">this community project for the Location History Format</a> provides excellent definitions, documentation, and JSON schemas for all these JSON files.</p>
<p>Before loading these files into R and playing with them, understanding what’s in them is useful, so let’s take a quick tour.</p>
<section id="settings" class="level2"><h2 class="anchored" data-anchor-id="settings">Settings</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Complete documentation for <code>Settings.json</code>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://locationhistoryformat.com/reference/settings/">Full documentation</a></li>
</ul>
</div>
</div>
<p><code>Settings.json</code> is a small file that contains a bunch of device-specific settings and details, like the unique ID for your phone, the date and time when you added your phone to your account, and so on. It’s not super important for working with your data—consider it extra metadata.</p>
</section><section id="records" class="level2"><h2 class="anchored" data-anchor-id="records">Records</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Complete documentation for <code>Records.json</code>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://locationhistoryformat.com/guides/raw-location/">Basic overview</a></li>
<li><a href="https://locationhistoryformat.com/reference/records/">Full documentation</a></li>
</ul>
</div>
</div>
<p><code>Records.json</code> <em>is</em> important. This contains an entry for every time Google Maps recorded your location somewhere. Here’s what a typical entry looks like (each entry is nested under a <code>"locations"</code> property):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"locations"</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">300489450</span><span class="fu">,</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-899629451</span><span class="fu">,</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"accuracy"</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"velocity"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"heading"</span><span class="fu">:</span> <span class="dv">329</span><span class="fu">,</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"altitude"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"verticalAccuracy"</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"platformType"</span><span class="fu">:</span> <span class="st">"IOS"</span><span class="fu">,</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"serverTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T01:05:58.248Z"</span><span class="fu">,</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"deviceTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T01:05:57.559Z"</span><span class="fu">,</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"batteryCharging"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"formFactor"</span><span class="fu">:</span> <span class="st">"PHONE"</span><span class="fu">,</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"timestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T00:52:57Z"</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>Location details like <code>latitudeE7</code> and <code>longitudeE7</code>, multiplied by 10,000,000 so there are no decimals</li>
<li>Accuracy details like <code>accuracy</code>, or radius of the location measurement, in meters. Smaller numbers mean better precision.</li>
<li>Position details like <code>heading</code> (degrees east of north, from 0 to 359), <code>velocity</code> (meters per second), <code>altitude</code> (meters), and <code>verticalAccuracy</code> (accuracy of altitude in meters; smaller means better precision)</li>
<li>Device details like <code>deviceTag</code> (Google’s internal ID for your device; I changed mine to 0 in this post for privacy reasons), <code>platformType</code> and <code>formFactor</code> (type of device), <code>batteryCharging</code> (whether your device was charging at the time), and some timestamps for the device time, server time, and UTC time.</li>
</ul>
<p>This is pretty straightforward to work with, since it’s essentially rectangular data, or data that can be thought of as rows and columns. Each location entry in the JSON file is a row; each property is a column (<code>accuracy</code> is 9, <code>altitude</code> is 1, and so on), like this:</p>
<table class="caption-top table">
<caption>Example dataset from Google Location History JSON</caption>
<colgroup>
<col style="width: 9%">
<col style="width: 16%">
<col style="width: 18%">
<col style="width: 7%">
<col style="width: 16%">
<col style="width: 30%">
</colgroup>
<thead><tr class="header">
<th>rowid</th>
<th>latitudeE7</th>
<th>longitudeE7</th>
<th>…</th>
<th>formFactor</th>
<th>timestamp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>54383</td>
<td>300489450</td>
<td>-899629451</td>
<td>…</td>
<td>PHONE</td>
<td>2023-06-04T00:52:57Z</td>
</tr>
<tr class="even">
<td>54384</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
<td>…</td>
</tr>
</tbody>
</table>
<p>The only data manipulation we need to do is modify the latitude and longitude columns. Both of those have been multiplied by 10,000,000 so that there are no decimal points in the coordinates (probably to avoid <a href="https://floating-point-gui.de/basic/">the weirdness inherent in floating point math</a>). There’s actually a hint about this in the column names for <code>latitudeE7</code> and <code>longitudeE7</code>—in R and most other programming languages, <code>1e7</code> is computer notation for <span class="math inline">\(10^7\)</span>. If we divide both those columns by 10,000,000, we’ll get standard-looking geographic coordinates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fl">300489450</span> <span class="op">/</span> <span class="fl">10000000</span></span>
<span><span class="co">## [1] 30.05</span></span>
<span><span class="op">-</span><span class="fl">899629451</span> <span class="op">/</span> <span class="fl">1e7</span>  <span class="co"># We can write it as 1e7 too</span></span>
<span><span class="co">## [1] -89.96</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the sake of this post, the most important pieces of data here will be location (<code>latitudeE7</code> and <code>longitudeE7</code>), time (<code>timestamp</code>), and elevation (<code>altitude</code>). The velocity data might be cool to do something with some day, but I won’t touch it for now.</p>
</section><section id="semantic-location-history" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="semantic-location-history">Semantic location history</h2>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Complete documentation for semantic location history files
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><a href="https://locationhistoryformat.com/guides/semantic-location/">Basic overview</a></li>
<li><a href="https://locationhistoryformat.com/reference/semantic/">Full documentation</a></li>
</ul>
</div>
</div>
<p>These month-specific JSON files are super neat and full of really rich data. Each entry is one of two types of events: activity segments (<code>activitySegment</code>) and place visits (<code>placeVisit</code>).</p>
<p>Here’s what the beginning of a typical activity segment entry looks like (with a <em>lot</em> of parts omitted for space—<a href="data/example-activitySegment.json">click here for a complete example entry</a>):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"timelineObjects"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"activitySegment"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"startLocation"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">339703585</span><span class="fu">,</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-842416959</span><span class="fu">,</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"endLocation"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">339786509</span><span class="fu">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-842006268</span><span class="fu">,</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"duration"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"startTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-01T00:15:26.999Z"</span><span class="fu">,</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"endTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-01T00:28:47Z"</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"distance"</span><span class="fu">:</span> <span class="dv">5483</span><span class="fu">,</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="fu">,</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"confidence"</span><span class="fu">:</span> <span class="st">"HIGH"</span><span class="fu">,</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"activities"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="fu">,</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"probability"</span><span class="fu">:</span> <span class="fl">91.4052665233612</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"STILL"</span><span class="fu">,</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"probability"</span><span class="fu">:</span> <span class="fl">6.64205327630043</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>          <span class="er">...</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>        <span class="er">...</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>And here’s the beginning typical place visit entry (<a href="data/example-placeVisit.json">click here for a complete example entry</a>)</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode json code-with-copy"><code class="sourceCode json"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"timelineObjects"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"placeVisit"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"location"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">323281024</span><span class="fu">,</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-863373283</span><span class="fu">,</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"placeId"</span><span class="fu">:</span> <span class="st">"ChIJQ0NgzsqAjogRISqopW4DZMc"</span><span class="fu">,</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"address"</span><span class="fu">:</span> <span class="st">"1030 W South Blvd, Montgomery, AL 36105, USA"</span><span class="fu">,</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Chevron"</span><span class="fu">,</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">},</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"locationConfidence"</span><span class="fu">:</span> <span class="fl">89.41639</span><span class="fu">,</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"calibratedProbability"</span><span class="fu">:</span> <span class="fl">80.56358</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"duration"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"startTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-03T14:27:23.001Z"</span><span class="fu">,</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"endTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-03T14:50:24Z"</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"placeConfidence"</span><span class="fu">:</span> <span class="st">"MEDIUM_CONFIDENCE"</span><span class="fu">,</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="er">...</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Working with these gnarly JSON files is a lot trickier than working with <code>Records.json</code> because all this data is deeply nested within specific properties of the activity or place visit.</p>
<p>To help visualize all this nesting, here’s what a single <code>placeVisit</code> entry looks like (screenshot via <a href="https://akhiljay.github.io/JSON-tree-visualizer/">this JSON tree visualizer</a>), with the visit details + alternative places + child visits and <em>their</em> alternative locations and confidence levels + lots of other details:</p>
<div class="page-columns page-full">
<div class="quarto-figure quarto-figure-center page-columns page-full">
<figure class="figure page-columns page-full"><p class="page-columns page-full"><img src="img/json-tree.png" class="img-fluid figure-img column-screen-inset-right"></p>
<figcaption>JSON tree for one <code>placeVisit</code> entry</figcaption></figure>
</div>
</div>
<p>Yikes.</p>
<p>For this post, I don’t care about all the alternative possible locations or possible modes of transportation or confidence levels or anything. I cleaned those up in my <a href="https://timeline.google.com/">Google Timeline</a> before exporting the data, so I’m pretty confident everything is relatively correct.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
More on cleaning up your Google Timeline
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Google actually has a really nice web-based frontend for your whole location history at <a href="https://timeline.google.com">Google Timeline</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/google-timeline.png" class="img-fluid figure-img"></p>
<figcaption>My Google Timeline from June 4, 2023</figcaption></figure>
</div>
<p>Before downloading my location data from this road trip, I checked my history for each day at Google Timeline to confirm that it was marking the right trips locations. It generally did a good job, but when an entry has lower confidence (the <code>confidence</code> entry in the JSON data), Google shows you its uncertainty. For instance, here it’s not sure about two stops:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/timeline-confirm-location.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Google’s uncertainty about two locations</figcaption></figure>
</div>
<p>Those are both correct, so I clicked on the check to confirm.</p>
<p>Other times, it gets things wrong. Like here, it thought I was on a motorcycle for this leg of the trip:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/timeline-motorcycle.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Google’s incorrect guess that I was motorcycling instead of driving</figcaption></figure>
</div>
<p>That’s obviously not correct, so I edited it to be “Driving” instead:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/timeline-fixed.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Switching motorcylcing to driving</figcaption></figure>
</div>
<p>And other times, when cell reception is bad, it misses entire activities. Like here, where we went to <a href="https://www.nps.gov/deto/index.htm">Devil’s Tower</a> where there’s no cell reception at all, Google saw that we left the hotel at 8:14 AM and somehow magically arrived at Devil’s Tower at 9:21 AM. It failed to record how we did it, so I clicked on “Add activity” and told Google I was driving.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/timeline-missing-activity.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Missing activity</figcaption></figure>
</div>
</div>
</div>
</div>
<p>Here’s all I’ll worry about here:</p>
<p><strong>For <code>placeVisit</code>s:</strong></p>
<ul>
<li>Location coordinates (<code>location</code> → <code>latitudeE7</code> and <code>location</code> → <code>longitudeE7</code>)</li>
<li>Location ID (<code>location</code> → <code>placeId</code>): Google’s internal ID for the place</li>
<li>Location name (<code>location</code> → <code>name</code>)</li>
<li>Location address (<code>location</code> → <code>address</code>)</li>
<li>Start and end times (<code>duration</code> → <code>startTimestamp</code> and <code>duration</code> → <code>endTimestamp</code>)</li>
</ul>
<p><strong>For <code>activitySegment</code>s:</strong></p>
<ul>
<li>Distance (<code>distance</code>)</li>
<li>Activity type (<code>activityType</code>)</li>
<li>Start and end coordinates (<code>startLocation</code> → (<code>latitudeE7</code> &amp; <code>longitudeE7</code>) and <code>endLocation</code> → (<code>latitudeE7</code> &amp; <code>longitudeE7</code>))</li>
<li>Start and end times (<code>duration</code> → <code>startTimestamp</code> and <code>duration</code> → <code>endTimestamp</code>)</li>
</ul></section></section><section id="loading-and-playing-with-your-location-history-in-r" class="level1"><h1>Loading and playing with your location history in R</h1>
<p>We can load all these JSON files with R using the <code><a href="https://jeroen.r-universe.dev/jsonlite/reference/read_json.html">read_json()</a></code> function from {jsonlite}, but we need to do a little bit of fancy data wrangling with the more complex semantic location history JSON files.</p>
<section id="records.json" class="level2"><h2 class="anchored" data-anchor-id="records.json"><code>Records.json</code></h2>
<section id="loading-and-cleaning-data" class="level3"><h3 class="anchored" data-anchor-id="loading-and-cleaning-data">Loading and cleaning data</h3>
<p>Loading <code>Records.json</code> is easy. Because it is essentially rectangular data already, we can use <code>simplifyVector = TRUE</code> to have R convert the <code>locations</code> slot of the JSON file to a data frame automatically.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_locations_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/read_json.html">read_json</a></span><span class="op">(</span><span class="st">"data/Records.json"</span>, simplifyVector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Pull out the "locations" slot (this is the same as doing full_data$locations)</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"locations"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make this a tibble just so it prints nicer here on the blog</span></span>
<span>  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="va">all_locations_raw</span></span>
<span><span class="co">## # A tibble: 2,288 × 15</span></span>
<span><span class="co">##    latitudeE7 longitudeE7 accuracy velocity heading altitude verticalAccuracy deviceTag platformType serverTimestamp          batteryCharging formFactor timestamp                source deviceTimestamp</span></span>
<span><span class="co">##         &lt;int&gt;       &lt;int&gt;    &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;int&gt;            &lt;int&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;                    &lt;lgl&gt;           &lt;chr&gt;      &lt;chr&gt;                    &lt;chr&gt;  &lt;chr&gt;          </span></span>
<span><span class="co">##  1  338465853  -843051758        4       30     205      271                3         0 IOS          2023-06-03T12:00:21.140Z TRUE            PHONE      2023-06-03T12:00:21.001Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  2  338361607  -843273246       25       32     238      272                3         0 IOS          2023-06-03T12:01:41.112Z TRUE            PHONE      2023-06-03T12:01:41Z     &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  3  338283154  -843438356        4       29     228      270                3         0 IOS          2023-06-03T12:02:36.183Z TRUE            PHONE      2023-06-03T12:02:36.001Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  4  338185757  -843621145        4       30     203      259                3         0 IOS          2023-06-03T12:03:46.098Z TRUE            PHONE      2023-06-03T12:03:46Z     &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  5  338086421  -843782498        4       30     233      277                3         0 IOS          2023-06-03T12:04:51.107Z TRUE            PHONE      2023-06-03T12:04:51.001Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  6  337970326  -843935971        4       27     192      269                3         0 IOS          2023-06-03T12:05:56.167Z TRUE            PHONE      2023-06-03T12:05:55.999Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  7  337805263  -843911732        4       27     180      282                3         0 IOS          2023-06-03T12:07:03.134Z TRUE            PHONE      2023-06-03T12:07:03.001Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  8  337672676  -843890003        4       23     125      291                3         0 IOS          2023-06-03T12:08:08.143Z TRUE            PHONE      2023-06-03T12:08:08Z     &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">##  9  337553940  -843786019        4       27     181      310                3         0 IOS          2023-06-03T12:09:16.194Z TRUE            PHONE      2023-06-03T12:09:16.001Z &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">## 10  337437364  -843914546        4       26     207      295                3         0 IOS          2023-06-03T12:10:24.118Z TRUE            PHONE      2023-06-03T12:10:24Z     &lt;NA&gt;   &lt;NA&gt;           </span></span>
<span><span class="co">## # ℹ 2,278 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We need to clean this data up a bit before using it:</p>
<ul>
<li><p>Right now the latitude and longitude coordinates are multiplied by 10,000,000, and they’re just numbers—R doesn’t know that they’re geographic coordinates. We need to divide them by <span class="math inline">\(10^7\)</span> and then use them to create an {sf}-enabled <code>geometry</code> column using <code>st_as_sf()</code> from {sf}.</p></li>
<li>
<p>Right now all the timestamps are in UTC (Greenwich Mean Time), not local time. Ordinarily converting UTC times to local time zones is really easy with <code>with_tz()</code> from {lubridate}:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># One of the times from the trip</span></span>
<span><span class="va">time_utc</span> <span class="op">&lt;-</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="st">"2023-06-03 14:27:23"</span><span class="op">)</span></span>
<span><span class="va">time_utc</span></span>
<span><span class="co">## [1] "2023-06-03 14:27:23 UTC"</span></span>
<span></span>
<span><span class="co"># Convert it to US Central Daylight Time since we were in Alabama at the time</span></span>
<span><span class="fu">with_tz</span><span class="op">(</span><span class="va">time_utc</span>, tzone <span class="op">=</span> <span class="st">"America/Chicago"</span><span class="op">)</span></span>
<span><span class="co">## [1] "2023-06-03 09:27:23 CDT"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, this was a big road trip and we covered every possible time zone in the continental US (technically not Pacific Daylight Time, but Arizona doesn’t use daylight saving time, so it’s the same time as Pacific time during the summer), so we can’t just convert all the timestamps to just one time zone. We need to figure out which US time zone each latitude/longitude point is in.</p>
<p>I fretted a lot about the best way to do this! I eventually stumbled across <a href="https://github.com/evansiroky/timezone-boundary-builder">a project that has shapefiles for all the world’s time zones</a> and was about to start using that to look up which time zone each point fell inside, but then I discovered that there’s already an R package that does this (and it uses the same time zone boundary project behind the scenes): <a href="https://andyteucher.ca/lutz/">{lutz}</a> (<strong>l</strong>ook <strong>u</strong>p <strong>t</strong>ime <strong>z</strong>ones). We just have to use <code>tz_lookup()</code> and it’ll identify the correct time zone for each point.</p>
<p>But there’s one more wrinkle! This is <em>surprisingly</em> difficult! You’d think we could just use something like <code>mutate(local_time = with_tz(timestamp, tzone = "whatever")</code> and make a local time column, but NOPE. R stores time zone details as an attribute for the entire column, so there’s no way to have a column with times across multiple time zones (<a href="https://github.com/tidyverse/lubridate/issues/359">see this issue here</a>). Notice how the <code>local_time</code> column here is the same regardless of time zone:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example_thing</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">timestamp</span>, <span class="op">~</span><span class="va">tz</span>,</span>
<span>  <span class="st">"2023-06-01 00:00:00"</span>, <span class="st">"America/New_York"</span>,</span>
<span>  <span class="st">"2023-06-01 01:00:00"</span>, <span class="st">"America/New_York"</span>,</span>
<span>  <span class="st">"2023-06-01 00:00:00"</span>, <span class="st">"America/Phoenix"</span>,</span>
<span>  <span class="st">"2023-06-01 01:00:00"</span>, <span class="st">"America/Phoenix"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>timestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">timestamp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># The local times are all the same (New York) because columns can only have one time zone</span></span>
<span><span class="va">example_thing</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Have to use rowwise() because with_tz() isn't vectorized (with good reason)</span></span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>local_time <span class="op">=</span> <span class="fu">with_tz</span><span class="op">(</span><span class="va">timestamp</span>, tzone <span class="op">=</span> <span class="va">tz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 4 × 3</span></span>
<span><span class="co">## # Rowwise: </span></span>
<span><span class="co">##   timestamp           tz               local_time         </span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;chr&gt;            &lt;dttm&gt;             </span></span>
<span><span class="co">## 1 2023-06-01 00:00:00 America/New_York 2023-05-31 20:00:00</span></span>
<span><span class="co">## 2 2023-06-01 01:00:00 America/New_York 2023-05-31 21:00:00</span></span>
<span><span class="co">## 3 2023-06-01 00:00:00 America/Phoenix  2023-05-31 20:00:00</span></span>
<span><span class="co">## 4 2023-06-01 01:00:00 America/Phoenix  2023-05-31 21:00:00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>So as a workaround, we can group by time zone, which lets us work on a smaller subset of the data for each time zone, thus getting around the “one time zone per column” rule. However, that still doesn’t quite work, because when R is done with the grouping, it puts everything back together in one column, thus breaking the “one time zone per column” rule, and New York time takes over for the whole column again:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example_thing</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>local_time <span class="op">=</span> <span class="fu">with_tz</span><span class="op">(</span><span class="va">timestamp</span>, <span class="va">tz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 4 × 3</span></span>
<span><span class="co">## # Groups:   tz [2]</span></span>
<span><span class="co">##   timestamp           tz               local_time         </span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;chr&gt;            &lt;dttm&gt;             </span></span>
<span><span class="co">## 1 2023-06-01 00:00:00 America/New_York 2023-05-31 20:00:00</span></span>
<span><span class="co">## 2 2023-06-01 01:00:00 America/New_York 2023-05-31 21:00:00</span></span>
<span><span class="co">## 3 2023-06-01 00:00:00 America/Phoenix  2023-05-31 20:00:00</span></span>
<span><span class="co">## 4 2023-06-01 01:00:00 America/Phoenix  2023-05-31 21:00:00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To get around that, we can use <code>force_tz()</code> to convert each local time back to a fake version of UTC. Each timestamp all have the same time zone attribute (UTC), but the time will be US Eastern, Central, Mountain, or whatever. It’s the local time as if it were UTC. It works!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">example_thing</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>local_time <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">timestamp</span>, <span class="va">tz</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 4 × 3</span></span>
<span><span class="co">## # Groups:   tz [2]</span></span>
<span><span class="co">##   timestamp           tz               local_time         </span></span>
<span><span class="co">##   &lt;dttm&gt;              &lt;chr&gt;            &lt;dttm&gt;             </span></span>
<span><span class="co">## 1 2023-06-01 00:00:00 America/New_York 2023-05-31 20:00:00</span></span>
<span><span class="co">## 2 2023-06-01 01:00:00 America/New_York 2023-05-31 21:00:00</span></span>
<span><span class="co">## 3 2023-06-01 00:00:00 America/Phoenix  2023-05-31 17:00:00</span></span>
<span><span class="co">## 4 2023-06-01 01:00:00 America/Phoenix  2023-05-31 18:00:00</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</li>
<li><p>Finally we’ll add some extra columns for the day, month, and year based on the local time. The file I’m working with here only contains a few days from our trip, but if you’re using your own data, you’ll likely have years of entries, so these columns help with filtering (i.e.&nbsp;you can use <code>filter(year == 2017)</code> to see your whole location history for that year.)</p></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_locations</span> <span class="op">&lt;-</span> <span class="va">all_locations_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Scale down the location data (divide any column that ends in E7 by 10000000)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">ends_with</span><span class="op">(</span><span class="st">"E7"</span><span class="op">)</span>, <span class="op">~</span> <span class="va">.</span> <span class="op">/</span> <span class="fl">1e7</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Create a geometry column with the coordinates</span></span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitudeE7"</span>, <span class="st">"latitudeE7"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"EPSG:4326"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make a column with the time zone for each point</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>tz <span class="op">=</span> <span class="fu">tz_lookup</span><span class="op">(</span><span class="va">.</span>, method <span class="op">=</span> <span class="st">"accurate"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Convert the timestamp to an actual UTC-based timestamp</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>timestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">timestamp</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Create a version of the timestamp in local time, but in UTC</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>timestamp_local <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">timestamp</span>, <span class="va">tz</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add some helper columns for filtering, grouping, etc.</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">timestamp_local</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">timestamp_local</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">timestamp_local</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    day_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">timestamp_local</span>, <span class="st">"%B %e"</span><span class="op">)</span>,</span>
<span>    <span class="co"># With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span>    <span class="co"># any double spaces and replace them with single spaces </span></span>
<span>    <span class="co"># (e.g., "June  3" becomes "June 3")</span></span>
<span>    day_month <span class="op">=</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">day_month</span>, <span class="st">"  "</span>, <span class="st">" "</span><span class="op">)</span>,</span>
<span>    day_month <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">day_month</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">all_locations</span></span>
<span><span class="co">## Simple feature collection with 2288 features and 19 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -111.6 ymin: 29.4 xmax: -84.31 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 2,288 × 20</span></span>
<span><span class="co">##    accuracy velocity heading altitude verticalAccuracy deviceTag platformType serverTimestamp          batteryCharging formFactor timestamp           source deviceTimestamp       geometry tz               timestamp_local      year month   day day_month</span></span>
<span><span class="co">##  *    &lt;int&gt;    &lt;int&gt;   &lt;int&gt;    &lt;int&gt;            &lt;int&gt;     &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;                    &lt;lgl&gt;           &lt;chr&gt;      &lt;dttm&gt;              &lt;chr&gt;  &lt;chr&gt;              &lt;POINT [°]&gt; &lt;chr&gt;            &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;    </span></span>
<span><span class="co">##  1        4       30     205      271                3         0 IOS          2023-06-03T12:00:21.140Z TRUE            PHONE      2023-06-03 12:00:21 &lt;NA&gt;   &lt;NA&gt;            (-84.31 33.85) America/New_York 2023-06-03 08:00:21  2023     6     3 June 3   </span></span>
<span><span class="co">##  2       25       32     238      272                3         0 IOS          2023-06-03T12:01:41.112Z TRUE            PHONE      2023-06-03 12:01:41 &lt;NA&gt;   &lt;NA&gt;            (-84.33 33.84) America/New_York 2023-06-03 08:01:41  2023     6     3 June 3   </span></span>
<span><span class="co">##  3        4       29     228      270                3         0 IOS          2023-06-03T12:02:36.183Z TRUE            PHONE      2023-06-03 12:02:36 &lt;NA&gt;   &lt;NA&gt;            (-84.34 33.83) America/New_York 2023-06-03 08:02:36  2023     6     3 June 3   </span></span>
<span><span class="co">##  4        4       30     203      259                3         0 IOS          2023-06-03T12:03:46.098Z TRUE            PHONE      2023-06-03 12:03:46 &lt;NA&gt;   &lt;NA&gt;            (-84.36 33.82) America/New_York 2023-06-03 08:03:46  2023     6     3 June 3   </span></span>
<span><span class="co">##  5        4       30     233      277                3         0 IOS          2023-06-03T12:04:51.107Z TRUE            PHONE      2023-06-03 12:04:51 &lt;NA&gt;   &lt;NA&gt;            (-84.38 33.81) America/New_York 2023-06-03 08:04:51  2023     6     3 June 3   </span></span>
<span><span class="co">##  6        4       27     192      269                3         0 IOS          2023-06-03T12:05:56.167Z TRUE            PHONE      2023-06-03 12:05:55 &lt;NA&gt;   &lt;NA&gt;             (-84.39 33.8) America/New_York 2023-06-03 08:05:55  2023     6     3 June 3   </span></span>
<span><span class="co">##  7        4       27     180      282                3         0 IOS          2023-06-03T12:07:03.134Z TRUE            PHONE      2023-06-03 12:07:03 &lt;NA&gt;   &lt;NA&gt;            (-84.39 33.78) America/New_York 2023-06-03 08:07:03  2023     6     3 June 3   </span></span>
<span><span class="co">##  8        4       23     125      291                3         0 IOS          2023-06-03T12:08:08.143Z TRUE            PHONE      2023-06-03 12:08:08 &lt;NA&gt;   &lt;NA&gt;            (-84.39 33.77) America/New_York 2023-06-03 08:08:08  2023     6     3 June 3   </span></span>
<span><span class="co">##  9        4       27     181      310                3         0 IOS          2023-06-03T12:09:16.194Z TRUE            PHONE      2023-06-03 12:09:16 &lt;NA&gt;   &lt;NA&gt;            (-84.38 33.76) America/New_York 2023-06-03 08:09:16  2023     6     3 June 3   </span></span>
<span><span class="co">## 10        4       26     207      295                3         0 IOS          2023-06-03T12:10:24.118Z TRUE            PHONE      2023-06-03 12:10:24 &lt;NA&gt;   &lt;NA&gt;            (-84.39 33.74) America/New_York 2023-06-03 08:10:24  2023     6     3 June 3   </span></span>
<span><span class="co">## # ℹ 2,278 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Over the 4 days I’ve included in this JSON file, Google recorded my location 2,288 times(!!).</p>
</section><section id="basic-maps" class="level3"><h3 class="anchored" data-anchor-id="basic-maps">Basic maps</h3>
<p>Since we converted the latitude and longitude coordinates into a <code>geometry</code> column, we can plot it really easily:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># I used https://www.openstreetmap.org/export to make this window</span></span>
<span><span class="va">trip_window</span> <span class="op">&lt;-</span> <span class="fu">st_sfc</span><span class="op">(</span></span>
<span>  <span class="fu">st_point</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">115.137</span>, <span class="fl">24.567</span><span class="op">)</span><span class="op">)</span>,  <span class="co"># left (west), bottom (south)</span></span>
<span>  <span class="fu">st_point</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">79.146</span>, <span class="fl">37.475</span><span class="op">)</span><span class="op">)</span>,   <span class="co"># right (east), top (north)</span></span>
<span>  crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"EPSG:4326"</span><span class="op">)</span>  <span class="co"># WGS 84</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_coordinates</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">trip_window</span></span>
<span><span class="co">##            X     Y</span></span>
<span><span class="co">## [1,] -115.14 24.57</span></span>
<span><span class="co">## [2,]  -79.15 37.48</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lower_48</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">all_locations</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"X"</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"Y"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip_map</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/basic-map-points-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>That looks like a solid thick black line, but it’s not. It’s actually 2,288 individual dots. We can confirm if we zoom in really close (this is the area around The Alamo in San Antonio, Texas):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_locations</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addCircles</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># I got these coordinates from Google Maps</span></span>
<span>  <span class="fu">setView</span><span class="op">(</span>lat <span class="op">=</span> <span class="fl">29.425733271447523</span>, lng <span class="op">=</span> <span class="op">-</span><span class="fl">98.48627553904525</span>, zoom <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1b4ff99564eb6e8884a5" style="width:100%;height:415.327564894932px;"></div>
<script type="application/json" data-for="htmlwidget-1b4ff99564eb6e8884a5">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addCircles","args":[[33.8465853,33.8361607,33.8283154,33.8185757,33.8086421,33.7970326,33.7805263,33.7672676,33.755394,33.7437364,33.7266033,33.7120551,33.6977384,33.6854827,33.6724931,33.6614919,33.6505909,33.6382219,33.6206107,33.6188275,33.6017875,33.5894309,33.575587,33.5612994,33.551666,33.5419701,33.5307047,33.5196752,33.5025841,33.4868779,33.4695842,33.4529994,33.4410196,33.4307704,33.4164157,33.400236,33.3845295,33.367116,33.3473453,33.329622,33.3141708,33.2946076,33.2756129,33.2570992,33.2388582,33.2211068,33.2070114,33.1947363,33.1800601,33.1635535,33.1469295,33.1313731,33.1133854,33.0953763,33.0804292,33.0661186,33.0536296,33.0401393,33.0241776,33.0100232,32.9975247,32.984959,32.9766727,32.9661492,32.9520121,32.9343297,32.9153437,32.8990072,32.8830232,32.8685804,32.8535169,32.8390878,32.8251834,32.8092655,32.7935376,32.7775912,32.761054,32.7444772,32.7263163,32.7074977,32.6889266,32.6724289,32.655765,32.6396942,32.6307417,32.62115,32.6111249,32.6023451,32.5912678,32.5778347,32.566639,32.5567551,32.5458052,32.5357867,32.5268961,32.5138636,32.5051784,32.4927251,32.4830665,32.4761401,32.472994,32.4659154,32.4543746,32.4479079,32.4456109,32.4450559,32.4421467,32.4368088,32.4369081,32.4282755,32.4253472,32.417796,32.4046326,32.3937649,32.383276,32.3772266,32.3708433,32.368239,32.3663068,32.3681836,32.3674677,32.3623099,32.3620472,32.3633132,32.3601972,32.3625554,32.3656225,32.3679243,32.365449,32.3490366,32.3348526,32.3281331,32.328181,32.3282387,32.328219,32.3281521,32.3281942,32.3283146,32.3284652,32.3284945,32.3284747,32.3285068,32.3284623,32.3284699,32.3283168,32.3284881,32.3282939,32.3283059,32.3284885,32.3283173,32.328255,32.3282621,32.3280175,32.3283076,32.3228458,32.3025838,32.2837481,32.2660126,32.2490936,32.2318429,32.2169014,32.2000606,32.181882,32.1638748,32.145883,32.1284689,32.1106098,32.0933267,32.0732255,32.0565843,32.0388402,32.0210906,32.0014736,31.9819484,31.9615367,31.94599,31.9284032,31.9098954,31.8919927,31.8740803,31.8587958,31.8456354,31.8275285,31.8072821,31.7872142,31.7708241,31.7520598,31.7338749,31.7160622,31.6990567,31.685201,31.6683284,31.6502702,31.6339555,31.6177417,31.6021115,31.5862065,31.5722019,31.5591425,31.5468064,31.5334551,31.5170671,31.5010555,31.4857736,31.4703785,31.4530374,31.4368718,31.4246471,31.4100812,31.394028,31.3774742,31.3629033,31.3511947,31.3421016,31.3316287,31.3188693,31.3076475,31.2942295,31.2793378,31.2651871,31.2513789,31.24066,31.2302515,31.2176633,31.202361,31.1876348,31.1727007,31.1615484,31.1514874,31.1420276,31.1317233,31.1210225,31.1109729,31.1047457,31.0951692,31.0828245,31.0691315,31.061016,31.0500195,31.0412343,31.0337267,31.0214083,31.0091086,30.9958549,30.98203,30.9725589,30.9655336,30.961153,30.9583572,30.9536361,30.9520923,30.946395,30.9410888,30.9349072,30.928652,30.9189927,30.9095054,30.905613,30.8946628,30.8835377,30.8722132,30.8603503,30.8421501,30.8246759,30.8062728,30.7899996,30.7746541,30.7557289,30.7410989,30.7278948,30.7088952,30.6892435,30.6709399,30.6520902,30.6339786,30.622899,30.6112068,30.5984575,30.5952165,30.5968347,30.5947506,30.5945862,30.5946134,30.593956,30.5942222,30.5953955,30.5953997,30.5953938,30.5942057,30.5944558,30.595026,30.5949843,30.5952165,30.5966323,30.586948,30.5760961,30.5650693,30.5534265,30.5438065,30.5351421,30.5256766,30.5145257,30.5057563,30.4990393,30.4948295,30.4888101,30.4806684,30.4719487,30.4635727,30.4592954,30.4574283,30.4554239,30.4462839,30.4397106,30.4384038,30.4381834,30.4379877,30.4371161,30.4348084,30.4328351,30.4358939,30.4442478,30.4474018,30.4554281,30.458571,30.4545417,30.4543823,30.4542241,30.4540025,30.4476636,30.4521596,30.4607795,30.4580429,30.4494179,30.4452661,30.4414173,30.4375919,30.4315039,30.4261591,30.4236737,30.4187226,30.4172202,30.4116514,30.4044444,30.403439,30.4040394,30.4006194,30.3902237,30.382794,30.3757163,30.3689249,30.3621521,30.3561502,30.3503511,30.3446993,30.3389576,30.333219,30.3333054,30.3273871,30.3210271,30.314124,30.30707,30.3021601,30.2974261,30.2975609,30.2989761,30.3045912,30.2907077,30.2724161,30.2553238,30.236162,30.2209636,30.2060746,30.1909248,30.1756789,30.1603898,30.1453435,30.1279953,30.1126541,30.0977123,30.0822151,30.0674338,30.0559491,30.0492333,30.0483896,30.0481172,30.0486619,30.0483953,30.0493447,30.0486958,30.0487032,30.0489771,30.0488432,30.0488832,30.0488515,30.0489484,30.0488609,30.0491397,30.0486922,30.0485854,30.0486399,30.0484413,30.0475104,30.0477322,30.0477151,30.0476216,30.0485587,30.0425982,30.033528,30.0274905,30.0179842,30.0059231,30.0024907,29.9910691,29.9782112,29.96631,29.9645202,29.9614949,29.9597695,29.9561512,29.9588282,29.9578756,29.9572829,29.9569766,29.9564419,29.956197,29.9569818,29.9578915,29.958136,29.9578768,29.9576923,29.9570057,29.9567951,29.9576175,29.9575051,29.9566267,29.9566282,29.9551868,29.9550549,29.955944,29.9571275,29.9567951,29.9593109,29.9620029,29.960799,29.9615694,29.9621612,29.9614436,29.9620029,29.9574772,29.959868,29.959701,29.9591854,29.9589734,29.9584065,29.9579042,29.9574824,29.9590051,29.9563931,29.957031,29.9565776,29.9563484,29.95623,29.9562698,29.9562665,29.9562579,29.9560295,29.9562264,29.9566011,29.9563931,29.9573154,29.9579891,29.9596762,29.9633068,29.9681582,29.9729652,29.9794238,29.9899345,30.0015705,30.0056644,30.0180968,30.0277624,30.0348076,30.0437517,30.044553,30.0482173,30.0488184,30.0481775,30.0485714,30.0488577,30.0488991,30.0483757,30.0490243,30.0489821,30.0489226,30.0491197,30.048945,30.0488652,30.048923,30.048872,30.0489176,30.0488804,30.0489307,30.0488966,30.0489278,30.0491186,30.0490468,30.0488489,30.0488619,30.0489528,30.0488882,30.0488068,30.0488706,30.0488852,30.0490002,30.0489248,30.0487611,30.0488768,30.0488171,30.0491572,30.0488308,30.0484679,30.0489697,30.0484701,30.0490594,30.0490268,30.049002,30.0492231,30.04832,30.0486199,30.0485211,30.0486766,30.04851,30.0485164,30.0485207,30.0485315,30.0485426,30.0486791,30.0488184,30.0466457,30.0457894,30.053524,30.0513113,30.0330897,30.0158572,30.0027887,29.9876518,29.9716765,29.9576357,29.9494325,29.9429562,29.9372376,29.9406198,29.9447873,29.9447244,29.9447195,29.9455162,29.9463288,29.9419702,29.9418763,29.9418411,29.9417632,29.9408523,29.9401584,29.9419311,29.9419878,29.9423854,29.9427192,29.9431043,29.9421209,29.942002,29.9430796,29.9422869,29.9418971,29.9419082,29.9418152,29.9420659,29.941895,29.9418865,29.9418865,29.942002,29.9449369,29.9501731,29.9578683,29.9613603,29.9646362,29.966494,29.9691236,29.9697512,29.9716122,29.9738942,29.9800474,29.9904125,29.9917045,29.9921273,29.9939539,29.9957089,29.9967826,29.9976885,29.9988265,30.0008335,30.008163,30.0095047,30.0082292,30.0067708,30.0088306,30.0194187,30.0306567,30.0414135,30.0529394,30.0639916,30.075206,30.0823303,30.0888533,30.0950689,30.1018521,30.107986,30.1102461,30.1122893,30.1143561,30.1163727,30.1184716,30.1208097,30.1231064,30.1264204,30.1336406,30.1405891,30.1475801,30.151914,30.1557399,30.1622492,30.1689298,30.1772475,30.187719,30.1972445,30.2105928,30.2275046,30.2442869,30.2632523,30.2830125,30.3041545,30.3222978,30.3382712,30.3540899,30.3712223,30.3833788,30.394535,30.4080512,30.4190201,30.4223517,30.4232489,30.4236348,30.424783,30.4272611,30.4384984,30.4394988,30.4405393,30.445572,30.4494212,30.4536966,30.4524923,30.4512944,30.4465134,30.4409137,30.4353813,30.4298946,30.4225949,30.4168324,30.4114911,30.4057936,30.3997036,30.3939256,30.3884027,30.3824092,30.376519,30.370966,30.3656092,30.3608347,30.3552631,30.3500071,30.3447489,30.3398202,30.3347094,30.3290675,30.3239067,30.3192156,30.316481,30.3161281,30.3164817,30.3164817,30.316481,30.3164848,30.3164925,30.3164799,30.3166402,30.3167719,30.3167404,30.3168353,30.3166172,30.3164813,30.3164633,30.3164701,30.3164606,30.3164489,30.3164493,30.316496,30.3164746,30.316627,30.3167314,30.3167313,30.3165209,30.316527,30.3165837,30.3165775,30.3165652,30.316524,30.3165701,30.3165512,30.316569,30.3165486,30.3165732,30.3165523,30.3155591,30.3119713,30.3065294,30.3003064,30.2939645,30.2845527,30.2771102,30.2708426,30.2635503,30.2549325,30.2474187,30.2471289,30.2472771,30.2474158,30.2475565,30.2477364,30.2478235,30.2479346,30.2504388,30.2525202,30.252378,30.2467353,30.240019,30.2357022,30.2357659,30.2358427,30.2360391,30.2361764,30.2339539,30.2310425,30.2315196,30.2321887,30.2363777,30.2364564,30.2365462,30.2415237,30.2468031,30.246761,30.2466271,30.2469025,30.2479421,30.2474105,30.2473069,30.2471401,30.2468592,30.2467995,30.2467505,30.2466962,30.2467297,30.2466341,30.2467456,30.2497215,30.2496946,30.247973,30.2477934,30.2477939,30.2476477,30.2440969,30.2456995,30.246735,30.2362666,30.2359139,30.2372353,30.2371048,30.237541,30.2314602,30.2239118,30.2163161,30.2161424,30.2159036,30.2159614,30.2140834,30.2100752,30.2057801,30.2017682,30.197492,30.1931017,30.1886284,30.1874868,30.1860665,30.1875058,30.1877115,30.1874878,30.187535,30.1876029,30.1875639,30.1875872,30.1875701,30.1874138,30.1875686,30.1877636,30.1877565,30.1877457,30.1877457,30.1878483,30.1877912,30.1875657,30.1875636,30.1875651,30.187591,30.1875951,30.1873983,30.1875739,30.1823432,30.1744131,30.1657838,30.1566318,30.1486442,30.1401289,30.1319062,30.1234119,30.1187278,30.1214583,30.1214864,30.1172225,30.1147067,30.1218259,30.1299332,30.1301227,30.1310018,30.1304445,30.1297697,30.1314254,30.1358468,30.1269188,30.1145907,30.1012817,30.0949458,30.0963041,30.0961663,30.0841568,30.0670281,30.0537339,30.0422234,30.0284751,30.0153574,30.0011909,29.9890124,29.9874866,29.989025,29.9890239,29.9890124,29.9890124,29.9890124,29.9890109,29.9891113,29.9891133,29.989034,29.9890386,29.9889321,29.9889256,29.9874489,29.9769762,29.9621112,29.9477574,29.9357698,29.9233092,29.9080018,29.8964045,29.8829088,29.8728625,29.8599723,29.8447456,29.8289724,29.8273439,29.8271901,29.8289584,29.8308363,29.8325583,29.8343155,29.8361249,29.8377596,29.8386866,29.8395933,29.8404937,29.8408012,29.8401336,29.8393227,29.8389926,29.8366096,29.8321052,29.8287807,29.8265652,29.8244758,29.8225147,29.8214048,29.8131636,29.808884,29.8044727,29.8006351,29.7975388,29.7905128,29.7951881,29.7901789,29.7828702,29.7766609,29.7714946,29.7708304,29.7715225,29.7704947,29.773934,29.7748058,29.778008,29.7755132,29.7743993,29.7691574,29.768883,29.7712489,29.778919,29.7766684,29.7775736,29.7785306,29.7828751,29.7840308,29.7845221,29.784567,29.784712,29.7847984,29.7849007,29.785005,29.7850723,29.7851231,29.7851504,29.7851202,29.7853172,29.7853951,29.7853823,29.7854904,29.7856053,29.7793483,29.7774685,29.7775085,29.7774571,29.777401,29.7773386,29.7790054,29.7788481,29.7815697,29.7779346,29.7729372,29.7708885,29.7736268,29.7765488,29.7757869,29.768006,29.7613835,29.7635525,29.7607735,29.7572391,29.7543711,29.7514918,29.7475192,29.7423644,29.7377858,29.7326898,29.7281244,29.7236123,29.7188598,29.7162013,29.7127331,29.7050657,29.6980038,29.6924337,29.6937858,29.6936303,29.6934933,29.6923798,29.6909907,29.6895921,29.6886854,29.691855,29.6923799,29.6920719,29.6904329,29.68872,29.6925165,29.6965352,29.6960631,29.6952933,29.694561,29.6951115,29.6952926,29.6952938,29.6953162,29.6952929,29.6953252,29.694988,29.6951832,29.6949994,29.6950198,29.6950108,29.6950055,29.6949877,29.6950163,29.6949249,29.6949961,29.6949708,29.6950051,29.6949905,29.694985,29.6949995,29.6949799,29.6949923,29.6949923,29.6949583,29.6949834,29.6939309,29.6950355,29.690861,29.6895042,29.6901981,29.6915756,29.6937939,29.6976423,29.6978369,29.6971457,29.6965373,29.6960463,29.6920662,29.6923088,29.6925511,29.6909345,29.6812728,29.6703971,29.6680619,29.666053,29.6638229,29.661334,29.6580477,29.6554521,29.6519818,29.6499565,29.6515075,29.6529857,29.6542449,29.6522375,29.6484697,29.6502838,29.6519585,29.6471379,29.6414476,29.6355497,29.6295354,29.6234628,29.6166257,29.6150693,29.6147526,29.6096299,29.6044961,29.5995464,29.5995156,29.5994571,29.5887632,29.5759157,29.5638083,29.5490237,29.5421814,29.5351037,29.5293553,29.5215814,29.5139625,29.5066623,29.4994738,29.4921952,29.4858184,29.4791777,29.4722598,29.4657127,29.4601318,29.4538347,29.4471473,29.4398762,29.4333161,29.4273955,29.4130703,29.4068638,29.4029223,29.4028277,29.4018215,29.4027972,29.4029548,29.4029489,29.4029915,29.4029375,29.4029872,29.4029251,29.40293,29.4029577,29.4029964,29.4030033,29.4029394,29.4028663,29.4028159,29.4029047,29.4029735,29.402971,29.402975,29.4030331,29.4029135,29.4029811,29.4030115,29.4030312,29.402827,29.4028474,29.4027223,29.4029174,29.402901,29.4029499,29.4028201,29.4027942,29.4027911,29.4028048,29.4028067,29.4027969,29.4027959,29.4029773,29.4028277,29.4028592,29.4018061,29.3971059,29.4091111,29.4198411,29.4215708,29.4215708,29.4226959,29.4228618,29.4233574,29.4238629,29.4238629,29.4228989,29.4229368,29.4232088,29.4224398,29.4236948,29.4239438,29.4242142,29.4245528,29.4249606,29.4250825,29.4252131,29.4237545,29.4259096,29.4255609,29.4257454,29.4257128,29.425811,29.4260218,29.4261176,29.4263047,29.4262991,29.4257508,29.4260027,29.4256512,29.4259096,29.4247173,29.4249482,29.424958,29.4236904,29.4231377,29.4247173,29.4228447,29.4228136,29.4228447,29.4228543,29.4223451,29.4214654,29.4244437,29.4383992,29.4375824,29.4346847,29.4436294,29.4598139,29.4764605,29.4848404,29.4994078,29.5183379,29.5340672,29.5470294,29.5640557,29.582609,29.6000422,29.6160879,29.6339853,29.6499316,29.6671681,29.6855317,29.703233,29.7195113,29.7331239,29.7479716,29.7621824,29.7747121,29.7871975,29.8061248,29.8246543,29.8378831,29.8553474,29.8740292,29.8888496,29.9050816,29.9166312,29.9275443,29.9436809,29.9604115,29.9785062,29.987382,30.0001081,30.0144879,30.030925,30.0436865,30.0534454,30.0563665,30.0678059,30.0698979,30.0705143,30.0729971,30.0848332,30.0953876,30.1094422,30.1183902,30.1288541,30.1462182,30.1635141,30.1718236,30.1798222,30.1851348,30.1910586,30.1981519,30.2061596,30.2170941,30.2311212,30.2455195,30.2562995,30.2667647,30.2792336,30.2910942,30.3041594,30.3185659,30.3368985,30.3576245,30.376199,30.3940374,30.4028829,30.411977,30.4261489,30.4326427,30.4475816,30.4661494,30.4853776,30.4971405,30.5093723,30.5078481,30.5093341,30.5092842,30.509353,30.5093762,30.5093762,30.5093762,30.5091158,30.5091379,30.509263,30.5089787,30.5091819,30.5091269,30.5091004,30.5090255,30.5090199,30.5091519,30.5090295,30.5090221,30.5090031,30.509008,30.5090656,30.5091015,30.5090948,30.5090794,30.5090517,30.5090143,30.5090114,30.5090218,30.5090334,30.5091114,30.5091279,30.509153,30.5090949,30.50916,30.5091342,30.5089669,30.5090961,30.5091137,30.5091224,30.5091075,30.5090916,30.5095308,30.5155731,30.5206869,30.5263948,30.5257386,30.521266,30.514133,30.5011709,30.502665,30.499565,30.4949795,30.4956101,30.4872253,30.4831199,30.4806895,30.4741044,30.4676042,30.4602505,30.4540554,30.4464342,30.4441357,30.4469813,30.4536219,30.4623732,30.4721759,30.4820104,30.4905107,30.4997449,30.5093935,30.5195377,30.5306249,30.5414408,30.5501126,30.5581459,30.5647478,30.56817,30.5714049,30.5737024,30.5759798,30.5782051,30.5862042,30.5905234,30.5983222,30.6084548,30.6158628,30.6159177,30.6159177,30.6159177,30.6159442,30.615945,30.6159507,30.6183986,30.6217144,30.6203113,30.6213548,30.6279375,30.6344472,30.6413469,30.647875,30.6594888,30.6647679,30.669116,30.6742839,30.6799182,30.686052,30.6920937,30.6974189,30.7032523,30.7090121,30.7117672,30.7123651,30.7084867,30.7059429,30.7008529,30.6962079,30.6926178,30.6837017,30.6775566,30.6815373,30.6875281,30.6897695,30.6926688,30.6971386,30.7012187,30.7081393,30.7225587,30.7279736,30.730748,30.7338141,30.7346181,30.7377856,30.742201,30.7476341,30.7407991,30.7334443,30.722359,30.7158168,30.7171441,30.7286475,30.7403671,30.7443231,30.7485107,30.7578267,30.7679732,30.7830614,30.7993252,30.8105303,30.8256231,30.8364127,30.846146,30.8576717,30.8691182,30.877842,30.8854459,30.8921306,30.8916212,30.8935258,30.8931056,30.891124,30.8850684,30.8886106,30.8953101,30.8954239,30.8923034,30.8886856,30.8848811,30.8786211,30.8696713,30.8651162,30.8621126,30.8612475,30.8638652,30.8733272,30.8769578,30.8799581,30.8846343,30.8895136,30.8901274,30.8907464,30.8913958,30.8919809,30.8954531,30.9053575,30.9072242,30.9023997,30.9117423,30.9236961,30.9362895,30.9496983,30.9626819,30.9750872,30.9862491,30.9966061,31.0067894,31.0187309,31.0291175,31.0425461,31.0559604,31.0680859,31.0802724,31.0933402,31.1062553,31.1192344,31.1342525,31.1498098,31.1643261,31.1792094,31.1954698,31.2123287,31.2291314,31.2450689,31.2610738,31.2744772,31.2887209,31.3044786,31.3196304,31.3407316,31.359863,31.3757457,31.3896056,31.3990416,31.3989884,31.3990272,31.3990265,31.3990258,31.3989941,31.3990038,31.3986705,31.399015,31.3991125,31.3991288,31.3991378,31.3989533,31.3990051,31.3989983,31.3989849,31.3990383,31.3989704,31.3989657,31.3989891,31.3989848,31.3990038,31.4014409,31.402124,31.4050046,31.411269,31.4223238,31.4317329,31.4443276,31.4605972,31.4747691,31.4887114,31.5046576,31.5193151,31.5338121,31.5477256,31.5613592,31.5786817,31.5947328,31.6087121,31.6269522,31.6416408,31.648432,31.6546877,31.659829,31.6655745,31.6711724,31.6779387,31.6856573,31.6976348,31.7099242,31.7255386,31.7393658,31.7540745,31.7684988,31.7822298,31.7969771,31.8135032,31.8248853,31.8315656,31.8483901,31.8644699,31.8819006,31.894479,31.9081803,31.9220112,31.9358082,31.9529987,31.9696143,31.9847475,31.9984339,32.0095213,32.0192349,32.0296916,32.0436333,32.0576482,32.0704691,32.083139,32.1089903,32.1227531,32.1352155,32.1465673,32.158499,32.1697046,32.1814462,32.1934507,32.2044362,32.2154614,32.2248038,32.2313629,32.2393833,32.2491167,32.2596715,32.2674543,32.2705449,32.2746968,32.2760694,32.2774765,32.2816896,32.2860913,32.2933042,32.3013663,32.3121074,32.3230633,32.3341045,32.3460087,32.3574034,32.3701118,32.3816616,32.3876021,32.3890064,32.3932268,32.39384,32.3950488,32.4019808,32.3996297,32.4000562,32.4017108,32.4019822,32.402006,32.4020007,32.4019826,32.4015237,32.401498,32.4014477,32.401465,32.4013086,32.4015204,32.401475,32.401423,32.4013926,32.4019865,32.401526,32.4014911,32.4015289,32.4015101,32.4015638,32.4014734,32.401478,32.401515,32.4014765,32.4017801,32.4015363,32.3985848,32.3901043,32.3828983,32.3730361,32.3656891,32.3541027,32.3421912,32.3282748,32.313231,32.2968492,32.2798912,32.2627632,32.2454408,32.2287909,32.2113132,32.1978597,32.1851649,32.1759155,32.178348,32.1883302,32.1896225,32.1901942,32.1812458,32.1748631,32.1748539,32.1747882,32.1749049,32.1748616,32.1753629,32.1751983,32.1750785,32.1754145,32.1751511,32.1748699,32.1751541,32.1750228,32.1749224,32.1749417,32.1749555,32.1749415,32.1749182,32.1750095,32.175166,32.1740686,32.1792362,32.1824583,32.192066,32.1919319,32.1875323,32.1807993,32.1750985,32.1804425,32.1933881,32.2068119,32.2215396,32.2386683,32.2570896,32.2755244,32.2938933,32.3123943,32.330629,32.3465337,32.3601542,32.3703024,32.370427,32.3829743,32.3939728,32.3963634,32.4030209,32.4137359,32.4146754,32.4146817,32.4227966,32.4312838,32.4407674,32.4512995,32.4656893,32.4812548,32.4859967,32.4918643,32.5003348,32.5155014,32.5319325,32.5513967,32.5690746,32.585922,32.604545,32.6221628,32.63993,32.6589936,32.6783401,32.6988503,32.718401,32.7390731,32.7589929,32.7802236,32.8002107,32.8181295,32.8321041,32.8421897,32.8465203,32.8594205,32.873199,32.8879281,32.9006235,32.9160909,32.9340374,32.9518378,32.9695445,32.9888458,33.0069707,33.0270578,33.0491246,33.0695959,33.0891425,33.1109744,33.1315089,33.1537521,33.1745248,33.1958054,33.2159867,33.2379765,33.2581503,33.2795075,33.2986757,33.3119484,33.3235671,33.3393592,33.3545015,33.3651651,33.3725843,33.3794427,33.3869677,33.3930092,33.3951118,33.4000425,33.4081553,33.4119601,33.4154804,33.4226033,33.4293714,33.4357546,33.4466682,33.4583673,33.4721752,33.4897897,33.5063839,33.5251106,33.544604,33.564614,33.5843942,33.6011374,33.6183707,33.6348775,33.6530081,33.6721243,33.6906493,33.7108951,33.7297246,33.7481566,33.7690489,33.7878213,33.8090325,33.8308589,33.8510288,33.8723171,33.8939875,33.9138599,33.929162,33.9431777,33.9586869,33.9736239,33.9884392,34.0021118,34.0183205,34.0336234,34.0487774,34.0668403,34.0850521,34.1014219,34.1200188,34.1381324,34.1568966,34.1735717,34.1922368,34.2125463,34.2327343,34.2516862,34.2694625,34.2883671,34.3090363,34.3269202,34.3442642,34.3610804,34.3797262,34.3985789,34.4177165,34.4353859,34.4545089,34.4720834,34.4894228,34.5077363,34.5251559,34.5423189,34.5596154,34.5778869,34.5924974,34.5945248,34.5944867,34.5944934,34.5944991,34.5945109,34.5944907,34.5944748,34.5944854,34.5944891,34.5946518,34.5946711,34.5947363,34.5947038,34.5947789,34.5947491,34.5947497,34.5947625,34.5947545,34.5947586,34.594742,34.5947335,34.5947335,34.5947786,34.5947756,34.5947205,34.5947176,34.5947213,34.5946146,34.5947492,34.594756,34.5947873,34.5947612,34.5947712,34.5947759,34.5948163,34.5946867,34.6017386,34.6016788,34.5958313,34.5891509,34.5896764,34.5888339,34.5917502,34.5966768,34.6047014,34.6149298,34.6262499,34.6405385,34.6444812,34.6487808,34.6514862,34.6590614,34.6754248,34.6952135,34.7144326,34.7342148,34.7525363,34.7703032,34.7895298,34.8091983,34.8292074,34.8474105,34.8646119,34.88414,34.9042143,34.921876,34.9420986,34.9607739,34.9799413,35.000891,35.0088318,35.0099364,35.008398,35.0044774,35.0047459,35.0049589,35.0051372,35.0053809,35.0053601,35.0059824,35.0066964,35.0050424,35.0049261,35.0048397,35.0048197,35.0079094,35.0114751,35.0194762,35.0290767,35.0387478,35.0480979,35.0566035,35.0645309,35.0726382,35.0814756,35.088602,35.0962417,35.1023702,35.1111509,35.113574,35.1021981,35.0954444,35.0829986,35.080734,35.0665656,35.0616827,35.0632863,35.0669839,35.0742183,35.0813559,35.0885385,35.0965258,35.1039106,35.1047132,35.1073164,35.1075969,35.1061973,35.1055435,35.105164,35.105784,35.1063613,35.1065287,35.1050557,35.106196,35.1058121,35.0986265,35.0900263,35.081275,35.0739654,35.0675105,35.0639599,35.0645294,35.0640966,35.0645294,35.0645294,35.0645294,35.0645294,35.0645294,35.0645322,35.0645486,35.0645577,35.0645296,35.0645222,35.0645523,35.0645284,35.064505,35.0645005,35.0645542,35.0634664,35.0644223,35.0652777,35.0640558,35.0592415,35.0558055,35.0523997,35.0488635,35.0448182,35.0401843,35.0358741,35.030635,35.0253887,35.0202859,35.0135096,35.0077361,35.0012449,34.9949984,34.9887588,34.9817781,34.9787718,34.9826159,34.9862387,34.9897118,34.9930999,34.9934584,34.9937824,35.0025274,35.017368,35.0332082,35.0391018,35.029908,35.0265375,35.0271522,35.0302848,35.0368259,35.047355,35.0605923,35.0738915,35.0744572,35.0751699,35.0758735,35.0763587,35.0727691,35.0652964,35.0644247,35.0684066,35.0759623,35.0902105,35.1033375,35.1154314,35.128837,35.1436452,35.1534231,35.1648985,35.18431,35.2018107,35.2190945,35.2345084,35.2490647,35.2654321,35.284429,35.3044611,35.3244826,35.345128,35.3557055,35.3640564,35.3711625,35.3757293,35.3814413,35.3862194,35.3889273,35.3909351,35.3956468,35.4004878,35.4050212,35.4127504,35.4220817,35.4307836,35.4394532,35.4475328,35.4549797,35.464288,35.4773664,35.483616,35.4892465,35.4952292,35.5039893,35.5126304,35.519325,35.5263163,35.5304126,35.5318327,35.5309028,35.5312918,35.5301682,35.5292555,35.5289845,35.5293723,35.5288397,35.5288977,35.5289845,35.5290159,35.5290302,35.5289874,35.5289909,35.5288933,35.5289843,35.528964,35.5289934,35.5290217,35.528932,35.5289492,35.5289703,35.5289723,35.5290658,35.5288293,35.5288409,35.5288004,35.5290036,35.5288503,35.5288727,35.5288727,35.5288727,35.5288727,35.5288727,35.5288419,35.5288419,35.5288452,35.5288557,35.5288365,35.5288345,35.5288391,35.5288479,35.5291518,35.5292278,35.5289354,35.5294794,35.5297754,35.5298036,35.5297781,35.5297754,35.5297754,35.5297666,35.529744,35.5300424,35.5299654,35.5339859,35.5309401,35.5278771,35.5217775,35.5141771,35.5111428,35.4994334,35.4963824,35.4904935,35.4830319,35.4717062,35.4574662,35.4394875,35.4266782,35.4117447,35.3926383,35.377855,35.367649,35.3532386,35.3371731,35.323655,35.3117692,35.302201,35.29322,35.2845946,35.2810577,35.2829158,35.2830549,35.2784036,35.2678001,35.2520653,35.2382046,35.2252827,35.2138626,35.2065143,35.201923,35.197377,35.19283,35.1898783,35.1904123,35.1899125,35.189917,35.1904394,35.1868323,35.1762627,35.1643605,35.1524732,35.1406332,35.1286086,35.1195993,35.1117762,35.1048929,35.1009459,35.0976543,35.0936916,35.0873559,35.0808512,35.0745756,35.0679109,35.0583592,35.0460352,35.0345984,35.0225393,35.0097146,35.0016478,34.9969775,34.9929113,34.9909038,34.9910128,34.9869085,34.9825768,34.9782519,34.9711568,34.9576821,34.9425257,34.9248805,34.913242,34.9085861,34.9063653,34.9091291,34.9145187,34.9253092,34.9385273,34.947186,34.9551148,34.9546357,34.9584739,34.9623448,34.966522,34.9700623,34.9711846,34.9722381,34.9733671,34.9787203,34.9866368,34.9940989,35.0017038,35.0069728,35.010289,35.0159626,35.0271007,35.0396161,35.038473,35.039775,35.0454316,35.0515274,35.0577443,35.0645163,35.0707673,35.0763362,35.0820775,35.0886579,35.0934724,35.0963778,35.0995505,35.1016518,35.1059921,35.1100548,35.1122864,35.1143879,35.1174734,35.1166029,35.1186637,35.1208743,35.1274509,35.1349042,35.1431939,35.1507018,35.1586973,35.1601679,35.1614299,35.1698075,35.178032,35.1865248,35.1949416,35.2026903,35.2018772,35.2025624,35.2020213,35.2062784,35.2097034,35.2146846,35.2186688,35.2179974,35.2210796,35.2159135,35.2150697,35.2113672],[-84.3051758,-84.3273246,-84.3438356,-84.3621145,-84.3782498,-84.3935971,-84.3911732,-84.3890003,-84.3786019,-84.3914546,-84.3937695,-84.4013967,-84.4049403,-84.4033858,-84.4144991,-84.4276159,-84.4421424,-84.4564173,-84.4613678,-84.4839758,-84.4887164,-84.5062481,-84.5248002,-84.5424602,-84.5646385,-84.5866331,-84.6059195,-84.6256142,-84.6374356,-84.6520712,-84.6677062,-84.680744,-84.69883,-84.7179306,-84.7318536,-84.7456314,-84.7562372,-84.7596283,-84.7612124,-84.7728107,-84.786625,-84.7947233,-84.8018032,-84.8058839,-84.807025,-84.8150928,-84.8312521,-84.8458617,-84.8593035,-84.8675704,-84.878876,-84.89168,-84.9028912,-84.9093494,-84.9206745,-84.9385745,-84.9570798,-84.9714897,-84.9836637,-84.9990069,-85.0169191,-85.0355808,-85.0572835,-85.0768118,-85.0936392,-85.1059977,-85.1170413,-85.1307989,-85.1454572,-85.1637588,-85.1798475,-85.196041,-85.21059,-85.2245422,-85.2382569,-85.2524358,-85.2679604,-85.2825737,-85.2971749,-85.3093569,-85.3197978,-85.3321764,-85.3447665,-85.3571857,-85.3746585,-85.3932607,-85.4146784,-85.4349643,-85.455994,-85.4738014,-85.4921056,-85.5117281,-85.5306126,-85.549378,-85.569207,-85.5869292,-85.6073163,-85.6252638,-85.6456535,-85.6678863,-85.6920666,-85.7143132,-85.7322202,-85.7566331,-85.7814344,-85.8047588,-85.8278582,-85.8514679,-85.8755536,-85.8989607,-85.9212944,-85.9424582,-85.9629879,-85.9827673,-86.0033713,-86.0237652,-86.0458941,-86.0677511,-86.0916638,-86.1166861,-86.1422597,-86.1670989,-86.1908249,-86.2140041,-86.2386041,-86.2623546,-86.2820335,-86.3044964,-86.3224878,-86.3217538,-86.3317209,-86.3372877,-86.337309,-86.3372514,-86.3372421,-86.337279,-86.3372613,-86.3373469,-86.3375387,-86.337604,-86.3375933,-86.3376304,-86.3375527,-86.3375601,-86.3373134,-86.3370365,-86.3372558,-86.3373273,-86.3375594,-86.3372971,-86.3374133,-86.3372955,-86.3376103,-86.3373611,-86.3360363,-86.3378592,-86.3437949,-86.3556782,-86.3689315,-86.3846975,-86.4015093,-86.4152339,-86.4258949,-86.4341185,-86.4398985,-86.4483872,-86.4608243,-86.4729043,-86.4831926,-86.4945197,-86.5071595,-86.5162411,-86.5245639,-86.5313289,-86.5409554,-86.5586452,-86.5729914,-86.5875195,-86.6036833,-86.617037,-86.631198,-86.6480807,-86.663473,-86.6687176,-86.6781064,-86.6949664,-86.7076299,-86.7183131,-86.7301998,-86.7425953,-86.7512885,-86.7614012,-86.7760449,-86.7925313,-86.8089401,-86.8247704,-86.8378959,-86.8516759,-86.8665498,-86.8805601,-86.8958161,-86.9122567,-86.9280967,-86.9418762,-86.9548371,-86.9694358,-86.9858835,-87.0004018,-87.014157,-87.0280989,-87.043812,-87.0625131,-87.082416,-87.1031732,-87.1233355,-87.1443056,-87.1627462,-87.1818657,-87.2013561,-87.2199459,-87.2382332,-87.2574129,-87.2769698,-87.2949576,-87.3129726,-87.3304072,-87.3491384,-87.3717501,-87.3927512,-87.412445,-87.433902,-87.4525246,-87.473308,-87.4974268,-87.5189197,-87.536606,-87.5562319,-87.5768553,-87.594903,-87.6148136,-87.6350677,-87.6530083,-87.6731667,-87.6907528,-87.7103101,-87.7325643,-87.755036,-87.7767482,-87.8001099,-87.8233921,-87.8459861,-87.8682104,-87.8879937,-87.9110178,-87.9342703,-87.9551257,-87.9750624,-87.9961459,-88.0159911,-88.0342458,-88.0531374,-88.0708034,-88.0797175,-88.0930434,-88.1042529,-88.1014838,-88.0964108,-88.0935321,-88.1072451,-88.120166,-88.1221407,-88.1262829,-88.1273447,-88.1225993,-88.1185497,-88.1295092,-88.1431364,-88.1545722,-88.1633546,-88.1627496,-88.164056,-88.1636184,-88.1635537,-88.1628771,-88.1636828,-88.163331,-88.1633528,-88.1633234,-88.1628456,-88.163215,-88.1632969,-88.1649383,-88.1633546,-88.1619295,-88.1608361,-88.1797522,-88.1952027,-88.2112692,-88.2266756,-88.2442671,-88.2622093,-88.2815951,-88.3007814,-88.3225486,-88.3438264,-88.3660706,-88.3856774,-88.4065173,-88.4266286,-88.4497887,-88.4747625,-88.4973883,-88.5185676,-88.5413461,-88.564724,-88.5896637,-88.613324,-88.6368922,-88.6591215,-88.6779027,-88.7012531,-88.7244214,-88.7472499,-88.7704739,-88.7928993,-88.8180255,-88.8432827,-88.8688573,-88.8924655,-88.9172109,-88.9400284,-88.9618745,-88.9842746,-89.003717,-89.027056,-89.051515,-89.0759015,-89.0987927,-89.11984,-89.1444275,-89.1670343,-89.1915449,-89.2126344,-89.2329846,-89.2553419,-89.2774605,-89.3011816,-89.3218668,-89.3446087,-89.3676817,-89.3896083,-89.4112535,-89.4310874,-89.4498428,-89.4715787,-89.4946979,-89.5175762,-89.5408976,-89.5615717,-89.5823447,-89.6048167,-89.6271631,-89.6473842,-89.6693493,-89.6917429,-89.7143931,-89.7359522,-89.7475451,-89.7543693,-89.7607462,-89.7692081,-89.7846152,-89.7991163,-89.8151302,-89.8312415,-89.8473986,-89.8633417,-89.8772868,-89.8907838,-89.9041046,-89.9179121,-89.9310769,-89.9460425,-89.9566957,-89.9626273,-89.9625546,-89.962393,-89.9626219,-89.9627502,-89.9625587,-89.962395,-89.9630299,-89.9625987,-89.962677,-89.962734,-89.9627376,-89.9627972,-89.9629582,-89.9626426,-89.9623835,-89.9623627,-89.9631403,-89.9628741,-89.9627189,-89.9627086,-89.9624403,-89.9626426,-89.9671227,-89.985174,-90.0038414,-90.0138086,-90.0218668,-90.0371769,-90.0504504,-90.0608208,-90.0715954,-90.0735287,-90.0706617,-90.0699522,-90.0643023,-90.0678069,-90.0664403,-90.0655456,-90.0650886,-90.0642548,-90.0645014,-90.0651399,-90.0662793,-90.0646745,-90.0636614,-90.0632259,-90.0647748,-90.061943,-90.0616739,-90.0620035,-90.0616871,-90.0618267,-90.0626007,-90.0625538,-90.0623514,-90.0620957,-90.061943,-90.0646779,-90.0681356,-90.0669614,-90.0678887,-90.0681413,-90.0678327,-90.0681356,-90.0657598,-90.0655122,-90.0652023,-90.0650869,-90.0653102,-90.0658132,-90.0662807,-90.0657676,-90.0657423,-90.0641243,-90.0652485,-90.0645903,-90.064378,-90.0644739,-90.0645501,-90.0645625,-90.0639758,-90.0636348,-90.0632474,-90.0629125,-90.0641243,-90.0622288,-90.0616412,-90.0594821,-90.0562782,-90.0566965,-90.0569814,-90.0575119,-90.0511178,-90.0389504,-90.0224293,-90.0135326,-90.0010175,-89.981357,-89.9647311,-89.9632848,-89.962454,-89.9627352,-89.9625872,-89.9624574,-89.9623103,-89.962923,-89.962505,-89.9627908,-89.9627186,-89.9627579,-89.9628913,-89.9629451,-89.9628887,-89.9628853,-89.96271,-89.9627974,-89.9627082,-89.9627847,-89.962808,-89.9628019,-89.9630248,-89.9626096,-89.962838,-89.9627637,-89.9627437,-89.9626747,-89.9626727,-89.9627372,-89.9628532,-89.9629666,-89.9628419,-89.9626405,-89.9629182,-89.9626114,-89.9631683,-89.9628093,-89.9623937,-89.9629519,-89.9624108,-89.9627089,-89.9628616,-89.9627755,-89.9628757,-89.9625818,-89.96242,-89.962486,-89.9626625,-89.9624686,-89.9624982,-89.9624987,-89.9624969,-89.9624559,-89.9624336,-89.9627352,-89.9616641,-89.9606972,-89.9492587,-89.9389775,-89.9395854,-89.9396195,-89.9387829,-89.9441833,-89.9494789,-89.9562612,-89.9603985,-89.9635606,-89.9662883,-89.9750522,-89.9848618,-89.9862646,-89.9861817,-89.9867016,-89.9917354,-89.9945534,-89.9944559,-89.9944988,-89.9944584,-89.994946,-89.9942526,-89.9942101,-89.9942279,-89.9941622,-89.9936257,-89.9936138,-89.9942406,-89.9943577,-89.9936628,-89.9940157,-89.9944837,-89.9945179,-89.9943001,-89.9944203,-89.9944512,-89.9944614,-89.9944614,-89.9943577,-89.9925906,-89.9937749,-89.9981088,-90.0000297,-90.0087078,-90.0153026,-90.0258363,-90.0297903,-90.0377756,-90.0478308,-90.0484011,-90.0492787,-90.0548469,-90.0746704,-90.0949567,-90.1164968,-90.1358715,-90.1583648,-90.178802,-90.2001345,-90.2194123,-90.2401839,-90.2610107,-90.2799665,-90.3003394,-90.3179435,-90.3345282,-90.3503932,-90.3674039,-90.3838005,-90.4003716,-90.4194594,-90.4422433,-90.4641129,-90.4858953,-90.5080018,-90.5329367,-90.5551955,-90.5792596,-90.6017002,-90.6250516,-90.6511461,-90.6773316,-90.7017946,-90.7258504,-90.7488196,-90.7719778,-90.7948869,-90.8187216,-90.8425152,-90.8671125,-90.8881606,-90.9096978,-90.9294647,-90.9467965,-90.960803,-90.9716418,-90.9821115,-90.9891039,-90.9929929,-91.0058096,-91.022132,-91.0356957,-91.0499163,-91.0674747,-91.0847928,-91.1018977,-91.1176707,-91.1324277,-91.1409507,-91.1447553,-91.1554755,-91.1688332,-91.1782614,-91.1949505,-91.2131674,-91.2315701,-91.2521378,-91.2743141,-91.2949088,-91.3154804,-91.3369397,-91.35804,-91.3788259,-91.399382,-91.4201578,-91.4415798,-91.4656116,-91.4889304,-91.5121529,-91.5333849,-91.5538016,-91.5759476,-91.5976994,-91.6182563,-91.6373315,-91.6556204,-91.6759974,-91.6954307,-91.714146,-91.733038,-91.7518937,-91.7726175,-91.7916227,-91.8137638,-91.8299357,-91.8304352,-91.8298949,-91.8298949,-91.8299357,-91.8298705,-91.8298617,-91.8298801,-91.8298644,-91.8293816,-91.8294105,-91.8294696,-91.8296983,-91.8300217,-91.8300072,-91.829992,-91.8300009,-91.8300312,-91.8300213,-91.8300567,-91.8300673,-91.829696,-91.8294919,-91.8295937,-91.8297877,-91.8299911,-91.8300591,-91.8300225,-91.8300301,-91.8300445,-91.8300122,-91.8300687,-91.8300673,-91.8300768,-91.8300789,-91.829913,-91.8331406,-91.8520597,-91.8757864,-91.8980121,-91.9206678,-91.9414434,-91.9633565,-91.9837103,-92.0062033,-92.0274162,-92.0490908,-92.0720054,-92.0954385,-92.1175512,-92.1422948,-92.1647347,-92.1879952,-92.2104338,-92.23263,-92.2570044,-92.2799836,-92.3009196,-92.3227777,-92.3460385,-92.369855,-92.3930233,-92.416748,-92.4395122,-92.4636154,-92.4884406,-92.5116732,-92.5346027,-92.5574678,-92.5806212,-92.6047091,-92.6263256,-92.6495533,-92.67262,-92.6967695,-92.7206257,-92.7427208,-92.766821,-92.7913635,-92.8161146,-92.8386609,-92.8605283,-92.882203,-92.9038067,-92.925017,-92.9477128,-92.9686132,-92.9895575,-93.0118692,-93.0345734,-93.0596318,-93.0852445,-93.1090749,-93.1330437,-93.1577254,-93.1802843,-93.1968796,-93.2162353,-93.2369146,-93.2549346,-93.2768914,-93.2943596,-93.3115448,-93.3293382,-93.3504942,-93.3735113,-93.3945224,-93.4187245,-93.4403088,-93.4628798,-93.4838998,-93.5054437,-93.5292619,-93.5527458,-93.5708579,-93.5694294,-93.5707539,-93.5708138,-93.5708582,-93.5708805,-93.5707004,-93.5706467,-93.5706896,-93.5706621,-93.5706603,-93.5707097,-93.5706535,-93.570816,-93.5707867,-93.5707867,-93.5707404,-93.5706859,-93.5707157,-93.5707579,-93.5707624,-93.570737,-93.57074,-93.5711306,-93.5707108,-93.5740212,-93.5925198,-93.6125311,-93.6338536,-93.6527072,-93.6721813,-93.6913851,-93.7110438,-93.7292393,-93.749806,-93.7727085,-93.794137,-93.8169854,-93.8371455,-93.8582232,-93.8825494,-93.906949,-93.9314545,-93.9552396,-93.9805135,-94.0030762,-94.0232799,-94.0418403,-94.0618811,-94.0840939,-94.1060243,-94.1272727,-94.1359692,-94.1346845,-94.1413547,-94.1529806,-94.167176,-94.1804731,-94.1946545,-94.2116156,-94.2087377,-94.2116243,-94.2116234,-94.2116156,-94.2116156,-94.2116156,-94.2116139,-94.2117519,-94.2117551,-94.2118634,-94.2118575,-94.2119861,-94.2115925,-94.2095567,-94.2192011,-94.2341754,-94.249152,-94.263924,-94.2791481,-94.2977948,-94.3120668,-94.3285319,-94.3409141,-94.3557119,-94.3729114,-94.389564,-94.414046,-94.4394899,-94.4644555,-94.4888806,-94.5116372,-94.5351353,-94.5593782,-94.582245,-94.6071342,-94.6317356,-94.6559948,-94.6791191,-94.7013396,-94.7250366,-94.7467271,-94.7691803,-94.7931695,-94.8177817,-94.8426686,-94.8668333,-94.8898485,-94.9149705,-94.9375484,-94.9598305,-94.9838035,-95.0084202,-95.0322528,-95.0539933,-95.0719397,-95.0914898,-95.1124667,-95.1310519,-95.152481,-95.1739733,-95.1968262,-95.2187536,-95.2378562,-95.2581779,-95.2780989,-95.2978893,-95.3186094,-95.3369838,-95.3547528,-95.3654825,-95.3783176,-95.3987233,-95.4181803,-95.4368887,-95.456835,-95.4760852,-95.4978813,-95.5170105,-95.5374993,-95.5621296,-95.5798086,-95.6020366,-95.6209502,-95.6424551,-95.6636837,-95.68478,-95.7065571,-95.7278614,-95.749733,-95.7721725,-95.7949697,-95.8142748,-95.8355775,-95.8578256,-95.8790387,-95.9007694,-95.922687,-95.9444572,-95.9646805,-95.985197,-96.0083862,-96.0289354,-96.0525542,-96.0768648,-96.0993793,-96.1218633,-96.1418891,-96.1635005,-96.1869689,-96.2092012,-96.2310186,-96.2551464,-96.2794462,-96.301387,-96.3267529,-96.349496,-96.3746647,-96.3972071,-96.4194199,-96.4432758,-96.4666653,-96.4906237,-96.5118669,-96.5300898,-96.5474582,-96.5692126,-96.5922388,-96.6133176,-96.6374208,-96.6595515,-96.6826387,-96.7042722,-96.7272217,-96.7490864,-96.7739688,-96.7970373,-96.8211438,-96.8442541,-96.8658778,-96.8868403,-96.9021006,-96.9019925,-96.9023357,-96.9022412,-96.902078,-96.9022007,-96.9020749,-96.90211,-96.9019903,-96.9018705,-96.9019047,-96.9018274,-96.9018151,-96.9018945,-96.9019142,-96.9019067,-96.901948,-96.9019511,-96.9019473,-96.9020088,-96.9019414,-96.9019361,-96.901965,-96.9019366,-96.9019079,-96.9019079,-96.9019532,-96.9019216,-96.9033236,-96.9019853,-96.9218103,-96.9452377,-96.9684542,-96.9945896,-97.0194329,-97.0423112,-97.0683249,-97.0949022,-97.1198866,-97.1465076,-97.1715961,-97.1970894,-97.2216314,-97.2473756,-97.2719717,-97.2949048,-97.3192436,-97.3433895,-97.3703273,-97.394405,-97.4198197,-97.4441272,-97.469735,-97.4958223,-97.521259,-97.5456938,-97.5715256,-97.5949492,-97.6195729,-97.6450595,-97.6680602,-97.6902169,-97.7112268,-97.7330134,-97.755595,-97.7766182,-97.7999637,-97.8248332,-97.8500171,-97.8728096,-97.8950279,-97.9187246,-97.9434237,-97.9677906,-97.9871022,-98.0070859,-98.0285542,-98.0465369,-98.067569,-98.0898309,-98.1117833,-98.1322127,-98.1521858,-98.1716649,-98.1910621,-98.2116798,-98.2304163,-98.249883,-98.2704789,-98.2910138,-98.3125984,-98.3336044,-98.3547187,-98.3776855,-98.3991346,-98.4184323,-98.4321544,-98.4393874,-98.4420916,-98.4421992,-98.4420801,-98.4416623,-98.4420462,-98.4417413,-98.4420015,-98.4420623,-98.4422044,-98.4421766,-98.4422474,-98.4422535,-98.4421892,-98.4422033,-98.4422172,-98.4421907,-98.4422605,-98.4422094,-98.4421037,-98.4422456,-98.4421811,-98.442065,-98.442127,-98.4422451,-98.4421795,-98.4421981,-98.4416654,-98.4421866,-98.4424071,-98.4422051,-98.4422228,-98.4416598,-98.4417097,-98.4419328,-98.4416862,-98.4417017,-98.4416858,-98.4416642,-98.4416702,-98.4424005,-98.4421992,-98.443969,-98.4617981,-98.4770016,-98.4795455,-98.4796453,-98.479866,-98.479866,-98.4829642,-98.4868792,-98.485969,-98.4877737,-98.4877737,-98.4868991,-98.4871962,-98.4877761,-98.4878587,-98.4880643,-98.4880638,-98.4882678,-98.4884631,-98.4884437,-98.4880377,-98.4871865,-98.4875204,-98.4862923,-98.4866655,-98.4866538,-98.4863014,-98.4863374,-98.4860623,-98.4860206,-98.4860618,-98.4858503,-98.4857535,-98.4856024,-98.4864695,-98.4862923,-98.4891968,-98.4887821,-98.4896166,-98.4900058,-98.4879643,-98.4891968,-98.4868861,-98.4869063,-98.4868861,-98.486889,-98.4849384,-98.4812999,-98.4813208,-98.4774843,-98.4911451,-98.5027438,-98.5147152,-98.5157777,-98.5192459,-98.5371072,-98.5481692,-98.5543431,-98.5650834,-98.5824599,-98.5912258,-98.5969658,-98.6000376,-98.6064138,-98.6130983,-98.6233851,-98.6317383,-98.6423054,-98.6542831,-98.6658279,-98.6810644,-98.697462,-98.7134223,-98.7297935,-98.7473862,-98.7532584,-98.7589568,-98.7738555,-98.7857385,-98.7959335,-98.8108815,-98.821281,-98.8378366,-98.8577869,-98.8738769,-98.888269,-98.8994705,-98.921338,-98.9406728,-98.9587903,-98.9740887,-98.9944201,-99.0158461,-99.0389721,-99.0568666,-99.0816714,-99.1047441,-99.1269278,-99.1464652,-99.1663313,-99.1827029,-99.2029636,-99.2223537,-99.2318541,-99.2416985,-99.2633593,-99.2862561,-99.3108562,-99.3353206,-99.3595658,-99.3834735,-99.4038053,-99.4236418,-99.4430977,-99.4635565,-99.4868859,-99.5063184,-99.5270998,-99.5503928,-99.5695393,-99.5821037,-99.5951339,-99.6067989,-99.6212006,-99.6435672,-99.6653031,-99.682719,-99.7033386,-99.719045,-99.7299048,-99.7391454,-99.7574828,-99.7732821,-99.7732322,-99.7730391,-99.7731956,-99.7732621,-99.7732839,-99.7732839,-99.7732839,-99.773128,-99.7731031,-99.772818,-99.7730711,-99.7728358,-99.7730955,-99.7731663,-99.7730089,-99.7730211,-99.7730237,-99.7730103,-99.7729978,-99.7730002,-99.7730147,-99.7730146,-99.7730367,-99.773026,-99.7730505,-99.7731059,-99.7729962,-99.7729884,-99.7728914,-99.7729698,-99.7730663,-99.77314,-99.7731381,-99.7731278,-99.773153,-99.7731318,-99.7730065,-99.7730784,-99.7731009,-99.773103,-99.7730981,-99.7730983,-99.7759383,-99.7950482,-99.8160683,-99.8395856,-99.8625217,-99.8855137,-99.9075319,-99.9274127,-99.9498017,-99.9722728,-99.994406,-100.0168538,-100.0376638,-100.0580438,-100.0790289,-100.1000557,-100.1207708,-100.1442924,-100.1676055,-100.192065,-100.2154674,-100.2390158,-100.2638933,-100.2856164,-100.3056967,-100.3260139,-100.3472252,-100.3702842,-100.3915278,-100.4123222,-100.4350974,-100.4573901,-100.4812851,-100.5059455,-100.5284941,-100.5512133,-100.573189,-100.5979841,-100.622992,-100.6453061,-100.665166,-100.6869609,-100.7089451,-100.7285376,-100.7439921,-100.7445242,-100.7445242,-100.7445242,-100.744506,-100.7444978,-100.7444867,-100.7565646,-100.7966809,-100.8183972,-100.8370042,-100.8548652,-100.8719909,-100.8902339,-100.9084917,-100.9440841,-100.9641545,-100.9842257,-101.0068776,-101.0288272,-101.0540171,-101.0793678,-101.1019804,-101.1266147,-101.152225,-101.1642136,-101.1659975,-101.1804691,-101.2040592,-101.2266571,-101.249588,-101.2759296,-101.3017722,-101.3262452,-101.3525032,-101.376332,-101.3984966,-101.4460223,-101.4711558,-101.4943204,-101.5160641,-101.5306587,-101.5536369,-101.578407,-101.6010098,-101.6253506,-101.649218,-101.6728631,-101.6962518,-101.7184191,-101.7392346,-101.7584218,-101.7827445,-101.8067369,-101.8270358,-101.845517,-101.8713383,-101.8950086,-101.9172642,-101.9407319,-101.9582454,-101.971627,-101.9933967,-102.0082217,-102.0320534,-102.0539409,-102.0737593,-102.0935717,-102.1186236,-102.1419664,-102.1668289,-102.1928225,-102.2187721,-102.2442502,-102.2713863,-102.2939639,-102.3187451,-102.3429559,-102.3661984,-102.3913297,-102.4152384,-102.4403164,-102.4623417,-102.4861099,-102.5119566,-102.5377683,-102.5635154,-102.5891976,-102.6136763,-102.6406794,-102.6645647,-102.6913158,-102.7180047,-102.7450755,-102.7723452,-102.8014074,-102.8279361,-102.8513567,-102.8705551,-102.8950112,-102.9113827,-102.9262664,-102.9446472,-102.9640745,-102.9845958,-103.0043405,-103.0232321,-103.0432241,-103.0621598,-103.0807928,-103.1006538,-103.120761,-103.1404019,-103.1600447,-103.1785119,-103.19711,-103.2170419,-103.2367489,-103.2558579,-103.2672297,-103.2788277,-103.2896513,-103.3007569,-103.3129078,-103.3254961,-103.3380585,-103.3499727,-103.3632944,-103.3779289,-103.3934179,-103.4106242,-103.4260419,-103.4342743,-103.4452066,-103.4600478,-103.4730434,-103.4807406,-103.4807125,-103.4807308,-103.4807305,-103.4807435,-103.4807479,-103.4808019,-103.4805504,-103.4803374,-103.480642,-103.4802668,-103.480595,-103.4803208,-103.4803114,-103.480313,-103.480316,-103.4803153,-103.4803055,-103.4803636,-103.4803283,-103.4807852,-103.4805067,-103.4828405,-103.4831861,-103.4845559,-103.4874748,-103.4926302,-103.4970634,-103.5029349,-103.5107439,-103.5193954,-103.5334609,-103.5450861,-103.5557711,-103.5663401,-103.5764977,-103.586454,-103.5990992,-103.6108469,-103.6210747,-103.6344287,-103.6511998,-103.6741456,-103.695326,-103.7127454,-103.7322656,-103.7513243,-103.7742627,-103.7883947,-103.7987173,-103.8093474,-103.8228043,-103.834747,-103.8475013,-103.8598937,-103.8717468,-103.8844753,-103.8987597,-103.9085771,-103.9143153,-103.9261402,-103.937288,-103.9493329,-103.9580212,-103.967479,-103.9770754,-103.9866481,-103.9985667,-104.0100948,-104.0205836,-104.0300895,-104.0404414,-104.0504848,-104.0597465,-104.0624948,-104.0649403,-104.0671888,-104.0694178,-104.0731224,-104.0733309,-104.0735255,-104.0737004,-104.0738513,-104.0709011,-104.0673599,-104.0644196,-104.0673857,-104.0703969,-104.0721834,-104.0764962,-104.0832042,-104.0878913,-104.0875694,-104.0960804,-104.1000816,-104.1009799,-104.1009927,-104.1010022,-104.1010107,-104.1010281,-104.1016559,-104.1081717,-104.1213328,-104.1348134,-104.1484301,-104.1631283,-104.1771887,-104.1928698,-104.2071161,-104.2146469,-104.2174755,-104.2204136,-104.2206072,-104.2210284,-104.2236905,-104.2224815,-104.2226138,-104.223376,-104.2236697,-104.2236715,-104.2236546,-104.2236238,-104.2245061,-104.2244499,-104.2242692,-104.2243675,-104.2247046,-104.2245047,-104.2241716,-104.2245711,-104.2246097,-104.2235774,-104.2243453,-104.2244567,-104.2245333,-104.2244863,-104.2244037,-104.2244845,-104.2244705,-104.2243978,-104.2245537,-104.223708,-104.2242713,-104.2222784,-104.2199164,-104.2241659,-104.2308082,-104.2357888,-104.2436249,-104.2516879,-104.2604626,-104.2679942,-104.2762071,-104.2845393,-104.2931107,-104.30177,-104.3100914,-104.3198605,-104.3367085,-104.3527269,-104.3709007,-104.3821137,-104.3872769,-104.3985121,-104.4093702,-104.4416286,-104.4489906,-104.4428878,-104.4433716,-104.4430743,-104.4430567,-104.4440577,-104.4438402,-104.4443092,-104.4439608,-104.4436341,-104.4431211,-104.4441338,-104.4442474,-104.4430955,-104.4431199,-104.4431141,-104.4430534,-104.4430856,-104.4421019,-104.4436713,-104.4460369,-104.4444136,-104.4320036,-104.4116854,-104.4024784,-104.3897497,-104.3831825,-104.3744657,-104.3583057,-104.3419751,-104.3250274,-104.3134358,-104.3048851,-104.2956658,-104.2864423,-104.277274,-104.2681193,-104.2589951,-104.2486139,-104.2394089,-104.2325111,-104.2374581,-104.2375767,-104.2382404,-104.2498904,-104.2551135,-104.2550073,-104.2617777,-104.2754274,-104.27829,-104.2900912,-104.3017202,-104.3146677,-104.3219041,-104.3259345,-104.3315647,-104.3516903,-104.3715856,-104.385474,-104.3981368,-104.4016051,-104.4130613,-104.4217846,-104.4210396,-104.4116825,-104.401789,-104.3953694,-104.3954724,-104.3957698,-104.3957208,-104.395654,-104.3955758,-104.3955206,-104.3954951,-104.3953337,-104.3967155,-104.3974939,-104.3979366,-104.398962,-104.4004542,-104.4101691,-104.4242627,-104.435633,-104.438786,-104.4387037,-104.4391991,-104.4397424,-104.4402442,-104.4408444,-104.4414675,-104.4419978,-104.4420651,-104.4414323,-104.4438796,-104.4473973,-104.4506864,-104.4540464,-104.4572428,-104.4606718,-104.4638804,-104.4661531,-104.4662913,-104.4795295,-104.4988867,-104.5066429,-104.5102925,-104.5132762,-104.5178435,-104.5225626,-104.522667,-104.5226828,-104.5227038,-104.5227155,-104.522719,-104.5227299,-104.5228932,-104.5229117,-104.5229754,-104.5230453,-104.5231543,-104.5233215,-104.5210497,-104.5192034,-104.5192384,-104.5192107,-104.5192498,-104.5192863,-104.5193208,-104.5300363,-104.5422975,-104.5540465,-104.562272,-104.5646522,-104.56699,-104.5694768,-104.571816,-104.5735822,-104.5743191,-104.5748517,-104.5755207,-104.5785855,-104.5835993,-104.5888887,-104.5942697,-104.5994231,-104.6149472,-104.6308828,-104.6485563,-104.6655628,-104.683767,-104.7055818,-104.7256375,-104.7445667,-104.7623826,-104.7781192,-104.7940044,-104.8083442,-104.8245243,-104.8403358,-104.8567315,-104.8708571,-104.8802175,-104.8901901,-104.9002424,-104.9097382,-104.9188265,-104.9283036,-104.9386104,-104.954073,-104.9692781,-104.9842228,-105.0003976,-105.0169443,-105.0337565,-105.049447,-105.0662604,-105.0817146,-105.0969935,-105.1131238,-105.1284952,-105.143627,-105.1588789,-105.1750193,-105.1880595,-105.1897594,-105.1896783,-105.1896348,-105.1896642,-105.1897732,-105.1897205,-105.1897539,-105.1897319,-105.1897388,-105.189236,-105.1892726,-105.1895044,-105.1895732,-105.1895312,-105.1895175,-105.1894584,-105.1894367,-105.1895062,-105.1895223,-105.1895353,-105.1894963,-105.1894963,-105.1895202,-105.1895206,-105.1895366,-105.1895341,-105.1897566,-105.1896717,-105.1894425,-105.1894914,-105.1894547,-105.189499,-105.1895001,-105.18953,-105.1895235,-105.1895696,-105.2021809,-105.2144095,-105.2292596,-105.2463828,-105.2632554,-105.2838143,-105.3041351,-105.3277184,-105.3515004,-105.37217,-105.3926457,-105.4081205,-105.4287241,-105.4501382,-105.4652788,-105.4779239,-105.4876269,-105.4991587,-105.5104087,-105.5219929,-105.5327205,-105.5431393,-105.554408,-105.5659291,-105.5776807,-105.5883706,-105.598466,-105.6004628,-105.6066064,-105.6163808,-105.6275905,-105.6379522,-105.6485825,-105.6600913,-105.6665102,-105.6886761,-105.7141361,-105.7395201,-105.76396,-105.787455,-105.8120677,-105.8370032,-105.8601041,-105.8852946,-105.9123952,-105.938766,-105.9622905,-105.9864583,-106.0129845,-106.0367368,-106.0609451,-106.08388,-106.1057031,-106.1273348,-106.1502963,-106.1713806,-106.1934782,-106.2148998,-106.236981,-106.2546074,-106.2736918,-106.2909539,-106.3109229,-106.3311974,-106.3499938,-106.3707573,-106.3843967,-106.4057939,-106.4234837,-106.4468143,-106.4699163,-106.4900091,-106.5087211,-106.5272397,-106.5459615,-106.5659069,-106.5856367,-106.6022565,-106.6137408,-106.6171446,-106.6266113,-106.6299411,-106.6369225,-106.6445859,-106.6482547,-106.6569724,-106.6721738,-106.6888226,-106.7070355,-106.7214987,-106.7385995,-106.7558941,-106.7704583,-106.7833569,-106.7870144,-106.784347,-106.783874,-106.784347,-106.784347,-106.784347,-106.784347,-106.784347,-106.7843476,-106.7843512,-106.7843455,-106.7843132,-106.7842909,-106.7843028,-106.7842815,-106.7842628,-106.7842693,-106.7842865,-106.7844497,-106.7843801,-106.7877795,-106.7904228,-106.810139,-106.8325785,-106.8547319,-106.8729047,-106.8910003,-106.9114444,-106.9304484,-106.9533564,-106.9763709,-106.998286,-107.0195949,-107.0377519,-107.0581303,-107.077736,-107.0973079,-107.1193144,-107.1408669,-107.165828,-107.1892484,-107.2120041,-107.2369223,-107.263826,-107.2893396,-107.3104488,-107.3282804,-107.3398191,-107.3632887,-107.3849161,-107.4080329,-107.4347263,-107.4606316,-107.4836605,-107.5069921,-107.5248612,-107.5410788,-107.5647503,-107.5913347,-107.6193395,-107.6446368,-107.665553,-107.6881254,-107.7109335,-107.7365035,-107.7588747,-107.7780265,-107.7979628,-107.8163515,-107.8367367,-107.8522361,-107.8728431,-107.8952501,-107.9017571,-107.9177444,-107.9341535,-107.9487997,-107.962748,-107.9784453,-107.9860025,-107.9901525,-107.9973378,-108.0099702,-108.0330681,-108.0537143,-108.0763233,-108.1007556,-108.1231595,-108.1473207,-108.1726033,-108.1966017,-108.2195331,-108.2431039,-108.2651444,-108.2871105,-108.3084434,-108.3277466,-108.3475778,-108.3662884,-108.3848992,-108.4054609,-108.4249344,-108.4506148,-108.4754274,-108.4983722,-108.5214713,-108.5442841,-108.566027,-108.5892538,-108.6138492,-108.6368058,-108.6586201,-108.6692899,-108.6798984,-108.6960385,-108.708639,-108.7088292,-108.7084008,-108.7084919,-108.708639,-108.7085743,-108.7086344,-108.7086269,-108.7085813,-108.7086513,-108.7085506,-108.7084987,-108.7085236,-108.7085372,-108.708529,-108.7085245,-108.7085763,-108.7084913,-108.7085179,-108.7083725,-108.7083491,-108.7084045,-108.7085246,-108.7083672,-108.7083338,-108.7083338,-108.7083338,-108.7083338,-108.7083338,-108.708365,-108.708365,-108.7083642,-108.7083646,-108.7084047,-108.7083713,-108.7083572,-108.7083419,-108.7086241,-108.7090767,-108.7084779,-108.7121336,-108.7199608,-108.7198517,-108.71987,-108.7199608,-108.7199608,-108.7199417,-108.7197694,-108.7220069,-108.7226758,-108.727051,-108.7431752,-108.7627521,-108.7833931,-108.8046059,-108.8253687,-108.8408765,-108.8632394,-108.8868336,-108.9091483,-108.9290446,-108.9466536,-108.9624511,-108.9813406,-108.9972173,-109.008916,-109.0268054,-109.0444331,-109.0566354,-109.0694042,-109.0843392,-109.1043799,-109.1264349,-109.1471803,-109.1675497,-109.1896357,-109.2099664,-109.2323404,-109.253031,-109.270439,-109.2858316,-109.3029523,-109.3194012,-109.3374409,-109.360508,-109.3824308,-109.4040486,-109.4256762,-109.4355546,-109.4332728,-109.4356427,-109.4356485,-109.4359636,-109.4482559,-109.4683685,-109.4866915,-109.5049764,-109.5231838,-109.5430148,-109.5668214,-109.5894389,-109.6098346,-109.6319443,-109.6548452,-109.6767561,-109.6981361,-109.7201402,-109.7413494,-109.7638727,-109.7850705,-109.8066882,-109.8265821,-109.8476253,-109.870105,-109.895343,-109.9215661,-109.9477268,-109.9717778,-109.9965851,-110.020602,-110.0450421,-110.0694705,-110.0919512,-110.109448,-110.1267058,-110.1366769,-110.1549151,-110.1795649,-110.2025611,-110.2259237,-110.2471948,-110.2637365,-110.2787473,-110.2972281,-110.3167429,-110.3399636,-110.3643883,-110.388822,-110.4151499,-110.4407725,-110.465612,-110.4889228,-110.5120145,-110.5355047,-110.5585834,-110.580425,-110.6026882,-110.6246409,-110.6461984,-110.6670588,-110.682879,-110.696588,-110.7168515,-110.7381446,-110.7595957,-110.7803991,-110.8016346,-110.8247808,-110.8461376,-110.8651937,-110.8846442,-110.9039787,-110.9241769,-110.9438851,-110.9655005,-110.9858347,-111.0059991,-111.0273753,-111.0483255,-111.0683291,-111.0892901,-111.110163,-111.1329721,-111.1553572,-111.1788029,-111.1991014,-111.2216992,-111.242191,-111.2640047,-111.2844899,-111.3053813,-111.3266125,-111.3474504,-111.3690012,-111.3898755,-111.4101438,-111.431626,-111.4554012,-111.4769146,-111.4997985,-111.5203655,-111.5418187,-111.5629336,-111.5812691,-111.5877524,-111.5953976,-111.5968955,-111.6042783],10,null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":true,"fillColor":"#03F","fillOpacity":0.2},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]}],"limits":{"lat":[29.3971059,35.5339859],"lng":[-111.6042783,-84.3051758]},"setView":[[29.4257332714475,-98.4862755390452],18,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>&nbsp;</p>
<p>We can convert all these points into a single path (or a <code>LINESTRING</code> simple geographic feature instead of lots of <code>POINT</code>s) so that they can connect, using a combination of <code>st_combine()</code> to concatenate all the points and <code>st_cast()</code> to switch their format from a bunch of points to an official <code>LINESTRING</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">big_long_combined_route</span> <span class="op">&lt;-</span> <span class="va">all_locations</span><span class="op">$</span><span class="va">geometry</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_combine</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_cast</span><span class="op">(</span><span class="st">"LINESTRING"</span><span class="op">)</span></span>
<span><span class="va">big_long_combined_route</span></span>
<span><span class="co">## Geometry set for 1 feature </span></span>
<span><span class="co">## Geometry type: LINESTRING</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -111.6 ymin: 29.4 xmax: -84.31 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now instead of having two thousand+ points, it’s just one single <code>LINESTRING</code> feature. It shows up as a line now:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lower_48</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">big_long_combined_route</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"X"</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"Y"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip_map</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/basic-map-linestring-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>We can confirm if we zoom in around the Alamo again too:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">big_long_combined_route</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">leaflet</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addTiles</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">addPolylines</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">setView</span><span class="op">(</span>lat <span class="op">=</span> <span class="fl">29.425733271447523</span>, lng <span class="op">=</span> <span class="op">-</span><span class="fl">98.48627553904525</span>, zoom <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8f836166d559454ecd73" style="width:100%;height:415.327564894932px;"></div>
<script type="application/json" data-for="htmlwidget-8f836166d559454ecd73">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-84.3051758,-84.3273246,-84.3438356,-84.3621145,-84.3782498,-84.3935971,-84.3911732,-84.3890003,-84.3786019,-84.3914546,-84.3937695,-84.4013967,-84.4049403,-84.4033858,-84.4144991,-84.4276159,-84.4421424,-84.4564173,-84.4613678,-84.4839758,-84.4887164,-84.5062481,-84.5248002,-84.5424602,-84.5646385,-84.5866331,-84.6059195,-84.6256142,-84.6374356,-84.6520712,-84.6677062,-84.680744,-84.69883,-84.7179306,-84.7318536,-84.7456314,-84.7562372,-84.7596283,-84.7612124,-84.7728107,-84.786625,-84.7947233,-84.8018032,-84.8058839,-84.807025,-84.8150928,-84.8312521,-84.8458617,-84.8593035,-84.8675704,-84.878876,-84.89168,-84.9028912,-84.9093494,-84.9206745,-84.9385745,-84.9570798,-84.9714897,-84.9836637,-84.9990069,-85.0169191,-85.0355808,-85.0572835,-85.0768118,-85.0936392,-85.1059977,-85.1170413,-85.1307989,-85.1454572,-85.1637588,-85.1798475,-85.196041,-85.21059,-85.2245422,-85.2382569,-85.2524358,-85.2679604,-85.2825737,-85.2971749,-85.3093569,-85.3197978,-85.3321764,-85.3447665,-85.3571857,-85.3746585,-85.3932607,-85.4146784,-85.4349643,-85.455994,-85.4738014,-85.4921056,-85.5117281,-85.5306126,-85.549378,-85.569207,-85.5869292,-85.6073163,-85.6252638,-85.6456535,-85.6678863,-85.6920666,-85.7143132,-85.7322202,-85.7566331,-85.7814344,-85.8047588,-85.8278582,-85.8514679,-85.8755536,-85.8989607,-85.9212944,-85.9424582,-85.9629879,-85.9827673,-86.0033713,-86.0237652,-86.0458941,-86.0677511,-86.0916638,-86.1166861,-86.1422597,-86.1670989,-86.1908249,-86.2140041,-86.2386041,-86.2623546,-86.2820335,-86.3044964,-86.3224878,-86.3217538,-86.3317209,-86.3372877,-86.337309,-86.3372514,-86.3372421,-86.337279,-86.3372613,-86.3373469,-86.3375387,-86.337604,-86.3375933,-86.3376304,-86.3375527,-86.3375601,-86.3373134,-86.3370365,-86.3372558,-86.3373273,-86.3375594,-86.3372971,-86.3374133,-86.3372955,-86.3376103,-86.3373611,-86.3360363,-86.3378592,-86.3437949,-86.3556782,-86.3689315,-86.3846975,-86.4015093,-86.4152339,-86.4258949,-86.4341185,-86.4398985,-86.4483872,-86.4608243,-86.4729043,-86.4831926,-86.4945197,-86.5071595,-86.5162411,-86.5245639,-86.5313289,-86.5409554,-86.5586452,-86.5729914,-86.5875195,-86.6036833,-86.617037,-86.631198,-86.6480807,-86.663473,-86.6687176,-86.6781064,-86.6949664,-86.7076299,-86.7183131,-86.7301998,-86.7425953,-86.7512885,-86.7614012,-86.7760449,-86.7925313,-86.8089401,-86.8247704,-86.8378959,-86.8516759,-86.8665498,-86.8805601,-86.8958161,-86.9122567,-86.9280967,-86.9418762,-86.9548371,-86.9694358,-86.9858835,-87.0004018,-87.014157,-87.0280989,-87.043812,-87.0625131,-87.082416,-87.1031732,-87.1233355,-87.1443056,-87.1627462,-87.1818657,-87.2013561,-87.2199459,-87.2382332,-87.2574129,-87.2769698,-87.2949576,-87.3129726,-87.3304072,-87.3491384,-87.3717501,-87.3927512,-87.412445,-87.433902,-87.4525246,-87.473308,-87.4974268,-87.5189197,-87.536606,-87.5562319,-87.5768553,-87.594903,-87.6148136,-87.6350677,-87.6530083,-87.6731667,-87.6907528,-87.7103101,-87.7325643,-87.755036,-87.7767482,-87.8001099,-87.8233921,-87.8459861,-87.8682104,-87.8879937,-87.9110178,-87.9342703,-87.9551257,-87.9750624,-87.9961459,-88.0159911,-88.0342458,-88.0531374,-88.0708034,-88.0797175,-88.0930434,-88.1042529,-88.1014838,-88.0964108,-88.0935321,-88.1072451,-88.120166,-88.1221407,-88.1262829,-88.1273447,-88.1225993,-88.1185497,-88.1295092,-88.1431364,-88.1545722,-88.1633546,-88.1627496,-88.164056,-88.1636184,-88.1635537,-88.1628771,-88.1636828,-88.163331,-88.1633528,-88.1633234,-88.1628456,-88.163215,-88.1632969,-88.1649383,-88.1633546,-88.1619295,-88.1608361,-88.1797522,-88.1952027,-88.2112692,-88.2266756,-88.2442671,-88.2622093,-88.2815951,-88.3007814,-88.3225486,-88.3438264,-88.3660706,-88.3856774,-88.4065173,-88.4266286,-88.4497887,-88.4747625,-88.4973883,-88.5185676,-88.5413461,-88.564724,-88.5896637,-88.613324,-88.6368922,-88.6591215,-88.6779027,-88.7012531,-88.7244214,-88.7472499,-88.7704739,-88.7928993,-88.8180255,-88.8432827,-88.8688573,-88.8924655,-88.9172109,-88.9400284,-88.9618745,-88.9842746,-89.003717,-89.027056,-89.051515,-89.0759015,-89.0987927,-89.11984,-89.1444275,-89.1670343,-89.1915449,-89.2126344,-89.2329846,-89.2553419,-89.2774605,-89.3011816,-89.3218668,-89.3446087,-89.3676817,-89.3896083,-89.4112535,-89.4310874,-89.4498428,-89.4715787,-89.4946979,-89.5175762,-89.5408976,-89.5615717,-89.5823447,-89.6048167,-89.6271631,-89.6473842,-89.6693493,-89.6917429,-89.7143931,-89.7359522,-89.7475451,-89.7543693,-89.7607462,-89.7692081,-89.7846152,-89.7991163,-89.8151302,-89.8312415,-89.8473986,-89.8633417,-89.8772868,-89.8907838,-89.9041046,-89.9179121,-89.9310769,-89.9460425,-89.9566957,-89.9626273,-89.9625546,-89.962393,-89.9626219,-89.9627502,-89.9625587,-89.962395,-89.9630299,-89.9625987,-89.962677,-89.962734,-89.9627376,-89.9627972,-89.9629582,-89.9626426,-89.9623835,-89.9623627,-89.9631403,-89.9628741,-89.9627189,-89.9627086,-89.9624403,-89.9626426,-89.9671227,-89.985174,-90.0038414,-90.0138086,-90.0218668,-90.0371769,-90.0504504,-90.0608208,-90.0715954,-90.0735287,-90.0706617,-90.0699522,-90.0643023,-90.0678069,-90.0664403,-90.0655456,-90.0650886,-90.0642548,-90.0645014,-90.0651399,-90.0662793,-90.0646745,-90.0636614,-90.0632259,-90.0647748,-90.061943,-90.0616739,-90.0620035,-90.0616871,-90.0618267,-90.0626007,-90.0625538,-90.0623514,-90.0620957,-90.061943,-90.0646779,-90.0681356,-90.0669614,-90.0678887,-90.0681413,-90.0678327,-90.0681356,-90.0657598,-90.0655122,-90.0652023,-90.0650869,-90.0653102,-90.0658132,-90.0662807,-90.0657676,-90.0657423,-90.0641243,-90.0652485,-90.0645903,-90.064378,-90.0644739,-90.0645501,-90.0645625,-90.0639758,-90.0636348,-90.0632474,-90.0629125,-90.0641243,-90.0622288,-90.0616412,-90.0594821,-90.0562782,-90.0566965,-90.0569814,-90.0575119,-90.0511178,-90.0389504,-90.0224293,-90.0135326,-90.0010175,-89.981357,-89.9647311,-89.9632848,-89.962454,-89.9627352,-89.9625872,-89.9624574,-89.9623103,-89.962923,-89.962505,-89.9627908,-89.9627186,-89.9627579,-89.9628913,-89.9629451,-89.9628887,-89.9628853,-89.96271,-89.9627974,-89.9627082,-89.9627847,-89.962808,-89.9628019,-89.9630248,-89.9626096,-89.962838,-89.9627637,-89.9627437,-89.9626747,-89.9626727,-89.9627372,-89.9628532,-89.9629666,-89.9628419,-89.9626405,-89.9629182,-89.9626114,-89.9631683,-89.9628093,-89.9623937,-89.9629519,-89.9624108,-89.9627089,-89.9628616,-89.9627755,-89.9628757,-89.9625818,-89.96242,-89.962486,-89.9626625,-89.9624686,-89.9624982,-89.9624987,-89.9624969,-89.9624559,-89.9624336,-89.9627352,-89.9616641,-89.9606972,-89.9492587,-89.9389775,-89.9395854,-89.9396195,-89.9387829,-89.9441833,-89.9494789,-89.9562612,-89.9603985,-89.9635606,-89.9662883,-89.9750522,-89.9848618,-89.9862646,-89.9861817,-89.9867016,-89.9917354,-89.9945534,-89.9944559,-89.9944988,-89.9944584,-89.994946,-89.9942526,-89.9942101,-89.9942279,-89.9941622,-89.9936257,-89.9936138,-89.9942406,-89.9943577,-89.9936628,-89.9940157,-89.9944837,-89.9945179,-89.9943001,-89.9944203,-89.9944512,-89.9944614,-89.9944614,-89.9943577,-89.9925906,-89.9937749,-89.9981088,-90.0000297,-90.0087078,-90.0153026,-90.0258363,-90.0297903,-90.0377756,-90.0478308,-90.0484011,-90.0492787,-90.0548469,-90.0746704,-90.0949567,-90.1164968,-90.1358715,-90.1583648,-90.178802,-90.2001345,-90.2194123,-90.2401839,-90.2610107,-90.2799665,-90.3003394,-90.3179435,-90.3345282,-90.3503932,-90.3674039,-90.3838005,-90.4003716,-90.4194594,-90.4422433,-90.4641129,-90.4858953,-90.5080018,-90.5329367,-90.5551955,-90.5792596,-90.6017002,-90.6250516,-90.6511461,-90.6773316,-90.7017946,-90.7258504,-90.7488196,-90.7719778,-90.7948869,-90.8187216,-90.8425152,-90.8671125,-90.8881606,-90.9096978,-90.9294647,-90.9467965,-90.960803,-90.9716418,-90.9821115,-90.9891039,-90.9929929,-91.0058096,-91.022132,-91.0356957,-91.0499163,-91.0674747,-91.0847928,-91.1018977,-91.1176707,-91.1324277,-91.1409507,-91.1447553,-91.1554755,-91.1688332,-91.1782614,-91.1949505,-91.2131674,-91.2315701,-91.2521378,-91.2743141,-91.2949088,-91.3154804,-91.3369397,-91.35804,-91.3788259,-91.399382,-91.4201578,-91.4415798,-91.4656116,-91.4889304,-91.5121529,-91.5333849,-91.5538016,-91.5759476,-91.5976994,-91.6182563,-91.6373315,-91.6556204,-91.6759974,-91.6954307,-91.714146,-91.733038,-91.7518937,-91.7726175,-91.7916227,-91.8137638,-91.8299357,-91.8304352,-91.8298949,-91.8298949,-91.8299357,-91.8298705,-91.8298617,-91.8298801,-91.8298644,-91.8293816,-91.8294105,-91.8294696,-91.8296983,-91.8300217,-91.8300072,-91.829992,-91.8300009,-91.8300312,-91.8300213,-91.8300567,-91.8300673,-91.829696,-91.8294919,-91.8295937,-91.8297877,-91.8299911,-91.8300591,-91.8300225,-91.8300301,-91.8300445,-91.8300122,-91.8300687,-91.8300673,-91.8300768,-91.8300789,-91.829913,-91.8331406,-91.8520597,-91.8757864,-91.8980121,-91.9206678,-91.9414434,-91.9633565,-91.9837103,-92.0062033,-92.0274162,-92.0490908,-92.0720054,-92.0954385,-92.1175512,-92.1422948,-92.1647347,-92.1879952,-92.2104338,-92.23263,-92.2570044,-92.2799836,-92.3009196,-92.3227777,-92.3460385,-92.369855,-92.3930233,-92.416748,-92.4395122,-92.4636154,-92.4884406,-92.5116732,-92.5346027,-92.5574678,-92.5806212,-92.6047091,-92.6263256,-92.6495533,-92.67262,-92.6967695,-92.7206257,-92.7427208,-92.766821,-92.7913635,-92.8161146,-92.8386609,-92.8605283,-92.882203,-92.9038067,-92.925017,-92.9477128,-92.9686132,-92.9895575,-93.0118692,-93.0345734,-93.0596318,-93.0852445,-93.1090749,-93.1330437,-93.1577254,-93.1802843,-93.1968796,-93.2162353,-93.2369146,-93.2549346,-93.2768914,-93.2943596,-93.3115448,-93.3293382,-93.3504942,-93.3735113,-93.3945224,-93.4187245,-93.4403088,-93.4628798,-93.4838998,-93.5054437,-93.5292619,-93.5527458,-93.5708579,-93.5694294,-93.5707539,-93.5708138,-93.5708582,-93.5708805,-93.5707004,-93.5706467,-93.5706896,-93.5706621,-93.5706603,-93.5707097,-93.5706535,-93.570816,-93.5707867,-93.5707867,-93.5707404,-93.5706859,-93.5707157,-93.5707579,-93.5707624,-93.570737,-93.57074,-93.5711306,-93.5707108,-93.5740212,-93.5925198,-93.6125311,-93.6338536,-93.6527072,-93.6721813,-93.6913851,-93.7110438,-93.7292393,-93.749806,-93.7727085,-93.794137,-93.8169854,-93.8371455,-93.8582232,-93.8825494,-93.906949,-93.9314545,-93.9552396,-93.9805135,-94.0030762,-94.0232799,-94.0418403,-94.0618811,-94.0840939,-94.1060243,-94.1272727,-94.1359692,-94.1346845,-94.1413547,-94.1529806,-94.167176,-94.1804731,-94.1946545,-94.2116156,-94.2087377,-94.2116243,-94.2116234,-94.2116156,-94.2116156,-94.2116156,-94.2116139,-94.2117519,-94.2117551,-94.2118634,-94.2118575,-94.2119861,-94.2115925,-94.2095567,-94.2192011,-94.2341754,-94.249152,-94.263924,-94.2791481,-94.2977948,-94.3120668,-94.3285319,-94.3409141,-94.3557119,-94.3729114,-94.389564,-94.414046,-94.4394899,-94.4644555,-94.4888806,-94.5116372,-94.5351353,-94.5593782,-94.582245,-94.6071342,-94.6317356,-94.6559948,-94.6791191,-94.7013396,-94.7250366,-94.7467271,-94.7691803,-94.7931695,-94.8177817,-94.8426686,-94.8668333,-94.8898485,-94.9149705,-94.9375484,-94.9598305,-94.9838035,-95.0084202,-95.0322528,-95.0539933,-95.0719397,-95.0914898,-95.1124667,-95.1310519,-95.152481,-95.1739733,-95.1968262,-95.2187536,-95.2378562,-95.2581779,-95.2780989,-95.2978893,-95.3186094,-95.3369838,-95.3547528,-95.3654825,-95.3783176,-95.3987233,-95.4181803,-95.4368887,-95.456835,-95.4760852,-95.4978813,-95.5170105,-95.5374993,-95.5621296,-95.5798086,-95.6020366,-95.6209502,-95.6424551,-95.6636837,-95.68478,-95.7065571,-95.7278614,-95.749733,-95.7721725,-95.7949697,-95.8142748,-95.8355775,-95.8578256,-95.8790387,-95.9007694,-95.922687,-95.9444572,-95.9646805,-95.985197,-96.0083862,-96.0289354,-96.0525542,-96.0768648,-96.0993793,-96.1218633,-96.1418891,-96.1635005,-96.1869689,-96.2092012,-96.2310186,-96.2551464,-96.2794462,-96.301387,-96.3267529,-96.349496,-96.3746647,-96.3972071,-96.4194199,-96.4432758,-96.4666653,-96.4906237,-96.5118669,-96.5300898,-96.5474582,-96.5692126,-96.5922388,-96.6133176,-96.6374208,-96.6595515,-96.6826387,-96.7042722,-96.7272217,-96.7490864,-96.7739688,-96.7970373,-96.8211438,-96.8442541,-96.8658778,-96.8868403,-96.9021006,-96.9019925,-96.9023357,-96.9022412,-96.902078,-96.9022007,-96.9020749,-96.90211,-96.9019903,-96.9018705,-96.9019047,-96.9018274,-96.9018151,-96.9018945,-96.9019142,-96.9019067,-96.901948,-96.9019511,-96.9019473,-96.9020088,-96.9019414,-96.9019361,-96.901965,-96.9019366,-96.9019079,-96.9019079,-96.9019532,-96.9019216,-96.9033236,-96.9019853,-96.9218103,-96.9452377,-96.9684542,-96.9945896,-97.0194329,-97.0423112,-97.0683249,-97.0949022,-97.1198866,-97.1465076,-97.1715961,-97.1970894,-97.2216314,-97.2473756,-97.2719717,-97.2949048,-97.3192436,-97.3433895,-97.3703273,-97.394405,-97.4198197,-97.4441272,-97.469735,-97.4958223,-97.521259,-97.5456938,-97.5715256,-97.5949492,-97.6195729,-97.6450595,-97.6680602,-97.6902169,-97.7112268,-97.7330134,-97.755595,-97.7766182,-97.7999637,-97.8248332,-97.8500171,-97.8728096,-97.8950279,-97.9187246,-97.9434237,-97.9677906,-97.9871022,-98.0070859,-98.0285542,-98.0465369,-98.067569,-98.0898309,-98.1117833,-98.1322127,-98.1521858,-98.1716649,-98.1910621,-98.2116798,-98.2304163,-98.249883,-98.2704789,-98.2910138,-98.3125984,-98.3336044,-98.3547187,-98.3776855,-98.3991346,-98.4184323,-98.4321544,-98.4393874,-98.4420916,-98.4421992,-98.4420801,-98.4416623,-98.4420462,-98.4417413,-98.4420015,-98.4420623,-98.4422044,-98.4421766,-98.4422474,-98.4422535,-98.4421892,-98.4422033,-98.4422172,-98.4421907,-98.4422605,-98.4422094,-98.4421037,-98.4422456,-98.4421811,-98.442065,-98.442127,-98.4422451,-98.4421795,-98.4421981,-98.4416654,-98.4421866,-98.4424071,-98.4422051,-98.4422228,-98.4416598,-98.4417097,-98.4419328,-98.4416862,-98.4417017,-98.4416858,-98.4416642,-98.4416702,-98.4424005,-98.4421992,-98.443969,-98.4617981,-98.4770016,-98.4795455,-98.4796453,-98.479866,-98.479866,-98.4829642,-98.4868792,-98.485969,-98.4877737,-98.4877737,-98.4868991,-98.4871962,-98.4877761,-98.4878587,-98.4880643,-98.4880638,-98.4882678,-98.4884631,-98.4884437,-98.4880377,-98.4871865,-98.4875204,-98.4862923,-98.4866655,-98.4866538,-98.4863014,-98.4863374,-98.4860623,-98.4860206,-98.4860618,-98.4858503,-98.4857535,-98.4856024,-98.4864695,-98.4862923,-98.4891968,-98.4887821,-98.4896166,-98.4900058,-98.4879643,-98.4891968,-98.4868861,-98.4869063,-98.4868861,-98.486889,-98.4849384,-98.4812999,-98.4813208,-98.4774843,-98.4911451,-98.5027438,-98.5147152,-98.5157777,-98.5192459,-98.5371072,-98.5481692,-98.5543431,-98.5650834,-98.5824599,-98.5912258,-98.5969658,-98.6000376,-98.6064138,-98.6130983,-98.6233851,-98.6317383,-98.6423054,-98.6542831,-98.6658279,-98.6810644,-98.697462,-98.7134223,-98.7297935,-98.7473862,-98.7532584,-98.7589568,-98.7738555,-98.7857385,-98.7959335,-98.8108815,-98.821281,-98.8378366,-98.8577869,-98.8738769,-98.888269,-98.8994705,-98.921338,-98.9406728,-98.9587903,-98.9740887,-98.9944201,-99.0158461,-99.0389721,-99.0568666,-99.0816714,-99.1047441,-99.1269278,-99.1464652,-99.1663313,-99.1827029,-99.2029636,-99.2223537,-99.2318541,-99.2416985,-99.2633593,-99.2862561,-99.3108562,-99.3353206,-99.3595658,-99.3834735,-99.4038053,-99.4236418,-99.4430977,-99.4635565,-99.4868859,-99.5063184,-99.5270998,-99.5503928,-99.5695393,-99.5821037,-99.5951339,-99.6067989,-99.6212006,-99.6435672,-99.6653031,-99.682719,-99.7033386,-99.719045,-99.7299048,-99.7391454,-99.7574828,-99.7732821,-99.7732322,-99.7730391,-99.7731956,-99.7732621,-99.7732839,-99.7732839,-99.7732839,-99.773128,-99.7731031,-99.772818,-99.7730711,-99.7728358,-99.7730955,-99.7731663,-99.7730089,-99.7730211,-99.7730237,-99.7730103,-99.7729978,-99.7730002,-99.7730147,-99.7730146,-99.7730367,-99.773026,-99.7730505,-99.7731059,-99.7729962,-99.7729884,-99.7728914,-99.7729698,-99.7730663,-99.77314,-99.7731381,-99.7731278,-99.773153,-99.7731318,-99.7730065,-99.7730784,-99.7731009,-99.773103,-99.7730981,-99.7730983,-99.7759383,-99.7950482,-99.8160683,-99.8395856,-99.8625217,-99.8855137,-99.9075319,-99.9274127,-99.9498017,-99.9722728,-99.994406,-100.0168538,-100.0376638,-100.0580438,-100.0790289,-100.1000557,-100.1207708,-100.1442924,-100.1676055,-100.192065,-100.2154674,-100.2390158,-100.2638933,-100.2856164,-100.3056967,-100.3260139,-100.3472252,-100.3702842,-100.3915278,-100.4123222,-100.4350974,-100.4573901,-100.4812851,-100.5059455,-100.5284941,-100.5512133,-100.573189,-100.5979841,-100.622992,-100.6453061,-100.665166,-100.6869609,-100.7089451,-100.7285376,-100.7439921,-100.7445242,-100.7445242,-100.7445242,-100.744506,-100.7444978,-100.7444867,-100.7565646,-100.7966809,-100.8183972,-100.8370042,-100.8548652,-100.8719909,-100.8902339,-100.9084917,-100.9440841,-100.9641545,-100.9842257,-101.0068776,-101.0288272,-101.0540171,-101.0793678,-101.1019804,-101.1266147,-101.152225,-101.1642136,-101.1659975,-101.1804691,-101.2040592,-101.2266571,-101.249588,-101.2759296,-101.3017722,-101.3262452,-101.3525032,-101.376332,-101.3984966,-101.4460223,-101.4711558,-101.4943204,-101.5160641,-101.5306587,-101.5536369,-101.578407,-101.6010098,-101.6253506,-101.649218,-101.6728631,-101.6962518,-101.7184191,-101.7392346,-101.7584218,-101.7827445,-101.8067369,-101.8270358,-101.845517,-101.8713383,-101.8950086,-101.9172642,-101.9407319,-101.9582454,-101.971627,-101.9933967,-102.0082217,-102.0320534,-102.0539409,-102.0737593,-102.0935717,-102.1186236,-102.1419664,-102.1668289,-102.1928225,-102.2187721,-102.2442502,-102.2713863,-102.2939639,-102.3187451,-102.3429559,-102.3661984,-102.3913297,-102.4152384,-102.4403164,-102.4623417,-102.4861099,-102.5119566,-102.5377683,-102.5635154,-102.5891976,-102.6136763,-102.6406794,-102.6645647,-102.6913158,-102.7180047,-102.7450755,-102.7723452,-102.8014074,-102.8279361,-102.8513567,-102.8705551,-102.8950112,-102.9113827,-102.9262664,-102.9446472,-102.9640745,-102.9845958,-103.0043405,-103.0232321,-103.0432241,-103.0621598,-103.0807928,-103.1006538,-103.120761,-103.1404019,-103.1600447,-103.1785119,-103.19711,-103.2170419,-103.2367489,-103.2558579,-103.2672297,-103.2788277,-103.2896513,-103.3007569,-103.3129078,-103.3254961,-103.3380585,-103.3499727,-103.3632944,-103.3779289,-103.3934179,-103.4106242,-103.4260419,-103.4342743,-103.4452066,-103.4600478,-103.4730434,-103.4807406,-103.4807125,-103.4807308,-103.4807305,-103.4807435,-103.4807479,-103.4808019,-103.4805504,-103.4803374,-103.480642,-103.4802668,-103.480595,-103.4803208,-103.4803114,-103.480313,-103.480316,-103.4803153,-103.4803055,-103.4803636,-103.4803283,-103.4807852,-103.4805067,-103.4828405,-103.4831861,-103.4845559,-103.4874748,-103.4926302,-103.4970634,-103.5029349,-103.5107439,-103.5193954,-103.5334609,-103.5450861,-103.5557711,-103.5663401,-103.5764977,-103.586454,-103.5990992,-103.6108469,-103.6210747,-103.6344287,-103.6511998,-103.6741456,-103.695326,-103.7127454,-103.7322656,-103.7513243,-103.7742627,-103.7883947,-103.7987173,-103.8093474,-103.8228043,-103.834747,-103.8475013,-103.8598937,-103.8717468,-103.8844753,-103.8987597,-103.9085771,-103.9143153,-103.9261402,-103.937288,-103.9493329,-103.9580212,-103.967479,-103.9770754,-103.9866481,-103.9985667,-104.0100948,-104.0205836,-104.0300895,-104.0404414,-104.0504848,-104.0597465,-104.0624948,-104.0649403,-104.0671888,-104.0694178,-104.0731224,-104.0733309,-104.0735255,-104.0737004,-104.0738513,-104.0709011,-104.0673599,-104.0644196,-104.0673857,-104.0703969,-104.0721834,-104.0764962,-104.0832042,-104.0878913,-104.0875694,-104.0960804,-104.1000816,-104.1009799,-104.1009927,-104.1010022,-104.1010107,-104.1010281,-104.1016559,-104.1081717,-104.1213328,-104.1348134,-104.1484301,-104.1631283,-104.1771887,-104.1928698,-104.2071161,-104.2146469,-104.2174755,-104.2204136,-104.2206072,-104.2210284,-104.2236905,-104.2224815,-104.2226138,-104.223376,-104.2236697,-104.2236715,-104.2236546,-104.2236238,-104.2245061,-104.2244499,-104.2242692,-104.2243675,-104.2247046,-104.2245047,-104.2241716,-104.2245711,-104.2246097,-104.2235774,-104.2243453,-104.2244567,-104.2245333,-104.2244863,-104.2244037,-104.2244845,-104.2244705,-104.2243978,-104.2245537,-104.223708,-104.2242713,-104.2222784,-104.2199164,-104.2241659,-104.2308082,-104.2357888,-104.2436249,-104.2516879,-104.2604626,-104.2679942,-104.2762071,-104.2845393,-104.2931107,-104.30177,-104.3100914,-104.3198605,-104.3367085,-104.3527269,-104.3709007,-104.3821137,-104.3872769,-104.3985121,-104.4093702,-104.4416286,-104.4489906,-104.4428878,-104.4433716,-104.4430743,-104.4430567,-104.4440577,-104.4438402,-104.4443092,-104.4439608,-104.4436341,-104.4431211,-104.4441338,-104.4442474,-104.4430955,-104.4431199,-104.4431141,-104.4430534,-104.4430856,-104.4421019,-104.4436713,-104.4460369,-104.4444136,-104.4320036,-104.4116854,-104.4024784,-104.3897497,-104.3831825,-104.3744657,-104.3583057,-104.3419751,-104.3250274,-104.3134358,-104.3048851,-104.2956658,-104.2864423,-104.277274,-104.2681193,-104.2589951,-104.2486139,-104.2394089,-104.2325111,-104.2374581,-104.2375767,-104.2382404,-104.2498904,-104.2551135,-104.2550073,-104.2617777,-104.2754274,-104.27829,-104.2900912,-104.3017202,-104.3146677,-104.3219041,-104.3259345,-104.3315647,-104.3516903,-104.3715856,-104.385474,-104.3981368,-104.4016051,-104.4130613,-104.4217846,-104.4210396,-104.4116825,-104.401789,-104.3953694,-104.3954724,-104.3957698,-104.3957208,-104.395654,-104.3955758,-104.3955206,-104.3954951,-104.3953337,-104.3967155,-104.3974939,-104.3979366,-104.398962,-104.4004542,-104.4101691,-104.4242627,-104.435633,-104.438786,-104.4387037,-104.4391991,-104.4397424,-104.4402442,-104.4408444,-104.4414675,-104.4419978,-104.4420651,-104.4414323,-104.4438796,-104.4473973,-104.4506864,-104.4540464,-104.4572428,-104.4606718,-104.4638804,-104.4661531,-104.4662913,-104.4795295,-104.4988867,-104.5066429,-104.5102925,-104.5132762,-104.5178435,-104.5225626,-104.522667,-104.5226828,-104.5227038,-104.5227155,-104.522719,-104.5227299,-104.5228932,-104.5229117,-104.5229754,-104.5230453,-104.5231543,-104.5233215,-104.5210497,-104.5192034,-104.5192384,-104.5192107,-104.5192498,-104.5192863,-104.5193208,-104.5300363,-104.5422975,-104.5540465,-104.562272,-104.5646522,-104.56699,-104.5694768,-104.571816,-104.5735822,-104.5743191,-104.5748517,-104.5755207,-104.5785855,-104.5835993,-104.5888887,-104.5942697,-104.5994231,-104.6149472,-104.6308828,-104.6485563,-104.6655628,-104.683767,-104.7055818,-104.7256375,-104.7445667,-104.7623826,-104.7781192,-104.7940044,-104.8083442,-104.8245243,-104.8403358,-104.8567315,-104.8708571,-104.8802175,-104.8901901,-104.9002424,-104.9097382,-104.9188265,-104.9283036,-104.9386104,-104.954073,-104.9692781,-104.9842228,-105.0003976,-105.0169443,-105.0337565,-105.049447,-105.0662604,-105.0817146,-105.0969935,-105.1131238,-105.1284952,-105.143627,-105.1588789,-105.1750193,-105.1880595,-105.1897594,-105.1896783,-105.1896348,-105.1896642,-105.1897732,-105.1897205,-105.1897539,-105.1897319,-105.1897388,-105.189236,-105.1892726,-105.1895044,-105.1895732,-105.1895312,-105.1895175,-105.1894584,-105.1894367,-105.1895062,-105.1895223,-105.1895353,-105.1894963,-105.1894963,-105.1895202,-105.1895206,-105.1895366,-105.1895341,-105.1897566,-105.1896717,-105.1894425,-105.1894914,-105.1894547,-105.189499,-105.1895001,-105.18953,-105.1895235,-105.1895696,-105.2021809,-105.2144095,-105.2292596,-105.2463828,-105.2632554,-105.2838143,-105.3041351,-105.3277184,-105.3515004,-105.37217,-105.3926457,-105.4081205,-105.4287241,-105.4501382,-105.4652788,-105.4779239,-105.4876269,-105.4991587,-105.5104087,-105.5219929,-105.5327205,-105.5431393,-105.554408,-105.5659291,-105.5776807,-105.5883706,-105.598466,-105.6004628,-105.6066064,-105.6163808,-105.6275905,-105.6379522,-105.6485825,-105.6600913,-105.6665102,-105.6886761,-105.7141361,-105.7395201,-105.76396,-105.787455,-105.8120677,-105.8370032,-105.8601041,-105.8852946,-105.9123952,-105.938766,-105.9622905,-105.9864583,-106.0129845,-106.0367368,-106.0609451,-106.08388,-106.1057031,-106.1273348,-106.1502963,-106.1713806,-106.1934782,-106.2148998,-106.236981,-106.2546074,-106.2736918,-106.2909539,-106.3109229,-106.3311974,-106.3499938,-106.3707573,-106.3843967,-106.4057939,-106.4234837,-106.4468143,-106.4699163,-106.4900091,-106.5087211,-106.5272397,-106.5459615,-106.5659069,-106.5856367,-106.6022565,-106.6137408,-106.6171446,-106.6266113,-106.6299411,-106.6369225,-106.6445859,-106.6482547,-106.6569724,-106.6721738,-106.6888226,-106.7070355,-106.7214987,-106.7385995,-106.7558941,-106.7704583,-106.7833569,-106.7870144,-106.784347,-106.783874,-106.784347,-106.784347,-106.784347,-106.784347,-106.784347,-106.7843476,-106.7843512,-106.7843455,-106.7843132,-106.7842909,-106.7843028,-106.7842815,-106.7842628,-106.7842693,-106.7842865,-106.7844497,-106.7843801,-106.7877795,-106.7904228,-106.810139,-106.8325785,-106.8547319,-106.8729047,-106.8910003,-106.9114444,-106.9304484,-106.9533564,-106.9763709,-106.998286,-107.0195949,-107.0377519,-107.0581303,-107.077736,-107.0973079,-107.1193144,-107.1408669,-107.165828,-107.1892484,-107.2120041,-107.2369223,-107.263826,-107.2893396,-107.3104488,-107.3282804,-107.3398191,-107.3632887,-107.3849161,-107.4080329,-107.4347263,-107.4606316,-107.4836605,-107.5069921,-107.5248612,-107.5410788,-107.5647503,-107.5913347,-107.6193395,-107.6446368,-107.665553,-107.6881254,-107.7109335,-107.7365035,-107.7588747,-107.7780265,-107.7979628,-107.8163515,-107.8367367,-107.8522361,-107.8728431,-107.8952501,-107.9017571,-107.9177444,-107.9341535,-107.9487997,-107.962748,-107.9784453,-107.9860025,-107.9901525,-107.9973378,-108.0099702,-108.0330681,-108.0537143,-108.0763233,-108.1007556,-108.1231595,-108.1473207,-108.1726033,-108.1966017,-108.2195331,-108.2431039,-108.2651444,-108.2871105,-108.3084434,-108.3277466,-108.3475778,-108.3662884,-108.3848992,-108.4054609,-108.4249344,-108.4506148,-108.4754274,-108.4983722,-108.5214713,-108.5442841,-108.566027,-108.5892538,-108.6138492,-108.6368058,-108.6586201,-108.6692899,-108.6798984,-108.6960385,-108.708639,-108.7088292,-108.7084008,-108.7084919,-108.708639,-108.7085743,-108.7086344,-108.7086269,-108.7085813,-108.7086513,-108.7085506,-108.7084987,-108.7085236,-108.7085372,-108.708529,-108.7085245,-108.7085763,-108.7084913,-108.7085179,-108.7083725,-108.7083491,-108.7084045,-108.7085246,-108.7083672,-108.7083338,-108.7083338,-108.7083338,-108.7083338,-108.7083338,-108.708365,-108.708365,-108.7083642,-108.7083646,-108.7084047,-108.7083713,-108.7083572,-108.7083419,-108.7086241,-108.7090767,-108.7084779,-108.7121336,-108.7199608,-108.7198517,-108.71987,-108.7199608,-108.7199608,-108.7199417,-108.7197694,-108.7220069,-108.7226758,-108.727051,-108.7431752,-108.7627521,-108.7833931,-108.8046059,-108.8253687,-108.8408765,-108.8632394,-108.8868336,-108.9091483,-108.9290446,-108.9466536,-108.9624511,-108.9813406,-108.9972173,-109.008916,-109.0268054,-109.0444331,-109.0566354,-109.0694042,-109.0843392,-109.1043799,-109.1264349,-109.1471803,-109.1675497,-109.1896357,-109.2099664,-109.2323404,-109.253031,-109.270439,-109.2858316,-109.3029523,-109.3194012,-109.3374409,-109.360508,-109.3824308,-109.4040486,-109.4256762,-109.4355546,-109.4332728,-109.4356427,-109.4356485,-109.4359636,-109.4482559,-109.4683685,-109.4866915,-109.5049764,-109.5231838,-109.5430148,-109.5668214,-109.5894389,-109.6098346,-109.6319443,-109.6548452,-109.6767561,-109.6981361,-109.7201402,-109.7413494,-109.7638727,-109.7850705,-109.8066882,-109.8265821,-109.8476253,-109.870105,-109.895343,-109.9215661,-109.9477268,-109.9717778,-109.9965851,-110.020602,-110.0450421,-110.0694705,-110.0919512,-110.109448,-110.1267058,-110.1366769,-110.1549151,-110.1795649,-110.2025611,-110.2259237,-110.2471948,-110.2637365,-110.2787473,-110.2972281,-110.3167429,-110.3399636,-110.3643883,-110.388822,-110.4151499,-110.4407725,-110.465612,-110.4889228,-110.5120145,-110.5355047,-110.5585834,-110.580425,-110.6026882,-110.6246409,-110.6461984,-110.6670588,-110.682879,-110.696588,-110.7168515,-110.7381446,-110.7595957,-110.7803991,-110.8016346,-110.8247808,-110.8461376,-110.8651937,-110.8846442,-110.9039787,-110.9241769,-110.9438851,-110.9655005,-110.9858347,-111.0059991,-111.0273753,-111.0483255,-111.0683291,-111.0892901,-111.110163,-111.1329721,-111.1553572,-111.1788029,-111.1991014,-111.2216992,-111.242191,-111.2640047,-111.2844899,-111.3053813,-111.3266125,-111.3474504,-111.3690012,-111.3898755,-111.4101438,-111.431626,-111.4554012,-111.4769146,-111.4997985,-111.5203655,-111.5418187,-111.5629336,-111.5812691,-111.5877524,-111.5953976,-111.5968955,-111.6042783],"lat":[33.8465853,33.8361607,33.8283154,33.8185757,33.8086421,33.7970326,33.7805263,33.7672676,33.755394,33.7437364,33.7266033,33.7120551,33.6977384,33.6854827,33.6724931,33.6614919,33.6505909,33.6382219,33.6206107,33.6188275,33.6017875,33.5894309,33.575587,33.5612994,33.551666,33.5419701,33.5307047,33.5196752,33.5025841,33.4868779,33.4695842,33.4529994,33.4410196,33.4307704,33.4164157,33.400236,33.3845295,33.367116,33.3473453,33.329622,33.3141708,33.2946076,33.2756129,33.2570992,33.2388582,33.2211068,33.2070114,33.1947363,33.1800601,33.1635535,33.1469295,33.1313731,33.1133854,33.0953763,33.0804292,33.0661186,33.0536296,33.0401393,33.0241776,33.0100232,32.9975247,32.984959,32.9766727,32.9661492,32.9520121,32.9343297,32.9153437,32.8990072,32.8830232,32.8685804,32.8535169,32.8390878,32.8251834,32.8092655,32.7935376,32.7775912,32.761054,32.7444772,32.7263163,32.7074977,32.6889266,32.6724289,32.655765,32.6396942,32.6307417,32.62115,32.6111249,32.6023451,32.5912678,32.5778347,32.566639,32.5567551,32.5458052,32.5357867,32.5268961,32.5138636,32.5051784,32.4927251,32.4830665,32.4761401,32.472994,32.4659154,32.4543746,32.4479079,32.4456109,32.4450559,32.4421467,32.4368088,32.4369081,32.4282755,32.4253472,32.417796,32.4046326,32.3937649,32.383276,32.3772266,32.3708433,32.368239,32.3663068,32.3681836,32.3674677,32.3623099,32.3620472,32.3633132,32.3601972,32.3625554,32.3656225,32.3679243,32.365449,32.3490366,32.3348526,32.3281331,32.328181,32.3282387,32.328219,32.3281521,32.3281942,32.3283146,32.3284652,32.3284945,32.3284747,32.3285068,32.3284623,32.3284699,32.3283168,32.3284881,32.3282939,32.3283059,32.3284885,32.3283173,32.328255,32.3282621,32.3280175,32.3283076,32.3228458,32.3025838,32.2837481,32.2660126,32.2490936,32.2318429,32.2169014,32.2000606,32.181882,32.1638748,32.145883,32.1284689,32.1106098,32.0933267,32.0732255,32.0565843,32.0388402,32.0210906,32.0014736,31.9819484,31.9615367,31.94599,31.9284032,31.9098954,31.8919927,31.8740803,31.8587958,31.8456354,31.8275285,31.8072821,31.7872142,31.7708241,31.7520598,31.7338749,31.7160622,31.6990567,31.685201,31.6683284,31.6502702,31.6339555,31.6177417,31.6021115,31.5862065,31.5722019,31.5591425,31.5468064,31.5334551,31.5170671,31.5010555,31.4857736,31.4703785,31.4530374,31.4368718,31.4246471,31.4100812,31.394028,31.3774742,31.3629033,31.3511947,31.3421016,31.3316287,31.3188693,31.3076475,31.2942295,31.2793378,31.2651871,31.2513789,31.24066,31.2302515,31.2176633,31.202361,31.1876348,31.1727007,31.1615484,31.1514874,31.1420276,31.1317233,31.1210225,31.1109729,31.1047457,31.0951692,31.0828245,31.0691315,31.061016,31.0500195,31.0412343,31.0337267,31.0214083,31.0091086,30.9958549,30.98203,30.9725589,30.9655336,30.961153,30.9583572,30.9536361,30.9520923,30.946395,30.9410888,30.9349072,30.928652,30.9189927,30.9095054,30.905613,30.8946628,30.8835377,30.8722132,30.8603503,30.8421501,30.8246759,30.8062728,30.7899996,30.7746541,30.7557289,30.7410989,30.7278948,30.7088952,30.6892435,30.6709399,30.6520902,30.6339786,30.622899,30.6112068,30.5984575,30.5952165,30.5968347,30.5947506,30.5945862,30.5946134,30.593956,30.5942222,30.5953955,30.5953997,30.5953938,30.5942057,30.5944558,30.595026,30.5949843,30.5952165,30.5966323,30.586948,30.5760961,30.5650693,30.5534265,30.5438065,30.5351421,30.5256766,30.5145257,30.5057563,30.4990393,30.4948295,30.4888101,30.4806684,30.4719487,30.4635727,30.4592954,30.4574283,30.4554239,30.4462839,30.4397106,30.4384038,30.4381834,30.4379877,30.4371161,30.4348084,30.4328351,30.4358939,30.4442478,30.4474018,30.4554281,30.458571,30.4545417,30.4543823,30.4542241,30.4540025,30.4476636,30.4521596,30.4607795,30.4580429,30.4494179,30.4452661,30.4414173,30.4375919,30.4315039,30.4261591,30.4236737,30.4187226,30.4172202,30.4116514,30.4044444,30.403439,30.4040394,30.4006194,30.3902237,30.382794,30.3757163,30.3689249,30.3621521,30.3561502,30.3503511,30.3446993,30.3389576,30.333219,30.3333054,30.3273871,30.3210271,30.314124,30.30707,30.3021601,30.2974261,30.2975609,30.2989761,30.3045912,30.2907077,30.2724161,30.2553238,30.236162,30.2209636,30.2060746,30.1909248,30.1756789,30.1603898,30.1453435,30.1279953,30.1126541,30.0977123,30.0822151,30.0674338,30.0559491,30.0492333,30.0483896,30.0481172,30.0486619,30.0483953,30.0493447,30.0486958,30.0487032,30.0489771,30.0488432,30.0488832,30.0488515,30.0489484,30.0488609,30.0491397,30.0486922,30.0485854,30.0486399,30.0484413,30.0475104,30.0477322,30.0477151,30.0476216,30.0485587,30.0425982,30.033528,30.0274905,30.0179842,30.0059231,30.0024907,29.9910691,29.9782112,29.96631,29.9645202,29.9614949,29.9597695,29.9561512,29.9588282,29.9578756,29.9572829,29.9569766,29.9564419,29.956197,29.9569818,29.9578915,29.958136,29.9578768,29.9576923,29.9570057,29.9567951,29.9576175,29.9575051,29.9566267,29.9566282,29.9551868,29.9550549,29.955944,29.9571275,29.9567951,29.9593109,29.9620029,29.960799,29.9615694,29.9621612,29.9614436,29.9620029,29.9574772,29.959868,29.959701,29.9591854,29.9589734,29.9584065,29.9579042,29.9574824,29.9590051,29.9563931,29.957031,29.9565776,29.9563484,29.95623,29.9562698,29.9562665,29.9562579,29.9560295,29.9562264,29.9566011,29.9563931,29.9573154,29.9579891,29.9596762,29.9633068,29.9681582,29.9729652,29.9794238,29.9899345,30.0015705,30.0056644,30.0180968,30.0277624,30.0348076,30.0437517,30.044553,30.0482173,30.0488184,30.0481775,30.0485714,30.0488577,30.0488991,30.0483757,30.0490243,30.0489821,30.0489226,30.0491197,30.048945,30.0488652,30.048923,30.048872,30.0489176,30.0488804,30.0489307,30.0488966,30.0489278,30.0491186,30.0490468,30.0488489,30.0488619,30.0489528,30.0488882,30.0488068,30.0488706,30.0488852,30.0490002,30.0489248,30.0487611,30.0488768,30.0488171,30.0491572,30.0488308,30.0484679,30.0489697,30.0484701,30.0490594,30.0490268,30.049002,30.0492231,30.04832,30.0486199,30.0485211,30.0486766,30.04851,30.0485164,30.0485207,30.0485315,30.0485426,30.0486791,30.0488184,30.0466457,30.0457894,30.053524,30.0513113,30.0330897,30.0158572,30.0027887,29.9876518,29.9716765,29.9576357,29.9494325,29.9429562,29.9372376,29.9406198,29.9447873,29.9447244,29.9447195,29.9455162,29.9463288,29.9419702,29.9418763,29.9418411,29.9417632,29.9408523,29.9401584,29.9419311,29.9419878,29.9423854,29.9427192,29.9431043,29.9421209,29.942002,29.9430796,29.9422869,29.9418971,29.9419082,29.9418152,29.9420659,29.941895,29.9418865,29.9418865,29.942002,29.9449369,29.9501731,29.9578683,29.9613603,29.9646362,29.966494,29.9691236,29.9697512,29.9716122,29.9738942,29.9800474,29.9904125,29.9917045,29.9921273,29.9939539,29.9957089,29.9967826,29.9976885,29.9988265,30.0008335,30.008163,30.0095047,30.0082292,30.0067708,30.0088306,30.0194187,30.0306567,30.0414135,30.0529394,30.0639916,30.075206,30.0823303,30.0888533,30.0950689,30.1018521,30.107986,30.1102461,30.1122893,30.1143561,30.1163727,30.1184716,30.1208097,30.1231064,30.1264204,30.1336406,30.1405891,30.1475801,30.151914,30.1557399,30.1622492,30.1689298,30.1772475,30.187719,30.1972445,30.2105928,30.2275046,30.2442869,30.2632523,30.2830125,30.3041545,30.3222978,30.3382712,30.3540899,30.3712223,30.3833788,30.394535,30.4080512,30.4190201,30.4223517,30.4232489,30.4236348,30.424783,30.4272611,30.4384984,30.4394988,30.4405393,30.445572,30.4494212,30.4536966,30.4524923,30.4512944,30.4465134,30.4409137,30.4353813,30.4298946,30.4225949,30.4168324,30.4114911,30.4057936,30.3997036,30.3939256,30.3884027,30.3824092,30.376519,30.370966,30.3656092,30.3608347,30.3552631,30.3500071,30.3447489,30.3398202,30.3347094,30.3290675,30.3239067,30.3192156,30.316481,30.3161281,30.3164817,30.3164817,30.316481,30.3164848,30.3164925,30.3164799,30.3166402,30.3167719,30.3167404,30.3168353,30.3166172,30.3164813,30.3164633,30.3164701,30.3164606,30.3164489,30.3164493,30.316496,30.3164746,30.316627,30.3167314,30.3167313,30.3165209,30.316527,30.3165837,30.3165775,30.3165652,30.316524,30.3165701,30.3165512,30.316569,30.3165486,30.3165732,30.3165523,30.3155591,30.3119713,30.3065294,30.3003064,30.2939645,30.2845527,30.2771102,30.2708426,30.2635503,30.2549325,30.2474187,30.2471289,30.2472771,30.2474158,30.2475565,30.2477364,30.2478235,30.2479346,30.2504388,30.2525202,30.252378,30.2467353,30.240019,30.2357022,30.2357659,30.2358427,30.2360391,30.2361764,30.2339539,30.2310425,30.2315196,30.2321887,30.2363777,30.2364564,30.2365462,30.2415237,30.2468031,30.246761,30.2466271,30.2469025,30.2479421,30.2474105,30.2473069,30.2471401,30.2468592,30.2467995,30.2467505,30.2466962,30.2467297,30.2466341,30.2467456,30.2497215,30.2496946,30.247973,30.2477934,30.2477939,30.2476477,30.2440969,30.2456995,30.246735,30.2362666,30.2359139,30.2372353,30.2371048,30.237541,30.2314602,30.2239118,30.2163161,30.2161424,30.2159036,30.2159614,30.2140834,30.2100752,30.2057801,30.2017682,30.197492,30.1931017,30.1886284,30.1874868,30.1860665,30.1875058,30.1877115,30.1874878,30.187535,30.1876029,30.1875639,30.1875872,30.1875701,30.1874138,30.1875686,30.1877636,30.1877565,30.1877457,30.1877457,30.1878483,30.1877912,30.1875657,30.1875636,30.1875651,30.187591,30.1875951,30.1873983,30.1875739,30.1823432,30.1744131,30.1657838,30.1566318,30.1486442,30.1401289,30.1319062,30.1234119,30.1187278,30.1214583,30.1214864,30.1172225,30.1147067,30.1218259,30.1299332,30.1301227,30.1310018,30.1304445,30.1297697,30.1314254,30.1358468,30.1269188,30.1145907,30.1012817,30.0949458,30.0963041,30.0961663,30.0841568,30.0670281,30.0537339,30.0422234,30.0284751,30.0153574,30.0011909,29.9890124,29.9874866,29.989025,29.9890239,29.9890124,29.9890124,29.9890124,29.9890109,29.9891113,29.9891133,29.989034,29.9890386,29.9889321,29.9889256,29.9874489,29.9769762,29.9621112,29.9477574,29.9357698,29.9233092,29.9080018,29.8964045,29.8829088,29.8728625,29.8599723,29.8447456,29.8289724,29.8273439,29.8271901,29.8289584,29.8308363,29.8325583,29.8343155,29.8361249,29.8377596,29.8386866,29.8395933,29.8404937,29.8408012,29.8401336,29.8393227,29.8389926,29.8366096,29.8321052,29.8287807,29.8265652,29.8244758,29.8225147,29.8214048,29.8131636,29.808884,29.8044727,29.8006351,29.7975388,29.7905128,29.7951881,29.7901789,29.7828702,29.7766609,29.7714946,29.7708304,29.7715225,29.7704947,29.773934,29.7748058,29.778008,29.7755132,29.7743993,29.7691574,29.768883,29.7712489,29.778919,29.7766684,29.7775736,29.7785306,29.7828751,29.7840308,29.7845221,29.784567,29.784712,29.7847984,29.7849007,29.785005,29.7850723,29.7851231,29.7851504,29.7851202,29.7853172,29.7853951,29.7853823,29.7854904,29.7856053,29.7793483,29.7774685,29.7775085,29.7774571,29.777401,29.7773386,29.7790054,29.7788481,29.7815697,29.7779346,29.7729372,29.7708885,29.7736268,29.7765488,29.7757869,29.768006,29.7613835,29.7635525,29.7607735,29.7572391,29.7543711,29.7514918,29.7475192,29.7423644,29.7377858,29.7326898,29.7281244,29.7236123,29.7188598,29.7162013,29.7127331,29.7050657,29.6980038,29.6924337,29.6937858,29.6936303,29.6934933,29.6923798,29.6909907,29.6895921,29.6886854,29.691855,29.6923799,29.6920719,29.6904329,29.68872,29.6925165,29.6965352,29.6960631,29.6952933,29.694561,29.6951115,29.6952926,29.6952938,29.6953162,29.6952929,29.6953252,29.694988,29.6951832,29.6949994,29.6950198,29.6950108,29.6950055,29.6949877,29.6950163,29.6949249,29.6949961,29.6949708,29.6950051,29.6949905,29.694985,29.6949995,29.6949799,29.6949923,29.6949923,29.6949583,29.6949834,29.6939309,29.6950355,29.690861,29.6895042,29.6901981,29.6915756,29.6937939,29.6976423,29.6978369,29.6971457,29.6965373,29.6960463,29.6920662,29.6923088,29.6925511,29.6909345,29.6812728,29.6703971,29.6680619,29.666053,29.6638229,29.661334,29.6580477,29.6554521,29.6519818,29.6499565,29.6515075,29.6529857,29.6542449,29.6522375,29.6484697,29.6502838,29.6519585,29.6471379,29.6414476,29.6355497,29.6295354,29.6234628,29.6166257,29.6150693,29.6147526,29.6096299,29.6044961,29.5995464,29.5995156,29.5994571,29.5887632,29.5759157,29.5638083,29.5490237,29.5421814,29.5351037,29.5293553,29.5215814,29.5139625,29.5066623,29.4994738,29.4921952,29.4858184,29.4791777,29.4722598,29.4657127,29.4601318,29.4538347,29.4471473,29.4398762,29.4333161,29.4273955,29.4130703,29.4068638,29.4029223,29.4028277,29.4018215,29.4027972,29.4029548,29.4029489,29.4029915,29.4029375,29.4029872,29.4029251,29.40293,29.4029577,29.4029964,29.4030033,29.4029394,29.4028663,29.4028159,29.4029047,29.4029735,29.402971,29.402975,29.4030331,29.4029135,29.4029811,29.4030115,29.4030312,29.402827,29.4028474,29.4027223,29.4029174,29.402901,29.4029499,29.4028201,29.4027942,29.4027911,29.4028048,29.4028067,29.4027969,29.4027959,29.4029773,29.4028277,29.4028592,29.4018061,29.3971059,29.4091111,29.4198411,29.4215708,29.4215708,29.4226959,29.4228618,29.4233574,29.4238629,29.4238629,29.4228989,29.4229368,29.4232088,29.4224398,29.4236948,29.4239438,29.4242142,29.4245528,29.4249606,29.4250825,29.4252131,29.4237545,29.4259096,29.4255609,29.4257454,29.4257128,29.425811,29.4260218,29.4261176,29.4263047,29.4262991,29.4257508,29.4260027,29.4256512,29.4259096,29.4247173,29.4249482,29.424958,29.4236904,29.4231377,29.4247173,29.4228447,29.4228136,29.4228447,29.4228543,29.4223451,29.4214654,29.4244437,29.4383992,29.4375824,29.4346847,29.4436294,29.4598139,29.4764605,29.4848404,29.4994078,29.5183379,29.5340672,29.5470294,29.5640557,29.582609,29.6000422,29.6160879,29.6339853,29.6499316,29.6671681,29.6855317,29.703233,29.7195113,29.7331239,29.7479716,29.7621824,29.7747121,29.7871975,29.8061248,29.8246543,29.8378831,29.8553474,29.8740292,29.8888496,29.9050816,29.9166312,29.9275443,29.9436809,29.9604115,29.9785062,29.987382,30.0001081,30.0144879,30.030925,30.0436865,30.0534454,30.0563665,30.0678059,30.0698979,30.0705143,30.0729971,30.0848332,30.0953876,30.1094422,30.1183902,30.1288541,30.1462182,30.1635141,30.1718236,30.1798222,30.1851348,30.1910586,30.1981519,30.2061596,30.2170941,30.2311212,30.2455195,30.2562995,30.2667647,30.2792336,30.2910942,30.3041594,30.3185659,30.3368985,30.3576245,30.376199,30.3940374,30.4028829,30.411977,30.4261489,30.4326427,30.4475816,30.4661494,30.4853776,30.4971405,30.5093723,30.5078481,30.5093341,30.5092842,30.509353,30.5093762,30.5093762,30.5093762,30.5091158,30.5091379,30.509263,30.5089787,30.5091819,30.5091269,30.5091004,30.5090255,30.5090199,30.5091519,30.5090295,30.5090221,30.5090031,30.509008,30.5090656,30.5091015,30.5090948,30.5090794,30.5090517,30.5090143,30.5090114,30.5090218,30.5090334,30.5091114,30.5091279,30.509153,30.5090949,30.50916,30.5091342,30.5089669,30.5090961,30.5091137,30.5091224,30.5091075,30.5090916,30.5095308,30.5155731,30.5206869,30.5263948,30.5257386,30.521266,30.514133,30.5011709,30.502665,30.499565,30.4949795,30.4956101,30.4872253,30.4831199,30.4806895,30.4741044,30.4676042,30.4602505,30.4540554,30.4464342,30.4441357,30.4469813,30.4536219,30.4623732,30.4721759,30.4820104,30.4905107,30.4997449,30.5093935,30.5195377,30.5306249,30.5414408,30.5501126,30.5581459,30.5647478,30.56817,30.5714049,30.5737024,30.5759798,30.5782051,30.5862042,30.5905234,30.5983222,30.6084548,30.6158628,30.6159177,30.6159177,30.6159177,30.6159442,30.615945,30.6159507,30.6183986,30.6217144,30.6203113,30.6213548,30.6279375,30.6344472,30.6413469,30.647875,30.6594888,30.6647679,30.669116,30.6742839,30.6799182,30.686052,30.6920937,30.6974189,30.7032523,30.7090121,30.7117672,30.7123651,30.7084867,30.7059429,30.7008529,30.6962079,30.6926178,30.6837017,30.6775566,30.6815373,30.6875281,30.6897695,30.6926688,30.6971386,30.7012187,30.7081393,30.7225587,30.7279736,30.730748,30.7338141,30.7346181,30.7377856,30.742201,30.7476341,30.7407991,30.7334443,30.722359,30.7158168,30.7171441,30.7286475,30.7403671,30.7443231,30.7485107,30.7578267,30.7679732,30.7830614,30.7993252,30.8105303,30.8256231,30.8364127,30.846146,30.8576717,30.8691182,30.877842,30.8854459,30.8921306,30.8916212,30.8935258,30.8931056,30.891124,30.8850684,30.8886106,30.8953101,30.8954239,30.8923034,30.8886856,30.8848811,30.8786211,30.8696713,30.8651162,30.8621126,30.8612475,30.8638652,30.8733272,30.8769578,30.8799581,30.8846343,30.8895136,30.8901274,30.8907464,30.8913958,30.8919809,30.8954531,30.9053575,30.9072242,30.9023997,30.9117423,30.9236961,30.9362895,30.9496983,30.9626819,30.9750872,30.9862491,30.9966061,31.0067894,31.0187309,31.0291175,31.0425461,31.0559604,31.0680859,31.0802724,31.0933402,31.1062553,31.1192344,31.1342525,31.1498098,31.1643261,31.1792094,31.1954698,31.2123287,31.2291314,31.2450689,31.2610738,31.2744772,31.2887209,31.3044786,31.3196304,31.3407316,31.359863,31.3757457,31.3896056,31.3990416,31.3989884,31.3990272,31.3990265,31.3990258,31.3989941,31.3990038,31.3986705,31.399015,31.3991125,31.3991288,31.3991378,31.3989533,31.3990051,31.3989983,31.3989849,31.3990383,31.3989704,31.3989657,31.3989891,31.3989848,31.3990038,31.4014409,31.402124,31.4050046,31.411269,31.4223238,31.4317329,31.4443276,31.4605972,31.4747691,31.4887114,31.5046576,31.5193151,31.5338121,31.5477256,31.5613592,31.5786817,31.5947328,31.6087121,31.6269522,31.6416408,31.648432,31.6546877,31.659829,31.6655745,31.6711724,31.6779387,31.6856573,31.6976348,31.7099242,31.7255386,31.7393658,31.7540745,31.7684988,31.7822298,31.7969771,31.8135032,31.8248853,31.8315656,31.8483901,31.8644699,31.8819006,31.894479,31.9081803,31.9220112,31.9358082,31.9529987,31.9696143,31.9847475,31.9984339,32.0095213,32.0192349,32.0296916,32.0436333,32.0576482,32.0704691,32.083139,32.1089903,32.1227531,32.1352155,32.1465673,32.158499,32.1697046,32.1814462,32.1934507,32.2044362,32.2154614,32.2248038,32.2313629,32.2393833,32.2491167,32.2596715,32.2674543,32.2705449,32.2746968,32.2760694,32.2774765,32.2816896,32.2860913,32.2933042,32.3013663,32.3121074,32.3230633,32.3341045,32.3460087,32.3574034,32.3701118,32.3816616,32.3876021,32.3890064,32.3932268,32.39384,32.3950488,32.4019808,32.3996297,32.4000562,32.4017108,32.4019822,32.402006,32.4020007,32.4019826,32.4015237,32.401498,32.4014477,32.401465,32.4013086,32.4015204,32.401475,32.401423,32.4013926,32.4019865,32.401526,32.4014911,32.4015289,32.4015101,32.4015638,32.4014734,32.401478,32.401515,32.4014765,32.4017801,32.4015363,32.3985848,32.3901043,32.3828983,32.3730361,32.3656891,32.3541027,32.3421912,32.3282748,32.313231,32.2968492,32.2798912,32.2627632,32.2454408,32.2287909,32.2113132,32.1978597,32.1851649,32.1759155,32.178348,32.1883302,32.1896225,32.1901942,32.1812458,32.1748631,32.1748539,32.1747882,32.1749049,32.1748616,32.1753629,32.1751983,32.1750785,32.1754145,32.1751511,32.1748699,32.1751541,32.1750228,32.1749224,32.1749417,32.1749555,32.1749415,32.1749182,32.1750095,32.175166,32.1740686,32.1792362,32.1824583,32.192066,32.1919319,32.1875323,32.1807993,32.1750985,32.1804425,32.1933881,32.2068119,32.2215396,32.2386683,32.2570896,32.2755244,32.2938933,32.3123943,32.330629,32.3465337,32.3601542,32.3703024,32.370427,32.3829743,32.3939728,32.3963634,32.4030209,32.4137359,32.4146754,32.4146817,32.4227966,32.4312838,32.4407674,32.4512995,32.4656893,32.4812548,32.4859967,32.4918643,32.5003348,32.5155014,32.5319325,32.5513967,32.5690746,32.585922,32.604545,32.6221628,32.63993,32.6589936,32.6783401,32.6988503,32.718401,32.7390731,32.7589929,32.7802236,32.8002107,32.8181295,32.8321041,32.8421897,32.8465203,32.8594205,32.873199,32.8879281,32.9006235,32.9160909,32.9340374,32.9518378,32.9695445,32.9888458,33.0069707,33.0270578,33.0491246,33.0695959,33.0891425,33.1109744,33.1315089,33.1537521,33.1745248,33.1958054,33.2159867,33.2379765,33.2581503,33.2795075,33.2986757,33.3119484,33.3235671,33.3393592,33.3545015,33.3651651,33.3725843,33.3794427,33.3869677,33.3930092,33.3951118,33.4000425,33.4081553,33.4119601,33.4154804,33.4226033,33.4293714,33.4357546,33.4466682,33.4583673,33.4721752,33.4897897,33.5063839,33.5251106,33.544604,33.564614,33.5843942,33.6011374,33.6183707,33.6348775,33.6530081,33.6721243,33.6906493,33.7108951,33.7297246,33.7481566,33.7690489,33.7878213,33.8090325,33.8308589,33.8510288,33.8723171,33.8939875,33.9138599,33.929162,33.9431777,33.9586869,33.9736239,33.9884392,34.0021118,34.0183205,34.0336234,34.0487774,34.0668403,34.0850521,34.1014219,34.1200188,34.1381324,34.1568966,34.1735717,34.1922368,34.2125463,34.2327343,34.2516862,34.2694625,34.2883671,34.3090363,34.3269202,34.3442642,34.3610804,34.3797262,34.3985789,34.4177165,34.4353859,34.4545089,34.4720834,34.4894228,34.5077363,34.5251559,34.5423189,34.5596154,34.5778869,34.5924974,34.5945248,34.5944867,34.5944934,34.5944991,34.5945109,34.5944907,34.5944748,34.5944854,34.5944891,34.5946518,34.5946711,34.5947363,34.5947038,34.5947789,34.5947491,34.5947497,34.5947625,34.5947545,34.5947586,34.594742,34.5947335,34.5947335,34.5947786,34.5947756,34.5947205,34.5947176,34.5947213,34.5946146,34.5947492,34.594756,34.5947873,34.5947612,34.5947712,34.5947759,34.5948163,34.5946867,34.6017386,34.6016788,34.5958313,34.5891509,34.5896764,34.5888339,34.5917502,34.5966768,34.6047014,34.6149298,34.6262499,34.6405385,34.6444812,34.6487808,34.6514862,34.6590614,34.6754248,34.6952135,34.7144326,34.7342148,34.7525363,34.7703032,34.7895298,34.8091983,34.8292074,34.8474105,34.8646119,34.88414,34.9042143,34.921876,34.9420986,34.9607739,34.9799413,35.000891,35.0088318,35.0099364,35.008398,35.0044774,35.0047459,35.0049589,35.0051372,35.0053809,35.0053601,35.0059824,35.0066964,35.0050424,35.0049261,35.0048397,35.0048197,35.0079094,35.0114751,35.0194762,35.0290767,35.0387478,35.0480979,35.0566035,35.0645309,35.0726382,35.0814756,35.088602,35.0962417,35.1023702,35.1111509,35.113574,35.1021981,35.0954444,35.0829986,35.080734,35.0665656,35.0616827,35.0632863,35.0669839,35.0742183,35.0813559,35.0885385,35.0965258,35.1039106,35.1047132,35.1073164,35.1075969,35.1061973,35.1055435,35.105164,35.105784,35.1063613,35.1065287,35.1050557,35.106196,35.1058121,35.0986265,35.0900263,35.081275,35.0739654,35.0675105,35.0639599,35.0645294,35.0640966,35.0645294,35.0645294,35.0645294,35.0645294,35.0645294,35.0645322,35.0645486,35.0645577,35.0645296,35.0645222,35.0645523,35.0645284,35.064505,35.0645005,35.0645542,35.0634664,35.0644223,35.0652777,35.0640558,35.0592415,35.0558055,35.0523997,35.0488635,35.0448182,35.0401843,35.0358741,35.030635,35.0253887,35.0202859,35.0135096,35.0077361,35.0012449,34.9949984,34.9887588,34.9817781,34.9787718,34.9826159,34.9862387,34.9897118,34.9930999,34.9934584,34.9937824,35.0025274,35.017368,35.0332082,35.0391018,35.029908,35.0265375,35.0271522,35.0302848,35.0368259,35.047355,35.0605923,35.0738915,35.0744572,35.0751699,35.0758735,35.0763587,35.0727691,35.0652964,35.0644247,35.0684066,35.0759623,35.0902105,35.1033375,35.1154314,35.128837,35.1436452,35.1534231,35.1648985,35.18431,35.2018107,35.2190945,35.2345084,35.2490647,35.2654321,35.284429,35.3044611,35.3244826,35.345128,35.3557055,35.3640564,35.3711625,35.3757293,35.3814413,35.3862194,35.3889273,35.3909351,35.3956468,35.4004878,35.4050212,35.4127504,35.4220817,35.4307836,35.4394532,35.4475328,35.4549797,35.464288,35.4773664,35.483616,35.4892465,35.4952292,35.5039893,35.5126304,35.519325,35.5263163,35.5304126,35.5318327,35.5309028,35.5312918,35.5301682,35.5292555,35.5289845,35.5293723,35.5288397,35.5288977,35.5289845,35.5290159,35.5290302,35.5289874,35.5289909,35.5288933,35.5289843,35.528964,35.5289934,35.5290217,35.528932,35.5289492,35.5289703,35.5289723,35.5290658,35.5288293,35.5288409,35.5288004,35.5290036,35.5288503,35.5288727,35.5288727,35.5288727,35.5288727,35.5288727,35.5288419,35.5288419,35.5288452,35.5288557,35.5288365,35.5288345,35.5288391,35.5288479,35.5291518,35.5292278,35.5289354,35.5294794,35.5297754,35.5298036,35.5297781,35.5297754,35.5297754,35.5297666,35.529744,35.5300424,35.5299654,35.5339859,35.5309401,35.5278771,35.5217775,35.5141771,35.5111428,35.4994334,35.4963824,35.4904935,35.4830319,35.4717062,35.4574662,35.4394875,35.4266782,35.4117447,35.3926383,35.377855,35.367649,35.3532386,35.3371731,35.323655,35.3117692,35.302201,35.29322,35.2845946,35.2810577,35.2829158,35.2830549,35.2784036,35.2678001,35.2520653,35.2382046,35.2252827,35.2138626,35.2065143,35.201923,35.197377,35.19283,35.1898783,35.1904123,35.1899125,35.189917,35.1904394,35.1868323,35.1762627,35.1643605,35.1524732,35.1406332,35.1286086,35.1195993,35.1117762,35.1048929,35.1009459,35.0976543,35.0936916,35.0873559,35.0808512,35.0745756,35.0679109,35.0583592,35.0460352,35.0345984,35.0225393,35.0097146,35.0016478,34.9969775,34.9929113,34.9909038,34.9910128,34.9869085,34.9825768,34.9782519,34.9711568,34.9576821,34.9425257,34.9248805,34.913242,34.9085861,34.9063653,34.9091291,34.9145187,34.9253092,34.9385273,34.947186,34.9551148,34.9546357,34.9584739,34.9623448,34.966522,34.9700623,34.9711846,34.9722381,34.9733671,34.9787203,34.9866368,34.9940989,35.0017038,35.0069728,35.010289,35.0159626,35.0271007,35.0396161,35.038473,35.039775,35.0454316,35.0515274,35.0577443,35.0645163,35.0707673,35.0763362,35.0820775,35.0886579,35.0934724,35.0963778,35.0995505,35.1016518,35.1059921,35.1100548,35.1122864,35.1143879,35.1174734,35.1166029,35.1186637,35.1208743,35.1274509,35.1349042,35.1431939,35.1507018,35.1586973,35.1601679,35.1614299,35.1698075,35.178032,35.1865248,35.1949416,35.2026903,35.2018772,35.2025624,35.2020213,35.2062784,35.2097034,35.2146846,35.2186688,35.2179974,35.2210796,35.2159135,35.2150697,35.2113672]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[29.3971059,35.5339859],"lng":[-111.6042783,-84.3051758]},"setView":[[29.4257332714475,-98.4862755390452],18,[]]},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>&nbsp;</p>
<p>The <code>big_long_combined_route</code> object we just made here isn’t a data frame anymore—it’s a list instead. It still works with <code>geom_sf()</code>, but because we collapsed all the points into one line, we lots lots of detail, like timestamps. We can keep some of those details if we use <code>group_by()</code> to separate lines per day (or hour or whatever grouping variable we want). For instance, earlier we created a column called <code>day</code>. Let’s make a separate linestring for each day using <code>group_by()</code> and <code>nest()</code> and <code>map()</code>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Combine all the points in the day into a connected linestring</span></span>
<span><span class="va">daily_routes</span> <span class="op">&lt;-</span> <span class="va">all_locations</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day_month</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">nest</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>path <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span><span class="fu">st_cast</span><span class="op">(</span><span class="fu">st_combine</span><span class="op">(</span><span class="va">.</span><span class="op">)</span>, <span class="st">"LINESTRING"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_set_geometry</span><span class="op">(</span><span class="st">"path"</span><span class="op">)</span></span>
<span><span class="va">daily_routes</span></span>
<span><span class="co">## Simple feature collection with 4 features and 2 fields</span></span>
<span><span class="co">## Geometry type: LINESTRING</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -111.6 ymin: 29.4 xmax: -84.31 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 4 × 3</span></span>
<span><span class="co">## # Groups:   day_month [4]</span></span>
<span><span class="co">##   day_month data                                                                                                 path</span></span>
<span><span class="co">##   &lt;fct&gt;     &lt;list&gt;                                                                                   &lt;LINESTRING [°]&gt;</span></span>
<span><span class="co">## 1 June 3    &lt;sf [521 × 19]&gt; (-84.31 33.85, -84.33 33.84, -84.34 33.83, -84.36 33.82, -84.38 33.81, -84.39 33.8, -8...</span></span>
<span><span class="co">## 2 June 4    &lt;sf [596 × 19]&gt; (-89.96 30.05, -89.96 30.05, -89.96 30.05, -89.96 30.05, -89.96 30.05, -89.96 30.05, -...</span></span>
<span><span class="co">## 3 June 5    &lt;sf [509 × 19]&gt; (-98.44 29.4, -98.44 29.4, -98.44 29.4, -98.44 29.4, -98.44 29.4, -98.44 29.4, -98.44 ...</span></span>
<span><span class="co">## 4 June 6    &lt;sf [662 × 19]&gt; (-104.2 32.4, -104.2 32.4, -104.2 32.4, -104.2 32.4, -104.2 32.4, -104.2 32.4, -104.2 ...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we have a data frame with a row per day, and a corresponding path per day too:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lower_48</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">daily_routes</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">day_month</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">daily_routes</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">day_month</span>, fill <span class="op">=</span> <span class="va">day_month</span>, geometry <span class="op">=</span> <span class="va">path</span><span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, seed <span class="op">=</span> <span class="fl">12345</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"white"</span>, size <span class="op">=</span> <span class="fl">3</span>, segment.color <span class="op">=</span> <span class="st">"grey30"</span>, </span>
<span>    min.segment.length <span class="op">=</span> <span class="fl">0</span>, box.padding <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>, family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span>, name <span class="op">=</span> <span class="cn">NULL</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span>, name <span class="op">=</span> <span class="cn">NULL</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"X"</span><span class="op">]</span>,</span>
<span>    ylim <span class="op">=</span> <span class="va">trip_window</span><span class="op">[</span>, <span class="st">"Y"</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip_map</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/basic-map-linestring-by-day-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="semantic-location-history-1" class="level2"><h2 class="anchored" data-anchor-id="semantic-location-history-1">Semantic location history</h2>
<p>Working with <code>Records.json</code> is great and fairly straightforward (once we handle all the weird data cleaning issues and time zones!), but we can do even cooler things with the more detailed semantic location history data. As seen earlier, this data is far more complex, with all sorts of nested entries and predicted probabilities of modes of transportation or location stops, so we can’t use the <code>simplifyVector</code> to get a basic data frame. Instead, we need to pull out each of the elements we’re interested in and build our own data frame.</p>
<p>Additionally, the location history file includes both <code>placeVisit</code>s and <code>activitySegment</code>s in the same file, so to make life a little easier, we can filter the data after we read the file to only keep one of the types of events using <code>map()</code></p>
<section id="placevisits" class="level3"><h3 class="anchored" data-anchor-id="placevisits">
<code>placeVisit</code>s</h3>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">place_visits_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/read_json.html">read_json</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/Semantic Location History/2023/2023_JUNE_truncated.json"</span>, </span>
<span>  simplifyVector <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Extract the timelineObjects JSON element</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"timelineObjects"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Filter the list to only keep placeVisits</span></span>
<span>  <span class="co"># { More verbose function-based approach: map(~ .x[["placeVisit"]]) }</span></span>
<span>  <span class="co"># Neat selection-based approach with just the name!</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="st">"placeVisit"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Discard all the empty elements (i.e. the activitySegments)</span></span>
<span>  <span class="fu">compact</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For this post, I’m interested in looking at all the places we stopped for gas and bathroom breaks along the way. I’m not interested in hotel stops or tourist stops. I want to know how long we typically stopped for breaks. There are 24 entries in this list…</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">place_visits_raw</span><span class="op">)</span></span>
<span><span class="co">## [1] 24</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>…but not all of them are gas or bathroom breaks, so I manually looked through the data and copied the location IDs of the stops that weren’t gas stops.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">not_driving_stops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"ChIJnwDSTcsDnogRLyt_lqVprLY"</span>,  <span class="co"># Hotel in New Orleans, LA</span></span>
<span>  <span class="st">"ChIJgcNDAhKmIIYRRA4mio_7VgE"</span>,  <span class="co"># Parking in the French Quarter</span></span>
<span>  <span class="st">"ChIJv30_Xw-mIIYRpt26QbLBh58"</span>,  <span class="co"># Louis Armstrong Park</span></span>
<span>  <span class="st">"ChIJ59n6fW8dnogRWi-5N6olcyU"</span>,  <span class="co"># Chalmette Battlefield</span></span>
<span>  <span class="st">"ChIJ_7z4c1_2XIYR6b9p0NvEiVE"</span>,  <span class="co"># Hotel in San Antonio, TX</span></span>
<span>  <span class="st">"ChIJX4k2TVVfXIYRIsTnhA-P-Rc"</span>,  <span class="co"># The Alamo</span></span>
<span>  <span class="st">"ChIJAdu5Qad544YRhyJT8qzimi4"</span>,  <span class="co"># Hotel in Carlsbad, NM</span></span>
<span>  <span class="st">"ChIJW9e4xBN544YRvbI7vfc91G4"</span>,  <span class="co"># Carlsbad Caverns</span></span>
<span>  <span class="st">"ChIJERiZZMWOLYcRQbo78w80s34"</span>   <span class="co"># Hotel in Flagstaff, AZ</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Currently, <code>place_visits_raw</code> is a huge nested list with the complete place information from Google. All we care about is a small subset of that data, so we can take the list, extract the parts we need, and build a data frame with <code>map() %&gt;% list_rbind()</code> (the recommended replacement for {purrr}’s now-superseded <code>map_df()</code>). Like we did with <code>Records.json</code>, we’ll also figure out the time zone for each point and make all the timestamps be local.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Computer friendly timezones like America/New_York work for computers, but I</span></span>
<span><span class="co"># want to sometimes show them as US-standard abbreviations like EDT (Eastern</span></span>
<span><span class="co"># Daylight Time), so here's a little lookup table we can use to join to bigger</span></span>
<span><span class="co"># datasets for better abbreviations</span></span>
<span><span class="va">tz_abbreviations</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">tz</span>,                <span class="op">~</span><span class="va">tz_abb</span>,</span>
<span>  <span class="st">"America/New_York"</span>, <span class="st">"EDT"</span>,</span>
<span>  <span class="st">"America/Chicago"</span>,  <span class="st">"CDT"</span>,</span>
<span>  <span class="st">"America/Denver"</span>,   <span class="st">"MDT"</span>,</span>
<span>  <span class="st">"America/Phoenix"</span>,  <span class="st">"MST"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">place_visits</span> <span class="op">&lt;-</span> <span class="va">place_visits_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Extract parts of the nested list</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="op">{</span></span>
<span>    <span class="fu">tibble</span><span class="op">(</span></span>
<span>      id <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">location</span><span class="op">$</span><span class="va">placeId</span>,</span>
<span>      latitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">location</span><span class="op">$</span><span class="va">latitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      longitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">location</span><span class="op">$</span><span class="va">longitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      name <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">location</span><span class="op">$</span><span class="va">name</span>,</span>
<span>      address <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">location</span><span class="op">$</span><span class="va">address</span>,</span>
<span>      startTimestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">duration</span><span class="op">$</span><span class="va">startTimestamp</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span>
<span>      endTimestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">duration</span><span class="op">$</span><span class="va">endTimestamp</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">list_rbind</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Calculate the duration of the stop</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration <span class="op">=</span> <span class="va">endTimestamp</span> <span class="op">-</span> <span class="va">startTimestamp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make an indicator for if the stop was a gas or bathroom break</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>driving_stop <span class="op">=</span> <span class="op">!</span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">not_driving_stops</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make a geometry column</span></span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"longitudeE7"</span>, <span class="st">"latitudeE7"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"EPSG:4326"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make a column with the time zone for each point</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>tz <span class="op">=</span> <span class="fu">tz_lookup</span><span class="op">(</span><span class="va">.</span>, method <span class="op">=</span> <span class="st">"accurate"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Create a version of the timestamp in local time, but in UTC</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    startTimestamp_local <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">startTimestamp</span>, <span class="va">tz</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span>,</span>
<span>    endTimestamp_local <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">endTimestamp</span>, <span class="va">tz</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add a column for direction</span></span>
<span>  <span class="co"># In the real data, I have values for "There" (the trip from Atlanta to Utah)</span></span>
<span>  <span class="co"># and "Back again" (the trip from Utah to Atlanta)</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>direction <span class="op">=</span> <span class="st">"There"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add some helper columns for filtering, grouping, etc.</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    day_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">startTimestamp_local</span>, <span class="st">"%B %e"</span><span class="op">)</span>,</span>
<span>    <span class="co"># With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span>    <span class="co"># any double spaces and replace them with single spaces </span></span>
<span>    <span class="co"># (e.g., "June  3" becomes "June 3")</span></span>
<span>    day_month <span class="op">=</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">day_month</span>, <span class="st">"  "</span>, <span class="st">" "</span><span class="op">)</span>,</span>
<span>    day_month <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">day_month</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Bring in abbreviated time zones</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">tz_abbreviations</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">tz</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">place_visits</span></span>
<span><span class="co">## Simple feature collection with 24 features and 16 fields</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -111.6 ymin: 29.4 xmax: -86.34 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 24 × 17</span></span>
<span><span class="co">##    id                          name                            address                                            startTimestamp      endTimestamp        duration    driving_stop       geometry tz              startTimestamp_local endTimestamp_local  direction  year month   day day_month tz_abb</span></span>
<span><span class="co">##    &lt;chr&gt;                       &lt;chr&gt;                           &lt;chr&gt;                                              &lt;dttm&gt;              &lt;dttm&gt;              &lt;drtn&gt;      &lt;lgl&gt;           &lt;POINT [°]&gt; &lt;chr&gt;           &lt;dttm&gt;               &lt;dttm&gt;              &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;     &lt;chr&gt; </span></span>
<span><span class="co">##  1 ChIJQ0NgzsqAjogRISqopW4DZMc Chevron                         1030 W South Blvd, Montgomery, AL 36105, USA       2023-06-03 14:27:23 2023-06-03 14:50:24  23.02 mins TRUE         (-86.34 32.33) America/Chicago 2023-06-03 09:27:23  2023-06-03 09:50:24 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  2 ChIJMU2weFNKmogRNvJ9RoXN_Vk Walmart Supercenter             5245 Rangeline Service Rd, Mobile, AL 36619, USA   2023-06-03 17:12:34 2023-06-03 17:59:38  47.07 mins TRUE         (-88.16 30.59) America/Chicago 2023-06-03 12:12:34  2023-06-03 12:59:38 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  3 ChIJnwDSTcsDnogRLyt_lqVprLY Comfort Suites New Orleans East 7051 Bullard Ave, New Orleans, LA 70128, USA       2023-06-03 19:45:22 2023-06-03 20:52:17  66.90 mins FALSE        (-89.96 30.05) America/Chicago 2023-06-03 14:45:22  2023-06-03 15:52:17 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  4 ChIJgcNDAhKmIIYRRA4mio_7VgE P149 - Chartres St Garage       537 Chartres St, New Orleans, LA 70130, USA        2023-06-03 21:08:30 2023-06-03 22:31:08  82.64 mins FALSE        (-90.06 29.96) America/Chicago 2023-06-03 16:08:30  2023-06-03 17:31:08 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  5 ChIJv30_Xw-mIIYRpt26QbLBh58 Louis Armstrong Park            701 N Rampart St, New Orleans, LA 70116, USA       2023-06-03 22:44:22 2023-06-03 22:59:51  15.48 mins FALSE        (-90.07 29.96) America/Chicago 2023-06-03 17:44:22  2023-06-03 17:59:51 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  6 ChIJgcNDAhKmIIYRRA4mio_7VgE P149 - Chartres St Garage       537 Chartres St, New Orleans, LA 70130, USA        2023-06-03 23:10:10 2023-06-03 23:19:40   9.50 mins FALSE        (-90.06 29.96) America/Chicago 2023-06-03 18:10:10  2023-06-03 18:19:40 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  7 ChIJnwDSTcsDnogRLyt_lqVprLY Comfort Suites New Orleans East 7051 Bullard Ave, New Orleans, LA 70128, USA       2023-06-03 23:37:50 2023-06-04 14:01:02 863.20 mins FALSE        (-89.96 30.05) America/Chicago 2023-06-03 18:37:50  2023-06-04 09:01:02 There      2023     6     3 June 3    CDT   </span></span>
<span><span class="co">##  8 ChIJ59n6fW8dnogRWi-5N6olcyU Chalmette Battlefield           1 Battlefield Rd, Chalmette, LA 70043, USA         2023-06-04 14:24:06 2023-06-04 15:54:20  90.25 mins FALSE        (-89.99 29.94) America/Chicago 2023-06-04 09:24:06  2023-06-04 10:54:20 There      2023     6     4 June 4    CDT   </span></span>
<span><span class="co">##  9 ChIJTZPVqVh9JIYRx10_jt-c4LE Exxon                           2939 Grand Point Hwy, Breaux Bridge, LA 70517, USA 2023-06-04 17:54:09 2023-06-04 18:31:35  37.45 mins TRUE         (-91.83 30.32) America/Chicago 2023-06-04 12:54:09  2023-06-04 13:31:35 There      2023     6     4 June 4    CDT   </span></span>
<span><span class="co">## 10 ChIJFWLuzkT3O4YRBX2lqNQDF4w Exxon                           1410 Gum Cove Rd, Vinton, LA 70668, USA            2023-06-04 20:02:26 2023-06-04 20:26:48  24.37 mins TRUE         (-93.57 30.19) America/Chicago 2023-06-04 15:02:26  2023-06-04 15:26:48 There      2023     6     4 June 4    CDT   </span></span>
<span><span class="co">## # ℹ 14 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="activitysegments" class="level3"><h3 class="anchored" data-anchor-id="activitysegments">
<code>activitySegment</code>s</h3>
<p>We’ll go through the same data loading and cleaning process for the <code>activitySegments</code>. It’s a little more complicated because we have pairs of timestamps and locations (start/end times, start/end locations), and the times and locations can be in different time zones, so we need to do the <code>group_by(tz)</code> trick twice with <code>group_by(tz_start)</code> and <code>group_by(tz_end)</code>. We also need to get two geometry columns, which requires a little data trickery, as you’ll see below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">activity_segments_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jeroen.r-universe.dev/jsonlite/reference/read_json.html">read_json</a></span><span class="op">(</span></span>
<span>  <span class="st">"data/Semantic Location History/2023/2023_JUNE_truncated.json"</span>, </span>
<span>  simplifyVector <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Extract the timelineObjects JSON element</span></span>
<span>  <span class="fu">pluck</span><span class="op">(</span><span class="st">"timelineObjects"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Filter the list to only keep activitySegments</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="st">"activitySegment"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># Discard all the empty elements (i.e. the placeVisits)</span></span>
<span>  <span class="fu">compact</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">activity_segments_not_clean</span> <span class="op">&lt;-</span> <span class="va">activity_segments_raw</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Extract parts of the nested list</span></span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="op">~</span><span class="op">{</span></span>
<span>    <span class="fu">tibble</span><span class="op">(</span></span>
<span>      distance_m <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">distance</span>,</span>
<span>      activity_type <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">activityType</span>,</span>
<span>      start_latitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">startLocation</span><span class="op">$</span><span class="va">latitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      start_longitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">startLocation</span><span class="op">$</span><span class="va">longitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      end_latitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">endLocation</span><span class="op">$</span><span class="va">latitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      end_longitudeE7 <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">endLocation</span><span class="op">$</span><span class="va">longitudeE7</span> <span class="op">/</span> <span class="fl">1e7</span>,</span>
<span>      startTimestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">duration</span><span class="op">$</span><span class="va">startTimestamp</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>,</span>
<span>      endTimestamp <span class="op">=</span> <span class="fu">ymd_hms</span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">duration</span><span class="op">$</span><span class="va">endTimestamp</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">list_rbind</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ↑ that needs to be a separate data frame so that we can refer to it to make a</span></span>
<span><span class="co"># geometry column for the end latitude/longitude</span></span>
<span><span class="va">activity_segments</span> <span class="op">&lt;-</span> <span class="va">activity_segments_not_clean</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Calculate the duration and distance and speed of the segment</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration <span class="op">=</span> <span class="va">endTimestamp</span> <span class="op">-</span> <span class="va">startTimestamp</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>distance_miles <span class="op">=</span> <span class="fu">meters_to_miles</span><span class="op">(</span><span class="va">distance_m</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span> <span class="op">/</span> <span class="fl">60</span>,</span>
<span>    avg_mph <span class="op">=</span> <span class="va">distance_miles</span> <span class="op">/</span> <span class="va">hours</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make two geometry columns</span></span>
<span>  <span class="fu">st_as_sf</span><span class="op">(</span>coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"start_longitudeE7"</span>, <span class="st">"start_latitudeE7"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"EPSG:4326"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">rename</span><span class="op">(</span><span class="st">"geometry_start"</span> <span class="op">=</span> <span class="st">"geometry"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>geometry_end <span class="op">=</span> <span class="fu">st_geometry</span><span class="op">(</span></span>
<span>    <span class="fu">st_as_sf</span><span class="op">(</span></span>
<span>      <span class="va">activity_segments_not_clean</span>, </span>
<span>      coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"end_longitudeE7"</span>, <span class="st">"end_latitudeE7"</span><span class="op">)</span>, </span>
<span>      crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"EPSG:4326"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">end_longitudeE7</span>, <span class="op">-</span><span class="va">end_latitudeE7</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make a column with the time zone for each point</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>tz_start <span class="op">=</span> <span class="fu">tz_lookup</span><span class="op">(</span><span class="va">geometry_start</span>, method <span class="op">=</span> <span class="st">"accurate"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>tz_end <span class="op">=</span> <span class="fu">tz_lookup</span><span class="op">(</span><span class="va">geometry_end</span>, method <span class="op">=</span> <span class="st">"accurate"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Create a version of the timestamps in local time, but in UTC</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz_start</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>startTimestamp_local <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">startTimestamp</span>, <span class="va">tz_start</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">tz_end</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>endTimestamp_local <span class="op">=</span> <span class="fu">force_tz</span><span class="op">(</span><span class="fu">with_tz</span><span class="op">(</span><span class="va">endTimestamp</span>, <span class="va">tz_end</span><span class="op">)</span>, <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add some helper columns for filtering, grouping, etc.</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span>,</span>
<span>    month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span>,</span>
<span>    day <span class="op">=</span> <span class="fu">day</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    day_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">startTimestamp_local</span>, <span class="st">"%B %e"</span><span class="op">)</span>,</span>
<span>    <span class="co"># With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span>    <span class="co"># any double spaces and replace them with single spaces </span></span>
<span>    <span class="co"># (e.g., "June  3" becomes "June 3")</span></span>
<span>    day_month <span class="op">=</span> <span class="fu">str_replace</span><span class="op">(</span><span class="va">day_month</span>, <span class="st">"  "</span>, <span class="st">" "</span><span class="op">)</span>,</span>
<span>    day_month <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">day_month</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Bring in abbreviated time zones for both the start and end time zones</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span></span>
<span>    <span class="fu">rename</span><span class="op">(</span><span class="va">tz_abbreviations</span>, <span class="st">"tz_start_abb"</span> <span class="op">=</span> <span class="st">"tz_abb"</span><span class="op">)</span>, </span>
<span>    by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">tz_start</span> <span class="op">==</span> <span class="va">tz</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span></span>
<span>    <span class="fu">rename</span><span class="op">(</span><span class="va">tz_abbreviations</span>, <span class="st">"tz_end_abb"</span> <span class="op">=</span> <span class="st">"tz_abb"</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">tz_end</span> <span class="op">==</span> <span class="va">tz</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Create an id column so we can better reference individual activities </span></span>
<span>  <span class="co"># Make it a character so it can combine with the place visit id column</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">activity_segments</span></span>
<span><span class="co">## Simple feature collection with 23 features and 19 fields</span></span>
<span><span class="co">## Active geometry column: geometry_start</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -108.7 ymin: 29.4 xmax: -86.34 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 23 × 21</span></span>
<span><span class="co">##    distance_m activity_type        startTimestamp      endTimestamp        duration    distance_miles hours avg_mph geometry_start   geometry_end tz_start        tz_end          startTimestamp_local endTimestamp_local   year month   day day_month tz_start_abb tz_end_abb id   </span></span>
<span><span class="co">##  *      &lt;int&gt; &lt;chr&gt;                &lt;dttm&gt;              &lt;dttm&gt;              &lt;drtn&gt;               &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;POINT [°]&gt;    &lt;POINT [°]&gt; &lt;chr&gt;           &lt;chr&gt;           &lt;dttm&gt;               &lt;dttm&gt;              &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;     &lt;chr&gt;        &lt;chr&gt;      &lt;chr&gt;</span></span>
<span><span class="co">##  1     272317 IN_PASSENGER_VEHICLE 2023-06-03 14:50:24 2023-06-03 17:12:34 142.17 mins        169.    2.37    71.4  (-86.34 32.33) (-88.16 30.59) America/Chicago America/Chicago 2023-06-03 09:50:24  2023-06-03 12:12:34  2023     6     3 June 3    CDT          CDT        1    </span></span>
<span><span class="co">##  2     195400 IN_PASSENGER_VEHICLE 2023-06-03 17:59:38 2023-06-03 19:45:22 105.75 mins        121.    1.76    68.9   (-88.16 30.6) (-89.96 30.05) America/Chicago America/Chicago 2023-06-03 12:59:38  2023-06-03 14:45:22  2023     6     3 June 3    CDT          CDT        2    </span></span>
<span><span class="co">##  3      15368 IN_PASSENGER_VEHICLE 2023-06-03 20:52:17 2023-06-03 21:08:30  16.22 mins          9.55  0.270   35.3  (-89.96 30.05) (-90.07 29.96) America/Chicago America/Chicago 2023-06-03 15:52:17  2023-06-03 16:08:30  2023     6     3 June 3    CDT          CDT        3    </span></span>
<span><span class="co">##  4       1026 WALKING              2023-06-03 22:31:08 2023-06-03 22:44:22  13.23 mins          0.638 0.221    2.89 (-90.06 29.96) (-90.07 29.96) America/Chicago America/Chicago 2023-06-03 17:31:08  2023-06-03 17:44:22  2023     6     3 June 3    CDT          CDT        4    </span></span>
<span><span class="co">##  5       1280 WALKING              2023-06-03 22:59:51 2023-06-03 23:10:10  10.32 mins          0.795 0.172    4.63 (-90.07 29.96) (-90.06 29.96) America/Chicago America/Chicago 2023-06-03 17:59:51  2023-06-03 18:10:10  2023     6     3 June 3    CDT          CDT        5    </span></span>
<span><span class="co">##  6      14611 IN_PASSENGER_VEHICLE 2023-06-03 23:19:40 2023-06-03 23:37:50  18.17 mins          9.08  0.303   30.0  (-90.06 29.96) (-89.96 30.05) America/Chicago America/Chicago 2023-06-03 18:19:40  2023-06-03 18:37:50  2023     6     3 June 3    CDT          CDT        6    </span></span>
<span><span class="co">##  7      14258 IN_PASSENGER_VEHICLE 2023-06-04 14:01:02 2023-06-04 14:24:06  23.07 mins          8.86  0.384   23.0  (-89.96 30.05) (-89.99 29.94) America/Chicago America/Chicago 2023-06-04 09:01:02  2023-06-04 09:24:06  2023     6     4 June 4    CDT          CDT        7    </span></span>
<span><span class="co">##  8     199631 IN_PASSENGER_VEHICLE 2023-06-04 15:54:20 2023-06-04 17:54:09 119.80 mins        124.    2.00    62.1  (-89.99 29.94) (-91.83 30.32) America/Chicago America/Chicago 2023-06-04 10:54:20  2023-06-04 12:54:09  2023     6     4 June 4    CDT          CDT        8    </span></span>
<span><span class="co">##  9     169541 IN_PASSENGER_VEHICLE 2023-06-04 18:31:35 2023-06-04 20:02:26  90.83 mins        105.    1.51    69.6  (-91.83 30.32) (-93.57 30.19) America/Chicago America/Chicago 2023-06-04 13:31:35  2023-06-04 15:02:26  2023     6     4 June 4    CDT          CDT        9    </span></span>
<span><span class="co">## 10      71377 IN_PASSENGER_VEHICLE 2023-06-04 20:26:48 2023-06-04 21:06:44  39.93 mins         44.4   0.666   66.6  (-93.57 30.19) (-94.21 29.99) America/Chicago America/Chicago 2023-06-04 15:26:48  2023-06-04 16:06:44  2023     6     4 June 4    CDT          CDT        10   </span></span>
<span><span class="co">## # ℹ 13 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="both-combined" class="level3"><h3 class="anchored" data-anchor-id="both-combined">Both combined</h3>
<p>All these <code>placeVisit</code> and <code>activitySegment</code> entries were originally in the same JSON file since they actually fit together nicely—activity segments lead to place visits, which are then followed by more activity segments (i.e.&nbsp;you drive to a place, do stuff at that place, and drive to a different place, and so on). Because the two event types are structured so differently, we had to split them up and load and clean them separately. But it can be helpful to put them back together so there’s a consistent timeline—it’ll help with making plots below, and it creates a neat log of the whole trip.</p>
<p>We’ll use <code>bind_rows()</code> to combine the two and then sort. It’s kind of an ugly dataset, with lots of missing data in every other row since each type of entry has slightly different columns in it, but some columns are consistent throughout, like <code>duration</code> and the different timestamps, so it’ll be helpful.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">all_stops_activities</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>visit <span class="op">=</span> <span class="va">place_visits</span>, segment <span class="op">=</span> <span class="va">activity_segments</span><span class="op">)</span>,</span>
<span>  .id <span class="op">=</span> <span class="st">"type"</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">startTimestamp</span><span class="op">)</span></span>
<span><span class="va">all_stops_activities</span></span>
<span><span class="co">## Simple feature collection with 47 features and 26 fields</span></span>
<span><span class="co">## Active geometry column: geometry (with 23 geometries empty)</span></span>
<span><span class="co">## Geometry type: POINT</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -111.6 ymin: 29.4 xmax: -86.34 ymax: 35.53</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span>
<span><span class="co">## # A tibble: 47 × 29</span></span>
<span><span class="co">##    type    id             name  address startTimestamp      endTimestamp        duration driving_stop       geometry tz              startTimestamp_local endTimestamp_local  direction  year month   day day_month tz_abb distance_m activity_type  distance_miles  hours avg_mph geometry_start</span></span>
<span><span class="co">##    &lt;chr&gt;   &lt;chr&gt;          &lt;chr&gt; &lt;chr&gt;   &lt;dttm&gt;              &lt;dttm&gt;              &lt;drtn&gt;   &lt;lgl&gt;           &lt;POINT [°]&gt; &lt;chr&gt;           &lt;dttm&gt;               &lt;dttm&gt;              &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;     &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;                   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;POINT [°]&gt;</span></span>
<span><span class="co">##  1 visit   ChIJQ0NgzsqAj… Chev… 1030 W… 2023-06-03 14:27:23 2023-06-03 14:50:24  23.02 … TRUE         (-86.34 32.33) America/Chicago 2023-06-03 09:27:23  2023-06-03 09:50:24 There      2023     6     3 June 3    CDT            NA &lt;NA&gt;                   NA     NA       NA             EMPTY</span></span>
<span><span class="co">##  2 segment 1              &lt;NA&gt;  &lt;NA&gt;    2023-06-03 14:50:24 2023-06-03 17:12:34 142.17 … NA                    EMPTY &lt;NA&gt;            2023-06-03 09:50:24  2023-06-03 12:12:34 &lt;NA&gt;       2023     6     3 June 3    &lt;NA&gt;       272317 IN_PASSENGER_…        169.     2.37    71.4  (-86.34 32.33)</span></span>
<span><span class="co">##  3 visit   ChIJMU2weFNKm… Walm… 5245 R… 2023-06-03 17:12:34 2023-06-03 17:59:38  47.07 … TRUE         (-88.16 30.59) America/Chicago 2023-06-03 12:12:34  2023-06-03 12:59:38 There      2023     6     3 June 3    CDT            NA &lt;NA&gt;                   NA     NA       NA             EMPTY</span></span>
<span><span class="co">##  4 segment 2              &lt;NA&gt;  &lt;NA&gt;    2023-06-03 17:59:38 2023-06-03 19:45:22 105.75 … NA                    EMPTY &lt;NA&gt;            2023-06-03 12:59:38  2023-06-03 14:45:22 &lt;NA&gt;       2023     6     3 June 3    &lt;NA&gt;       195400 IN_PASSENGER_…        121.     1.76    68.9   (-88.16 30.6)</span></span>
<span><span class="co">##  5 visit   ChIJnwDSTcsDn… Comf… 7051 B… 2023-06-03 19:45:22 2023-06-03 20:52:17  66.90 … FALSE        (-89.96 30.05) America/Chicago 2023-06-03 14:45:22  2023-06-03 15:52:17 There      2023     6     3 June 3    CDT            NA &lt;NA&gt;                   NA     NA       NA             EMPTY</span></span>
<span><span class="co">##  6 segment 3              &lt;NA&gt;  &lt;NA&gt;    2023-06-03 20:52:17 2023-06-03 21:08:30  16.22 … NA                    EMPTY &lt;NA&gt;            2023-06-03 15:52:17  2023-06-03 16:08:30 &lt;NA&gt;       2023     6     3 June 3    &lt;NA&gt;        15368 IN_PASSENGER_…          9.55   0.270   35.3  (-89.96 30.05)</span></span>
<span><span class="co">##  7 visit   ChIJgcNDAhKmI… P149… 537 Ch… 2023-06-03 21:08:30 2023-06-03 22:31:08  82.64 … FALSE        (-90.06 29.96) America/Chicago 2023-06-03 16:08:30  2023-06-03 17:31:08 There      2023     6     3 June 3    CDT            NA &lt;NA&gt;                   NA     NA       NA             EMPTY</span></span>
<span><span class="co">##  8 segment 4              &lt;NA&gt;  &lt;NA&gt;    2023-06-03 22:31:08 2023-06-03 22:44:22  13.23 … NA                    EMPTY &lt;NA&gt;            2023-06-03 17:31:08  2023-06-03 17:44:22 &lt;NA&gt;       2023     6     3 June 3    &lt;NA&gt;         1026 WALKING                 0.638  0.221    2.89 (-90.06 29.96)</span></span>
<span><span class="co">##  9 visit   ChIJv30_Xw-mI… Loui… 701 N … 2023-06-03 22:44:22 2023-06-03 22:59:51  15.48 … FALSE        (-90.07 29.96) America/Chicago 2023-06-03 17:44:22  2023-06-03 17:59:51 There      2023     6     3 June 3    CDT            NA &lt;NA&gt;                   NA     NA       NA             EMPTY</span></span>
<span><span class="co">## 10 segment 5              &lt;NA&gt;  &lt;NA&gt;    2023-06-03 22:59:51 2023-06-03 23:10:10  10.32 … NA                    EMPTY &lt;NA&gt;            2023-06-03 17:59:51  2023-06-03 18:10:10 &lt;NA&gt;       2023     6     3 June 3    &lt;NA&gt;         1280 WALKING                 0.795  0.172    4.63 (-90.07 29.96)</span></span>
<span><span class="co">## # ℹ 37 more rows</span></span>
<span><span class="co">## # ℹ 5 more variables: geometry_end &lt;POINT [°]&gt;, tz_start &lt;chr&gt;, tz_end &lt;chr&gt;, tz_start_abb &lt;chr&gt;, tz_end_abb &lt;chr&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section></section><section id="road-trip-analysis" class="level1 page-columns page-full"><h1>Road trip analysis</h1>
<p>Phew, that was a lot of work getting this data all wrangled together and cleaned up. Let’s analyze this trip!</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Truncated vs.&nbsp;complete data
</div>
</div>
<div class="callout-body-container callout-body">
<p>All the plots and tables below use the complete data from our road trip, with every day and every stop. Everything above only worked with the first four days (and even then, omitted the first 30 minutes of the first day for the sake of privacy).</p>
<p><a href="data.zip">I provided truncated raw JSON files</a> for the sake of illustrating how to load and process and work with this kind of location data. But I want to analyze my actual full data, so I cleaned that up separately (<a href="clean-data-real.R">with this file</a>; <a href="https://github.com/andrewheiss/ath-quarto/blob/main/blog/2023/07/03/using-google-location-history-with-r-roadtrip/clean-data-real.R">view at GitHub</a>). I’ll load all those complete objects here.</p>
<p>If you’re following along with my truncated data, never fear! These plots and tables will all still generally work, they’ll just show the first few days and not the actual complete plots you see here.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Folded code
</div>
</div>
<div class="callout-body-container callout-body">
<p>There’s been a lot of code in this post already, so I’ve folded all the remaining code chunks so it’s easier to just see the plots and tables. You can see the underlying code if you click on the little toggle triangle.</p>
</div>
</div>
<section id="maps" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="maps">Maps</h2>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Find all the states that daily_routes crosses</span></span>
<span><span class="va">states_crossed_through</span> <span class="op">&lt;-</span> <span class="fu">st_intersection</span><span class="op">(</span></span>
<span>  <span class="fu">st_transform</span><span class="op">(</span><span class="va">lower_48</span>, <span class="fu">st_crs</span><span class="op">(</span><span class="va">daily_routes</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">daily_routes</span></span>
<span><span class="op">)</span></span>
<span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></span>
<span></span>
<span><span class="co"># Create a column that flags if the state is crossed through</span></span>
<span><span class="va">lower_48_highlighted</span> <span class="op">&lt;-</span> <span class="va">lower_48</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>visited <span class="op">=</span> <span class="va">NAME</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">states_crossed_through</span><span class="op">$</span><span class="va">NAME</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>In total, we crossed through 17 different states over the course of our big circular 13-day drive. We made 76 different stops along the way, all marked with points in <a href="#fig-map-basic" class="quarto-xref">Figure&nbsp;1</a>:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Make a map!</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lower_48_highlighted</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">visited</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey98"</span>, <span class="st">"grey90"</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">daily_routes</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">place_visits</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotation_scale</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"bl"</span>, bar_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey30"</span>, <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    unit_category <span class="op">=</span> <span class="st">"imperial"</span>, text_family <span class="op">=</span> <span class="st">"Overpass"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Each point is a stop"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"ESRI:102003"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Albers</span></span>
<span>  <span class="fu">theme_roadtrip_map</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-map-basic" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-map-basic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="index_files/figure-html/fig-map-basic-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img column-page-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-basic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Basic map of our mega road trip
</figcaption></figure>
</div>
</div>
</div>
<p>In <a href="#fig-map-with-dates" class="quarto-xref">Figure&nbsp;2</a> we can color each leg of the trip a different color to see how the driving was divided up over time:</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Use the same colors for each direction</span></span>
<span><span class="va">colors_there</span> <span class="op">&lt;-</span> <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu">carto_pal</span><span class="op">(</span><span class="fl">7</span>, <span class="st">"SunsetDark"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">colors_back_again</span> <span class="op">&lt;-</span> <span class="fu">rcartocolor</span><span class="fu">::</span><span class="fu">carto_pal</span><span class="op">(</span><span class="fl">6</span>, <span class="st">"SunsetDark"</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># CARTO's Sunset Dark is neat, but the first yellow color is a little too light</span></span>
<span><span class="co"># to see comfortably, so we replace it with the yellow from the CARTO Prism</span></span>
<span><span class="co"># palette</span></span>
<span><span class="va">colors_there</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">colors_back_again</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Make a map!</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">lower_48_highlighted</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">visited</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey98"</span>, <span class="st">"grey90"</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Reset fill scale so that the labels can be filled</span></span>
<span>  <span class="fu">new_scale_fill</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">daily_routes</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">day_month</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.75</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">colors_there</span>, <span class="va">colors_back_again</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">place_visits</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">day_month</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">daily_routes</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>label <span class="op">=</span> <span class="va">day_month</span>, fill <span class="op">=</span> <span class="va">day_month</span>, geometry <span class="op">=</span> <span class="va">path</span><span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"sf_coordinates"</span>, seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">3</span>, segment.color <span class="op">=</span> <span class="st">"grey30"</span>, min.segment.length <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    show.legend <span class="op">=</span> <span class="cn">FALSE</span>, family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">colors_there</span>, <span class="va">colors_back_again</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotation_scale</span><span class="op">(</span></span>
<span>    location <span class="op">=</span> <span class="st">"bl"</span>, bar_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"grey30"</span>, <span class="st">"white"</span><span class="op">)</span>,</span>
<span>    unit_category <span class="op">=</span> <span class="st">"imperial"</span>, text_family <span class="op">=</span> <span class="st">"Overpass"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Each point is a stop"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_sf</span><span class="op">(</span>crs <span class="op">=</span> <span class="fu">st_crs</span><span class="op">(</span><span class="st">"ESRI:102003"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Albers</span></span>
<span>  <span class="fu">theme_roadtrip_map</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-map-with-dates" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-map-with-dates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="index_files/figure-html/fig-map-with-dates-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img column-page-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-map-with-dates-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Map of our mega road trip, by day
</figcaption></figure>
</div>
</div>
</div>
</section><section id="distance-and-time" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="distance-and-time">Distance and time</h2>
<p><a href="#tbl-distance-time-day" class="quarto-xref">Table&nbsp;1</a> answers a bunch of questions about distance and time:</p>
<ul>
<li>
<strong>How many miles did we drive each day?</strong> Roughly 500ish miles per day. The way out was longer than the way back (2,832 miles there vs.&nbsp;2,390 miles back). In total we drove <strong>5,222 miles</strong> (!!!). This is <em>shockingly</em> close to the <a href="https://www.andrewheiss.com/blog/2023/06/01/geocoding-routing-openstreetmap-r/#summary-statistics">5,260 miles that OpenStreetMap mapped out for me in this previous blog post</a>, even with some changes to the route (i.e.&nbsp;we didn’t end up going through Minnesota and went through Nebraska instead)</li>
<li>
<strong>How long did we spend driving each day?</strong> Roughly 8.5 hours per day. The way out was 5 hours longer than the way back (though that’s a little inflated because June 8 doesn’t really count, as we were just driving around Capitol Reef National Park). In total we drove for <strong>91 hours and 47 minutes</strong>,</li>
<li>
<strong>What was the earliest time we started each day and the latest time we arrived each evening?</strong> The earliest departure was 7:30 AM when we left Atlanta on June 3; the latest arrivals were when we got to Sioux Falls, South Dakota at 10:42 PM on June 22 and when we got to Flagstaff, Arizona on June 6 at 10:35 PM.</li>
</ul>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">time_distance_day</span> <span class="op">&lt;-</span> <span class="va">activity_segments</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">activity_type</span> <span class="op">==</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">direction</span>, <span class="va">day_month</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span></span>
<span>    total_distance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">distance_miles</span><span class="op">)</span>,</span>
<span>    total_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span>,</span>
<span>    start_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span>,</span>
<span>    start_tz <span class="op">=</span> <span class="va">tz_start_abb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.min</a></span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span><span class="op">]</span>,</span>
<span>    end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">endTimestamp_local</span><span class="op">)</span>,</span>
<span>    end_tz <span class="op">=</span> <span class="va">tz_end_abb</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">endTimestamp_local</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    nice_start_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">start_time</span>, format <span class="op">=</span> <span class="st">"%I:%M %p"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="va">start_tz</span><span class="op">)</span>,</span>
<span>    nice_end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">end_time</span>, format <span class="op">=</span> <span class="st">"%I:%M %p"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="va">end_tz</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Remove leading zeros from hour</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">nice_start_time</span>, <span class="va">nice_end_time</span><span class="op">)</span>, <span class="op">~</span><span class="fu">str_replace</span><span class="op">(</span><span class="va">.x</span>, <span class="st">"^0"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time_distance_day</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">direction</span>, <span class="va">day_month</span>, <span class="va">total_distance</span>, <span class="va">total_time</span>, <span class="va">nice_start_time</span>, <span class="va">nice_end_time</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">direction</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">summary_rows</span><span class="op">(</span></span>
<span>    groups <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">total_distance</span>, <span class="va">total_time</span><span class="op">)</span>,</span>
<span>    fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Subtotal <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fmt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="fu">fmt_number</span><span class="op">(</span><span class="va">.</span>, columns <span class="op">=</span> <span class="va">total_distance</span>, decimals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span><span class="fu">fmt</span><span class="op">(</span><span class="va">.</span>, columns <span class="op">=</span> <span class="va">total_time</span>, fns <span class="op">=</span> <span class="va">fmt_difftime</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">grand_summary_rows</span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">total_distance</span>, <span class="va">total_time</span><span class="op">)</span>,</span>
<span>    fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Total <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    fmt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="op">~</span><span class="fu">fmt_number</span><span class="op">(</span><span class="va">.</span>, columns <span class="op">=</span> <span class="va">total_distance</span>, decimals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span><span class="fu">fmt</span><span class="op">(</span><span class="va">.</span>, columns <span class="op">=</span> <span class="va">total_time</span>, fns <span class="op">=</span> <span class="va">fmt_difftime</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    missing_text <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_footnote</span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="st">"This wasn't really a travel day; we spent the day hiking around Capitol Reef National Park and hanging out at my aunt's cabin in Grover, Utah."</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span></span>
<span>      columns <span class="op">=</span> <span class="va">day_month</span>,</span>
<span>      rows <span class="op">=</span> <span class="va">day_month</span> <span class="op">==</span> <span class="st">"June 8"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    day_month <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    total_distance <span class="op">=</span> <span class="st">"Miles"</span>,</span>
<span>    total_time <span class="op">=</span> <span class="st">"Driving time"</span>,</span>
<span>    nice_start_time <span class="op">=</span> <span class="st">"Start time"</span>,</span>
<span>    nice_end_time <span class="op">=</span> <span class="st">"End time"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cols_align</span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="va">total_time</span>,</span>
<span>    align <span class="op">=</span> <span class="st">"left"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fmt_number</span><span class="op">(</span>columns <span class="op">=</span> <span class="va">total_distance</span>, decimals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fmt</span><span class="op">(</span>columns <span class="op">=</span> <span class="va">total_time</span>, fns <span class="op">=</span> <span class="va">fmt_difftime</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu">cells_row_groups</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">cells_summary</span><span class="op">(</span><span class="op">)</span>, <span class="fu">cells_stub_summary</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_fill</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey95"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cells_grand_summary</span><span class="op">(</span><span class="op">)</span>, <span class="fu">cells_stub_grand_summary</span><span class="op">(</span><span class="op">)</span>, </span>
<span>      <span class="fu">cells_column_labels</span><span class="op">(</span><span class="op">)</span>, <span class="fu">cells_stubhead</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>      <span class="fu">cell_fill</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">opt_horizontal_padding</span><span class="op">(</span>scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">opt_table_font</span><span class="op">(</span>font <span class="op">=</span> <span class="st">"Jost"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_options</span><span class="op">(</span></span>
<span>    row_group.as_column <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    footnotes.marks <span class="op">=</span> <span class="st">"standard"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-distance-time-day" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-distance-time-day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Daily distance and time details
</figcaption><div aria-describedby="tbl-distance-time-day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<div id="pzveloiefp" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pzveloiefp table {
  font-family: Jost, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pzveloiefp thead, #pzveloiefp tbody, #pzveloiefp tfoot, #pzveloiefp tr, #pzveloiefp td, #pzveloiefp th {
  border-style: none;
}

#pzveloiefp p {
  margin: 0;
  padding: 0;
}

#pzveloiefp .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pzveloiefp .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pzveloiefp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 10px;
  padding-right: 10px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pzveloiefp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 10px;
  padding-right: 10px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pzveloiefp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 10px;
  padding-right: 10px;
  overflow-x: hidden;
}

#pzveloiefp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pzveloiefp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pzveloiefp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pzveloiefp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pzveloiefp .gt_spanner_row {
  border-bottom-style: hidden;
}

#pzveloiefp .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pzveloiefp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pzveloiefp .gt_from_md > :first-child {
  margin-top: 0;
}

#pzveloiefp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pzveloiefp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pzveloiefp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 10px;
  padding-right: 10px;
}

#pzveloiefp .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 10px;
  padding-right: 10px;
  vertical-align: top;
}

#pzveloiefp .gt_row_group_first td {
  border-top-width: 2px;
}

#pzveloiefp .gt_row_group_first th {
  border-top-width: 2px;
}

#pzveloiefp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
}

#pzveloiefp .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pzveloiefp .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pzveloiefp .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
}

#pzveloiefp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pzveloiefp .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 10px;
  padding-right: 10px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pzveloiefp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pzveloiefp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 10px;
  padding-right: 10px;
}

#pzveloiefp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pzveloiefp .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 10px;
  padding-right: 10px;
}

#pzveloiefp .gt_left {
  text-align: left;
}

#pzveloiefp .gt_center {
  text-align: center;
}

#pzveloiefp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pzveloiefp .gt_font_normal {
  font-weight: normal;
}

#pzveloiefp .gt_font_bold {
  font-weight: bold;
}

#pzveloiefp .gt_font_italic {
  font-style: italic;
}

#pzveloiefp .gt_super {
  font-size: 65%;
}

#pzveloiefp .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pzveloiefp .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pzveloiefp .gt_indent_1 {
  text-indent: 5px;
}

#pzveloiefp .gt_indent_2 {
  text-indent: 10px;
}

#pzveloiefp .gt_indent_3 {
  text-indent: 15px;
}

#pzveloiefp .gt_indent_4 {
  text-indent: 20px;
}

#pzveloiefp .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings header">
<th class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col"></th>
<th id="Day" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Day</th>
<th id="Miles" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Miles</th>
<th id="Driving time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Driving time</th>
<th id="Start time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Start time</th>
<th id="End time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">End time</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="gt_row_group_first odd">
<td rowspan="7" class="gt_row gt_left gt_stub_row_group" headers="There stub_1_1 stub_1" style="font-weight: bold">There</td>
<td class="gt_row gt_center" headers="There stub_1_1 day_month">June 3</td>
<td class="gt_row gt_right" headers="There stub_1_1 total_distance">492</td>
<td class="gt_row gt_left" headers="There stub_1_1 total_time">7 hours 26 minutes</td>
<td class="gt_row gt_left" headers="There stub_1_1 nice_start_time">7:34 AM EDT</td>
<td class="gt_row gt_left" headers="There stub_1_1 nice_end_time">6:37 PM CDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="There day_month_2 day_month">June 4</td>
<td class="gt_row gt_right" headers="There day_month_2 total_distance">544</td>
<td class="gt_row gt_left" headers="There day_month_2 total_time">8 hours 16 minutes</td>
<td class="gt_row gt_left" headers="There day_month_2 nice_start_time">9:01 AM CDT</td>
<td class="gt_row gt_left" headers="There day_month_2 nice_end_time">8:30 PM CDT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="There day_month_3 day_month">June 5</td>
<td class="gt_row gt_right" headers="There day_month_3 total_distance">442</td>
<td class="gt_row gt_left" headers="There day_month_3 total_time">6 hours 56 minutes</td>
<td class="gt_row gt_left" headers="There day_month_3 nice_start_time">9:06 AM CDT</td>
<td class="gt_row gt_left" headers="There day_month_3 nice_end_time">6:10 PM MDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="There day_month_4 day_month">June 6</td>
<td class="gt_row gt_right" headers="There day_month_4 total_distance">626</td>
<td class="gt_row gt_left" headers="There day_month_4 total_time">10 hours 5 minutes</td>
<td class="gt_row gt_left" headers="There day_month_4 nice_start_time">8:24 AM MDT</td>
<td class="gt_row gt_left" headers="There day_month_4 nice_end_time">10:35 PM MST</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="There day_month_5 day_month">June 7</td>
<td class="gt_row gt_right" headers="There day_month_5 total_distance">438</td>
<td class="gt_row gt_left" headers="There day_month_5 total_time">8 hours 31 minutes</td>
<td class="gt_row gt_left" headers="There day_month_5 nice_start_time">8:40 AM MST</td>
<td class="gt_row gt_left" headers="There day_month_5 nice_end_time">8:46 PM MDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="There day_month_6 day_month">June 8<span class="gt_footnote_marks gt_asterisk" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>*</sup></span>
</td>
<td class="gt_row gt_right" headers="There day_month_6 total_distance">63</td>
<td class="gt_row gt_left" headers="There day_month_6 total_time">2 hours 18 minutes</td>
<td class="gt_row gt_left" headers="There day_month_6 nice_start_time">9:41 AM MDT</td>
<td class="gt_row gt_left" headers="There day_month_6 nice_end_time">7:42 PM MDT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="There day_month_7 day_month">June 9</td>
<td class="gt_row gt_right" headers="There day_month_7 total_distance">228</td>
<td class="gt_row gt_left" headers="There day_month_7 total_time">4 hours 41 minutes</td>
<td class="gt_row gt_left" headers="There day_month_7 nice_start_time">9:04 AM MDT</td>
<td class="gt_row gt_left" headers="There day_month_7 nice_end_time">3:06 PM MDT</td>
</tr>
<tr class="even">
<td id="summary_stub_There_1" class="gt_row gt_left gt_stub gt_summary_row gt_first_summary_row gt_last_summary_row" data-quarto-table-cell-role="th" scope="row" style="background-color: #F2F2F2">Subtotal</td>
<td class="gt_row gt_center gt_summary_row gt_first_summary_row gt_last_summary_row" headers="There summary_stub_There_1 day_month" style="background-color: #F2F2F2"></td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row gt_last_summary_row" headers="There summary_stub_There_1 total_distance" style="background-color: #F2F2F2">2,832</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="There summary_stub_There_1 total_time" style="background-color: #F2F2F2">48 hours 14 minutes</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="There summary_stub_There_1 nice_start_time" style="background-color: #F2F2F2"></td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="There summary_stub_There_1 nice_end_time" style="background-color: #F2F2F2"></td>
</tr>
<tr class="gt_row_group_first odd">
<td rowspan="6" class="gt_row gt_left gt_stub_row_group" headers="Back again stub_1_8 stub_1" style="font-weight: bold">Back again</td>
<td class="gt_row gt_center" headers="Back again stub_1_8 day_month">June 20</td>
<td class="gt_row gt_right" headers="Back again stub_1_8 total_distance">290</td>
<td class="gt_row gt_left" headers="Back again stub_1_8 total_time">4 hours 50 minutes</td>
<td class="gt_row gt_left" headers="Back again stub_1_8 nice_start_time">8:58 AM MDT</td>
<td class="gt_row gt_left" headers="Back again stub_1_8 nice_end_time">9:17 PM MDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Back again day_month_9 day_month">June 21</td>
<td class="gt_row gt_right" headers="Back again day_month_9 total_distance">408</td>
<td class="gt_row gt_left" headers="Back again day_month_9 total_time">11 hours 36 minutes</td>
<td class="gt_row gt_left" headers="Back again day_month_9 nice_start_time">8:16 AM MDT</td>
<td class="gt_row gt_left" headers="Back again day_month_9 nice_end_time">10:04 PM MDT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Back again day_month_10 day_month">June 22</td>
<td class="gt_row gt_right" headers="Back again day_month_10 total_distance">525</td>
<td class="gt_row gt_left" headers="Back again day_month_10 total_time">8 hours 27 minutes</td>
<td class="gt_row gt_left" headers="Back again day_month_10 nice_start_time">8:14 AM MDT</td>
<td class="gt_row gt_left" headers="Back again day_month_10 nice_end_time">10:42 PM CDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Back again day_month_11 day_month">June 23</td>
<td class="gt_row gt_right" headers="Back again day_month_11 total_distance">459</td>
<td class="gt_row gt_left" headers="Back again day_month_11 total_time">7 hours 27 minutes</td>
<td class="gt_row gt_left" headers="Back again day_month_11 nice_start_time">8:11 AM CDT</td>
<td class="gt_row gt_left" headers="Back again day_month_11 nice_end_time">8:22 PM CDT</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="Back again day_month_12 day_month">June 24</td>
<td class="gt_row gt_right" headers="Back again day_month_12 total_distance">446</td>
<td class="gt_row gt_left" headers="Back again day_month_12 total_time">7 hours 9 minutes</td>
<td class="gt_row gt_left" headers="Back again day_month_12 nice_start_time">9:09 AM CDT</td>
<td class="gt_row gt_left" headers="Back again day_month_12 nice_end_time">9:16 PM CDT</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="Back again day_month_13 day_month">June 25</td>
<td class="gt_row gt_right" headers="Back again day_month_13 total_distance">262</td>
<td class="gt_row gt_left" headers="Back again day_month_13 total_time">4 hours 1 minutes</td>
<td class="gt_row gt_left" headers="Back again day_month_13 nice_start_time">7:49 AM CDT</td>
<td class="gt_row gt_left" headers="Back again day_month_13 nice_end_time">12:51 PM EDT</td>
</tr>
<tr class="odd">
<td id="summary_stub_Back again_1" class="gt_row gt_left gt_stub gt_summary_row gt_first_summary_row gt_last_summary_row" data-quarto-table-cell-role="th" scope="row" style="background-color: #F2F2F2">Subtotal</td>
<td class="gt_row gt_center gt_summary_row gt_first_summary_row gt_last_summary_row" headers="Back again summary_stub_Back again_1 day_month" style="background-color: #F2F2F2"></td>
<td class="gt_row gt_right gt_summary_row gt_first_summary_row gt_last_summary_row" headers="Back again summary_stub_Back again_1 total_distance" style="background-color: #F2F2F2">2,390</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="Back again summary_stub_Back again_1 total_time" style="background-color: #F2F2F2">43 hours 33 minutes</td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="Back again summary_stub_Back again_1 nice_start_time" style="background-color: #F2F2F2"></td>
<td class="gt_row gt_left gt_summary_row gt_first_summary_row gt_last_summary_row" headers="Back again summary_stub_Back again_1 nice_end_time" style="background-color: #F2F2F2"></td>
</tr>
<tr class="even">
<td id="grand_summary_stub_1" class="gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" data-quarto-table-cell-role="th" scope="row" style="font-weight: bold; background-color: #CCCCCC">Total</td>
<td class="gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" headers="grand_summary_stub_1 day_month" style="font-weight: bold; background-color: #CCCCCC"></td>
<td class="gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" headers="grand_summary_stub_1 total_distance" style="font-weight: bold; background-color: #CCCCCC">5,222</td>
<td class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" headers="grand_summary_stub_1 total_time" style="font-weight: bold; background-color: #CCCCCC">91 hours 47 minutes</td>
<td class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" headers="grand_summary_stub_1 nice_start_time" style="font-weight: bold; background-color: #CCCCCC"></td>
<td class="gt_row gt_left gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row" headers="grand_summary_stub_1 nice_end_time" style="font-weight: bold; background-color: #CCCCCC"></td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="odd">
<td colspan="6" class="gt_footnote">
<span class="gt_footnote_marks gt_asterisk" style="white-space:nowrap;font-style:italic;font-weight:normal;"><sup>*</sup></span> This wasn't really a travel day; we spent the day hiking around Capitol Reef National Park and hanging out at my aunt's cabin in Grover, Utah.</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-timeline-by-day" class="quarto-xref">Figure&nbsp;3</a> shows a timeline of each day’s events.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We typically started each day with some sort of sightseeing adventure (we didn’t do this on the first day, since we left our house that day—instead, we ended that day with a walk through the French Quarter in New Orleans). Our longest touristy adventure was technically Capitol Reef National Park, since we spent the whole day there, but if we don’t count that and instead look at the along-the-way stops, our longest adventures were Yellowstone, Nauvoo, and Carlsbad Caverns.</p>
<div class="no-row-height column-margin column-container"><div id="fn1"><p><sup>1</sup>&nbsp;All the times are in local time, which causes some weirdness when crossing time zones. Instead of somehow expanding or shrinking these timelines during stretches where we gained or lost time because of time zone changes, I just put a dotted border around those stretches to point them out.</p></div></div><div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Little dataset with names for the tourist stops we made</span></span>
<span><span class="co"># Gotta do some goofy things here because I don't want things double labeled though</span></span>
<span><span class="co">#</span></span>
<span><span class="co"># - Some IDs, like ChIJgcNDAhKmIIYRRA4mio_7VgE (a parking lot near the </span></span>
<span><span class="co">#   French Quarter) show up twice as placeVisits, but there should only be one </span></span>
<span><span class="co">#   label, so down below, after merging this into the timeline data, I use </span></span>
<span><span class="co">#   `group_by(visit_label) %&gt;% slice(1)` to only keep the first visit for labeling</span></span>
<span><span class="co"># - Yellowstone, though, looks goofy if the first segment is labeled, so I want </span></span>
<span><span class="co">#   to label the second. That messes with the grouping/slicing approach, so I </span></span>
<span><span class="co">#   add a trailing space to the Yellowstone visits I don't want labeled </span></span>
<span><span class="co">#   (i.e. "Yellowstone ") and then filter those out after grouping/slicing</span></span>
<span><span class="co"># - Nauvoo happened on two different days, but grouping/slicing only keeps the </span></span>
<span><span class="co">#   first. So I make the second day's visits use a different label with a space </span></span>
<span><span class="co">#   at the beginning and end of the label (i.e. " Nauvoo ")</span></span>
<span><span class="va">sightseeing</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>,                           <span class="op">~</span><span class="va">visit_label</span>,</span>
<span>  <span class="st">"ChIJgcNDAhKmIIYRRA4mio_7VgE"</span>, <span class="st">"The French\nQuarter"</span>,</span>
<span>  <span class="st">"ChIJv30_Xw-mIIYRpt26QbLBh58"</span>, <span class="st">"The French\nQuarter"</span>,  <span class="co"># Technically Louis Armstrong Park</span></span>
<span>  <span class="st">"ChIJ59n6fW8dnogRWi-5N6olcyU"</span>, <span class="st">"Chalmette\nBattlefield"</span>,</span>
<span>  <span class="st">"ChIJX4k2TVVfXIYRIsTnhA-P-Rc"</span>, <span class="st">"The Alamo"</span>,</span>
<span>  <span class="st">"ChIJW9e4xBN544YRvbI7vfc91G4"</span>, <span class="st">"Carlsbad\nCaverns"</span>,</span>
<span>  <span class="st">"ChIJrSLbJJIQM4cR4l5HTswDY8k"</span>, <span class="st">"The Grand\nCanyon"</span>,</span>
<span>  <span class="st">"ChIJU6LnB_8ASocRB_9PSFPsO94"</span>, <span class="st">"Capitol Reef\nNational Park"</span>,</span>
<span>  <span class="st">"ChIJIw-BhQkZSocRncIWG0YMLJU"</span>, <span class="st">"Capitol Reef\nNational Park"</span>,  <span class="co"># Technically the visitor center</span></span>
<span>  <span class="st">"ChIJaSHejn29SYcR-YzTt_DNlTg"</span>, <span class="st">"Goblin\nValley"</span>,</span>
<span>  <span class="st">"ChIJVQ4oZOP4VFMREjDKbf7bHIE"</span>, <span class="st">"My sister's\nhouse"</span>,</span>
<span>  <span class="st">"ChIJp4yR8asLVFMRJJExTuHrYEs"</span>, <span class="st">"Rexburg"</span>,  <span class="co"># Technically Porter Park</span></span>
<span>  <span class="st">"ChIJz6VI3AMLVFMREvSOw9M0VR4"</span>, <span class="st">"Rexburg"</span>,  <span class="co"># Technically BYU-I</span></span>
<span>  <span class="st">"51"</span>,                          <span class="st">"Yellowstone"</span>,  <span class="co"># Technically the drive to Old Faithful; Google missed this</span></span>
<span>  <span class="st">"ChIJ3zGqpb65UVMR0rTSaqVZ5kc"</span>, <span class="st">"Yellowstone "</span>,</span>
<span>  <span class="st">"ChIJXy5ZgRvtUVMRoSJoWid8Owg"</span>, <span class="st">"Yellowstone "</span>,  <span class="co"># Technically Old Faithful</span></span>
<span>  <span class="st">"ChIJOT5U8z8GM1MResed1BOdJKk"</span>, <span class="st">"Devil's\nTower"</span>,</span>
<span>  <span class="st">"ChIJ39Y-tdg1fYcRQcZcBb499do"</span>, <span class="st">"Mount\nRushmore"</span>,</span>
<span>  <span class="st">"ChIJg_2MNnKRk4cRQGXbuvgqba4"</span>, <span class="st">"Winter\nQuarters"</span>,</span>
<span>  <span class="st">"ChIJh53YJHIm54cRmpf8_ZA3CVw"</span>, <span class="st">"Nauvoo"</span>,  <span class="co"># Technically the visitors center</span></span>
<span>  <span class="st">"ChIJDUPPu3Im54cRKj6BG8UkOko"</span>, <span class="st">"Nauvoo"</span>,  <span class="co"># Technically the temple</span></span>
<span>  <span class="st">"ChIJg0abVHYm54cR85yQbfLjt2o"</span>, <span class="st">" Nauvoo "</span>,  <span class="co"># Technically the family living center</span></span>
<span>  <span class="st">"ChIJm7cRetkl54cR-lEKk-eZnXA"</span>, <span class="st">" Nauvoo "</span>,  <span class="co"># Technically the Smith family cemetery</span></span>
<span>  <span class="st">"ChIJZ6tHUwsm54cRbmWsF639PjY"</span>, <span class="st">" Nauvoo "</span>   <span class="co"># Technically Carthage Jail</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">timeline_data</span> <span class="op">&lt;-</span> <span class="va">all_stops_activities</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Get rid of the geometry column since we're not doing anything map-related</span></span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Indicate if there was a time zone change during the activity</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    tz_change <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">tz_start</span><span class="op">)</span> <span class="op">|</span> <span class="va">tz_start_abb</span> <span class="op">==</span> <span class="va">tz_end_abb</span>, <span class="cn">NA</span>, <span class="st">"Time zone change"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Find the midpoint between the start and end times</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>time_mid <span class="op">=</span> <span class="va">startTimestamp_local</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="va">startTimestamp_local</span> <span class="op">-</span> <span class="va">endTimestamp_local</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add column for the name of the tourist stop</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">sightseeing</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Add column for more detailed type of stop</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    stop_type <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>      <span class="va">type</span> <span class="op">==</span> <span class="st">"visit"</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">visit_label</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Sightseeing"</span>,</span>
<span>      <span class="va">type</span> <span class="op">==</span> <span class="st">"visit"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">visit_label</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Gas/bathroom/hotel stop"</span>,</span>
<span>      <span class="va">type</span> <span class="op">==</span> <span class="st">"segment"</span> <span class="op">&amp;</span> <span class="va">id</span> <span class="op">==</span> <span class="st">"51"</span> <span class="op">~</span> <span class="st">"Sightseeing"</span>,</span>
<span>      <span class="va">type</span> <span class="op">==</span> <span class="st">"segment"</span> <span class="op">~</span> <span class="st">"Traveling"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># After finishing at Capitol Reef we returned to my aunt's cabin in Grover to</span></span>
<span>  <span class="co"># relax. I had to run back to the nearest town with 5G internet (Torrey) to</span></span>
<span>  <span class="co"># respond to e-mails and Slack messages (since I was teaching two online</span></span>
<span>  <span class="co"># classes throughout this whole road trip!), and that doesn't technically</span></span>
<span>  <span class="co"># count as part of the road trip, so we need to remove everything after 5 PM</span></span>
<span>  <span class="co"># on that day</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">day</span> <span class="op">==</span> <span class="fl">8</span> <span class="op">&amp;</span> <span class="fu">hour</span><span class="op">(</span><span class="va">endTimestamp_local</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">17</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># After arriving at the hotel in Rexburg, we made a late-night milkshake run</span></span>
<span>  <span class="co"># after the kids were in bed, which Google picked up. That doesn't technically</span></span>
<span>  <span class="co"># count as part of the road trip, so we need to remove everything after 6 PM</span></span>
<span>  <span class="co"># on that day</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">day</span> <span class="op">==</span> <span class="fl">20</span> <span class="op">&amp;</span> <span class="fu">hour</span><span class="op">(</span><span class="va">endTimestamp_local</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">18</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Set the timestamps for the final stop of the day (i.e. hotels) to NA and</span></span>
<span>  <span class="co"># then remove those rows for plotting</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">day</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    <span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">startTimestamp_local</span>, <span class="va">endTimestamp_local</span><span class="op">)</span>, </span>
<span>      <span class="op">~</span><span class="fu">if_else</span><span class="op">(</span><span class="fu">row_number</span><span class="op">(</span><span class="op">)</span> <span class="op">==</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">drop_na</span><span class="op">(</span><span class="va">startTimestamp_local</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Force all the timestamps to be on the same day for the sake of plotting</span></span>
<span><span class="fu">day</span><span class="op">(</span><span class="va">timeline_data</span><span class="op">$</span><span class="va">startTimestamp_local</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu">day</span><span class="op">(</span><span class="va">timeline_data</span><span class="op">$</span><span class="va">endTimestamp_local</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu">day</span><span class="op">(</span><span class="va">timeline_data</span><span class="op">$</span><span class="va">time_mid</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># Extract just the labels for plotting</span></span>
<span><span class="va">sightseeing_labels</span> <span class="op">&lt;-</span> <span class="va">timeline_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">stop_type</span> <span class="op">==</span> <span class="st">"Sightseeing"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">visit_label</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">visit_label</span> <span class="op">!=</span> <span class="st">"Yellowstone "</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Timeline plot</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">timeline_data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rect</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span></span>
<span>      xmin <span class="op">=</span> <span class="va">startTimestamp_local</span>, xmax <span class="op">=</span> <span class="va">endTimestamp_local</span>, </span>
<span>      ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="fl">1</span>, </span>
<span>      fill <span class="op">=</span> <span class="va">stop_type</span>, color <span class="op">=</span> <span class="va">tz_change</span>, linetype <span class="op">=</span> <span class="va">tz_change</span>, linewidth <span class="op">=</span> <span class="va">tz_change</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_label</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sightseeing_labels</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_mid</span>, y <span class="op">=</span> <span class="fl">0.5</span>, label <span class="op">=</span> <span class="va">visit_label</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu">lighten</span><span class="op">(</span><span class="va">clrs</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, <span class="fl">0.1</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"white"</span>, lineheight <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    inherit.aes <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Phew fancy aesthetic and scale work here</span></span>
<span>  <span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"3 hours"</span>, date_labels <span class="op">=</span> <span class="st">"%I:%M %p"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>expand <span class="op">=</span> <span class="fu">expansion</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, <span class="va">clrs</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, guide <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>order <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>, <span class="st">"white"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linewidth_discrete</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_linetype_manual</span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"21"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="st">"Time zone change"</span>,</span>
<span>    guide <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>override.aes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, order <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">guides</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"none"</span>, linewidth <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">day_month</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, dir <span class="op">=</span> <span class="st">"v"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, linetype <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-timeline-by-day" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-timeline-by-day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="index_files/figure-html/fig-timeline-by-day-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img column-page-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-timeline-by-day-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Timeline of our grand road trip
</figcaption></figure>
</div>
</div>
</div>
</section><section id="driving-and-breaks" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="driving-and-breaks">Driving and breaks</h2>
<p>As seen in <a href="#fig-timeline-by-day" class="quarto-xref">Figure&nbsp;3</a>, we had a pretty good rhythm of driving and taking gas/bathroom breaks—we broke up long stretches of driving with stops for gas and bathrooms.</p>
<p><a href="#tbl-driving-longest-shortest" class="quarto-xref">Table&nbsp;2</a> shows the top three longest and shortest stretches of driving. The longest stretch was on the final day—we drove 4 hours from Nashville to Atlanta with no bathroom breaks. We apparently just desperately wanted to get home! We did the same push-through-to-the-last-stop approach a few other times too. The third longest stretch was actually our first on the way home, leaving Spanish Fork, Utah to my sister’s house outside of Rexburg, Idaho, which we did in 3.5 hours, while the 2nd and 5th longest stretches involved pushing to our final destinations for the day (a hotel in Nauvoo, Illinois and my aunt’s cabin in Grover, Utah). The only long stretch that broke this patter was the fourth longest one after Carlsbad Caverns—we spent more than 3 hours on a little state road going all the way from southern New Mexico to a gas station at I-20.</p>
<p>The shortest stretches involved going from a main sightseeing stop to a gas station (Mount Rushmore to some Holiday gas station), going between sightseeing stops (the Smith Family Cemetery in Nauvoo to Carthage Jail), or going from a hotel to a sightseeing stop (our hotel in Carlsbad to Carlsbad Caverns National Park).</p>
<p>My favorite short stop is number 4 here, on June 4. We got gas in Louisiana somewhere and then had to stop at another gas station in Texas 39 minutes later for an emergency break for little kids who suddenly needed to use the bathroom again. After that particular stop, we instituted a “no drinking soda or juice in the car” rule for the kids and suddenly—like magic—their bladders worked a lot more slowly and we stopped making such frequent stops.</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">driving_data</span> <span class="op">&lt;-</span> <span class="va">all_stops_activities</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Get rid of the geometry column since we're not doing anything map-related</span></span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Find the previous and next place visits</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    origin_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,</span>
<span>    origin_address <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">address</span><span class="op">)</span>,</span>
<span>    destination_name <span class="op">=</span> <span class="fu">lead</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>,</span>
<span>    destination_address <span class="op">=</span> <span class="fu">lead</span><span class="op">(</span><span class="va">address</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># lag() doesn't work for the first entry, so manually add it</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    origin_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Home"</span>, <span class="va">origin_name</span><span class="op">)</span>,</span>
<span>    origin_address <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">id</span> <span class="op">==</span> <span class="fl">1</span>, <span class="st">"Atlanta, GA, USA"</span>, <span class="va">origin_address</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Only look at driving activities</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">activity_type</span> <span class="op">==</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Get rid of empty, place-related columns</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">address</span>, <span class="va">driving_stop</span>, <span class="va">tz</span>, <span class="va">geometry_start</span>, <span class="va">geometry_end</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Longest, shortest stretch of driving</span></span>
<span><span class="va">driving_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">distance_miles</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>duration_rank <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rank.html">rank</a></span><span class="op">(</span><span class="op">-</span><span class="va">duration</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>top_bottom <span class="op">=</span> <span class="fu">case_when</span><span class="op">(</span></span>
<span>    <span class="va">duration_rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span> <span class="op">~</span> <span class="st">"Longest stretches"</span>,</span>
<span>    <span class="va">duration_rank</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Shortest stretches"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">top_bottom</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">arrange</span><span class="op">(</span></span>
<span>    <span class="va">top_bottom</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">top_bottom</span> <span class="op">==</span> <span class="st">"Shortest stretches"</span>, <span class="fu">desc</span><span class="op">(</span><span class="va">duration_rank</span><span class="op">)</span>, <span class="va">duration_rank</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Format time stuff nicely</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    nice_time <span class="op">=</span> <span class="fu">fmt_difftime</span><span class="op">(</span><span class="va">duration</span><span class="op">)</span>,</span>
<span>    nice_start_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">startTimestamp_local</span>, format <span class="op">=</span> <span class="st">"%I:%M %p"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="va">tz_start_abb</span><span class="op">)</span>,</span>
<span>    nice_end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strptime.html">strftime</a></span><span class="op">(</span><span class="va">endTimestamp_local</span>, format <span class="op">=</span> <span class="st">"%I:%M %p"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="va">tz_end_abb</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Remove leading zeros from hour</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">nice_start_time</span>, <span class="va">nice_end_time</span><span class="op">)</span>, <span class="op">~</span><span class="fu">str_replace</span><span class="op">(</span><span class="va">.x</span>, <span class="st">"^0"</span>, <span class="st">""</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Make nice origin and destination columns</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    origin_nice <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'{origin_name}&lt;br&gt;&lt;span class="smaller-address"&gt;{origin_address}&lt;/span&gt;'</span><span class="op">)</span>,</span>
<span>    destination_nice <span class="op">=</span> <span class="fu"><a href="https://glue.tidyverse.org/reference/glue.html">glue</a></span><span class="op">(</span><span class="st">'{destination_name}&lt;br&gt;&lt;span class="smaller-address"&gt;{destination_address}&lt;/span&gt;'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span></span>
<span>    <span class="va">top_bottom</span>, <span class="va">day_month</span>, <span class="va">nice_time</span>, <span class="va">nice_start_time</span>, <span class="va">nice_end_time</span>, </span>
<span>    <span class="va">distance_miles</span>, <span class="va">origin_nice</span>, <span class="va">destination_nice</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">top_bottom</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    nice_time <span class="op">=</span> <span class="st">"Driving time"</span>,</span>
<span>    day_month <span class="op">=</span> <span class="st">"Day"</span>,</span>
<span>    nice_start_time <span class="op">=</span> <span class="st">"Start time"</span>,</span>
<span>    nice_end_time <span class="op">=</span> <span class="st">"End time"</span>,</span>
<span>    distance_miles <span class="op">=</span> <span class="st">"Miles"</span>,</span>
<span>    origin_nice <span class="op">=</span> <span class="st">"Origin"</span>,</span>
<span>    destination_nice <span class="op">=</span> <span class="st">"Destination"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu">cells_column_labels</span><span class="op">(</span><span class="op">)</span>, <span class="fu">cells_stubhead</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>      <span class="fu">cell_fill</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    locations <span class="op">=</span> <span class="fu">cells_row_groups</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>      <span class="fu">cell_text</span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>      <span class="fu">cell_fill</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"grey95"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">cols_align</span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">day_month</span>, <span class="va">origin_nice</span>, <span class="va">destination_nice</span><span class="op">)</span>,</span>
<span>    align <span class="op">=</span> <span class="st">"left"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fmt_markdown</span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">origin_nice</span>, <span class="va">destination_nice</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fmt_number</span><span class="op">(</span>columns <span class="op">=</span> <span class="va">distance_miles</span>, decimals <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">tab_footnote</span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="st">"Stretches less than 10 miles omitted (like if we had lunch somewhere and drove down the street to get gas)."</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">opt_css</span><span class="op">(</span></span>
<span>    css <span class="op">=</span> <span class="st">"</span></span>
<span><span class="st">    .smaller-address {</span></span>
<span><span class="st">      font-size: 0.7em;</span></span>
<span><span class="st">    }"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">opt_table_font</span><span class="op">(</span>font <span class="op">=</span> <span class="st">"Jost"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-driving-longest-shortest" class="cell quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-layout-align="center">
<figure class="quarto-float quarto-float-tbl figure page-columns page-full"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-driving-longest-shortest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Top five longest and shortest stretches of driving during the trip
</figcaption><div aria-describedby="tbl-driving-longest-shortest-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<div class="cell-output-display column-page-right">
<div id="dbgvzfontn" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dbgvzfontn table {
  font-family: Jost, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dbgvzfontn thead, #dbgvzfontn tbody, #dbgvzfontn tfoot, #dbgvzfontn tr, #dbgvzfontn td, #dbgvzfontn th {
  border-style: none;
}

#dbgvzfontn p {
  margin: 0;
  padding: 0;
}

#dbgvzfontn .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dbgvzfontn .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dbgvzfontn .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dbgvzfontn .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dbgvzfontn .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbgvzfontn .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbgvzfontn .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbgvzfontn .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dbgvzfontn .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dbgvzfontn .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dbgvzfontn .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dbgvzfontn .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dbgvzfontn .gt_spanner_row {
  border-bottom-style: hidden;
}

#dbgvzfontn .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dbgvzfontn .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dbgvzfontn .gt_from_md > :first-child {
  margin-top: 0;
}

#dbgvzfontn .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dbgvzfontn .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dbgvzfontn .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dbgvzfontn .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dbgvzfontn .gt_row_group_first td {
  border-top-width: 2px;
}

#dbgvzfontn .gt_row_group_first th {
  border-top-width: 2px;
}

#dbgvzfontn .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbgvzfontn .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dbgvzfontn .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dbgvzfontn .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbgvzfontn .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbgvzfontn .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dbgvzfontn .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dbgvzfontn .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dbgvzfontn .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbgvzfontn .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbgvzfontn .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbgvzfontn .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbgvzfontn .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbgvzfontn .gt_left {
  text-align: left;
}

#dbgvzfontn .gt_center {
  text-align: center;
}

#dbgvzfontn .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dbgvzfontn .gt_font_normal {
  font-weight: normal;
}

#dbgvzfontn .gt_font_bold {
  font-weight: bold;
}

#dbgvzfontn .gt_font_italic {
  font-style: italic;
}

#dbgvzfontn .gt_super {
  font-size: 65%;
}

#dbgvzfontn .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dbgvzfontn .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dbgvzfontn .gt_indent_1 {
  text-indent: 5px;
}

#dbgvzfontn .gt_indent_2 {
  text-indent: 10px;
}

#dbgvzfontn .gt_indent_3 {
  text-indent: 15px;
}

#dbgvzfontn .gt_indent_4 {
  text-indent: 20px;
}

#dbgvzfontn .gt_indent_5 {
  text-indent: 25px;
}

.smaller-address {
  font-size: 0.7em;
}
</style>
<table class="gt_table do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead><tr class="gt_col_headings header">
<th id="Day" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Day</th>
<th id="Driving time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Driving time</th>
<th id="Start time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Start time</th>
<th id="End time" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">End time</th>
<th id="Miles" class="gt_col_heading gt_columns_bottom_border gt_right" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Miles</th>
<th id="Origin" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Origin</th>
<th id="Destination" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #CCCCCC" scope="col">Destination</th>
</tr></thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row odd">
<td colspan="7" id="Longest stretches" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #F2F2F2" scope="colgroup">Longest stretches</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Longest stretches  day_month">June 25</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_time">4 hours 1 minutes</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_start_time">7:49 AM CDT</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_end_time">12:51 PM EDT</td>
<td class="gt_row gt_right" headers="Longest stretches  distance_miles">262</td>
<td class="gt_row gt_left" headers="Longest stretches  origin_nice"><div class="gt_from_md">
<p>Quality Inn<br><span class="smaller-address">2741 York Rd, Pleasant View, TN 37146, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Longest stretches  destination_nice"><div class="gt_from_md">
<p>Home<br><span class="smaller-address">Atlanta, GA, USA</span></p>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Longest stretches  day_month">June 23</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_time">3 hours 35 minutes</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_start_time">1:19 PM CDT</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_end_time">4:54 PM CDT</td>
<td class="gt_row gt_right" headers="Longest stretches  distance_miles">198</td>
<td class="gt_row gt_left" headers="Longest stretches  origin_nice"><div class="gt_from_md">
<p>McDonald’s<br><span class="smaller-address">120 SE 7th St, Stuart, IA 50250, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Longest stretches  destination_nice"><div class="gt_from_md">
<p>Inn at Old Nauvoo<br><span class="smaller-address">1875 Mulholland St, Nauvoo, IL 62354, USA</span></p>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Longest stretches  day_month">June 20</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_time">3 hours 31 minutes</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_start_time">8:58 AM MDT</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_end_time">12:30 PM MDT</td>
<td class="gt_row gt_right" headers="Longest stretches  distance_miles">244</td>
<td class="gt_row gt_left" headers="Longest stretches  origin_nice"><div class="gt_from_md">
<p>My aunt’s house<br><span class="smaller-address">Spanish Fork, UT, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Longest stretches  destination_nice"><div class="gt_from_md">
<p>My sister’s house<br><span class="smaller-address">Shelley, ID, USA</span></p>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Longest stretches  day_month">June 6</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_time">3 hours 9 minutes</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_start_time">12:18 PM MDT</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_end_time">3:28 PM MDT</td>
<td class="gt_row gt_right" headers="Longest stretches  distance_miles">191</td>
<td class="gt_row gt_left" headers="Longest stretches  origin_nice"><div class="gt_from_md">
<p>Carlsbad Caverns National Park<br><span class="smaller-address">Carlsbad, NM 88220, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Longest stretches  destination_nice"><div class="gt_from_md">
<p>Conoco<br><span class="smaller-address">1307 8th St, Vaughn, NM 88353, USA</span></p>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Longest stretches  day_month">June 7</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_time">3 hours 7 minutes</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_start_time">5:39 PM MDT</td>
<td class="gt_row gt_left" headers="Longest stretches  nice_end_time">8:46 PM MDT</td>
<td class="gt_row gt_right" headers="Longest stretches  distance_miles">163</td>
<td class="gt_row gt_left" headers="Longest stretches  origin_nice"><div class="gt_from_md">
<p>Glazier’s Market<br><span class="smaller-address">264 S 100 E, Kanab, UT 84741, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Longest stretches  destination_nice"><div class="gt_from_md">
<p>My aunt’s cabin<br><span class="smaller-address">Grover, UT, USA</span></p>
</div></td>
</tr>
<tr class="gt_group_heading_row odd">
<td colspan="7" id="Shortest stretches" class="gt_group_heading" data-quarto-table-cell-role="th" style="font-weight: bold; background-color: #F2F2F2" scope="colgroup">Shortest stretches</td>
</tr>
<tr class="gt_row_group_first even">
<td class="gt_row gt_left" headers="Shortest stretches  day_month">June 22</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_time">21 minutes</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_start_time">3:35 PM MDT</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_end_time">3:56 PM MDT</td>
<td class="gt_row gt_right" headers="Shortest stretches  distance_miles">15</td>
<td class="gt_row gt_left" headers="Shortest stretches  origin_nice"><div class="gt_from_md">
<p>Mount Rushmore National Memorial<br><span class="smaller-address">13000 SD-244, Keystone, SD 57751, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Shortest stretches  destination_nice"><div class="gt_from_md">
<p>Holiday Stationstores<br><span class="smaller-address">Caregiver Cir, Rapid City, SD 57701, USA</span></p>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Shortest stretches  day_month">June 24</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_time">25 minutes</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_start_time">12:20 PM CDT</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_end_time">12:45 PM CDT</td>
<td class="gt_row gt_right" headers="Shortest stretches  distance_miles">18</td>
<td class="gt_row gt_left" headers="Shortest stretches  origin_nice"><div class="gt_from_md">
<p>Smith Family Cemetery<br><span class="smaller-address">Nauvoo, IL 62354, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Shortest stretches  destination_nice"><div class="gt_from_md">
<p>Carthage Jail<br><span class="smaller-address">310 Buchanan St, Carthage, IL 62321, USA</span></p>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Shortest stretches  day_month">June 6</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_time">33 minutes</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_start_time">8:24 AM MDT</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_end_time">8:57 AM MDT</td>
<td class="gt_row gt_right" headers="Shortest stretches  distance_miles">22</td>
<td class="gt_row gt_left" headers="Shortest stretches  origin_nice"><div class="gt_from_md">
<p>Stevens Inn<br><span class="smaller-address">1829 S Canal St, Carlsbad, NM 88220, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Shortest stretches  destination_nice"><div class="gt_from_md">
<p>Carlsbad Caverns National Park<br><span class="smaller-address">Carlsbad, NM 88220, USA</span></p>
</div></td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Shortest stretches  day_month">June 4</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_time">39 minutes</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_start_time">3:26 PM CDT</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_end_time">4:06 PM CDT</td>
<td class="gt_row gt_right" headers="Shortest stretches  distance_miles">44</td>
<td class="gt_row gt_left" headers="Shortest stretches  origin_nice"><div class="gt_from_md">
<p>Exxon<br><span class="smaller-address">1410 Gum Cove Rd, Vinton, LA 70668, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Shortest stretches  destination_nice"><div class="gt_from_md">
<p>Love’s Travel Stop<br><span class="smaller-address">7495 Smith Rd, Beaumont, TX 77713, USA</span></p>
</div></td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Shortest stretches  day_month">June 20</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_time">42 minutes</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_start_time">2:14 PM MDT</td>
<td class="gt_row gt_left" headers="Shortest stretches  nice_end_time">2:56 PM MDT</td>
<td class="gt_row gt_right" headers="Shortest stretches  distance_miles">35</td>
<td class="gt_row gt_left" headers="Shortest stretches  origin_nice"><div class="gt_from_md">
<p>My sister’s house<br><span class="smaller-address">Shelley, ID, USA</span></p>
</div></td>
<td class="gt_row gt_left" headers="Shortest stretches  destination_nice"><div class="gt_from_md">
<p>AmericInn by Wyndham Rexburg BYUI<br><span class="smaller-address">1098 Golden Beauty Dr, Rexburg, ID 83440, USA</span></p>
</div></td>
</tr>
</tbody>
<tfoot class="gt_footnotes"><tr class="odd">
<td colspan="7" class="gt_footnote">Stretches less than 10 miles omitted (like if we had lunch somewhere and drove down the street to get gas).</td>
</tr></tfoot>
</table>
</div>
</div>
</div>
</figure>
</div>
</div>
<p>What about the stops? How long was a typical gas/bathroom break? <a href="#fig-stop-duration-dist" class="quarto-xref">Figure&nbsp;4</a> shows the distribution of the duration of all the non-touristy stops, and it actually reveals a pretty neat trimodal distribution! We had three general types of stops:</p>
<ul>
<li>
<strong>Fast</strong> (<em>10ish minutes</em>): stops for switching drivers, getting gas right after a sightseeing visit, or letting one kid go to the bathroom</li>
<li>
<strong>Standard</strong> (<em>25ish minutes</em>): stops where we got gas and had everyone go to the bathroom</li>
<li>
<strong>Meal</strong> (<em>40ish minutes</em>): stops where we got gas, went to the bathroom, ate food (typically peanut butter sandwiches that we made in the hotel in the morning), and walked around to stretch</li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34" data-cap-location="margin"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Cut duration into three categories</span></span>
<span><span class="va">places_hist_data</span> <span class="op">&lt;-</span> <span class="va">place_visits</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">driving_stop</span> <span class="op">==</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">15</span>, <span class="fl">35</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">places_hist_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">range</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">10</span>, y <span class="op">=</span> <span class="fl">7.75</span>, label <span class="op">=</span> <span class="st">"Fast stop"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">6</span>, xend <span class="op">=</span> <span class="fl">14</span>, y <span class="op">=</span> <span class="fl">7.35</span>, yend <span class="op">=</span> <span class="fl">7.35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">25</span>, y <span class="op">=</span> <span class="fl">7.75</span>, label <span class="op">=</span> <span class="st">"Standard gas + bathroom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">16</span>, xend <span class="op">=</span> <span class="fl">34</span>, y <span class="op">=</span> <span class="fl">7.35</span>, yend <span class="op">=</span> <span class="fl">7.35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"text"</span>, x <span class="op">=</span> <span class="fl">42.5</span>, y <span class="op">=</span> <span class="fl">7.75</span>, label <span class="op">=</span> <span class="st">"Gas + bathroom + meal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"segment"</span>, x <span class="op">=</span> <span class="fl">36</span>, xend <span class="op">=</span> <span class="fl">49</span>, y <span class="op">=</span> <span class="fl">7.35</span>, yend <span class="op">=</span> <span class="fl">7.35</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Minutes"</span>, y <span class="op">=</span> <span class="st">"Count"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-stop-duration-dist" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center" data-cap-location="margin">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-stop-duration-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="index_files/figure-html/fig-stop-duration-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%">
</div>
<figcaption class="quarto-float-caption-margin quarto-float-caption quarto-float-fig margin-caption" id="fig-stop-duration-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Distribution of non-sightseeing stops for the first four days of the trip
</figcaption></figure>
</div>
</div>
</div>
</section><section id="elevation-over-time" class="level2 page-columns page-full"><h2 class="anchored" data-anchor-id="elevation-over-time">Elevation over time</h2>
<p>And finally, just for fun since Google tracked this data and we might as well do something neat with it, we can look at how much the elevation changed over the course of the trip. Atlanta is 1,000 feet above sea level, and Utah County is 4,500 feed above sea level, but the 3,500-foot increase in elevation was hardly uniform. We dropped down to below sea level in New Orleans, climbed up to above 4,000 feet in Carlsbad (it turns out that Carlsbad Caverns is on top of a big mountain), and then climbed rapidly up to the Grand Canyon and Southern Utah in general at 7,500ish feet until dropping down to 4,500 feet at our final destination in Utah.</p>
<p>On the way back, we stayed at around 4,500ish feet until Yellowstone, where we hit the highest elevation of the whole trip at 8,530 feet. We then gradually worked our way down toward sea level as we traveled further east, finally hitting 1,000ish feet at the Mississippi River at Nauvoo, Illinois, where we mostly stayed until getting home (with a little Appalachian spike near the end).</p>
<div class="cell page-columns page-full" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">elevation_data</span> <span class="op">&lt;-</span> <span class="va">all_locations</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>elevation <span class="op">=</span> <span class="fu">meters_to_feet</span><span class="op">(</span><span class="va">altitude</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">elevation_stops</span> <span class="op">&lt;-</span> <span class="fu">tribble</span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">id</span>,                       <span class="op">~</span><span class="va">direction</span>,  <span class="op">~</span><span class="va">nudge_direction</span>, <span class="op">~</span><span class="va">stop_label</span>,</span>
<span>  <span class="st">"ChIJv30_Xw-mIIYRpt26QbLBh58"</span>, <span class="st">"There"</span>, <span class="st">"up"</span>, <span class="st">"New Orleans,\nLouisiana"</span>,</span>
<span>  <span class="st">"ChIJX4k2TVVfXIYRIsTnhA-P-Rc"</span>, <span class="st">"There"</span>, <span class="st">"down"</span>, <span class="st">"San Antonio,\nTexas"</span>,</span>
<span>  <span class="st">"ChIJW9e4xBN544YRvbI7vfc91G4"</span>, <span class="st">"There"</span>, <span class="st">"down"</span>, <span class="st">"Carlsbad Caverns,\nNew Mexico"</span>,</span>
<span>  <span class="st">"ChIJrSLbJJIQM4cR4l5HTswDY8k"</span>, <span class="st">"There"</span>, <span class="st">"up"</span>, <span class="st">"The Grand Canyon,\nArizona"</span>,</span>
<span>  <span class="st">"ChIJU6LnB_8ASocRB_9PSFPsO94"</span>, <span class="st">"There"</span>, <span class="st">"up"</span>, <span class="st">"Capitol Reef,\nUtah"</span>,</span>
<span>  <span class="st">"ChIJz6VI3AMLVFMREvSOw9M0VR4"</span>, <span class="st">"Back again"</span>, <span class="st">"down"</span>, <span class="st">"Rexburg,\nIdaho"</span>,</span>
<span>  <span class="st">"ChIJSWHsxv8JTlMR82z8b6wF_BM"</span>, <span class="st">"Back again"</span>, <span class="st">"up"</span>, <span class="st">"Yellowstone,\nWyoming"</span>,</span>
<span>  <span class="st">"ChIJ39Y-tdg1fYcRQcZcBb499do"</span>, <span class="st">"Back again"</span>, <span class="st">"up"</span>, <span class="st">"Mount Rushmore,\nSouth Dakota"</span>,</span>
<span>  <span class="st">"ChIJDUPPu3Im54cRKj6BG8UkOko"</span>, <span class="st">"Back again"</span>, <span class="st">"down"</span>, <span class="st">"Nauvoo,\nIllinois"</span>,</span>
<span>  <span class="st">"ChIJtUcJ-n36ZIgRhzY2PM19eWA"</span>, <span class="st">"Back again"</span>, <span class="st">"up"</span>, <span class="st">"Nashville,\nTennessee"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">stops_to_show</span> <span class="op">&lt;-</span> <span class="va">place_visits</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">st_drop_geometry</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">elevation_stops</span><span class="op">$</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">elevation_stops</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Magical new join_by(closest(...)) syntax for inexact, approximate matching</span></span>
<span>  <span class="co"># to get the closest elevation for the stop(!)</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">elevation_data</span>, by <span class="op">=</span> <span class="fu">join_by</span><span class="op">(</span><span class="fu">closest</span><span class="op">(</span><span class="va">startTimestamp_local</span> <span class="op">&gt;=</span> <span class="va">timestamp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="co"># Get rid of duplicate ids</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">elevation_data</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">timestamp_local</span>, y <span class="op">=</span> <span class="va">elevation</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">stops_to_show</span>, <span class="va">nudge_direction</span> <span class="op">==</span> <span class="st">"up"</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">startTimestamp_local</span>, label <span class="op">=</span> <span class="va">stop_label</span><span class="op">)</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">2500</span>, direction <span class="op">=</span> <span class="st">"y"</span>, lineheight <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span>,</span>
<span>    color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, segment.color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>, seed <span class="op">=</span> <span class="fl">1234</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_text_repel</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">stops_to_show</span>, <span class="va">nudge_direction</span> <span class="op">==</span> <span class="st">"down"</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">startTimestamp_local</span>, label <span class="op">=</span> <span class="va">stop_label</span><span class="op">)</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="op">-</span><span class="fl">1000</span>, lineheight <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"Overpass ExtraBold"</span>,</span>
<span>    color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">8</span><span class="op">]</span>, segment.color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span>, seed <span class="op">=</span> <span class="fl">1234</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%B %e"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8000</span>, by <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu">label_comma</span><span class="op">(</span>suffix <span class="op">=</span> <span class="st">" ft."</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"Elevation"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">direction</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_roadtrip</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display page-columns page-full">
<div id="fig-elevation" class="quarto-float quarto-figure quarto-figure-center anchored page-columns page-full" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure page-columns page-full"><div aria-describedby="fig-elevation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="page-columns page-full">
<img src="index_files/figure-html/fig-elevation-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img column-page-right" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-elevation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Elevation over the course of the trip
</figcaption></figure>
</div>
</div>
</div>
</section></section><section id="the-end" class="level1"><h1>The end</h1>
<p>This only scratches the surface of what you can do with your Google Location History data. There’s a ton of other stuff in those JSON files, including second-by-second data of each <code>activitySegment</code> (though those entries seem to use Google’s internal <code>ChIJ********</code> <a href="https://developers.google.com/maps/documentation/places/web-service/place-id">Place IDs</a> and not latitude and longitude coordinates), sub-visits for <code>placeVisits</code>, and lots of other stuff. Smarter people than me can dig through and figure out that data!</p>


<!-- -->

</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{heiss2023,
  author = {Heiss, Andrew},
  title = {Road Trip Analysis! {How} to Use and Play with {Google}
    {Location} {History} in {R}},
  date = {2023-07-03},
  url = {https://www.andrewheiss.com/blog/2023/07/03/using-google-location-history-with-r-roadtrip/},
  doi = {10.59350/24rwv-k9n62},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-heiss2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Heiss, Andrew. 2023. <span>“Road Trip Analysis! How to Use and Play with
Google Location History in R.”</span> July 3, 2023. <a href="https://doi.org/10.59350/24rwv-k9n62">https://doi.org/10.59350/24rwv-k9n62</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.andrewheiss\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="andrewheiss/ath-quarto" data-repo-id="R_kgDOIg6EJQ" data-category="Blog comments" data-category-id="DIC_kwDOIg6EJc4CSz92" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb36" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Road trip analysis! How to use and play with Google Location History in R"</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-07-03</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Learn how to use R to load and clean and play with all the location history data Google keeps about you and look at some neat plots and tables about our 5,000-mile summer road trip along the way"</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> index_files/figure-html/fig-map-with-dates-1.png</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="an">twitter-card:</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="co">  image: "index_files/figure-html/fig-map-with-dates-1.png"</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="an">open-graph:</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">  image: "index_files/figure-html/fig-map-with-dates-1.png"</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - r</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyverse</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - ggplot</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - gis</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - maps</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="co">    fig-cap-location: bottom</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="an">resources:</span><span class="co"> </span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - clean-data-real.R</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a><span class="an">doi:</span><span class="co"> 10.59350/24rwv-k9n62</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(fig.align = "center", fig.retina = 3,</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a><span class="in">                      fig.width = 7, fig.height = (7 / 1.618),</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a><span class="in">                      out.width = "100%", collapse = TRUE,</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a><span class="in">                      dev = "ragg_png",</span></span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a><span class="in">                      cache.extra = 123)  # Change number to invalidate cache</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(message = FALSE)</span></span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a><span class="in">options(digits = 4, width = 300,</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a><span class="in">        dplyr.summarise.inform = FALSE)</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>As I explained <span class="co">[</span><span class="ot">in my previous blog post</span><span class="co">](https://www.andrewheiss.com/blog/2023/06/01/geocoding-routing-openstreetmap-r/)</span>, in June 2023 I drove my family across the country in a 5,000-mile roundtrip odyssey from Atlanta, Georgia to just-south-of-Salt Lake City, Utah, and back again. Instead of taking a direct path through the middle the United States, we decided to hit as many tourist-y stops along the way, making a big circle along the southern US on the way out and along the northern US on the way back, stopping at a dozen really neat places, including:</span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">The French Quarter</span><span class="co">](https://en.wikipedia.org/wiki/French_Quarter)</span> in New Orleans, Louisiana</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">The Alamo</span><span class="co">](https://en.wikipedia.org/wiki/Alamo_Mission)</span> in San Antonio, Texas</span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Carlsbad Caverns National Park</span><span class="co">](https://en.wikipedia.org/wiki/Carlsbad_Caverns_National_Park)</span> in New Mexico</span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Grand Canyon National Park</span><span class="co">](https://en.wikipedia.org/wiki/Grand_Canyon)</span> in Arizona</span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Capitol Reef National Park</span><span class="co">](https://en.wikipedia.org/wiki/Capitol_Reef_National_Park)</span> in southern Utah (staying at <span class="co">[</span><span class="ot">my aunt's cabin</span><span class="co">](https://www.heissatopia.com/search?q=Grover)</span> in Grover, Utah)</span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Goblin Valley</span><span class="co">](https://en.wikipedia.org/wiki/Goblin_Valley_State_Park)</span> in southern Utah</span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Yellowstone National Park</span><span class="co">](https://en.wikipedia.org/wiki/Yellowstone_National_Park)</span> in Wyoming</span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Devil's Tower National Monument</span><span class="co">](https://en.wikipedia.org/wiki/Devils_Tower)</span> in Wyoming</span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Mount Rushmore National Memorial</span><span class="co">](https://en.wikipedia.org/wiki/Mount_Rushmore)</span> in South Dakota</span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Nauvoo, Illinois</span><span class="co">](https://en.wikipedia.org/wiki/Nauvoo,_Illinois)</span> and other <span class="co">[</span><span class="ot">LDS history</span><span class="co">](https://www.churchofjesuschrist.org/learn/locations/historic-nauvoo)</span> locations like the <span class="co">[</span><span class="ot">Smith Family Cemetery</span><span class="co">](https://en.wikipedia.org/wiki/Smith_Family_Cemetery)</span>, <span class="co">[</span><span class="ot">Winter Quarters</span><span class="co">]</span>(https://en.wikipedia.org/wiki/Winter_Quarters_(North_Omaha,_Nebraska)), and <span class="co">[</span><span class="ot">Carthage Jail</span><span class="co">](https://en.wikipedia.org/wiki/Carthage_Jail)</span></span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pictures!</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>Check out the <span class="co">[</span><span class="ot">#Roadtrip2023 tag on our blog</span><span class="co">](https://www.heissatopia.com/search/label/%23Roadtrip2023)</span> for photos and details of all these places.</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>In an effort to stay On Brand™, I wanted to keep a log of all our stops so I could go back and analyze the trip. How many miles would we drive? How much time would we spend in the car? How long would each gas stop and bathroom break be? Could I make some sort of map showing our journey?</span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>So, at the first gas station we stopped at in Alabama, I started a new file in my phone's Notes app and dutifully wrote down the arrival time, name and address of the gas station, and departure time. I had a nascent data file and was ready to use it through the trip.</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>About an hour after leaving our second gas station stop just outside Mississippi, I realized that I forgot to write down anything about the second gas station stop. My data collection process died after a single entry.</span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>I was initially disappointed that I wouldn't have any sort of data to work with at the end of the trip, but then I remembered that my phone was tracking every part of the whole trip through Google Maps. When we got to the first hotel, I searched Google to see if it was possible to export your location history from Google Maps and saw that it was, so I gave up on trying to keep my own log and outsourced all that to Google instead. I didn't know what exactly Google was tracking, but I figured it would at least have the date, time, and location of where we went, so that was good enough.</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>Right after we got home from our trip last week, I exported my data and was shocked by how much detail Google actually had. The exported JSON files contained 100,000+ location entries going all the back to 2013 (!!!). Parsing and sifting through and working with all this data initially seemed overwhelming (especially since Google doesn't actually provide any formal documentation for these files!), but once I worked through a few tricky issues, it was surprisingly straightforward to make maps, calculate distances and times, and do all sorts of other fun things with the data.</span>
<span id="cb36-68"><a href="#cb36-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-69"><a href="#cb36-69" aria-hidden="true" tabindex="-1"></a>So in this post I do three things:</span>
<span id="cb36-70"><a href="#cb36-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-71"><a href="#cb36-71" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span><span class="co">[</span><span class="ot">Give a basic overview</span><span class="co">](#anatomy-of-google-takeout-location-history-data)</span> of what exactly Google tracks in your Location History and how they store it across dozens of JSON files</span>
<span id="cb36-72"><a href="#cb36-72" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span><span class="co">[</span><span class="ot">Show</span><span class="co">](#loading-and-playing-with-your-location-history-in-r)</span> how to load, process, and clean this data using R</span>
<span id="cb36-73"><a href="#cb36-73" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span><span class="co">[</span><span class="ot">Create</span><span class="co">](#road-trip-analysis)</span> some neat plots and tables with details from our mega summer road trip around the US</span>
<span id="cb36-74"><a href="#cb36-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-75"><a href="#cb36-75" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb36-76"><a href="#cb36-76" aria-hidden="true" tabindex="-1"></a><span class="fu">### Who this post is for</span></span>
<span id="cb36-77"><a href="#cb36-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-78"><a href="#cb36-78" aria-hidden="true" tabindex="-1"></a>Here's what I assume you know:</span>
<span id="cb36-79"><a href="#cb36-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-80"><a href="#cb36-80" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You're familiar with <span class="co">[</span><span class="ot">R</span><span class="co">](https://www.r-project.org/)</span> and the <span class="co">[</span><span class="ot">tidyverse</span><span class="co">](https://www.tidyverse.org/)</span> (particularly <span class="co">[</span><span class="ot">{dplyr}</span><span class="co">](https://dplyr.tidyverse.org/)</span> and <span class="co">[</span><span class="ot">{ggplot2}</span><span class="co">](https://ggplot2.tidyverse.org/)</span>).</span>
<span id="cb36-81"><a href="#cb36-81" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>You're somewhat familiar with <span class="co">[</span><span class="ot">{sf}</span><span class="co">](https://r-spatial.github.io/sf/)</span> for working with geographic data. I have a <span class="co">[</span><span class="ot">whole tutorial here</span><span class="co">](https://datavizs23.classes.andrewheiss.com/example/12-example.html)</span> and a <span class="co">[</span><span class="ot">simplified one here</span><span class="co">](https://www.andrewheiss.com/blog/2023/04/26/middle-earth-mapping-sf-r-gis/#lightning-quick-overview-of-sf-and-shapefiles)</span> and the <span class="co">[</span><span class="ot">{sf} documentation has a ton of helpful vignettes and blog posts</span><span class="co">](https://r-spatial.github.io/sf/)</span>, and there are also two free books about it: <span class="co">[</span><span class="ot">*Spatial Data Science*</span><span class="co">](https://r-spatial.org/book/)</span> and <span class="co">[</span><span class="ot">*Geocomputation with R*</span><span class="co">](https://r.geocompx.org/)</span>. Also <span class="co">[</span><span class="ot">check this fantastic post out</span><span class="co">](https://www.jessesadler.com/post/simple-feature-objects/)</span> to learn more about the anatomy of a <span class="in">`geometry`</span> column with {sf}.</span>
<span id="cb36-82"><a href="#cb36-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-83"><a href="#cb36-83" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-84"><a href="#cb36-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-85"><a href="#cb36-85" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb36-86"><a href="#cb36-86" aria-hidden="true" tabindex="-1"></a><span class="fu">### Follow along!</span></span>
<span id="cb36-87"><a href="#cb36-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-88"><a href="#cb36-88" aria-hidden="true" tabindex="-1"></a>If you want to follow along with this post, I've created mostly-anonymized excerpts of the main JSON files for the first four days of this road trip that you can download:</span>
<span id="cb36-89"><a href="#cb36-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-90"><a href="#cb36-90" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">{{&lt; fa file-zipper &gt;}} `data.zip`</span><span class="co">](data.zip)</span></span>
<span id="cb36-91"><a href="#cb36-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-92"><a href="#cb36-92" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-93"><a href="#cb36-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-94"><a href="#cb36-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-95"><a href="#cb36-95" aria-hidden="true" tabindex="-1"></a><span class="fu"># Packages and functions</span></span>
<span id="cb36-96"><a href="#cb36-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-97"><a href="#cb36-97" aria-hidden="true" tabindex="-1"></a>Before officially getting started, let’s load all the packages we need and create some helpful functions and variables:</span>
<span id="cb36-98"><a href="#cb36-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-99"><a href="#cb36-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-libraries, warning=FALSE, message=FALSE}</span></span>
<span id="cb36-100"><a href="#cb36-100" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)     # ggplot, dplyr, and friends</span></span>
<span id="cb36-101"><a href="#cb36-101" aria-hidden="true" tabindex="-1"></a><span class="in">library(jsonlite)      # Read JSON files</span></span>
<span id="cb36-102"><a href="#cb36-102" aria-hidden="true" tabindex="-1"></a><span class="in">library(sf)            # Handle spatial data in a tidy way</span></span>
<span id="cb36-103"><a href="#cb36-103" aria-hidden="true" tabindex="-1"></a><span class="in">library(tigris)        # Access deographic data from the US Census</span></span>
<span id="cb36-104"><a href="#cb36-104" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggrepel)       # Nicer non-overlapping labels</span></span>
<span id="cb36-105"><a href="#cb36-105" aria-hidden="true" tabindex="-1"></a><span class="in">library(glue)          # Easier string interpolation</span></span>
<span id="cb36-106"><a href="#cb36-106" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)        # Nicer labeling functions</span></span>
<span id="cb36-107"><a href="#cb36-107" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)     # Combine plots nicely</span></span>
<span id="cb36-108"><a href="#cb36-108" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggspatial)     # Nicer map features like scale bars</span></span>
<span id="cb36-109"><a href="#cb36-109" aria-hidden="true" tabindex="-1"></a><span class="in">library(leaflet)       # Make interactive maps</span></span>
<span id="cb36-110"><a href="#cb36-110" aria-hidden="true" tabindex="-1"></a><span class="in">library(lutz)          # Look up time zones for lat/lon coordinates</span></span>
<span id="cb36-111"><a href="#cb36-111" aria-hidden="true" tabindex="-1"></a><span class="in">library(gt)            # Make fancy tables</span></span>
<span id="cb36-112"><a href="#cb36-112" aria-hidden="true" tabindex="-1"></a><span class="in">library(rcartocolor)   # Use CARTO colors (https://carto.com/carto-colors/)</span></span>
<span id="cb36-113"><a href="#cb36-113" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggnewscale)    # Use multiple scales for the same aesthetic in ggplot</span></span>
<span id="cb36-114"><a href="#cb36-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-115"><a href="#cb36-115" aria-hidden="true" tabindex="-1"></a><span class="in"># Custom ggplot themes to make pretty plots</span></span>
<span id="cb36-116"><a href="#cb36-116" aria-hidden="true" tabindex="-1"></a><span class="in"># Get the font at https://fonts.google.com/specimen/Overpass</span></span>
<span id="cb36-117"><a href="#cb36-117" aria-hidden="true" tabindex="-1"></a><span class="in">theme_roadtrip &lt;- function() {</span></span>
<span id="cb36-118"><a href="#cb36-118" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(base_family = "Overpass Light") +</span></span>
<span id="cb36-119"><a href="#cb36-119" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.grid.minor = element_blank(),</span></span>
<span id="cb36-120"><a href="#cb36-120" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.title = element_text(family = "Overpass", face = "bold"),</span></span>
<span id="cb36-121"><a href="#cb36-121" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title = element_text(family = "Overpass Medium"),</span></span>
<span id="cb36-122"><a href="#cb36-122" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.x = element_text(hjust = 0),</span></span>
<span id="cb36-123"><a href="#cb36-123" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.y = element_text(hjust = 1),</span></span>
<span id="cb36-124"><a href="#cb36-124" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.text = element_text(</span></span>
<span id="cb36-125"><a href="#cb36-125" aria-hidden="true" tabindex="-1"></a><span class="in">        family = "Overpass ExtraBold", face = "plain",</span></span>
<span id="cb36-126"><a href="#cb36-126" aria-hidden="true" tabindex="-1"></a><span class="in">        size = rel(1), hjust = 0),</span></span>
<span id="cb36-127"><a href="#cb36-127" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.background = element_rect(fill = "grey90", color = NA))</span></span>
<span id="cb36-128"><a href="#cb36-128" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-129"><a href="#cb36-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-130"><a href="#cb36-130" aria-hidden="true" tabindex="-1"></a><span class="in">theme_roadtrip_map &lt;- function() {</span></span>
<span id="cb36-131"><a href="#cb36-131" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_void(base_family = "Overpass Light") +</span></span>
<span id="cb36-132"><a href="#cb36-132" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(</span></span>
<span id="cb36-133"><a href="#cb36-133" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.title = element_text(family = "Overpass", face = "bold", hjust = 0.5),</span></span>
<span id="cb36-134"><a href="#cb36-134" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.text = element_text(</span></span>
<span id="cb36-135"><a href="#cb36-135" aria-hidden="true" tabindex="-1"></a><span class="in">        family = "Overpass ExtraBold", face = "plain",</span></span>
<span id="cb36-136"><a href="#cb36-136" aria-hidden="true" tabindex="-1"></a><span class="in">        size = rel(1.1), hjust = 0.5)</span></span>
<span id="cb36-137"><a href="#cb36-137" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-138"><a href="#cb36-138" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-139"><a href="#cb36-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-140"><a href="#cb36-140" aria-hidden="true" tabindex="-1"></a><span class="in"># Make labels use Overpass by default</span></span>
<span id="cb36-141"><a href="#cb36-141" aria-hidden="true" tabindex="-1"></a><span class="in">update_geom_defaults("label_repel", </span></span>
<span id="cb36-142"><a href="#cb36-142" aria-hidden="true" tabindex="-1"></a><span class="in">                     list(family = "Overpass",</span></span>
<span id="cb36-143"><a href="#cb36-143" aria-hidden="true" tabindex="-1"></a><span class="in">                          fontface = "plain"))</span></span>
<span id="cb36-144"><a href="#cb36-144" aria-hidden="true" tabindex="-1"></a><span class="in">update_geom_defaults("label", </span></span>
<span id="cb36-145"><a href="#cb36-145" aria-hidden="true" tabindex="-1"></a><span class="in">                     list(family = "Overpass",</span></span>
<span id="cb36-146"><a href="#cb36-146" aria-hidden="true" tabindex="-1"></a><span class="in">                          fontface = "plain"))</span></span>
<span id="cb36-147"><a href="#cb36-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-148"><a href="#cb36-148" aria-hidden="true" tabindex="-1"></a><span class="in">update_geom_defaults("text_repel", </span></span>
<span id="cb36-149"><a href="#cb36-149" aria-hidden="true" tabindex="-1"></a><span class="in">                     list(family = "Overpass",</span></span>
<span id="cb36-150"><a href="#cb36-150" aria-hidden="true" tabindex="-1"></a><span class="in">                          fontface = "plain"))</span></span>
<span id="cb36-151"><a href="#cb36-151" aria-hidden="true" tabindex="-1"></a><span class="in">update_geom_defaults("text", </span></span>
<span id="cb36-152"><a href="#cb36-152" aria-hidden="true" tabindex="-1"></a><span class="in">                     list(family = "Overpass",</span></span>
<span id="cb36-153"><a href="#cb36-153" aria-hidden="true" tabindex="-1"></a><span class="in">                          fontface = "plain"))</span></span>
<span id="cb36-154"><a href="#cb36-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-155"><a href="#cb36-155" aria-hidden="true" tabindex="-1"></a><span class="in"># CARTO Prism palette</span></span>
<span id="cb36-156"><a href="#cb36-156" aria-hidden="true" tabindex="-1"></a><span class="in"># https://carto.com/carto-colors/</span></span>
<span id="cb36-157"><a href="#cb36-157" aria-hidden="true" tabindex="-1"></a><span class="in">clrs &lt;- rcartocolor::carto_pal(name = "Prism")</span></span>
<span id="cb36-158"><a href="#cb36-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-159"><a href="#cb36-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-160"><a href="#cb36-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r get-us-states-fake, eval=FALSE}</span></span>
<span id="cb36-161"><a href="#cb36-161" aria-hidden="true" tabindex="-1"></a><span class="in">us_states &lt;- states(resolution = "20m", year = 2022, cb = TRUE)</span></span>
<span id="cb36-162"><a href="#cb36-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-163"><a href="#cb36-163" aria-hidden="true" tabindex="-1"></a><span class="in">lower_48 &lt;- us_states %&gt;% </span></span>
<span id="cb36-164"><a href="#cb36-164" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!(NAME %in% c("Alaska", "Hawaii", "Puerto Rico")))</span></span>
<span id="cb36-165"><a href="#cb36-165" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-166"><a href="#cb36-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-167"><a href="#cb36-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r get-us-states-actual, include=FALSE}</span></span>
<span id="cb36-168"><a href="#cb36-168" aria-hidden="true" tabindex="-1"></a><span class="in">states_file &lt;- "states.rds"</span></span>
<span id="cb36-169"><a href="#cb36-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-170"><a href="#cb36-170" aria-hidden="true" tabindex="-1"></a><span class="in">if (file.exists(states_file)) {</span></span>
<span id="cb36-171"><a href="#cb36-171" aria-hidden="true" tabindex="-1"></a><span class="in">  us_states &lt;- readRDS(states_file)</span></span>
<span id="cb36-172"><a href="#cb36-172" aria-hidden="true" tabindex="-1"></a><span class="in">} else {</span></span>
<span id="cb36-173"><a href="#cb36-173" aria-hidden="true" tabindex="-1"></a><span class="in">  us_states &lt;- states(resolution = "20m", year = 2022, cb = TRUE)</span></span>
<span id="cb36-174"><a href="#cb36-174" aria-hidden="true" tabindex="-1"></a><span class="in">  saveRDS(us_states, states_file)</span></span>
<span id="cb36-175"><a href="#cb36-175" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-176"><a href="#cb36-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-177"><a href="#cb36-177" aria-hidden="true" tabindex="-1"></a><span class="in">lower_48 &lt;- us_states %&gt;% </span></span>
<span id="cb36-178"><a href="#cb36-178" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(!(NAME %in% c("Alaska", "Hawaii", "Puerto Rico")))</span></span>
<span id="cb36-179"><a href="#cb36-179" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-180"><a href="#cb36-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-181"><a href="#cb36-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r helpful-functions}</span></span>
<span id="cb36-182"><a href="#cb36-182" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-183"><a href="#cb36-183" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "A bunch of helper functions that I've hidden because this chunk is long"</span></span>
<span id="cb36-184"><a href="#cb36-184" aria-hidden="true" tabindex="-1"></a><span class="in">#' Format difftime in minutes and hours</span></span>
<span id="cb36-185"><a href="#cb36-185" aria-hidden="true" tabindex="-1"></a><span class="in">#'</span></span>
<span id="cb36-186"><a href="#cb36-186" aria-hidden="true" tabindex="-1"></a><span class="in">#' This function takes a difftime input \code{x} and formats the result as a </span></span>
<span id="cb36-187"><a href="#cb36-187" aria-hidden="true" tabindex="-1"></a><span class="in">#' string indicating the number of hours and minutes in the duration.</span></span>
<span id="cb36-188"><a href="#cb36-188" aria-hidden="true" tabindex="-1"></a><span class="in">#'</span></span>
<span id="cb36-189"><a href="#cb36-189" aria-hidden="true" tabindex="-1"></a><span class="in">#' @param x A difftime input.</span></span>
<span id="cb36-190"><a href="#cb36-190" aria-hidden="true" tabindex="-1"></a><span class="in">#' @return A character vector of formatted duration strings.</span></span>
<span id="cb36-191"><a href="#cb36-191" aria-hidden="true" tabindex="-1"></a><span class="in">#' @examples</span></span>
<span id="cb36-192"><a href="#cb36-192" aria-hidden="true" tabindex="-1"></a><span class="in">#' x &lt;- as.difftime(c(93, 1007, 3056), units = "secs")</span></span>
<span id="cb36-193"><a href="#cb36-193" aria-hidden="true" tabindex="-1"></a><span class="in">#' fmt_duration(x)</span></span>
<span id="cb36-194"><a href="#cb36-194" aria-hidden="true" tabindex="-1"></a><span class="in">fmt_difftime &lt;- function(x) {</span></span>
<span id="cb36-195"><a href="#cb36-195" aria-hidden="true" tabindex="-1"></a><span class="in">  n_seconds &lt;- seconds(as.double(x, units = "secs"))</span></span>
<span id="cb36-196"><a href="#cb36-196" aria-hidden="true" tabindex="-1"></a><span class="in">  n_seconds &lt;- seconds_to_period(n_seconds)</span></span>
<span id="cb36-197"><a href="#cb36-197" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb36-198"><a href="#cb36-198" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- map_chr(n_seconds, \(n) {</span></span>
<span id="cb36-199"><a href="#cb36-199" aria-hidden="true" tabindex="-1"></a><span class="in">    if (as.numeric(n) &lt; 3600) {</span></span>
<span id="cb36-200"><a href="#cb36-200" aria-hidden="true" tabindex="-1"></a><span class="in">      # If this is less than an hour, don't format anything with hours</span></span>
<span id="cb36-201"><a href="#cb36-201" aria-hidden="true" tabindex="-1"></a><span class="in">      glue::glue("{MM} minutes", MM = minute(n))</span></span>
<span id="cb36-202"><a href="#cb36-202" aria-hidden="true" tabindex="-1"></a><span class="in">    } else {</span></span>
<span id="cb36-203"><a href="#cb36-203" aria-hidden="true" tabindex="-1"></a><span class="in">      # I only want to format this as a number of hours. If the duration is</span></span>
<span id="cb36-204"><a href="#cb36-204" aria-hidden="true" tabindex="-1"></a><span class="in">      # longer than 24 hours, seconds_to_period() rolls over into days (i.e.</span></span>
<span id="cb36-205"><a href="#cb36-205" aria-hidden="true" tabindex="-1"></a><span class="in">      # seconds_to_period(60 * 60 * 24) returns "1d 0H 0M 0S"), and it shows</span></span>
<span id="cb36-206"><a href="#cb36-206" aria-hidden="true" tabindex="-1"></a><span class="in">      # zero hours. So we extract the day part of the period, multiply it by 24,</span></span>
<span id="cb36-207"><a href="#cb36-207" aria-hidden="true" tabindex="-1"></a><span class="in">      # and add it to the hour component that we want to display</span></span>
<span id="cb36-208"><a href="#cb36-208" aria-hidden="true" tabindex="-1"></a><span class="in">      extra_day_hours &lt;- day(n) * 24</span></span>
<span id="cb36-209"><a href="#cb36-209" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb36-210"><a href="#cb36-210" aria-hidden="true" tabindex="-1"></a><span class="in">      glue::glue("{HH} hour{s} {MM} minutes",</span></span>
<span id="cb36-211"><a href="#cb36-211" aria-hidden="true" tabindex="-1"></a><span class="in">        HH = scales::label_comma()(hour(n) + extra_day_hours),</span></span>
<span id="cb36-212"><a href="#cb36-212" aria-hidden="true" tabindex="-1"></a><span class="in">        MM = minute(n),</span></span>
<span id="cb36-213"><a href="#cb36-213" aria-hidden="true" tabindex="-1"></a><span class="in">        s = ifelse(hour(n) == 1, "", "s")</span></span>
<span id="cb36-214"><a href="#cb36-214" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb36-215"><a href="#cb36-215" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb36-216"><a href="#cb36-216" aria-hidden="true" tabindex="-1"></a><span class="in">  })</span></span>
<span id="cb36-217"><a href="#cb36-217" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb36-218"><a href="#cb36-218" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb36-219"><a href="#cb36-219" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-220"><a href="#cb36-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-221"><a href="#cb36-221" aria-hidden="true" tabindex="-1"></a><span class="in">fmt_miles &lt;- scales::label_number(accuracy = 10, suffix = " miles", big.mark = ",")</span></span>
<span id="cb36-222"><a href="#cb36-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-223"><a href="#cb36-223" aria-hidden="true" tabindex="-1"></a><span class="in">miles_to_meters &lt;- function(x) {</span></span>
<span id="cb36-224"><a href="#cb36-224" aria-hidden="true" tabindex="-1"></a><span class="in">  x * 1609.344</span></span>
<span id="cb36-225"><a href="#cb36-225" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-226"><a href="#cb36-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-227"><a href="#cb36-227" aria-hidden="true" tabindex="-1"></a><span class="in">meters_to_miles &lt;- function(x) {</span></span>
<span id="cb36-228"><a href="#cb36-228" aria-hidden="true" tabindex="-1"></a><span class="in">  x / 1609.344</span></span>
<span id="cb36-229"><a href="#cb36-229" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-230"><a href="#cb36-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-231"><a href="#cb36-231" aria-hidden="true" tabindex="-1"></a><span class="in">meters_to_feet &lt;- function(x) {</span></span>
<span id="cb36-232"><a href="#cb36-232" aria-hidden="true" tabindex="-1"></a><span class="in">  x * 3.28084</span></span>
<span id="cb36-233"><a href="#cb36-233" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-234"><a href="#cb36-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-235"><a href="#cb36-235" aria-hidden="true" tabindex="-1"></a><span class="in">km_to_miles &lt;- function(x) {</span></span>
<span id="cb36-236"><a href="#cb36-236" aria-hidden="true" tabindex="-1"></a><span class="in">  meters_to_miles(x * 1000)</span></span>
<span id="cb36-237"><a href="#cb36-237" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb36-238"><a href="#cb36-238" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-239"><a href="#cb36-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-240"><a href="#cb36-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-241"><a href="#cb36-241" aria-hidden="true" tabindex="-1"></a><span class="fu"># Anatomy of Google Takeout Location History data</span></span>
<span id="cb36-242"><a href="#cb36-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-243"><a href="#cb36-243" aria-hidden="true" tabindex="-1"></a>You can use <span class="co">[</span><span class="ot">Google Takeout</span><span class="co">](https://takeout.google.com/)</span> to export your personal location history if you have it enabled in Google Maps, which you probably do—it's the default. (Though after looking at this post you might be tempted to disable it—it's surprising to see how much fine-grained data Google has about your location over time!)</span>
<span id="cb36-244"><a href="#cb36-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-245"><a href="#cb36-245" aria-hidden="true" tabindex="-1"></a>Go to <span class="co">[</span><span class="ot">Google Takeout</span><span class="co">](https://takeout.google.com/)</span> and create a new export. You can select data from any number of Google's different services, but here we only want Location History, so scroll all the way down to it, check its box, and then select "Next Step":</span>
<span id="cb36-246"><a href="#cb36-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-247"><a href="#cb36-247" aria-hidden="true" tabindex="-1"></a><span class="al">![Location History in Google Takeout](img/google-takeout.png)</span>{width=60%}</span>
<span id="cb36-248"><a href="#cb36-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-249"><a href="#cb36-249" aria-hidden="true" tabindex="-1"></a>Tell it to e-mail you a link to a one-time .zip export and then wait a couple minutes to get the link. Download it, unzip it, and you're ready to go!</span>
<span id="cb36-250"><a href="#cb36-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-251"><a href="#cb36-251" aria-hidden="true" tabindex="-1"></a><span class="al">![Location History export options in Google Takeout](img/google-takeout-options.png)</span>{width=60%}</span>
<span id="cb36-252"><a href="#cb36-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-253"><a href="#cb36-253" aria-hidden="true" tabindex="-1"></a>Your Location History data includes a bunch of JSON files:</span>
<span id="cb36-254"><a href="#cb36-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-255"><a href="#cb36-255" aria-hidden="true" tabindex="-1"></a><span class="in">```default</span></span>
<span id="cb36-256"><a href="#cb36-256" aria-hidden="true" tabindex="-1"></a><span class="in">.</span></span>
<span id="cb36-257"><a href="#cb36-257" aria-hidden="true" tabindex="-1"></a><span class="in">├── Settings.json</span></span>
<span id="cb36-258"><a href="#cb36-258" aria-hidden="true" tabindex="-1"></a><span class="in">├── Records.json</span></span>
<span id="cb36-259"><a href="#cb36-259" aria-hidden="true" tabindex="-1"></a><span class="in">└── Semantic Location History</span></span>
<span id="cb36-260"><a href="#cb36-260" aria-hidden="true" tabindex="-1"></a><span class="in">    ├── 2013</span></span>
<span id="cb36-261"><a href="#cb36-261" aria-hidden="true" tabindex="-1"></a><span class="in">    ├── ...</span></span>
<span id="cb36-262"><a href="#cb36-262" aria-hidden="true" tabindex="-1"></a><span class="in">    ├── 2022</span></span>
<span id="cb36-263"><a href="#cb36-263" aria-hidden="true" tabindex="-1"></a><span class="in">    │   ├── 2022_APRIL.json</span></span>
<span id="cb36-264"><a href="#cb36-264" aria-hidden="true" tabindex="-1"></a><span class="in">    │   ├── ...</span></span>
<span id="cb36-265"><a href="#cb36-265" aria-hidden="true" tabindex="-1"></a><span class="in">    │   └── ...</span></span>
<span id="cb36-266"><a href="#cb36-266" aria-hidden="true" tabindex="-1"></a><span class="in">    └── 2023</span></span>
<span id="cb36-267"><a href="#cb36-267" aria-hidden="true" tabindex="-1"></a><span class="in">        ├── 2023_APRIL.json</span></span>
<span id="cb36-268"><a href="#cb36-268" aria-hidden="true" tabindex="-1"></a><span class="in">        ├── ...</span></span>
<span id="cb36-269"><a href="#cb36-269" aria-hidden="true" tabindex="-1"></a><span class="in">        └── ...</span></span>
<span id="cb36-270"><a href="#cb36-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-271"><a href="#cb36-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-272"><a href="#cb36-272" aria-hidden="true" tabindex="-1"></a>For whatever reason, Google doesn't provide any documentation for these files and their contents! Lots of the data and JSON entries are self-explanatory and fairly straightforward, but lots are not!. Fortunately <span class="co">[</span><span class="ot">this community project for the Location History Format</span><span class="co">](https://locationhistoryformat.com/)</span> provides excellent definitions, documentation, and JSON schemas for all these JSON files. </span>
<span id="cb36-273"><a href="#cb36-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-274"><a href="#cb36-274" aria-hidden="true" tabindex="-1"></a>Before loading these files into R and playing with them, understanding what's in them is useful, so let's take a quick tour.</span>
<span id="cb36-275"><a href="#cb36-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-276"><a href="#cb36-276" aria-hidden="true" tabindex="-1"></a><span class="fu">## Settings</span></span>
<span id="cb36-277"><a href="#cb36-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-278"><a href="#cb36-278" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb36-279"><a href="#cb36-279" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complete documentation for `Settings.json`</span></span>
<span id="cb36-280"><a href="#cb36-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-281"><a href="#cb36-281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Full documentation</span><span class="co">](https://locationhistoryformat.com/reference/settings/)</span></span>
<span id="cb36-282"><a href="#cb36-282" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-283"><a href="#cb36-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-284"><a href="#cb36-284" aria-hidden="true" tabindex="-1"></a><span class="in">`Settings.json`</span> is a small file that contains a bunch of device-specific settings and details, like the unique ID for your phone, the date and time when you added your phone to your account, and so on. It's not super important for working with your data—consider it extra metadata.</span>
<span id="cb36-285"><a href="#cb36-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-286"><a href="#cb36-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-287"><a href="#cb36-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Records</span></span>
<span id="cb36-288"><a href="#cb36-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-289"><a href="#cb36-289" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb36-290"><a href="#cb36-290" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complete documentation for `Records.json`</span></span>
<span id="cb36-291"><a href="#cb36-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-292"><a href="#cb36-292" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Basic overview</span><span class="co">](https://locationhistoryformat.com/guides/raw-location/)</span></span>
<span id="cb36-293"><a href="#cb36-293" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Full documentation</span><span class="co">](https://locationhistoryformat.com/reference/records/)</span></span>
<span id="cb36-294"><a href="#cb36-294" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-295"><a href="#cb36-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-296"><a href="#cb36-296" aria-hidden="true" tabindex="-1"></a><span class="in">`Records.json`</span> *is* important. This contains an entry for every time Google Maps recorded your location somewhere. Here's what a typical entry looks like (each entry is nested under a <span class="in">`"locations"`</span> property): </span>
<span id="cb36-297"><a href="#cb36-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-298"><a href="#cb36-298" aria-hidden="true" tabindex="-1"></a><span class="in">```json</span></span>
<span id="cb36-299"><a href="#cb36-299" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb36-300"><a href="#cb36-300" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"locations"</span><span class="fu">:</span> <span class="ot">[</span><span class="fu">{</span></span>
<span id="cb36-301"><a href="#cb36-301" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">300489450</span><span class="fu">,</span></span>
<span id="cb36-302"><a href="#cb36-302" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-899629451</span><span class="fu">,</span></span>
<span id="cb36-303"><a href="#cb36-303" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"accuracy"</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></span>
<span id="cb36-304"><a href="#cb36-304" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"velocity"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb36-305"><a href="#cb36-305" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"heading"</span><span class="fu">:</span> <span class="dv">329</span><span class="fu">,</span></span>
<span id="cb36-306"><a href="#cb36-306" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"altitude"</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb36-307"><a href="#cb36-307" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"verticalAccuracy"</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></span>
<span id="cb36-308"><a href="#cb36-308" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span><span class="fu">,</span></span>
<span id="cb36-309"><a href="#cb36-309" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"platformType"</span><span class="fu">:</span> <span class="st">"IOS"</span><span class="fu">,</span></span>
<span id="cb36-310"><a href="#cb36-310" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"serverTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T01:05:58.248Z"</span><span class="fu">,</span></span>
<span id="cb36-311"><a href="#cb36-311" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"deviceTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T01:05:57.559Z"</span><span class="fu">,</span></span>
<span id="cb36-312"><a href="#cb36-312" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"batteryCharging"</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb36-313"><a href="#cb36-313" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"formFactor"</span><span class="fu">:</span> <span class="st">"PHONE"</span><span class="fu">,</span></span>
<span id="cb36-314"><a href="#cb36-314" aria-hidden="true" tabindex="-1"></a>    <span class="dt">"timestamp"</span><span class="fu">:</span> <span class="st">"2023-06-04T00:52:57Z"</span></span>
<span id="cb36-315"><a href="#cb36-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">]</span></span>
<span id="cb36-316"><a href="#cb36-316" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span>
<span id="cb36-317"><a href="#cb36-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-318"><a href="#cb36-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-319"><a href="#cb36-319" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location details like <span class="in">`latitudeE7`</span> and <span class="in">`longitudeE7`</span>, multiplied by 10,000,000 so there are no decimals</span>
<span id="cb36-320"><a href="#cb36-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Accuracy details like <span class="in">`accuracy`</span>, or radius of the location measurement, in meters. Smaller numbers mean better precision.</span>
<span id="cb36-321"><a href="#cb36-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Position details like <span class="in">`heading`</span> (degrees east of north, from 0 to 359), <span class="in">`velocity`</span> (meters per second), <span class="in">`altitude`</span> (meters), and <span class="in">`verticalAccuracy`</span> (accuracy of altitude in meters; smaller means better precision)</span>
<span id="cb36-322"><a href="#cb36-322" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Device details like <span class="in">`deviceTag`</span> (Google's internal ID for your device; I changed mine to 0 in this post for privacy reasons), <span class="in">`platformType`</span> and <span class="in">`formFactor`</span> (type of device), <span class="in">`batteryCharging`</span> (whether your device was charging at the time), and some timestamps for the device time, server time, and UTC time.</span>
<span id="cb36-323"><a href="#cb36-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-324"><a href="#cb36-324" aria-hidden="true" tabindex="-1"></a>This is pretty straightforward to work with, since it's essentially rectangular data, or data that can be thought of as rows and columns. Each location entry in the JSON file is a row; each property is a column (<span class="in">`accuracy`</span> is 9, <span class="in">`altitude`</span> is 1, and so on), like this:</span>
<span id="cb36-325"><a href="#cb36-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-326"><a href="#cb36-326" aria-hidden="true" tabindex="-1"></a>| rowid | latitudeE7 | longitudeE7 | ... | formFactor | timestamp            |</span>
<span id="cb36-327"><a href="#cb36-327" aria-hidden="true" tabindex="-1"></a>|-------|------------|-------------|-----|------------|----------------------|</span>
<span id="cb36-328"><a href="#cb36-328" aria-hidden="true" tabindex="-1"></a>| 54383 | 300489450  | -899629451  | ... | PHONE      | 2023-06-04T00:52:57Z |</span>
<span id="cb36-329"><a href="#cb36-329" aria-hidden="true" tabindex="-1"></a>| 54384 | ...        | ...         | ... | ...        | ...                  |</span>
<span id="cb36-330"><a href="#cb36-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-331"><a href="#cb36-331" aria-hidden="true" tabindex="-1"></a>: Example dataset from Google Location History JSON</span>
<span id="cb36-332"><a href="#cb36-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-333"><a href="#cb36-333" aria-hidden="true" tabindex="-1"></a>The only data manipulation we need to do is modify the latitude and longitude columns. Both of those have been multiplied by 10,000,000 so that there are no decimal points in the coordinates (probably to avoid <span class="co">[</span><span class="ot">the weirdness inherent in floating point math</span><span class="co">](https://floating-point-gui.de/basic/)</span>). There's actually a hint about this in the column names for <span class="in">`latitudeE7`</span> and <span class="in">`longitudeE7`</span>—in R and most other programming languages, <span class="in">`1e7`</span> is computer notation for $10^7$. If we divide both those columns by 10,000,000, we'll get standard-looking geographic coordinates:</span>
<span id="cb36-334"><a href="#cb36-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-335"><a href="#cb36-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r divide-1e7-example}</span></span>
<span id="cb36-336"><a href="#cb36-336" aria-hidden="true" tabindex="-1"></a><span class="in">300489450 / 10000000</span></span>
<span id="cb36-337"><a href="#cb36-337" aria-hidden="true" tabindex="-1"></a><span class="in">-899629451 / 1e7  # We can write it as 1e7 too</span></span>
<span id="cb36-338"><a href="#cb36-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-339"><a href="#cb36-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-340"><a href="#cb36-340" aria-hidden="true" tabindex="-1"></a>For the sake of this post, the most important pieces of data here will be location (<span class="in">`latitudeE7`</span> and <span class="in">`longitudeE7`</span>), time (<span class="in">`timestamp`</span>), and elevation (<span class="in">`altitude`</span>). The velocity data might be cool to do something with some day, but I won't touch it for now.</span>
<span id="cb36-341"><a href="#cb36-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-342"><a href="#cb36-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-343"><a href="#cb36-343" aria-hidden="true" tabindex="-1"></a><span class="fu">## Semantic location history</span></span>
<span id="cb36-344"><a href="#cb36-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-345"><a href="#cb36-345" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb36-346"><a href="#cb36-346" aria-hidden="true" tabindex="-1"></a><span class="fu">### Complete documentation for semantic location history files</span></span>
<span id="cb36-347"><a href="#cb36-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-348"><a href="#cb36-348" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Basic overview</span><span class="co">](https://locationhistoryformat.com/guides/semantic-location/)</span></span>
<span id="cb36-349"><a href="#cb36-349" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Full documentation</span><span class="co">](https://locationhistoryformat.com/reference/semantic/)</span></span>
<span id="cb36-350"><a href="#cb36-350" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-351"><a href="#cb36-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-352"><a href="#cb36-352" aria-hidden="true" tabindex="-1"></a>These month-specific JSON files are super neat and full of really rich data. Each entry is one of two types of events: activity segments (<span class="in">`activitySegment`</span>) and place visits (<span class="in">`placeVisit`</span>).</span>
<span id="cb36-353"><a href="#cb36-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-354"><a href="#cb36-354" aria-hidden="true" tabindex="-1"></a>Here's what the beginning of a typical activity segment entry looks like (with a *lot* of parts omitted for space—<span class="co">[</span><span class="ot">click here for a complete example entry</span><span class="co">](data/example-activitySegment.json)</span>): </span>
<span id="cb36-355"><a href="#cb36-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-356"><a href="#cb36-356" aria-hidden="true" tabindex="-1"></a><span class="in">```json</span></span>
<span id="cb36-357"><a href="#cb36-357" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb36-358"><a href="#cb36-358" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"timelineObjects"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb36-359"><a href="#cb36-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb36-360"><a href="#cb36-360" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"activitySegment"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-361"><a href="#cb36-361" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"startLocation"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-362"><a href="#cb36-362" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">339703585</span><span class="fu">,</span></span>
<span id="cb36-363"><a href="#cb36-363" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-842416959</span><span class="fu">,</span></span>
<span id="cb36-364"><a href="#cb36-364" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-365"><a href="#cb36-365" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb36-366"><a href="#cb36-366" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb36-367"><a href="#cb36-367" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb36-368"><a href="#cb36-368" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"endLocation"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-369"><a href="#cb36-369" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">339786509</span><span class="fu">,</span></span>
<span id="cb36-370"><a href="#cb36-370" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-842006268</span><span class="fu">,</span></span>
<span id="cb36-371"><a href="#cb36-371" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-372"><a href="#cb36-372" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb36-373"><a href="#cb36-373" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb36-374"><a href="#cb36-374" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb36-375"><a href="#cb36-375" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"duration"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-376"><a href="#cb36-376" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"startTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-01T00:15:26.999Z"</span><span class="fu">,</span></span>
<span id="cb36-377"><a href="#cb36-377" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"endTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-01T00:28:47Z"</span></span>
<span id="cb36-378"><a href="#cb36-378" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb36-379"><a href="#cb36-379" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"distance"</span><span class="fu">:</span> <span class="dv">5483</span><span class="fu">,</span></span>
<span id="cb36-380"><a href="#cb36-380" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="fu">,</span></span>
<span id="cb36-381"><a href="#cb36-381" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"confidence"</span><span class="fu">:</span> <span class="st">"HIGH"</span><span class="fu">,</span></span>
<span id="cb36-382"><a href="#cb36-382" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"activities"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb36-383"><a href="#cb36-383" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb36-384"><a href="#cb36-384" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"IN_PASSENGER_VEHICLE"</span><span class="fu">,</span></span>
<span id="cb36-385"><a href="#cb36-385" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"probability"</span><span class="fu">:</span> <span class="fl">91.4052665233612</span></span>
<span id="cb36-386"><a href="#cb36-386" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb36-387"><a href="#cb36-387" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb36-388"><a href="#cb36-388" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"activityType"</span><span class="fu">:</span> <span class="st">"STILL"</span><span class="fu">,</span></span>
<span id="cb36-389"><a href="#cb36-389" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"probability"</span><span class="fu">:</span> <span class="fl">6.64205327630043</span></span>
<span id="cb36-390"><a href="#cb36-390" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb36-391"><a href="#cb36-391" aria-hidden="true" tabindex="-1"></a>          <span class="er">...</span></span>
<span id="cb36-392"><a href="#cb36-392" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb36-393"><a href="#cb36-393" aria-hidden="true" tabindex="-1"></a>        <span class="er">...</span></span>
<span id="cb36-394"><a href="#cb36-394" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb36-395"><a href="#cb36-395" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb36-396"><a href="#cb36-396" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb36-397"><a href="#cb36-397" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span>
<span id="cb36-398"><a href="#cb36-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-399"><a href="#cb36-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-400"><a href="#cb36-400" aria-hidden="true" tabindex="-1"></a>And here's the beginning typical place visit entry (<span class="co">[</span><span class="ot">click here for a complete example entry</span><span class="co">](data/example-placeVisit.json)</span>)</span>
<span id="cb36-401"><a href="#cb36-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-402"><a href="#cb36-402" aria-hidden="true" tabindex="-1"></a><span class="in">```json</span></span>
<span id="cb36-403"><a href="#cb36-403" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb36-404"><a href="#cb36-404" aria-hidden="true" tabindex="-1"></a>  <span class="dt">"timelineObjects"</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb36-405"><a href="#cb36-405" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb36-406"><a href="#cb36-406" aria-hidden="true" tabindex="-1"></a>      <span class="dt">"placeVisit"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-407"><a href="#cb36-407" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"location"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-408"><a href="#cb36-408" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"latitudeE7"</span><span class="fu">:</span> <span class="dv">323281024</span><span class="fu">,</span></span>
<span id="cb36-409"><a href="#cb36-409" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"longitudeE7"</span><span class="fu">:</span> <span class="dv">-863373283</span><span class="fu">,</span></span>
<span id="cb36-410"><a href="#cb36-410" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"placeId"</span><span class="fu">:</span> <span class="st">"ChIJQ0NgzsqAjogRISqopW4DZMc"</span><span class="fu">,</span></span>
<span id="cb36-411"><a href="#cb36-411" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"address"</span><span class="fu">:</span> <span class="st">"1030 W South Blvd, Montgomery, AL 36105, USA"</span><span class="fu">,</span></span>
<span id="cb36-412"><a href="#cb36-412" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"name"</span><span class="fu">:</span> <span class="st">"Chevron"</span><span class="fu">,</span></span>
<span id="cb36-413"><a href="#cb36-413" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"sourceInfo"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-414"><a href="#cb36-414" aria-hidden="true" tabindex="-1"></a>            <span class="dt">"deviceTag"</span><span class="fu">:</span> <span class="dv">0</span></span>
<span id="cb36-415"><a href="#cb36-415" aria-hidden="true" tabindex="-1"></a>          <span class="fu">},</span></span>
<span id="cb36-416"><a href="#cb36-416" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"locationConfidence"</span><span class="fu">:</span> <span class="fl">89.41639</span><span class="fu">,</span></span>
<span id="cb36-417"><a href="#cb36-417" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"calibratedProbability"</span><span class="fu">:</span> <span class="fl">80.56358</span></span>
<span id="cb36-418"><a href="#cb36-418" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb36-419"><a href="#cb36-419" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"duration"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb36-420"><a href="#cb36-420" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"startTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-03T14:27:23.001Z"</span><span class="fu">,</span></span>
<span id="cb36-421"><a href="#cb36-421" aria-hidden="true" tabindex="-1"></a>          <span class="dt">"endTimestamp"</span><span class="fu">:</span> <span class="st">"2023-06-03T14:50:24Z"</span></span>
<span id="cb36-422"><a href="#cb36-422" aria-hidden="true" tabindex="-1"></a>        <span class="fu">},</span></span>
<span id="cb36-423"><a href="#cb36-423" aria-hidden="true" tabindex="-1"></a>        <span class="dt">"placeConfidence"</span><span class="fu">:</span> <span class="st">"MEDIUM_CONFIDENCE"</span><span class="fu">,</span></span>
<span id="cb36-424"><a href="#cb36-424" aria-hidden="true" tabindex="-1"></a>        <span class="er">...</span></span>
<span id="cb36-425"><a href="#cb36-425" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb36-426"><a href="#cb36-426" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb36-427"><a href="#cb36-427" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb36-428"><a href="#cb36-428" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span>
<span id="cb36-429"><a href="#cb36-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-430"><a href="#cb36-430" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-431"><a href="#cb36-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-432"><a href="#cb36-432" aria-hidden="true" tabindex="-1"></a>Working with these gnarly JSON files is a lot trickier than working with <span class="in">`Records.json`</span> because all this data is deeply nested within specific properties of the activity or place visit.</span>
<span id="cb36-433"><a href="#cb36-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-434"><a href="#cb36-434" aria-hidden="true" tabindex="-1"></a>To help visualize all this nesting, here's what a single <span class="in">`placeVisit`</span> entry looks like (screenshot via <span class="co">[</span><span class="ot">this JSON tree visualizer</span><span class="co">](https://akhiljay.github.io/JSON-tree-visualizer/)</span>), with the visit details + alternative places + child visits and *their* alternative locations and confidence levels + lots of other details:</span>
<span id="cb36-435"><a href="#cb36-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-436"><a href="#cb36-436" aria-hidden="true" tabindex="-1"></a>::: {.column-screen-inset-right}</span>
<span id="cb36-437"><a href="#cb36-437" aria-hidden="true" tabindex="-1"></a><span class="al">![JSON tree for one `placeVisit` entry](img/json-tree.png)</span></span>
<span id="cb36-438"><a href="#cb36-438" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-439"><a href="#cb36-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-440"><a href="#cb36-440" aria-hidden="true" tabindex="-1"></a>Yikes.</span>
<span id="cb36-441"><a href="#cb36-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-442"><a href="#cb36-442" aria-hidden="true" tabindex="-1"></a>For this post, I don't care about all the alternative possible locations or possible modes of transportation or confidence levels or anything. I cleaned those up in my <span class="co">[</span><span class="ot">Google Timeline</span><span class="co">](https://timeline.google.com/)</span> before exporting the data, so I'm pretty confident everything is relatively correct. </span>
<span id="cb36-443"><a href="#cb36-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-444"><a href="#cb36-444" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip collapse="true"}</span>
<span id="cb36-445"><a href="#cb36-445" aria-hidden="true" tabindex="-1"></a><span class="fu">### More on cleaning up your Google Timeline</span></span>
<span id="cb36-446"><a href="#cb36-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-447"><a href="#cb36-447" aria-hidden="true" tabindex="-1"></a>Google actually has a really nice web-based frontend for your whole location history at <span class="co">[</span><span class="ot">Google Timeline</span><span class="co">](https://timeline.google.com)</span>. </span>
<span id="cb36-448"><a href="#cb36-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-449"><a href="#cb36-449" aria-hidden="true" tabindex="-1"></a><span class="al">![My Google Timeline from June 4, 2023](img/google-timeline.png)</span></span>
<span id="cb36-450"><a href="#cb36-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-451"><a href="#cb36-451" aria-hidden="true" tabindex="-1"></a>Before downloading my location data from this road trip, I checked my history for each day at Google Timeline to confirm that it was marking the right trips locations. It generally did a good job, but when an entry has lower confidence (the <span class="in">`confidence`</span> entry in the JSON data), Google shows you its uncertainty. For instance, here it's not sure about two stops:</span>
<span id="cb36-452"><a href="#cb36-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-453"><a href="#cb36-453" aria-hidden="true" tabindex="-1"></a><span class="al">![Google's uncertainty about two locations](img/timeline-confirm-location.png)</span>{width=60%}</span>
<span id="cb36-454"><a href="#cb36-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-455"><a href="#cb36-455" aria-hidden="true" tabindex="-1"></a>Those are both correct, so I clicked on the check to confirm.</span>
<span id="cb36-456"><a href="#cb36-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-457"><a href="#cb36-457" aria-hidden="true" tabindex="-1"></a>Other times, it gets things wrong. Like here, it thought I was on a motorcycle for this leg of the trip:</span>
<span id="cb36-458"><a href="#cb36-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-459"><a href="#cb36-459" aria-hidden="true" tabindex="-1"></a><span class="al">![Google's incorrect guess that I was motorcycling instead of driving](img/timeline-motorcycle.png)</span>{width=60%}</span>
<span id="cb36-460"><a href="#cb36-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-461"><a href="#cb36-461" aria-hidden="true" tabindex="-1"></a>That's obviously not correct, so I edited it to be "Driving" instead:</span>
<span id="cb36-462"><a href="#cb36-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-463"><a href="#cb36-463" aria-hidden="true" tabindex="-1"></a><span class="al">![Switching motorcylcing to driving](img/timeline-fixed.png)</span>{width=60%}</span>
<span id="cb36-464"><a href="#cb36-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-465"><a href="#cb36-465" aria-hidden="true" tabindex="-1"></a>And other times, when cell reception is bad, it misses entire activities. Like here, where we went to <span class="co">[</span><span class="ot">Devil's Tower</span><span class="co">](https://www.nps.gov/deto/index.htm)</span> where there's no cell reception at all, Google saw that we left the hotel at 8:14 AM and somehow magically arrived at Devil's Tower at 9:21 AM. It failed to record how we did it, so I clicked on "Add activity" and told Google I was driving.</span>
<span id="cb36-466"><a href="#cb36-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-467"><a href="#cb36-467" aria-hidden="true" tabindex="-1"></a><span class="al">![Missing activity](img/timeline-missing-activity.png)</span>{width=60%}</span>
<span id="cb36-468"><a href="#cb36-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-469"><a href="#cb36-469" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-470"><a href="#cb36-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-471"><a href="#cb36-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-472"><a href="#cb36-472" aria-hidden="true" tabindex="-1"></a>Here's all I'll worry about here:</span>
<span id="cb36-473"><a href="#cb36-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-474"><a href="#cb36-474" aria-hidden="true" tabindex="-1"></a>**For `placeVisit`s:**</span>
<span id="cb36-475"><a href="#cb36-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-476"><a href="#cb36-476" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location coordinates (<span class="in">`location`</span> → <span class="in">`latitudeE7`</span> and <span class="in">`location`</span> → <span class="in">`longitudeE7`</span>)</span>
<span id="cb36-477"><a href="#cb36-477" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location ID (<span class="in">`location`</span> → <span class="in">`placeId`</span>): Google's internal ID for the place</span>
<span id="cb36-478"><a href="#cb36-478" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location name (<span class="in">`location`</span> → <span class="in">`name`</span>)</span>
<span id="cb36-479"><a href="#cb36-479" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Location address (<span class="in">`location`</span> → <span class="in">`address`</span>)</span>
<span id="cb36-480"><a href="#cb36-480" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Start and end times (<span class="in">`duration`</span> → <span class="in">`startTimestamp`</span> and <span class="in">`duration`</span> → <span class="in">`endTimestamp`</span>)</span>
<span id="cb36-481"><a href="#cb36-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-482"><a href="#cb36-482" aria-hidden="true" tabindex="-1"></a>**For `activitySegment`s:**</span>
<span id="cb36-483"><a href="#cb36-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-484"><a href="#cb36-484" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Distance (<span class="in">`distance`</span>)</span>
<span id="cb36-485"><a href="#cb36-485" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Activity type (<span class="in">`activityType`</span>)</span>
<span id="cb36-486"><a href="#cb36-486" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Start and end coordinates (<span class="in">`startLocation`</span> → (<span class="in">`latitudeE7`</span> &amp; <span class="in">`longitudeE7`</span>) and <span class="in">`endLocation`</span> → (<span class="in">`latitudeE7`</span> &amp; <span class="in">`longitudeE7`</span>))</span>
<span id="cb36-487"><a href="#cb36-487" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Start and end times (<span class="in">`duration`</span> → <span class="in">`startTimestamp`</span> and <span class="in">`duration`</span> → <span class="in">`endTimestamp`</span>)</span>
<span id="cb36-488"><a href="#cb36-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-489"><a href="#cb36-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-490"><a href="#cb36-490" aria-hidden="true" tabindex="-1"></a><span class="fu"># Loading and playing with your location history in R</span></span>
<span id="cb36-491"><a href="#cb36-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-492"><a href="#cb36-492" aria-hidden="true" tabindex="-1"></a>We can load all these JSON files with R using the <span class="in">`read_json()`</span> function from {jsonlite}, but we need to do a little bit of fancy data wrangling with the more complex semantic location history JSON files.</span>
<span id="cb36-493"><a href="#cb36-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-494"><a href="#cb36-494" aria-hidden="true" tabindex="-1"></a><span class="fu">## `Records.json`</span></span>
<span id="cb36-495"><a href="#cb36-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-496"><a href="#cb36-496" aria-hidden="true" tabindex="-1"></a><span class="fu">### Loading and cleaning data</span></span>
<span id="cb36-497"><a href="#cb36-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-498"><a href="#cb36-498" aria-hidden="true" tabindex="-1"></a>Loading <span class="in">`Records.json`</span> is easy. Because it is essentially rectangular data already, we can use <span class="in">`simplifyVector = TRUE`</span> to have R convert the <span class="in">`locations`</span> slot of the JSON file to a data frame automatically.</span>
<span id="cb36-499"><a href="#cb36-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-500"><a href="#cb36-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-records}</span></span>
<span id="cb36-501"><a href="#cb36-501" aria-hidden="true" tabindex="-1"></a><span class="in">all_locations_raw &lt;- read_json("data/Records.json", simplifyVector = TRUE) %&gt;% </span></span>
<span id="cb36-502"><a href="#cb36-502" aria-hidden="true" tabindex="-1"></a><span class="in">  # Pull out the "locations" slot (this is the same as doing full_data$locations)</span></span>
<span id="cb36-503"><a href="#cb36-503" aria-hidden="true" tabindex="-1"></a><span class="in">  pluck("locations") %&gt;% </span></span>
<span id="cb36-504"><a href="#cb36-504" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make this a tibble just so it prints nicer here on the blog</span></span>
<span id="cb36-505"><a href="#cb36-505" aria-hidden="true" tabindex="-1"></a><span class="in">  as_tibble() </span></span>
<span id="cb36-506"><a href="#cb36-506" aria-hidden="true" tabindex="-1"></a><span class="in">all_locations_raw</span></span>
<span id="cb36-507"><a href="#cb36-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-508"><a href="#cb36-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-509"><a href="#cb36-509" aria-hidden="true" tabindex="-1"></a>We need to clean this data up a bit before using it:</span>
<span id="cb36-510"><a href="#cb36-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-511"><a href="#cb36-511" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Right now the latitude and longitude coordinates are multiplied by 10,000,000, and they're just numbers—R doesn't know that they're geographic coordinates. We need to divide them by $10^7$ and then use them to create an {sf}-enabled <span class="in">`geometry`</span> column using <span class="in">`st_as_sf()`</span> from {sf}.</span>
<span id="cb36-512"><a href="#cb36-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-513"><a href="#cb36-513" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Right now all the timestamps are in UTC (Greenwich Mean Time), not local time. Ordinarily converting UTC times to local time zones is really easy with <span class="in">`with_tz()`</span> from {lubridate}:</span>
<span id="cb36-514"><a href="#cb36-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-515"><a href="#cb36-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r with-tz-example, indent="  "}</span></span>
<span id="cb36-516"><a href="#cb36-516" aria-hidden="true" tabindex="-1"></a><span class="in"># One of the times from the trip</span></span>
<span id="cb36-517"><a href="#cb36-517" aria-hidden="true" tabindex="-1"></a><span class="in">time_utc &lt;- ymd_hms("2023-06-03 14:27:23")</span></span>
<span id="cb36-518"><a href="#cb36-518" aria-hidden="true" tabindex="-1"></a><span class="in">time_utc</span></span>
<span id="cb36-519"><a href="#cb36-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-520"><a href="#cb36-520" aria-hidden="true" tabindex="-1"></a><span class="in"># Convert it to US Central Daylight Time since we were in Alabama at the time</span></span>
<span id="cb36-521"><a href="#cb36-521" aria-hidden="true" tabindex="-1"></a><span class="in">with_tz(time_utc, tzone = "America/Chicago")</span></span>
<span id="cb36-522"><a href="#cb36-522" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-523"><a href="#cb36-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-524"><a href="#cb36-524" aria-hidden="true" tabindex="-1"></a>  However, this was a big road trip and we covered every possible time zone in the continental US (technically not Pacific Daylight Time, but Arizona doesn't use daylight saving time, so it's the same time as Pacific time during the summer), so we can't just convert all the timestamps to just one time zone. We need to figure out which US time zone each latitude/longitude point is in.</span>
<span id="cb36-525"><a href="#cb36-525" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-526"><a href="#cb36-526" aria-hidden="true" tabindex="-1"></a>  I fretted a lot about the best way to do this! I eventually stumbled across <span class="co">[</span><span class="ot">a project that has shapefiles for all the world's time zones</span><span class="co">](https://github.com/evansiroky/timezone-boundary-builder)</span> and was about to start using that to look up which time zone each point fell inside, but then I discovered that there's already an R package that does this (and it uses the same time zone boundary project behind the scenes): <span class="co">[</span><span class="ot">{lutz}</span><span class="co">](https://andyteucher.ca/lutz/)</span> (**l**ook **u**p **t**ime **z**ones). We just have to use <span class="in">`tz_lookup()`</span> and it'll identify the correct time zone for each point.</span>
<span id="cb36-527"><a href="#cb36-527" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-528"><a href="#cb36-528" aria-hidden="true" tabindex="-1"></a>  But there's one more wrinkle! This is *surprisingly* difficult! You'd think we could just use something like <span class="in">`mutate(local_time = with_tz(timestamp, tzone = "whatever")`</span> and make a local time column, but NOPE. R stores time zone details as an attribute for the entire column, so there's no way to have a column with times across multiple time zones (<span class="co">[</span><span class="ot">see this issue here</span><span class="co">](https://github.com/tidyverse/lubridate/issues/359)</span>). Notice how the <span class="in">`local_time`</span> column here is the same regardless of time zone:</span>
<span id="cb36-529"><a href="#cb36-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-530"><a href="#cb36-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r example-timezone-wrong, indent="  "}</span></span>
<span id="cb36-531"><a href="#cb36-531" aria-hidden="true" tabindex="-1"></a><span class="in">example_thing &lt;- tribble(</span></span>
<span id="cb36-532"><a href="#cb36-532" aria-hidden="true" tabindex="-1"></a><span class="in">  ~timestamp, ~tz,</span></span>
<span id="cb36-533"><a href="#cb36-533" aria-hidden="true" tabindex="-1"></a><span class="in">  "2023-06-01 00:00:00", "America/New_York",</span></span>
<span id="cb36-534"><a href="#cb36-534" aria-hidden="true" tabindex="-1"></a><span class="in">  "2023-06-01 01:00:00", "America/New_York",</span></span>
<span id="cb36-535"><a href="#cb36-535" aria-hidden="true" tabindex="-1"></a><span class="in">  "2023-06-01 00:00:00", "America/Phoenix",</span></span>
<span id="cb36-536"><a href="#cb36-536" aria-hidden="true" tabindex="-1"></a><span class="in">  "2023-06-01 01:00:00", "America/Phoenix"</span></span>
<span id="cb36-537"><a href="#cb36-537" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb36-538"><a href="#cb36-538" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(timestamp = ymd_hms(timestamp))</span></span>
<span id="cb36-539"><a href="#cb36-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-540"><a href="#cb36-540" aria-hidden="true" tabindex="-1"></a><span class="in"># The local times are all the same (New York) because columns can only have one time zone</span></span>
<span id="cb36-541"><a href="#cb36-541" aria-hidden="true" tabindex="-1"></a><span class="in">example_thing %&gt;% </span></span>
<span id="cb36-542"><a href="#cb36-542" aria-hidden="true" tabindex="-1"></a><span class="in">  # Have to use rowwise() because with_tz() isn't vectorized (with good reason)</span></span>
<span id="cb36-543"><a href="#cb36-543" aria-hidden="true" tabindex="-1"></a><span class="in">  rowwise() %&gt;% </span></span>
<span id="cb36-544"><a href="#cb36-544" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(local_time = with_tz(timestamp, tzone = tz))</span></span>
<span id="cb36-545"><a href="#cb36-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-546"><a href="#cb36-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-547"><a href="#cb36-547" aria-hidden="true" tabindex="-1"></a>  So as a workaround, we can group by time zone, which lets us work on a smaller subset of the data for each time zone, thus getting around the "one time zone per column" rule. However, that still doesn't quite work, because when R is done with the grouping, it puts everything back together in one column, thus breaking the "one time zone per column" rule, and New York time takes over for the whole column again:</span>
<span id="cb36-548"><a href="#cb36-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-549"><a href="#cb36-549" aria-hidden="true" tabindex="-1"></a><span class="in">```{r example-time-grouped-wrong, indent="  "}</span></span>
<span id="cb36-550"><a href="#cb36-550" aria-hidden="true" tabindex="-1"></a><span class="in">example_thing %&gt;% </span></span>
<span id="cb36-551"><a href="#cb36-551" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz) %&gt;% </span></span>
<span id="cb36-552"><a href="#cb36-552" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(local_time = with_tz(timestamp, tz))</span></span>
<span id="cb36-553"><a href="#cb36-553" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-554"><a href="#cb36-554" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-555"><a href="#cb36-555" aria-hidden="true" tabindex="-1"></a>  To get around that, we can use <span class="in">`force_tz()`</span> to convert each local time back to a fake version of UTC. Each timestamp all have the same time zone attribute (UTC), but the time will be US Eastern, Central, Mountain, or whatever. It's the local time as if it were UTC. It works!</span>
<span id="cb36-556"><a href="#cb36-556" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-557"><a href="#cb36-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r example-time-grouped-right, indent="  "}</span></span>
<span id="cb36-558"><a href="#cb36-558" aria-hidden="true" tabindex="-1"></a><span class="in">example_thing %&gt;% </span></span>
<span id="cb36-559"><a href="#cb36-559" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz) %&gt;% </span></span>
<span id="cb36-560"><a href="#cb36-560" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(local_time = force_tz(with_tz(timestamp, tz), "UTC"))</span></span>
<span id="cb36-561"><a href="#cb36-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-562"><a href="#cb36-562" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-563"><a href="#cb36-563" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Finally we'll add some extra columns for the day, month, and year based on the local time. The file I'm working with here only contains a few days from our trip, but if you're using your own data, you'll likely have years of entries, so these columns help with filtering (i.e. you can use <span class="in">`filter(year == 2017)`</span> to see your whole location history for that year.)</span>
<span id="cb36-564"><a href="#cb36-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-565"><a href="#cb36-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-records-clean}</span></span>
<span id="cb36-566"><a href="#cb36-566" aria-hidden="true" tabindex="-1"></a><span class="in">all_locations &lt;- all_locations_raw %&gt;% </span></span>
<span id="cb36-567"><a href="#cb36-567" aria-hidden="true" tabindex="-1"></a><span class="in">  # Scale down the location data (divide any column that ends in E7 by 10000000)</span></span>
<span id="cb36-568"><a href="#cb36-568" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(ends_with("E7"), ~ . / 1e7)) %&gt;% </span></span>
<span id="cb36-569"><a href="#cb36-569" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create a geometry column with the coordinates</span></span>
<span id="cb36-570"><a href="#cb36-570" aria-hidden="true" tabindex="-1"></a><span class="in">  st_as_sf(coords = c("longitudeE7", "latitudeE7"), crs = st_crs("EPSG:4326")) %&gt;% </span></span>
<span id="cb36-571"><a href="#cb36-571" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make a column with the time zone for each point</span></span>
<span id="cb36-572"><a href="#cb36-572" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tz = tz_lookup(., method = "accurate")) %&gt;% </span></span>
<span id="cb36-573"><a href="#cb36-573" aria-hidden="true" tabindex="-1"></a><span class="in">  # Convert the timestamp to an actual UTC-based timestamp</span></span>
<span id="cb36-574"><a href="#cb36-574" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(timestamp = ymd_hms(timestamp, tz = "UTC")) %&gt;% </span></span>
<span id="cb36-575"><a href="#cb36-575" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create a version of the timestamp in local time, but in UTC</span></span>
<span id="cb36-576"><a href="#cb36-576" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz) %&gt;% </span></span>
<span id="cb36-577"><a href="#cb36-577" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(timestamp_local = force_tz(with_tz(timestamp, tz), "UTC")) %&gt;% </span></span>
<span id="cb36-578"><a href="#cb36-578" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;% </span></span>
<span id="cb36-579"><a href="#cb36-579" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add some helper columns for filtering, grouping, etc.</span></span>
<span id="cb36-580"><a href="#cb36-580" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-581"><a href="#cb36-581" aria-hidden="true" tabindex="-1"></a><span class="in">    year = year(timestamp_local),</span></span>
<span id="cb36-582"><a href="#cb36-582" aria-hidden="true" tabindex="-1"></a><span class="in">    month = month(timestamp_local),</span></span>
<span id="cb36-583"><a href="#cb36-583" aria-hidden="true" tabindex="-1"></a><span class="in">    day = day(timestamp_local)</span></span>
<span id="cb36-584"><a href="#cb36-584" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-585"><a href="#cb36-585" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-586"><a href="#cb36-586" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = strftime(timestamp_local, "%B %e"),</span></span>
<span id="cb36-587"><a href="#cb36-587" aria-hidden="true" tabindex="-1"></a><span class="in">    # With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span id="cb36-588"><a href="#cb36-588" aria-hidden="true" tabindex="-1"></a><span class="in">    # any double spaces and replace them with single spaces </span></span>
<span id="cb36-589"><a href="#cb36-589" aria-hidden="true" tabindex="-1"></a><span class="in">    # (e.g., "June  3" becomes "June 3")</span></span>
<span id="cb36-590"><a href="#cb36-590" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = str_replace(day_month, "  ", " "),</span></span>
<span id="cb36-591"><a href="#cb36-591" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = fct_inorder(day_month)</span></span>
<span id="cb36-592"><a href="#cb36-592" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb36-593"><a href="#cb36-593" aria-hidden="true" tabindex="-1"></a><span class="in">all_locations</span></span>
<span id="cb36-594"><a href="#cb36-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-595"><a href="#cb36-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-596"><a href="#cb36-596" aria-hidden="true" tabindex="-1"></a>Over the 4 days I've included in this JSON file, Google recorded my location <span class="in">`r label_comma()(nrow(all_locations))`</span> times(!!).</span>
<span id="cb36-597"><a href="#cb36-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-598"><a href="#cb36-598" aria-hidden="true" tabindex="-1"></a><span class="fu">### Basic maps</span></span>
<span id="cb36-599"><a href="#cb36-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-600"><a href="#cb36-600" aria-hidden="true" tabindex="-1"></a>Since we converted the latitude and longitude coordinates into a <span class="in">`geometry`</span> column, we can plot it really easily:</span>
<span id="cb36-601"><a href="#cb36-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-602"><a href="#cb36-602" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basic-map-points, fig.width=7, fig.height=2.95}</span></span>
<span id="cb36-603"><a href="#cb36-603" aria-hidden="true" tabindex="-1"></a><span class="in"># I used https://www.openstreetmap.org/export to make this window</span></span>
<span id="cb36-604"><a href="#cb36-604" aria-hidden="true" tabindex="-1"></a><span class="in">trip_window &lt;- st_sfc(</span></span>
<span id="cb36-605"><a href="#cb36-605" aria-hidden="true" tabindex="-1"></a><span class="in">  st_point(c(-115.137, 24.567)),  # left (west), bottom (south)</span></span>
<span id="cb36-606"><a href="#cb36-606" aria-hidden="true" tabindex="-1"></a><span class="in">  st_point(c(-79.146, 37.475)),   # right (east), top (north)</span></span>
<span id="cb36-607"><a href="#cb36-607" aria-hidden="true" tabindex="-1"></a><span class="in">  crs = st_crs("EPSG:4326")  # WGS 84</span></span>
<span id="cb36-608"><a href="#cb36-608" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb36-609"><a href="#cb36-609" aria-hidden="true" tabindex="-1"></a><span class="in">  st_coordinates()</span></span>
<span id="cb36-610"><a href="#cb36-610" aria-hidden="true" tabindex="-1"></a><span class="in">trip_window</span></span>
<span id="cb36-611"><a href="#cb36-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-612"><a href="#cb36-612" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb36-613"><a href="#cb36-613" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = lower_48) +</span></span>
<span id="cb36-614"><a href="#cb36-614" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = all_locations) +</span></span>
<span id="cb36-615"><a href="#cb36-615" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_sf(</span></span>
<span id="cb36-616"><a href="#cb36-616" aria-hidden="true" tabindex="-1"></a><span class="in">    xlim = trip_window[, "X"],</span></span>
<span id="cb36-617"><a href="#cb36-617" aria-hidden="true" tabindex="-1"></a><span class="in">    ylim = trip_window[, "Y"]) +</span></span>
<span id="cb36-618"><a href="#cb36-618" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip_map()</span></span>
<span id="cb36-619"><a href="#cb36-619" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-620"><a href="#cb36-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-621"><a href="#cb36-621" aria-hidden="true" tabindex="-1"></a>That looks like a solid thick black line, but it's not. It's actually <span class="in">`r label_comma()(nrow(all_locations))`</span> individual dots. We can confirm if we zoom in really close (this is the area around The Alamo in San Antonio, Texas):</span>
<span id="cb36-622"><a href="#cb36-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-623"><a href="#cb36-623" aria-hidden="true" tabindex="-1"></a><span class="in">```{r zoom-alamo-points}</span></span>
<span id="cb36-624"><a href="#cb36-624" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb36-625"><a href="#cb36-625" aria-hidden="true" tabindex="-1"></a><span class="in">all_locations %&gt;% </span></span>
<span id="cb36-626"><a href="#cb36-626" aria-hidden="true" tabindex="-1"></a><span class="in">  leaflet() %&gt;% </span></span>
<span id="cb36-627"><a href="#cb36-627" aria-hidden="true" tabindex="-1"></a><span class="in">  addTiles() %&gt;% </span></span>
<span id="cb36-628"><a href="#cb36-628" aria-hidden="true" tabindex="-1"></a><span class="in">  addCircles() %&gt;% </span></span>
<span id="cb36-629"><a href="#cb36-629" aria-hidden="true" tabindex="-1"></a><span class="in">  # I got these coordinates from Google Maps</span></span>
<span id="cb36-630"><a href="#cb36-630" aria-hidden="true" tabindex="-1"></a><span class="in">  setView(lat = 29.425733271447523, lng = -98.48627553904525, zoom = 18)</span></span>
<span id="cb36-631"><a href="#cb36-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-632"><a href="#cb36-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-633"><a href="#cb36-633" aria-hidden="true" tabindex="-1"></a>\ </span>
<span id="cb36-634"><a href="#cb36-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-635"><a href="#cb36-635" aria-hidden="true" tabindex="-1"></a>We can convert all these points into a single path (or a <span class="in">`LINESTRING`</span> simple geographic feature instead of lots of <span class="in">`POINT`</span>s) so that they can connect, using a combination of <span class="in">`st_combine()`</span> to concatenate all the points and <span class="in">`st_cast()`</span> to switch their format from a bunch of points to an official <span class="in">`LINESTRING`</span>:</span>
<span id="cb36-636"><a href="#cb36-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-637"><a href="#cb36-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r combined-linestring}</span></span>
<span id="cb36-638"><a href="#cb36-638" aria-hidden="true" tabindex="-1"></a><span class="in">big_long_combined_route &lt;- all_locations$geometry %&gt;% </span></span>
<span id="cb36-639"><a href="#cb36-639" aria-hidden="true" tabindex="-1"></a><span class="in">  st_combine() %&gt;% </span></span>
<span id="cb36-640"><a href="#cb36-640" aria-hidden="true" tabindex="-1"></a><span class="in">  st_cast("LINESTRING")</span></span>
<span id="cb36-641"><a href="#cb36-641" aria-hidden="true" tabindex="-1"></a><span class="in">big_long_combined_route</span></span>
<span id="cb36-642"><a href="#cb36-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-643"><a href="#cb36-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-644"><a href="#cb36-644" aria-hidden="true" tabindex="-1"></a>Now instead of having two thousand+ points, it's just one single <span class="in">`LINESTRING`</span> feature. It shows up as a line now:</span>
<span id="cb36-645"><a href="#cb36-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-646"><a href="#cb36-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basic-map-linestring, fig.width=7, fig.height=2.95}</span></span>
<span id="cb36-647"><a href="#cb36-647" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb36-648"><a href="#cb36-648" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = lower_48) +</span></span>
<span id="cb36-649"><a href="#cb36-649" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = big_long_combined_route) +</span></span>
<span id="cb36-650"><a href="#cb36-650" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_sf(</span></span>
<span id="cb36-651"><a href="#cb36-651" aria-hidden="true" tabindex="-1"></a><span class="in">    xlim = trip_window[, "X"],</span></span>
<span id="cb36-652"><a href="#cb36-652" aria-hidden="true" tabindex="-1"></a><span class="in">    ylim = trip_window[, "Y"]) +</span></span>
<span id="cb36-653"><a href="#cb36-653" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip_map()</span></span>
<span id="cb36-654"><a href="#cb36-654" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-655"><a href="#cb36-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-656"><a href="#cb36-656" aria-hidden="true" tabindex="-1"></a>We can confirm if we zoom in around the Alamo again too:</span>
<span id="cb36-657"><a href="#cb36-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-658"><a href="#cb36-658" aria-hidden="true" tabindex="-1"></a><span class="in">```{r zoom-alamo-lines}</span></span>
<span id="cb36-659"><a href="#cb36-659" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb36-660"><a href="#cb36-660" aria-hidden="true" tabindex="-1"></a><span class="in">big_long_combined_route %&gt;% </span></span>
<span id="cb36-661"><a href="#cb36-661" aria-hidden="true" tabindex="-1"></a><span class="in">  leaflet() %&gt;% </span></span>
<span id="cb36-662"><a href="#cb36-662" aria-hidden="true" tabindex="-1"></a><span class="in">  addTiles() %&gt;% </span></span>
<span id="cb36-663"><a href="#cb36-663" aria-hidden="true" tabindex="-1"></a><span class="in">  addPolylines() %&gt;% </span></span>
<span id="cb36-664"><a href="#cb36-664" aria-hidden="true" tabindex="-1"></a><span class="in">  setView(lat = 29.425733271447523, lng = -98.48627553904525, zoom = 18)</span></span>
<span id="cb36-665"><a href="#cb36-665" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-666"><a href="#cb36-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-667"><a href="#cb36-667" aria-hidden="true" tabindex="-1"></a>\ </span>
<span id="cb36-668"><a href="#cb36-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-669"><a href="#cb36-669" aria-hidden="true" tabindex="-1"></a>The <span class="in">`big_long_combined_route`</span> object we just made here isn't a data frame anymore—it's a list instead. It still works with <span class="in">`geom_sf()`</span>, but because we collapsed all the points into one line, we lost lots of detail, like timestamps. We can keep some of those details if we use <span class="in">`group_by()`</span> to separate lines per day (or hour or whatever grouping variable we want). For instance, earlier we created a column called <span class="in">`day`</span>. Let's make a separate linestring for each day using <span class="in">`group_by()`</span> and <span class="in">`nest()`</span> and <span class="in">`map()`</span>:</span>
<span id="cb36-670"><a href="#cb36-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-671"><a href="#cb36-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-linestring-by-day}</span></span>
<span id="cb36-672"><a href="#cb36-672" aria-hidden="true" tabindex="-1"></a><span class="in"># Combine all the points in the day into a connected linestring</span></span>
<span id="cb36-673"><a href="#cb36-673" aria-hidden="true" tabindex="-1"></a><span class="in">daily_routes &lt;- all_locations %&gt;% </span></span>
<span id="cb36-674"><a href="#cb36-674" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(day_month) %&gt;% </span></span>
<span id="cb36-675"><a href="#cb36-675" aria-hidden="true" tabindex="-1"></a><span class="in">  nest() %&gt;% </span></span>
<span id="cb36-676"><a href="#cb36-676" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(path = map(data, ~st_cast(st_combine(.), "LINESTRING"))) %&gt;% </span></span>
<span id="cb36-677"><a href="#cb36-677" aria-hidden="true" tabindex="-1"></a><span class="in">  unnest(path) %&gt;% </span></span>
<span id="cb36-678"><a href="#cb36-678" aria-hidden="true" tabindex="-1"></a><span class="in">  st_set_geometry("path")</span></span>
<span id="cb36-679"><a href="#cb36-679" aria-hidden="true" tabindex="-1"></a><span class="in">daily_routes</span></span>
<span id="cb36-680"><a href="#cb36-680" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-681"><a href="#cb36-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-682"><a href="#cb36-682" aria-hidden="true" tabindex="-1"></a>Now we have a data frame with a row per day, and a corresponding path per day too:</span>
<span id="cb36-683"><a href="#cb36-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-684"><a href="#cb36-684" aria-hidden="true" tabindex="-1"></a><span class="in">```{r basic-map-linestring-by-day, fig.width=7, fig.height=2.95, warning=FALSE}</span></span>
<span id="cb36-685"><a href="#cb36-685" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb36-686"><a href="#cb36-686" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = lower_48) +</span></span>
<span id="cb36-687"><a href="#cb36-687" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = daily_routes, aes(color = day_month),</span></span>
<span id="cb36-688"><a href="#cb36-688" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = 1) +</span></span>
<span id="cb36-689"><a href="#cb36-689" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label_repel(</span></span>
<span id="cb36-690"><a href="#cb36-690" aria-hidden="true" tabindex="-1"></a><span class="in">    data = daily_routes,</span></span>
<span id="cb36-691"><a href="#cb36-691" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(label = day_month, fill = day_month, geometry = path),</span></span>
<span id="cb36-692"><a href="#cb36-692" aria-hidden="true" tabindex="-1"></a><span class="in">    stat = "sf_coordinates", seed = 12345,</span></span>
<span id="cb36-693"><a href="#cb36-693" aria-hidden="true" tabindex="-1"></a><span class="in">    color = "white", size = 3, segment.color = "grey30", </span></span>
<span id="cb36-694"><a href="#cb36-694" aria-hidden="true" tabindex="-1"></a><span class="in">    min.segment.length = 0, box.padding = 1,</span></span>
<span id="cb36-695"><a href="#cb36-695" aria-hidden="true" tabindex="-1"></a><span class="in">    show.legend = FALSE, family = "Overpass ExtraBold"</span></span>
<span id="cb36-696"><a href="#cb36-696" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-697"><a href="#cb36-697" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = clrs[c(2, 4, 7, 9)], name = NULL, guide = "none") +</span></span>
<span id="cb36-698"><a href="#cb36-698" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(2, 4, 7, 9)], name = NULL, guide = "none") +</span></span>
<span id="cb36-699"><a href="#cb36-699" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_sf(</span></span>
<span id="cb36-700"><a href="#cb36-700" aria-hidden="true" tabindex="-1"></a><span class="in">    xlim = trip_window[, "X"],</span></span>
<span id="cb36-701"><a href="#cb36-701" aria-hidden="true" tabindex="-1"></a><span class="in">    ylim = trip_window[, "Y"]) +</span></span>
<span id="cb36-702"><a href="#cb36-702" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip_map()</span></span>
<span id="cb36-703"><a href="#cb36-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-704"><a href="#cb36-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-705"><a href="#cb36-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Semantic location history</span></span>
<span id="cb36-706"><a href="#cb36-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-707"><a href="#cb36-707" aria-hidden="true" tabindex="-1"></a>Working with <span class="in">`Records.json`</span> is great and fairly straightforward (once we handle all the weird data cleaning issues and time zones!), but we can do even cooler things with the more detailed semantic location history data. As seen earlier, this data is far more complex, with all sorts of nested entries and predicted probabilities of modes of transportation or location stops, so we can't use the <span class="in">`simplifyVector`</span> to get a basic data frame. Instead, we need to pull out each of the elements we're interested in and build our own data frame.</span>
<span id="cb36-708"><a href="#cb36-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-709"><a href="#cb36-709" aria-hidden="true" tabindex="-1"></a>Additionally, the location history file includes both <span class="in">`placeVisit`</span>s and <span class="in">`activitySegment`</span>s in the same file, so to make life a little easier, we can filter the data after we read the file to only keep one of the types of events using <span class="in">`map()`</span></span>
<span id="cb36-710"><a href="#cb36-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-711"><a href="#cb36-711" aria-hidden="true" tabindex="-1"></a><span class="fu">### `placeVisit`s</span></span>
<span id="cb36-712"><a href="#cb36-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-713"><a href="#cb36-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-place-visits-raw}</span></span>
<span id="cb36-714"><a href="#cb36-714" aria-hidden="true" tabindex="-1"></a><span class="in">place_visits_raw &lt;- read_json(</span></span>
<span id="cb36-715"><a href="#cb36-715" aria-hidden="true" tabindex="-1"></a><span class="in">  "data/Semantic Location History/2023/2023_JUNE_truncated.json", </span></span>
<span id="cb36-716"><a href="#cb36-716" aria-hidden="true" tabindex="-1"></a><span class="in">  simplifyVector = FALSE</span></span>
<span id="cb36-717"><a href="#cb36-717" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb36-718"><a href="#cb36-718" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract the timelineObjects JSON element</span></span>
<span id="cb36-719"><a href="#cb36-719" aria-hidden="true" tabindex="-1"></a><span class="in">  pluck("timelineObjects") %&gt;%</span></span>
<span id="cb36-720"><a href="#cb36-720" aria-hidden="true" tabindex="-1"></a><span class="in">  # Filter the list to only keep placeVisits</span></span>
<span id="cb36-721"><a href="#cb36-721" aria-hidden="true" tabindex="-1"></a><span class="in">  # { More verbose function-based approach: map(~ .x[["placeVisit"]]) }</span></span>
<span id="cb36-722"><a href="#cb36-722" aria-hidden="true" tabindex="-1"></a><span class="in">  # Neat selection-based approach with just the name!</span></span>
<span id="cb36-723"><a href="#cb36-723" aria-hidden="true" tabindex="-1"></a><span class="in">  map("placeVisit") %&gt;% </span></span>
<span id="cb36-724"><a href="#cb36-724" aria-hidden="true" tabindex="-1"></a><span class="in">  # Discard all the empty elements (i.e. the activitySegments)</span></span>
<span id="cb36-725"><a href="#cb36-725" aria-hidden="true" tabindex="-1"></a><span class="in">  compact()</span></span>
<span id="cb36-726"><a href="#cb36-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-727"><a href="#cb36-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-728"><a href="#cb36-728" aria-hidden="true" tabindex="-1"></a>For this post, I'm interested in looking at all the places we stopped for gas and bathroom breaks along the way. I'm not interested in hotel stops or tourist stops. I want to know how long we typically stopped for breaks. There are <span class="in">`r length(place_visits_raw)`</span> entries in this list…</span>
<span id="cb36-729"><a href="#cb36-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-730"><a href="#cb36-730" aria-hidden="true" tabindex="-1"></a><span class="in">```{r show-length-place-visits}</span></span>
<span id="cb36-731"><a href="#cb36-731" aria-hidden="true" tabindex="-1"></a><span class="in">length(place_visits_raw)</span></span>
<span id="cb36-732"><a href="#cb36-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-733"><a href="#cb36-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-734"><a href="#cb36-734" aria-hidden="true" tabindex="-1"></a>…but not all of them are gas or bathroom breaks, so I manually looked through the data and copied the location IDs of the stops that weren't gas stops.</span>
<span id="cb36-735"><a href="#cb36-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-736"><a href="#cb36-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r build-not-driving-stops}</span></span>
<span id="cb36-737"><a href="#cb36-737" aria-hidden="true" tabindex="-1"></a><span class="in">not_driving_stops &lt;- c(</span></span>
<span id="cb36-738"><a href="#cb36-738" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJnwDSTcsDnogRLyt_lqVprLY",  # Hotel in New Orleans, LA</span></span>
<span id="cb36-739"><a href="#cb36-739" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJgcNDAhKmIIYRRA4mio_7VgE",  # Parking in the French Quarter</span></span>
<span id="cb36-740"><a href="#cb36-740" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJv30_Xw-mIIYRpt26QbLBh58",  # Louis Armstrong Park</span></span>
<span id="cb36-741"><a href="#cb36-741" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ59n6fW8dnogRWi-5N6olcyU",  # Chalmette Battlefield</span></span>
<span id="cb36-742"><a href="#cb36-742" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ_7z4c1_2XIYR6b9p0NvEiVE",  # Hotel in San Antonio, TX</span></span>
<span id="cb36-743"><a href="#cb36-743" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJX4k2TVVfXIYRIsTnhA-P-Rc",  # The Alamo</span></span>
<span id="cb36-744"><a href="#cb36-744" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJAdu5Qad544YRhyJT8qzimi4",  # Hotel in Carlsbad, NM</span></span>
<span id="cb36-745"><a href="#cb36-745" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJW9e4xBN544YRvbI7vfc91G4",  # Carlsbad Caverns</span></span>
<span id="cb36-746"><a href="#cb36-746" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJERiZZMWOLYcRQbo78w80s34"   # Hotel in Flagstaff, AZ</span></span>
<span id="cb36-747"><a href="#cb36-747" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb36-748"><a href="#cb36-748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-749"><a href="#cb36-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-750"><a href="#cb36-750" aria-hidden="true" tabindex="-1"></a>Currently, <span class="in">`place_visits_raw`</span> is a huge nested list with the complete place information from Google. All we care about is a small subset of that data, so we can take the list, extract the parts we need, and build a data frame with <span class="in">`map() %&gt;% list_rbind()`</span> (the recommended replacement for {purrr}'s now-superseded <span class="in">`map_df()`</span>). Like we did with <span class="in">`Records.json`</span>, we'll also figure out the time zone for each point and make all the timestamps be local.</span>
<span id="cb36-751"><a href="#cb36-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-752"><a href="#cb36-752" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-place-visits-clean}</span></span>
<span id="cb36-753"><a href="#cb36-753" aria-hidden="true" tabindex="-1"></a><span class="in"># Computer friendly timezones like America/New_York work for computers, but I</span></span>
<span id="cb36-754"><a href="#cb36-754" aria-hidden="true" tabindex="-1"></a><span class="in"># want to sometimes show them as US-standard abbreviations like EDT (Eastern</span></span>
<span id="cb36-755"><a href="#cb36-755" aria-hidden="true" tabindex="-1"></a><span class="in"># Daylight Time), so here's a little lookup table we can use to join to bigger</span></span>
<span id="cb36-756"><a href="#cb36-756" aria-hidden="true" tabindex="-1"></a><span class="in"># datasets for better abbreviations</span></span>
<span id="cb36-757"><a href="#cb36-757" aria-hidden="true" tabindex="-1"></a><span class="in">tz_abbreviations &lt;- tribble(</span></span>
<span id="cb36-758"><a href="#cb36-758" aria-hidden="true" tabindex="-1"></a><span class="in">  ~tz,                ~tz_abb,</span></span>
<span id="cb36-759"><a href="#cb36-759" aria-hidden="true" tabindex="-1"></a><span class="in">  "America/New_York", "EDT",</span></span>
<span id="cb36-760"><a href="#cb36-760" aria-hidden="true" tabindex="-1"></a><span class="in">  "America/Chicago",  "CDT",</span></span>
<span id="cb36-761"><a href="#cb36-761" aria-hidden="true" tabindex="-1"></a><span class="in">  "America/Denver",   "MDT",</span></span>
<span id="cb36-762"><a href="#cb36-762" aria-hidden="true" tabindex="-1"></a><span class="in">  "America/Phoenix",  "MST"</span></span>
<span id="cb36-763"><a href="#cb36-763" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb36-764"><a href="#cb36-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-765"><a href="#cb36-765" aria-hidden="true" tabindex="-1"></a><span class="in">place_visits &lt;- place_visits_raw %&gt;% </span></span>
<span id="cb36-766"><a href="#cb36-766" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract parts of the nested list</span></span>
<span id="cb36-767"><a href="#cb36-767" aria-hidden="true" tabindex="-1"></a><span class="in">  map(~{</span></span>
<span id="cb36-768"><a href="#cb36-768" aria-hidden="true" tabindex="-1"></a><span class="in">    tibble(</span></span>
<span id="cb36-769"><a href="#cb36-769" aria-hidden="true" tabindex="-1"></a><span class="in">      id = .x$location$placeId,</span></span>
<span id="cb36-770"><a href="#cb36-770" aria-hidden="true" tabindex="-1"></a><span class="in">      latitudeE7 = .x$location$latitudeE7 / 1e7,</span></span>
<span id="cb36-771"><a href="#cb36-771" aria-hidden="true" tabindex="-1"></a><span class="in">      longitudeE7 = .x$location$longitudeE7 / 1e7,</span></span>
<span id="cb36-772"><a href="#cb36-772" aria-hidden="true" tabindex="-1"></a><span class="in">      name = .x$location$name,</span></span>
<span id="cb36-773"><a href="#cb36-773" aria-hidden="true" tabindex="-1"></a><span class="in">      address = .x$location$address,</span></span>
<span id="cb36-774"><a href="#cb36-774" aria-hidden="true" tabindex="-1"></a><span class="in">      startTimestamp = ymd_hms(.x$duration$startTimestamp, tz = "UTC"),</span></span>
<span id="cb36-775"><a href="#cb36-775" aria-hidden="true" tabindex="-1"></a><span class="in">      endTimestamp = ymd_hms(.x$duration$endTimestamp, tz = "UTC")</span></span>
<span id="cb36-776"><a href="#cb36-776" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-777"><a href="#cb36-777" aria-hidden="true" tabindex="-1"></a><span class="in">  }) %&gt;% </span></span>
<span id="cb36-778"><a href="#cb36-778" aria-hidden="true" tabindex="-1"></a><span class="in">  list_rbind() %&gt;% </span></span>
<span id="cb36-779"><a href="#cb36-779" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate the duration of the stop</span></span>
<span id="cb36-780"><a href="#cb36-780" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(duration = endTimestamp - startTimestamp) %&gt;% </span></span>
<span id="cb36-781"><a href="#cb36-781" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make an indicator for if the stop was a gas or bathroom break</span></span>
<span id="cb36-782"><a href="#cb36-782" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(driving_stop = !(id %in% not_driving_stops)) %&gt;% </span></span>
<span id="cb36-783"><a href="#cb36-783" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make a geometry column</span></span>
<span id="cb36-784"><a href="#cb36-784" aria-hidden="true" tabindex="-1"></a><span class="in">  st_as_sf(coords = c("longitudeE7", "latitudeE7"), crs = st_crs("EPSG:4326")) %&gt;% </span></span>
<span id="cb36-785"><a href="#cb36-785" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make a column with the time zone for each point</span></span>
<span id="cb36-786"><a href="#cb36-786" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tz = tz_lookup(., method = "accurate")) %&gt;% </span></span>
<span id="cb36-787"><a href="#cb36-787" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create a version of the timestamp in local time, but in UTC</span></span>
<span id="cb36-788"><a href="#cb36-788" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz) %&gt;% </span></span>
<span id="cb36-789"><a href="#cb36-789" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-790"><a href="#cb36-790" aria-hidden="true" tabindex="-1"></a><span class="in">    startTimestamp_local = force_tz(with_tz(startTimestamp, tz), "UTC"),</span></span>
<span id="cb36-791"><a href="#cb36-791" aria-hidden="true" tabindex="-1"></a><span class="in">    endTimestamp_local = force_tz(with_tz(endTimestamp, tz), "UTC")</span></span>
<span id="cb36-792"><a href="#cb36-792" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-793"><a href="#cb36-793" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;% </span></span>
<span id="cb36-794"><a href="#cb36-794" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add a column for direction</span></span>
<span id="cb36-795"><a href="#cb36-795" aria-hidden="true" tabindex="-1"></a><span class="in">  # In the real data, I have values for "There" (the trip from Atlanta to Utah)</span></span>
<span id="cb36-796"><a href="#cb36-796" aria-hidden="true" tabindex="-1"></a><span class="in">  # and "Back again" (the trip from Utah to Atlanta)</span></span>
<span id="cb36-797"><a href="#cb36-797" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(direction = "There") %&gt;% </span></span>
<span id="cb36-798"><a href="#cb36-798" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add some helper columns for filtering, grouping, etc.</span></span>
<span id="cb36-799"><a href="#cb36-799" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-800"><a href="#cb36-800" aria-hidden="true" tabindex="-1"></a><span class="in">    year = year(startTimestamp_local),</span></span>
<span id="cb36-801"><a href="#cb36-801" aria-hidden="true" tabindex="-1"></a><span class="in">    month = month(startTimestamp_local),</span></span>
<span id="cb36-802"><a href="#cb36-802" aria-hidden="true" tabindex="-1"></a><span class="in">    day = day(startTimestamp_local)</span></span>
<span id="cb36-803"><a href="#cb36-803" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-804"><a href="#cb36-804" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-805"><a href="#cb36-805" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = strftime(startTimestamp_local, "%B %e"),</span></span>
<span id="cb36-806"><a href="#cb36-806" aria-hidden="true" tabindex="-1"></a><span class="in">    # With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span id="cb36-807"><a href="#cb36-807" aria-hidden="true" tabindex="-1"></a><span class="in">    # any double spaces and replace them with single spaces </span></span>
<span id="cb36-808"><a href="#cb36-808" aria-hidden="true" tabindex="-1"></a><span class="in">    # (e.g., "June  3" becomes "June 3")</span></span>
<span id="cb36-809"><a href="#cb36-809" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = str_replace(day_month, "  ", " "),</span></span>
<span id="cb36-810"><a href="#cb36-810" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = fct_inorder(day_month)</span></span>
<span id="cb36-811"><a href="#cb36-811" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-812"><a href="#cb36-812" aria-hidden="true" tabindex="-1"></a><span class="in">  # Bring in abbreviated time zones</span></span>
<span id="cb36-813"><a href="#cb36-813" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(tz_abbreviations, by = join_by(tz))</span></span>
<span id="cb36-814"><a href="#cb36-814" aria-hidden="true" tabindex="-1"></a><span class="in">place_visits</span></span>
<span id="cb36-815"><a href="#cb36-815" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-816"><a href="#cb36-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-817"><a href="#cb36-817" aria-hidden="true" tabindex="-1"></a><span class="fu">### `activitySegment`s</span></span>
<span id="cb36-818"><a href="#cb36-818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-819"><a href="#cb36-819" aria-hidden="true" tabindex="-1"></a>We'll go through the same data loading and cleaning process for the <span class="in">`activitySegments`</span>. It's a little more complicated because we have pairs of timestamps and locations (start/end times, start/end locations), and the times and locations can be in different time zones, so we need to do the <span class="in">`group_by(tz)`</span> trick twice with <span class="in">`group_by(tz_start)`</span> and <span class="in">`group_by(tz_end)`</span>. We also need to get two geometry columns, which requires a little data trickery, as you'll see below:</span>
<span id="cb36-820"><a href="#cb36-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-821"><a href="#cb36-821" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-clean-activity-segments}</span></span>
<span id="cb36-822"><a href="#cb36-822" aria-hidden="true" tabindex="-1"></a><span class="in">activity_segments_raw &lt;- read_json(</span></span>
<span id="cb36-823"><a href="#cb36-823" aria-hidden="true" tabindex="-1"></a><span class="in">  "data/Semantic Location History/2023/2023_JUNE_truncated.json", </span></span>
<span id="cb36-824"><a href="#cb36-824" aria-hidden="true" tabindex="-1"></a><span class="in">  simplifyVector = FALSE</span></span>
<span id="cb36-825"><a href="#cb36-825" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb36-826"><a href="#cb36-826" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract the timelineObjects JSON element</span></span>
<span id="cb36-827"><a href="#cb36-827" aria-hidden="true" tabindex="-1"></a><span class="in">  pluck("timelineObjects") %&gt;%</span></span>
<span id="cb36-828"><a href="#cb36-828" aria-hidden="true" tabindex="-1"></a><span class="in">  # Filter the list to only keep activitySegments</span></span>
<span id="cb36-829"><a href="#cb36-829" aria-hidden="true" tabindex="-1"></a><span class="in">  map("activitySegment") %&gt;%</span></span>
<span id="cb36-830"><a href="#cb36-830" aria-hidden="true" tabindex="-1"></a><span class="in">  # Discard all the empty elements (i.e. the placeVisits)</span></span>
<span id="cb36-831"><a href="#cb36-831" aria-hidden="true" tabindex="-1"></a><span class="in">  compact()</span></span>
<span id="cb36-832"><a href="#cb36-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-833"><a href="#cb36-833" aria-hidden="true" tabindex="-1"></a><span class="in">activity_segments_not_clean &lt;- activity_segments_raw %&gt;% </span></span>
<span id="cb36-834"><a href="#cb36-834" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extract parts of the nested list</span></span>
<span id="cb36-835"><a href="#cb36-835" aria-hidden="true" tabindex="-1"></a><span class="in">  map(~{</span></span>
<span id="cb36-836"><a href="#cb36-836" aria-hidden="true" tabindex="-1"></a><span class="in">    tibble(</span></span>
<span id="cb36-837"><a href="#cb36-837" aria-hidden="true" tabindex="-1"></a><span class="in">      distance_m = .x$distance,</span></span>
<span id="cb36-838"><a href="#cb36-838" aria-hidden="true" tabindex="-1"></a><span class="in">      activity_type = .x$activityType,</span></span>
<span id="cb36-839"><a href="#cb36-839" aria-hidden="true" tabindex="-1"></a><span class="in">      start_latitudeE7 = .x$startLocation$latitudeE7 / 1e7,</span></span>
<span id="cb36-840"><a href="#cb36-840" aria-hidden="true" tabindex="-1"></a><span class="in">      start_longitudeE7 = .x$startLocation$longitudeE7 / 1e7,</span></span>
<span id="cb36-841"><a href="#cb36-841" aria-hidden="true" tabindex="-1"></a><span class="in">      end_latitudeE7 = .x$endLocation$latitudeE7 / 1e7,</span></span>
<span id="cb36-842"><a href="#cb36-842" aria-hidden="true" tabindex="-1"></a><span class="in">      end_longitudeE7 = .x$endLocation$longitudeE7 / 1e7,</span></span>
<span id="cb36-843"><a href="#cb36-843" aria-hidden="true" tabindex="-1"></a><span class="in">      startTimestamp = ymd_hms(.x$duration$startTimestamp, tz = "UTC"),</span></span>
<span id="cb36-844"><a href="#cb36-844" aria-hidden="true" tabindex="-1"></a><span class="in">      endTimestamp = ymd_hms(.x$duration$endTimestamp, tz = "UTC")</span></span>
<span id="cb36-845"><a href="#cb36-845" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-846"><a href="#cb36-846" aria-hidden="true" tabindex="-1"></a><span class="in">  }) %&gt;% </span></span>
<span id="cb36-847"><a href="#cb36-847" aria-hidden="true" tabindex="-1"></a><span class="in">  list_rbind()</span></span>
<span id="cb36-848"><a href="#cb36-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-849"><a href="#cb36-849" aria-hidden="true" tabindex="-1"></a><span class="in"># ↑ that needs to be a separate data frame so that we can refer to it to make a</span></span>
<span id="cb36-850"><a href="#cb36-850" aria-hidden="true" tabindex="-1"></a><span class="in"># geometry column for the end latitude/longitude</span></span>
<span id="cb36-851"><a href="#cb36-851" aria-hidden="true" tabindex="-1"></a><span class="in">activity_segments &lt;- activity_segments_not_clean %&gt;% </span></span>
<span id="cb36-852"><a href="#cb36-852" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate the duration and distance and speed of the segment</span></span>
<span id="cb36-853"><a href="#cb36-853" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(duration = endTimestamp - startTimestamp) %&gt;% </span></span>
<span id="cb36-854"><a href="#cb36-854" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(distance_miles = meters_to_miles(distance_m)) %&gt;% </span></span>
<span id="cb36-855"><a href="#cb36-855" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-856"><a href="#cb36-856" aria-hidden="true" tabindex="-1"></a><span class="in">    hours = as.numeric(duration) / 60,</span></span>
<span id="cb36-857"><a href="#cb36-857" aria-hidden="true" tabindex="-1"></a><span class="in">    avg_mph = distance_miles / hours</span></span>
<span id="cb36-858"><a href="#cb36-858" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-859"><a href="#cb36-859" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make two geometry columns</span></span>
<span id="cb36-860"><a href="#cb36-860" aria-hidden="true" tabindex="-1"></a><span class="in">  st_as_sf(coords = c("start_longitudeE7", "start_latitudeE7"), crs = st_crs("EPSG:4326")) %&gt;% </span></span>
<span id="cb36-861"><a href="#cb36-861" aria-hidden="true" tabindex="-1"></a><span class="in">  rename("geometry_start" = "geometry") %&gt;% </span></span>
<span id="cb36-862"><a href="#cb36-862" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(geometry_end = st_geometry(</span></span>
<span id="cb36-863"><a href="#cb36-863" aria-hidden="true" tabindex="-1"></a><span class="in">    st_as_sf(</span></span>
<span id="cb36-864"><a href="#cb36-864" aria-hidden="true" tabindex="-1"></a><span class="in">      activity_segments_not_clean, </span></span>
<span id="cb36-865"><a href="#cb36-865" aria-hidden="true" tabindex="-1"></a><span class="in">      coords = c("end_longitudeE7", "end_latitudeE7"), </span></span>
<span id="cb36-866"><a href="#cb36-866" aria-hidden="true" tabindex="-1"></a><span class="in">      crs = st_crs("EPSG:4326"))</span></span>
<span id="cb36-867"><a href="#cb36-867" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-868"><a href="#cb36-868" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-869"><a href="#cb36-869" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-end_longitudeE7, -end_latitudeE7) %&gt;% </span></span>
<span id="cb36-870"><a href="#cb36-870" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make a column with the time zone for each point</span></span>
<span id="cb36-871"><a href="#cb36-871" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tz_start = tz_lookup(geometry_start, method = "accurate")) %&gt;% </span></span>
<span id="cb36-872"><a href="#cb36-872" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(tz_end = tz_lookup(geometry_end, method = "accurate")) %&gt;% </span></span>
<span id="cb36-873"><a href="#cb36-873" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create a version of the timestamps in local time, but in UTC</span></span>
<span id="cb36-874"><a href="#cb36-874" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz_start) %&gt;% </span></span>
<span id="cb36-875"><a href="#cb36-875" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(startTimestamp_local = force_tz(with_tz(startTimestamp, tz_start), "UTC")) %&gt;% </span></span>
<span id="cb36-876"><a href="#cb36-876" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;% </span></span>
<span id="cb36-877"><a href="#cb36-877" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(tz_end) %&gt;% </span></span>
<span id="cb36-878"><a href="#cb36-878" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(endTimestamp_local = force_tz(with_tz(endTimestamp, tz_end), "UTC")) %&gt;% </span></span>
<span id="cb36-879"><a href="#cb36-879" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() %&gt;% </span></span>
<span id="cb36-880"><a href="#cb36-880" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add some helper columns for filtering, grouping, etc.</span></span>
<span id="cb36-881"><a href="#cb36-881" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-882"><a href="#cb36-882" aria-hidden="true" tabindex="-1"></a><span class="in">    year = year(startTimestamp_local),</span></span>
<span id="cb36-883"><a href="#cb36-883" aria-hidden="true" tabindex="-1"></a><span class="in">    month = month(startTimestamp_local),</span></span>
<span id="cb36-884"><a href="#cb36-884" aria-hidden="true" tabindex="-1"></a><span class="in">    day = day(startTimestamp_local)</span></span>
<span id="cb36-885"><a href="#cb36-885" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-886"><a href="#cb36-886" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-887"><a href="#cb36-887" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = strftime(startTimestamp_local, "%B %e"),</span></span>
<span id="cb36-888"><a href="#cb36-888" aria-hidden="true" tabindex="-1"></a><span class="in">    # With %e, there's a leading space for single-digit numbers, so we remove</span></span>
<span id="cb36-889"><a href="#cb36-889" aria-hidden="true" tabindex="-1"></a><span class="in">    # any double spaces and replace them with single spaces </span></span>
<span id="cb36-890"><a href="#cb36-890" aria-hidden="true" tabindex="-1"></a><span class="in">    # (e.g., "June  3" becomes "June 3")</span></span>
<span id="cb36-891"><a href="#cb36-891" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = str_replace(day_month, "  ", " "),</span></span>
<span id="cb36-892"><a href="#cb36-892" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = fct_inorder(day_month)</span></span>
<span id="cb36-893"><a href="#cb36-893" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-894"><a href="#cb36-894" aria-hidden="true" tabindex="-1"></a><span class="in">  # Bring in abbreviated time zones for both the start and end time zones</span></span>
<span id="cb36-895"><a href="#cb36-895" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(</span></span>
<span id="cb36-896"><a href="#cb36-896" aria-hidden="true" tabindex="-1"></a><span class="in">    rename(tz_abbreviations, "tz_start_abb" = "tz_abb"), </span></span>
<span id="cb36-897"><a href="#cb36-897" aria-hidden="true" tabindex="-1"></a><span class="in">    by = join_by(tz_start == tz)</span></span>
<span id="cb36-898"><a href="#cb36-898" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-899"><a href="#cb36-899" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(</span></span>
<span id="cb36-900"><a href="#cb36-900" aria-hidden="true" tabindex="-1"></a><span class="in">    rename(tz_abbreviations, "tz_end_abb" = "tz_abb"),</span></span>
<span id="cb36-901"><a href="#cb36-901" aria-hidden="true" tabindex="-1"></a><span class="in">    by = join_by(tz_end == tz)</span></span>
<span id="cb36-902"><a href="#cb36-902" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-903"><a href="#cb36-903" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create an id column so we can better reference individual activities </span></span>
<span id="cb36-904"><a href="#cb36-904" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make it a character so it can combine with the place visit id column</span></span>
<span id="cb36-905"><a href="#cb36-905" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(id = as.character(1:n()))</span></span>
<span id="cb36-906"><a href="#cb36-906" aria-hidden="true" tabindex="-1"></a><span class="in">activity_segments</span></span>
<span id="cb36-907"><a href="#cb36-907" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-908"><a href="#cb36-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-909"><a href="#cb36-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-910"><a href="#cb36-910" aria-hidden="true" tabindex="-1"></a><span class="fu">### Both combined</span></span>
<span id="cb36-911"><a href="#cb36-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-912"><a href="#cb36-912" aria-hidden="true" tabindex="-1"></a>All these <span class="in">`placeVisit`</span> and <span class="in">`activitySegment`</span> entries were originally in the same JSON file since they actually fit together nicely—activity segments lead to place visits, which are then followed by more activity segments (i.e. you drive to a place, do stuff at that place, and drive to a different place, and so on). Because the two event types are structured so differently, we had to split them up and load and clean them separately. But it can be helpful to put them back together so there's a consistent timeline—it'll help with making plots below, and it creates a neat log of the whole trip.</span>
<span id="cb36-913"><a href="#cb36-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-914"><a href="#cb36-914" aria-hidden="true" tabindex="-1"></a>We'll use <span class="in">`bind_rows()`</span> to combine the two and then sort. It's kind of an ugly dataset, with lots of missing data in every other row since each type of entry has slightly different columns in it, but some columns are consistent throughout, like <span class="in">`duration`</span> and the different timestamps, so it'll be helpful.</span>
<span id="cb36-915"><a href="#cb36-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-916"><a href="#cb36-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r make-combined-history}</span></span>
<span id="cb36-917"><a href="#cb36-917" aria-hidden="true" tabindex="-1"></a><span class="in">all_stops_activities &lt;- bind_rows(</span></span>
<span id="cb36-918"><a href="#cb36-918" aria-hidden="true" tabindex="-1"></a><span class="in">  list(visit = place_visits, segment = activity_segments),</span></span>
<span id="cb36-919"><a href="#cb36-919" aria-hidden="true" tabindex="-1"></a><span class="in">  .id = "type"</span></span>
<span id="cb36-920"><a href="#cb36-920" aria-hidden="true" tabindex="-1"></a><span class="in">) %&gt;% </span></span>
<span id="cb36-921"><a href="#cb36-921" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(startTimestamp)</span></span>
<span id="cb36-922"><a href="#cb36-922" aria-hidden="true" tabindex="-1"></a><span class="in">all_stops_activities</span></span>
<span id="cb36-923"><a href="#cb36-923" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-924"><a href="#cb36-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-925"><a href="#cb36-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-926"><a href="#cb36-926" aria-hidden="true" tabindex="-1"></a><span class="fu"># Road trip analysis</span></span>
<span id="cb36-927"><a href="#cb36-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-928"><a href="#cb36-928" aria-hidden="true" tabindex="-1"></a>Phew, that was a lot of work getting this data all wrangled together and cleaned up. Let's analyze this trip!</span>
<span id="cb36-929"><a href="#cb36-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-930"><a href="#cb36-930" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution}</span>
<span id="cb36-931"><a href="#cb36-931" aria-hidden="true" tabindex="-1"></a><span class="fu">### Truncated vs. complete data</span></span>
<span id="cb36-932"><a href="#cb36-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-933"><a href="#cb36-933" aria-hidden="true" tabindex="-1"></a>All the plots and tables below use the complete data from our road trip, with every day and every stop. Everything above only worked with the first four days (and even then, omitted the first 30 minutes of the first day for the sake of privacy). </span>
<span id="cb36-934"><a href="#cb36-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-935"><a href="#cb36-935" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">I provided truncated raw JSON files</span><span class="co">](data.zip)</span> for the sake of illustrating how to load and process and work with this kind of location data. But I want to analyze my actual full data, so I cleaned that up separately (<span class="co">[</span><span class="ot">with this file</span><span class="co">](clean-data-real.R)</span>; <span class="co">[</span><span class="ot">view at GitHub</span><span class="co">](https://github.com/andrewheiss/ath-quarto/blob/main/blog/2023/07/03/using-google-location-history-with-r-roadtrip/clean-data-real.R)</span>). I'll load all those complete objects here. </span>
<span id="cb36-936"><a href="#cb36-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-937"><a href="#cb36-937" aria-hidden="true" tabindex="-1"></a>If you're following along with my truncated data, never fear! These plots and tables will all still generally work, they'll just show the first few days and not the actual complete plots you see here.</span>
<span id="cb36-938"><a href="#cb36-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-939"><a href="#cb36-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r load-real-data, include=FALSE}</span></span>
<span id="cb36-940"><a href="#cb36-940" aria-hidden="true" tabindex="-1"></a><span class="in">invisible(list2env(readRDS("data_real/clean_data.rds"), .GlobalEnv))</span></span>
<span id="cb36-941"><a href="#cb36-941" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-942"><a href="#cb36-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-943"><a href="#cb36-943" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-944"><a href="#cb36-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-945"><a href="#cb36-945" aria-hidden="true" tabindex="-1"></a>::: {.callout-note}</span>
<span id="cb36-946"><a href="#cb36-946" aria-hidden="true" tabindex="-1"></a><span class="fu">### Folded code</span></span>
<span id="cb36-947"><a href="#cb36-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-948"><a href="#cb36-948" aria-hidden="true" tabindex="-1"></a>There's been a lot of code in this post already, so I've folded all the remaining code chunks so it's easier to just see the plots and tables. You can see the underlying code if you click on the little toggle triangle.</span>
<span id="cb36-949"><a href="#cb36-949" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb36-950"><a href="#cb36-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-951"><a href="#cb36-951" aria-hidden="true" tabindex="-1"></a><span class="fu">## Maps</span></span>
<span id="cb36-952"><a href="#cb36-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-953"><a href="#cb36-953" aria-hidden="true" tabindex="-1"></a><span class="in">```{r calculate-state-crossing}</span></span>
<span id="cb36-954"><a href="#cb36-954" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-955"><a href="#cb36-955" aria-hidden="true" tabindex="-1"></a><span class="in"># Find all the states that daily_routes crosses</span></span>
<span id="cb36-956"><a href="#cb36-956" aria-hidden="true" tabindex="-1"></a><span class="in">states_crossed_through &lt;- st_intersection(</span></span>
<span id="cb36-957"><a href="#cb36-957" aria-hidden="true" tabindex="-1"></a><span class="in">  st_transform(lower_48, st_crs(daily_routes)),</span></span>
<span id="cb36-958"><a href="#cb36-958" aria-hidden="true" tabindex="-1"></a><span class="in">  daily_routes</span></span>
<span id="cb36-959"><a href="#cb36-959" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb36-960"><a href="#cb36-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-961"><a href="#cb36-961" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a column that flags if the state is crossed through</span></span>
<span id="cb36-962"><a href="#cb36-962" aria-hidden="true" tabindex="-1"></a><span class="in">lower_48_highlighted &lt;- lower_48 %&gt;% </span></span>
<span id="cb36-963"><a href="#cb36-963" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(visited = NAME %in% unique(states_crossed_through$NAME))</span></span>
<span id="cb36-964"><a href="#cb36-964" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-965"><a href="#cb36-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-966"><a href="#cb36-966" aria-hidden="true" tabindex="-1"></a>In total, we crossed through <span class="in">`r sum(lower_48_highlighted$visited)`</span> different states over the course of our big circular 13-day drive. We made <span class="in">`r nrow(place_visits)`</span> different stops along the way, all marked with points in @fig-map-basic:</span>
<span id="cb36-967"><a href="#cb36-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-968"><a href="#cb36-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-map-basic, fig.width=9, fig.height=6}</span></span>
<span id="cb36-969"><a href="#cb36-969" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-970"><a href="#cb36-970" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Basic map of our mega road trip</span></span>
<span id="cb36-971"><a href="#cb36-971" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page-right</span></span>
<span id="cb36-972"><a href="#cb36-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-973"><a href="#cb36-973" aria-hidden="true" tabindex="-1"></a><span class="in"># Make a map!</span></span>
<span id="cb36-974"><a href="#cb36-974" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb36-975"><a href="#cb36-975" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = lower_48_highlighted, aes(fill = visited)) +</span></span>
<span id="cb36-976"><a href="#cb36-976" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("grey98", "grey90"), guide = "none") +</span></span>
<span id="cb36-977"><a href="#cb36-977" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = daily_routes, linewidth = 0.75) +</span></span>
<span id="cb36-978"><a href="#cb36-978" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = place_visits, size = 1.5) +</span></span>
<span id="cb36-979"><a href="#cb36-979" aria-hidden="true" tabindex="-1"></a><span class="in">  annotation_scale(</span></span>
<span id="cb36-980"><a href="#cb36-980" aria-hidden="true" tabindex="-1"></a><span class="in">    location = "bl", bar_cols = c("grey30", "white"),</span></span>
<span id="cb36-981"><a href="#cb36-981" aria-hidden="true" tabindex="-1"></a><span class="in">    unit_category = "imperial", text_family = "Overpass"</span></span>
<span id="cb36-982"><a href="#cb36-982" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-983"><a href="#cb36-983" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(caption = "Each point is a stop") +</span></span>
<span id="cb36-984"><a href="#cb36-984" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_sf(crs = st_crs("ESRI:102003")) +  # Albers</span></span>
<span id="cb36-985"><a href="#cb36-985" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip_map()</span></span>
<span id="cb36-986"><a href="#cb36-986" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-987"><a href="#cb36-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-988"><a href="#cb36-988" aria-hidden="true" tabindex="-1"></a>In @fig-map-with-dates we can color each leg of the trip a different color to see how the driving was divided up over time:</span>
<span id="cb36-989"><a href="#cb36-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-990"><a href="#cb36-990" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-map-with-dates, fig.width=9, fig.height=6}</span></span>
<span id="cb36-991"><a href="#cb36-991" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-992"><a href="#cb36-992" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Map of our mega road trip, by day</span></span>
<span id="cb36-993"><a href="#cb36-993" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page-right</span></span>
<span id="cb36-994"><a href="#cb36-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-995"><a href="#cb36-995" aria-hidden="true" tabindex="-1"></a><span class="in"># Use the same colors for each direction</span></span>
<span id="cb36-996"><a href="#cb36-996" aria-hidden="true" tabindex="-1"></a><span class="in">colors_there &lt;- rcartocolor::carto_pal(7, "SunsetDark")[c(1, 3, 2, 4, 6, 5, 7)]</span></span>
<span id="cb36-997"><a href="#cb36-997" aria-hidden="true" tabindex="-1"></a><span class="in">colors_back_again &lt;- rcartocolor::carto_pal(6, "SunsetDark")[c(1, 3, 2, 4, 6, 5)]</span></span>
<span id="cb36-998"><a href="#cb36-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-999"><a href="#cb36-999" aria-hidden="true" tabindex="-1"></a><span class="in"># CARTO's Sunset Dark is neat, but the first yellow color is a little too light</span></span>
<span id="cb36-1000"><a href="#cb36-1000" aria-hidden="true" tabindex="-1"></a><span class="in"># to see comfortably, so we replace it with the yellow from the CARTO Prism</span></span>
<span id="cb36-1001"><a href="#cb36-1001" aria-hidden="true" tabindex="-1"></a><span class="in"># palette</span></span>
<span id="cb36-1002"><a href="#cb36-1002" aria-hidden="true" tabindex="-1"></a><span class="in">colors_there[1] &lt;- clrs[6]</span></span>
<span id="cb36-1003"><a href="#cb36-1003" aria-hidden="true" tabindex="-1"></a><span class="in">colors_back_again[1] &lt;- clrs[6]</span></span>
<span id="cb36-1004"><a href="#cb36-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1005"><a href="#cb36-1005" aria-hidden="true" tabindex="-1"></a><span class="in"># Make a map!</span></span>
<span id="cb36-1006"><a href="#cb36-1006" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb36-1007"><a href="#cb36-1007" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = lower_48_highlighted, aes(fill = visited)) +</span></span>
<span id="cb36-1008"><a href="#cb36-1008" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c("grey98", "grey90"), guide = "none") +</span></span>
<span id="cb36-1009"><a href="#cb36-1009" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reset fill scale so that the labels can be filled</span></span>
<span id="cb36-1010"><a href="#cb36-1010" aria-hidden="true" tabindex="-1"></a><span class="in">  new_scale_fill() +</span></span>
<span id="cb36-1011"><a href="#cb36-1011" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = daily_routes, aes(color = day_month), linewidth = 0.75) +</span></span>
<span id="cb36-1012"><a href="#cb36-1012" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c(colors_there, colors_back_again), guide = "none") +</span></span>
<span id="cb36-1013"><a href="#cb36-1013" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_sf(data = place_visits, aes(color = day_month), size = 1.5) +</span></span>
<span id="cb36-1014"><a href="#cb36-1014" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label_repel(</span></span>
<span id="cb36-1015"><a href="#cb36-1015" aria-hidden="true" tabindex="-1"></a><span class="in">    data = daily_routes,</span></span>
<span id="cb36-1016"><a href="#cb36-1016" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(label = day_month, fill = day_month, geometry = path),</span></span>
<span id="cb36-1017"><a href="#cb36-1017" aria-hidden="true" tabindex="-1"></a><span class="in">    stat = "sf_coordinates", seed = 1234,</span></span>
<span id="cb36-1018"><a href="#cb36-1018" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 3, segment.color = "grey30", min.segment.length = 0,</span></span>
<span id="cb36-1019"><a href="#cb36-1019" aria-hidden="true" tabindex="-1"></a><span class="in">    show.legend = FALSE, family = "Overpass ExtraBold", color = "white"</span></span>
<span id="cb36-1020"><a href="#cb36-1020" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1021"><a href="#cb36-1021" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c(colors_there, colors_back_again), guide = "none") +</span></span>
<span id="cb36-1022"><a href="#cb36-1022" aria-hidden="true" tabindex="-1"></a><span class="in">  annotation_scale(</span></span>
<span id="cb36-1023"><a href="#cb36-1023" aria-hidden="true" tabindex="-1"></a><span class="in">    location = "bl", bar_cols = c("grey30", "white"),</span></span>
<span id="cb36-1024"><a href="#cb36-1024" aria-hidden="true" tabindex="-1"></a><span class="in">    unit_category = "imperial", text_family = "Overpass"</span></span>
<span id="cb36-1025"><a href="#cb36-1025" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1026"><a href="#cb36-1026" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(caption = "Each point is a stop") +</span></span>
<span id="cb36-1027"><a href="#cb36-1027" aria-hidden="true" tabindex="-1"></a><span class="in">  coord_sf(crs = st_crs("ESRI:102003")) +  # Albers</span></span>
<span id="cb36-1028"><a href="#cb36-1028" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip_map()</span></span>
<span id="cb36-1029"><a href="#cb36-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1030"><a href="#cb36-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1031"><a href="#cb36-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1032"><a href="#cb36-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">## Distance and time</span></span>
<span id="cb36-1033"><a href="#cb36-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1034"><a href="#cb36-1034" aria-hidden="true" tabindex="-1"></a>@tbl-distance-time-day answers a bunch of questions about distance and time:</span>
<span id="cb36-1035"><a href="#cb36-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1036"><a href="#cb36-1036" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How many miles did we drive each day?** Roughly 500ish miles per day. The way out was longer than the way back (2,832 miles there vs. 2,390 miles back). In total we drove **5,222 miles** (!!!). This is *shockingly* close to the <span class="co">[</span><span class="ot">5,260 miles that OpenStreetMap mapped out for me in this previous blog post</span><span class="co">](https://www.andrewheiss.com/blog/2023/06/01/geocoding-routing-openstreetmap-r/#summary-statistics)</span>, even with some changes to the route (i.e. we didn't end up going through Minnesota and went through Nebraska instead)</span>
<span id="cb36-1037"><a href="#cb36-1037" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**How long did we spend driving each day?** Roughly 8.5 hours per day. The way out was 5 hours longer than the way back (though that's a little inflated because June 8 doesn't really count, as we were just driving around Capitol Reef National Park). In total we drove for **91 hours and 47 minutes**,</span>
<span id="cb36-1038"><a href="#cb36-1038" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**What was the earliest time we started each day and the latest time we arrived each evening?** The earliest departure was 7:30 AM when we left Atlanta on June 3; the latest arrivals were when we got to Sioux Falls, South Dakota at 10:42 PM on June 22 and when we got to Flagstaff, Arizona on June 6 at 10:35 PM.</span>
<span id="cb36-1039"><a href="#cb36-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1040"><a href="#cb36-1040" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tbl-distance-time-day}</span></span>
<span id="cb36-1041"><a href="#cb36-1041" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-1042"><a href="#cb36-1042" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Daily distance and time details</span></span>
<span id="cb36-1043"><a href="#cb36-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1044"><a href="#cb36-1044" aria-hidden="true" tabindex="-1"></a><span class="in">time_distance_day &lt;- activity_segments %&gt;% </span></span>
<span id="cb36-1045"><a href="#cb36-1045" aria-hidden="true" tabindex="-1"></a><span class="in">  st_drop_geometry() %&gt;% </span></span>
<span id="cb36-1046"><a href="#cb36-1046" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(activity_type == "IN_PASSENGER_VEHICLE") %&gt;% </span></span>
<span id="cb36-1047"><a href="#cb36-1047" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(direction, day_month) %&gt;% </span></span>
<span id="cb36-1048"><a href="#cb36-1048" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(</span></span>
<span id="cb36-1049"><a href="#cb36-1049" aria-hidden="true" tabindex="-1"></a><span class="in">    total_distance = sum(distance_miles),</span></span>
<span id="cb36-1050"><a href="#cb36-1050" aria-hidden="true" tabindex="-1"></a><span class="in">    total_time = sum(duration),</span></span>
<span id="cb36-1051"><a href="#cb36-1051" aria-hidden="true" tabindex="-1"></a><span class="in">    start_time = min(startTimestamp_local),</span></span>
<span id="cb36-1052"><a href="#cb36-1052" aria-hidden="true" tabindex="-1"></a><span class="in">    start_tz = tz_start_abb[which.min(startTimestamp_local)],</span></span>
<span id="cb36-1053"><a href="#cb36-1053" aria-hidden="true" tabindex="-1"></a><span class="in">    end_time = max(endTimestamp_local),</span></span>
<span id="cb36-1054"><a href="#cb36-1054" aria-hidden="true" tabindex="-1"></a><span class="in">    end_tz = tz_end_abb[which.max(endTimestamp_local)]</span></span>
<span id="cb36-1055"><a href="#cb36-1055" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1056"><a href="#cb36-1056" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1057"><a href="#cb36-1057" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_start_time = paste(strftime(start_time, format = "%I:%M %p", tz = "UTC"), start_tz),</span></span>
<span id="cb36-1058"><a href="#cb36-1058" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_end_time = paste(strftime(end_time, format = "%I:%M %p", tz = "UTC"), end_tz)</span></span>
<span id="cb36-1059"><a href="#cb36-1059" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1060"><a href="#cb36-1060" aria-hidden="true" tabindex="-1"></a><span class="in">  # Remove leading zeros from hour</span></span>
<span id="cb36-1061"><a href="#cb36-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c(nice_start_time, nice_end_time), ~str_replace(.x, "^0", "")))</span></span>
<span id="cb36-1062"><a href="#cb36-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1063"><a href="#cb36-1063" aria-hidden="true" tabindex="-1"></a><span class="in">time_distance_day %&gt;% </span></span>
<span id="cb36-1064"><a href="#cb36-1064" aria-hidden="true" tabindex="-1"></a><span class="in">  select(direction, day_month, total_distance, total_time, nice_start_time, nice_end_time) %&gt;% </span></span>
<span id="cb36-1065"><a href="#cb36-1065" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(direction) %&gt;%</span></span>
<span id="cb36-1066"><a href="#cb36-1066" aria-hidden="true" tabindex="-1"></a><span class="in">  gt() %&gt;% </span></span>
<span id="cb36-1067"><a href="#cb36-1067" aria-hidden="true" tabindex="-1"></a><span class="in">  summary_rows(</span></span>
<span id="cb36-1068"><a href="#cb36-1068" aria-hidden="true" tabindex="-1"></a><span class="in">    groups = everything(),</span></span>
<span id="cb36-1069"><a href="#cb36-1069" aria-hidden="true" tabindex="-1"></a><span class="in">    columns = c(total_distance, total_time),</span></span>
<span id="cb36-1070"><a href="#cb36-1070" aria-hidden="true" tabindex="-1"></a><span class="in">    fns = list(Subtotal = ~ sum(.)),</span></span>
<span id="cb36-1071"><a href="#cb36-1071" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt = list(</span></span>
<span id="cb36-1072"><a href="#cb36-1072" aria-hidden="true" tabindex="-1"></a><span class="in">      ~fmt_number(., columns = total_distance, decimals = 0),</span></span>
<span id="cb36-1073"><a href="#cb36-1073" aria-hidden="true" tabindex="-1"></a><span class="in">      ~fmt(., columns = total_time, fns = fmt_difftime)</span></span>
<span id="cb36-1074"><a href="#cb36-1074" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb36-1075"><a href="#cb36-1075" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1076"><a href="#cb36-1076" aria-hidden="true" tabindex="-1"></a><span class="in">  grand_summary_rows(</span></span>
<span id="cb36-1077"><a href="#cb36-1077" aria-hidden="true" tabindex="-1"></a><span class="in">    columns = c(total_distance, total_time),</span></span>
<span id="cb36-1078"><a href="#cb36-1078" aria-hidden="true" tabindex="-1"></a><span class="in">    fns = list(Total = ~ sum(.)),</span></span>
<span id="cb36-1079"><a href="#cb36-1079" aria-hidden="true" tabindex="-1"></a><span class="in">    fmt = list(</span></span>
<span id="cb36-1080"><a href="#cb36-1080" aria-hidden="true" tabindex="-1"></a><span class="in">      ~fmt_number(., columns = total_distance, decimals = 0),</span></span>
<span id="cb36-1081"><a href="#cb36-1081" aria-hidden="true" tabindex="-1"></a><span class="in">      ~fmt(., columns = total_time, fns = fmt_difftime)</span></span>
<span id="cb36-1082"><a href="#cb36-1082" aria-hidden="true" tabindex="-1"></a><span class="in">    ),</span></span>
<span id="cb36-1083"><a href="#cb36-1083" aria-hidden="true" tabindex="-1"></a><span class="in">    missing_text = ""</span></span>
<span id="cb36-1084"><a href="#cb36-1084" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1085"><a href="#cb36-1085" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_footnote(</span></span>
<span id="cb36-1086"><a href="#cb36-1086" aria-hidden="true" tabindex="-1"></a><span class="in">    footnote = "This wasn't really a travel day; we spent the day hiking around Capitol Reef National Park and hanging out at my aunt's cabin in Grover, Utah.",</span></span>
<span id="cb36-1087"><a href="#cb36-1087" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = cells_body(</span></span>
<span id="cb36-1088"><a href="#cb36-1088" aria-hidden="true" tabindex="-1"></a><span class="in">      columns = day_month,</span></span>
<span id="cb36-1089"><a href="#cb36-1089" aria-hidden="true" tabindex="-1"></a><span class="in">      rows = day_month == "June 8"</span></span>
<span id="cb36-1090"><a href="#cb36-1090" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1091"><a href="#cb36-1091" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1092"><a href="#cb36-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  cols_label(</span></span>
<span id="cb36-1093"><a href="#cb36-1093" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = "Day",</span></span>
<span id="cb36-1094"><a href="#cb36-1094" aria-hidden="true" tabindex="-1"></a><span class="in">    total_distance = "Miles",</span></span>
<span id="cb36-1095"><a href="#cb36-1095" aria-hidden="true" tabindex="-1"></a><span class="in">    total_time = "Driving time",</span></span>
<span id="cb36-1096"><a href="#cb36-1096" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_start_time = "Start time",</span></span>
<span id="cb36-1097"><a href="#cb36-1097" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_end_time = "End time"</span></span>
<span id="cb36-1098"><a href="#cb36-1098" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1099"><a href="#cb36-1099" aria-hidden="true" tabindex="-1"></a><span class="in">  cols_align(</span></span>
<span id="cb36-1100"><a href="#cb36-1100" aria-hidden="true" tabindex="-1"></a><span class="in">    columns = total_time,</span></span>
<span id="cb36-1101"><a href="#cb36-1101" aria-hidden="true" tabindex="-1"></a><span class="in">    align = "left"</span></span>
<span id="cb36-1102"><a href="#cb36-1102" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1103"><a href="#cb36-1103" aria-hidden="true" tabindex="-1"></a><span class="in">  fmt_number(columns = total_distance, decimals = 0) %&gt;% </span></span>
<span id="cb36-1104"><a href="#cb36-1104" aria-hidden="true" tabindex="-1"></a><span class="in">  fmt(columns = total_time, fns = fmt_difftime) %&gt;% </span></span>
<span id="cb36-1105"><a href="#cb36-1105" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1106"><a href="#cb36-1106" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = cells_column_labels(),</span></span>
<span id="cb36-1107"><a href="#cb36-1107" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1108"><a href="#cb36-1108" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_text(weight = "bold")</span></span>
<span id="cb36-1109"><a href="#cb36-1109" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1110"><a href="#cb36-1110" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1111"><a href="#cb36-1111" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1112"><a href="#cb36-1112" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = cells_row_groups(),</span></span>
<span id="cb36-1113"><a href="#cb36-1113" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1114"><a href="#cb36-1114" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_text(weight = "bold")</span></span>
<span id="cb36-1115"><a href="#cb36-1115" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1116"><a href="#cb36-1116" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1117"><a href="#cb36-1117" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1118"><a href="#cb36-1118" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = list(cells_summary(), cells_stub_summary()),</span></span>
<span id="cb36-1119"><a href="#cb36-1119" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1120"><a href="#cb36-1120" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_fill(color = "grey95")</span></span>
<span id="cb36-1121"><a href="#cb36-1121" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1122"><a href="#cb36-1122" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1123"><a href="#cb36-1123" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1124"><a href="#cb36-1124" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = list(</span></span>
<span id="cb36-1125"><a href="#cb36-1125" aria-hidden="true" tabindex="-1"></a><span class="in">      cells_grand_summary(), cells_stub_grand_summary(), </span></span>
<span id="cb36-1126"><a href="#cb36-1126" aria-hidden="true" tabindex="-1"></a><span class="in">      cells_column_labels(), cells_stubhead()),</span></span>
<span id="cb36-1127"><a href="#cb36-1127" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1128"><a href="#cb36-1128" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_text(weight = "bold"),</span></span>
<span id="cb36-1129"><a href="#cb36-1129" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_fill(color = "grey80")</span></span>
<span id="cb36-1130"><a href="#cb36-1130" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1131"><a href="#cb36-1131" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1132"><a href="#cb36-1132" aria-hidden="true" tabindex="-1"></a><span class="in">  opt_horizontal_padding(scale = 2) %&gt;% </span></span>
<span id="cb36-1133"><a href="#cb36-1133" aria-hidden="true" tabindex="-1"></a><span class="in">  opt_table_font(font = "Jost") %&gt;% </span></span>
<span id="cb36-1134"><a href="#cb36-1134" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_options(</span></span>
<span id="cb36-1135"><a href="#cb36-1135" aria-hidden="true" tabindex="-1"></a><span class="in">    row_group.as_column = TRUE,</span></span>
<span id="cb36-1136"><a href="#cb36-1136" aria-hidden="true" tabindex="-1"></a><span class="in">    footnotes.marks = "standard"</span></span>
<span id="cb36-1137"><a href="#cb36-1137" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb36-1138"><a href="#cb36-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1139"><a href="#cb36-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1140"><a href="#cb36-1140" aria-hidden="true" tabindex="-1"></a>@fig-timeline-by-day shows a timeline of each day's events.^<span class="co">[</span><span class="ot">All the times are in local time, which causes some weirdness when crossing time zones. Instead of somehow expanding or shrinking these timelines during stretches where we gained or lost time because of time zone changes, I just put a dotted border around those stretches to point them out.</span><span class="co">]</span> We typically started each day with some sort of sightseeing adventure (we didn't do this on the first day, since we left our house that day—instead, we ended that day with a walk through the French Quarter in New Orleans). Our longest touristy adventure was technically Capitol Reef National Park, since we spent the whole day there, but if we don't count that and instead look at the along-the-way stops, our longest adventures were Yellowstone, Nauvoo, and Carlsbad Caverns.</span>
<span id="cb36-1141"><a href="#cb36-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1142"><a href="#cb36-1142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-timeline-by-day, fig.width=9, fig.height=8, warning=FALSE}</span></span>
<span id="cb36-1143"><a href="#cb36-1143" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-1144"><a href="#cb36-1144" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page-right</span></span>
<span id="cb36-1145"><a href="#cb36-1145" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Timeline of our grand road trip</span></span>
<span id="cb36-1146"><a href="#cb36-1146" aria-hidden="true" tabindex="-1"></a><span class="in"># Little dataset with names for the tourist stops we made</span></span>
<span id="cb36-1147"><a href="#cb36-1147" aria-hidden="true" tabindex="-1"></a><span class="in"># Gotta do some goofy things here because I don't want things double labeled though</span></span>
<span id="cb36-1148"><a href="#cb36-1148" aria-hidden="true" tabindex="-1"></a><span class="in">#</span></span>
<span id="cb36-1149"><a href="#cb36-1149" aria-hidden="true" tabindex="-1"></a><span class="in"># - Some IDs, like ChIJgcNDAhKmIIYRRA4mio_7VgE (a parking lot near the </span></span>
<span id="cb36-1150"><a href="#cb36-1150" aria-hidden="true" tabindex="-1"></a><span class="in">#   French Quarter) show up twice as placeVisits, but there should only be one </span></span>
<span id="cb36-1151"><a href="#cb36-1151" aria-hidden="true" tabindex="-1"></a><span class="in">#   label, so down below, after merging this into the timeline data, I use </span></span>
<span id="cb36-1152"><a href="#cb36-1152" aria-hidden="true" tabindex="-1"></a><span class="in">#   `group_by(visit_label) %&gt;% slice(1)` to only keep the first visit for labeling</span></span>
<span id="cb36-1153"><a href="#cb36-1153" aria-hidden="true" tabindex="-1"></a><span class="in"># - Yellowstone, though, looks goofy if the first segment is labeled, so I want </span></span>
<span id="cb36-1154"><a href="#cb36-1154" aria-hidden="true" tabindex="-1"></a><span class="in">#   to label the second. That messes with the grouping/slicing approach, so I </span></span>
<span id="cb36-1155"><a href="#cb36-1155" aria-hidden="true" tabindex="-1"></a><span class="in">#   add a trailing space to the Yellowstone visits I don't want labeled </span></span>
<span id="cb36-1156"><a href="#cb36-1156" aria-hidden="true" tabindex="-1"></a><span class="in">#   (i.e. "Yellowstone ") and then filter those out after grouping/slicing</span></span>
<span id="cb36-1157"><a href="#cb36-1157" aria-hidden="true" tabindex="-1"></a><span class="in"># - Nauvoo happened on two different days, but grouping/slicing only keeps the </span></span>
<span id="cb36-1158"><a href="#cb36-1158" aria-hidden="true" tabindex="-1"></a><span class="in">#   first. So I make the second day's visits use a different label with a space </span></span>
<span id="cb36-1159"><a href="#cb36-1159" aria-hidden="true" tabindex="-1"></a><span class="in">#   at the beginning and end of the label (i.e. " Nauvoo ")</span></span>
<span id="cb36-1160"><a href="#cb36-1160" aria-hidden="true" tabindex="-1"></a><span class="in">sightseeing &lt;- tribble(</span></span>
<span id="cb36-1161"><a href="#cb36-1161" aria-hidden="true" tabindex="-1"></a><span class="in">  ~id,                           ~visit_label,</span></span>
<span id="cb36-1162"><a href="#cb36-1162" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJgcNDAhKmIIYRRA4mio_7VgE", "The French\nQuarter",</span></span>
<span id="cb36-1163"><a href="#cb36-1163" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJv30_Xw-mIIYRpt26QbLBh58", "The French\nQuarter",  # Technically Louis Armstrong Park</span></span>
<span id="cb36-1164"><a href="#cb36-1164" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ59n6fW8dnogRWi-5N6olcyU", "Chalmette\nBattlefield",</span></span>
<span id="cb36-1165"><a href="#cb36-1165" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJX4k2TVVfXIYRIsTnhA-P-Rc", "The Alamo",</span></span>
<span id="cb36-1166"><a href="#cb36-1166" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJW9e4xBN544YRvbI7vfc91G4", "Carlsbad\nCaverns",</span></span>
<span id="cb36-1167"><a href="#cb36-1167" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJrSLbJJIQM4cR4l5HTswDY8k", "The Grand\nCanyon",</span></span>
<span id="cb36-1168"><a href="#cb36-1168" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJU6LnB_8ASocRB_9PSFPsO94", "Capitol Reef\nNational Park",</span></span>
<span id="cb36-1169"><a href="#cb36-1169" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJIw-BhQkZSocRncIWG0YMLJU", "Capitol Reef\nNational Park",  # Technically the visitor center</span></span>
<span id="cb36-1170"><a href="#cb36-1170" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJaSHejn29SYcR-YzTt_DNlTg", "Goblin\nValley",</span></span>
<span id="cb36-1171"><a href="#cb36-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJVQ4oZOP4VFMREjDKbf7bHIE", "My sister's\nhouse",</span></span>
<span id="cb36-1172"><a href="#cb36-1172" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJp4yR8asLVFMRJJExTuHrYEs", "Rexburg",  # Technically Porter Park</span></span>
<span id="cb36-1173"><a href="#cb36-1173" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJz6VI3AMLVFMREvSOw9M0VR4", "Rexburg",  # Technically BYU-I</span></span>
<span id="cb36-1174"><a href="#cb36-1174" aria-hidden="true" tabindex="-1"></a><span class="in">  "51",                          "Yellowstone",  # Technically the drive to Old Faithful; Google missed this</span></span>
<span id="cb36-1175"><a href="#cb36-1175" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ3zGqpb65UVMR0rTSaqVZ5kc", "Yellowstone ",</span></span>
<span id="cb36-1176"><a href="#cb36-1176" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJXy5ZgRvtUVMRoSJoWid8Owg", "Yellowstone ",  # Technically Old Faithful</span></span>
<span id="cb36-1177"><a href="#cb36-1177" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJOT5U8z8GM1MResed1BOdJKk", "Devil's\nTower",</span></span>
<span id="cb36-1178"><a href="#cb36-1178" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ39Y-tdg1fYcRQcZcBb499do", "Mount\nRushmore",</span></span>
<span id="cb36-1179"><a href="#cb36-1179" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJg_2MNnKRk4cRQGXbuvgqba4", "Winter\nQuarters",</span></span>
<span id="cb36-1180"><a href="#cb36-1180" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJh53YJHIm54cRmpf8_ZA3CVw", "Nauvoo",  # Technically the visitors center</span></span>
<span id="cb36-1181"><a href="#cb36-1181" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJDUPPu3Im54cRKj6BG8UkOko", "Nauvoo",  # Technically the temple</span></span>
<span id="cb36-1182"><a href="#cb36-1182" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJg0abVHYm54cR85yQbfLjt2o", " Nauvoo ",  # Technically the family living center</span></span>
<span id="cb36-1183"><a href="#cb36-1183" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJm7cRetkl54cR-lEKk-eZnXA", " Nauvoo ",  # Technically the Smith family cemetery</span></span>
<span id="cb36-1184"><a href="#cb36-1184" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJZ6tHUwsm54cRbmWsF639PjY", " Nauvoo "   # Technically Carthage Jail</span></span>
<span id="cb36-1185"><a href="#cb36-1185" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb36-1186"><a href="#cb36-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1187"><a href="#cb36-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1188"><a href="#cb36-1188" aria-hidden="true" tabindex="-1"></a><span class="in">timeline_data &lt;- all_stops_activities %&gt;% </span></span>
<span id="cb36-1189"><a href="#cb36-1189" aria-hidden="true" tabindex="-1"></a><span class="in">  # Get rid of the geometry column since we're not doing anything map-related</span></span>
<span id="cb36-1190"><a href="#cb36-1190" aria-hidden="true" tabindex="-1"></a><span class="in">  st_drop_geometry() %&gt;% </span></span>
<span id="cb36-1191"><a href="#cb36-1191" aria-hidden="true" tabindex="-1"></a><span class="in">  # Indicate if there was a time zone change during the activity</span></span>
<span id="cb36-1192"><a href="#cb36-1192" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1193"><a href="#cb36-1193" aria-hidden="true" tabindex="-1"></a><span class="in">    tz_change = ifelse(is.na(tz_start) | tz_start_abb == tz_end_abb, NA, "Time zone change")</span></span>
<span id="cb36-1194"><a href="#cb36-1194" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1195"><a href="#cb36-1195" aria-hidden="true" tabindex="-1"></a><span class="in">  # Find the midpoint between the start and end times</span></span>
<span id="cb36-1196"><a href="#cb36-1196" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(time_mid = startTimestamp_local - ((startTimestamp_local - endTimestamp_local) / 2)) %&gt;% </span></span>
<span id="cb36-1197"><a href="#cb36-1197" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add column for the name of the tourist stop</span></span>
<span id="cb36-1198"><a href="#cb36-1198" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(sightseeing, by = join_by(id)) %&gt;% </span></span>
<span id="cb36-1199"><a href="#cb36-1199" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add column for more detailed type of stop</span></span>
<span id="cb36-1200"><a href="#cb36-1200" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1201"><a href="#cb36-1201" aria-hidden="true" tabindex="-1"></a><span class="in">    stop_type = case_when(</span></span>
<span id="cb36-1202"><a href="#cb36-1202" aria-hidden="true" tabindex="-1"></a><span class="in">      type == "visit" &amp; !is.na(visit_label) ~ "Sightseeing",</span></span>
<span id="cb36-1203"><a href="#cb36-1203" aria-hidden="true" tabindex="-1"></a><span class="in">      type == "visit" &amp; is.na(visit_label) ~ "Gas/bathroom/hotel stop",</span></span>
<span id="cb36-1204"><a href="#cb36-1204" aria-hidden="true" tabindex="-1"></a><span class="in">      type == "segment" &amp; id == "51" ~ "Sightseeing",</span></span>
<span id="cb36-1205"><a href="#cb36-1205" aria-hidden="true" tabindex="-1"></a><span class="in">      type == "segment" ~ "Traveling"</span></span>
<span id="cb36-1206"><a href="#cb36-1206" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1207"><a href="#cb36-1207" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;%</span></span>
<span id="cb36-1208"><a href="#cb36-1208" aria-hidden="true" tabindex="-1"></a><span class="in">  # After finishing at Capitol Reef we returned to my aunt's cabin in Grover to</span></span>
<span id="cb36-1209"><a href="#cb36-1209" aria-hidden="true" tabindex="-1"></a><span class="in">  # relax. I had to run back to the nearest town with 5G internet (Torrey) to</span></span>
<span id="cb36-1210"><a href="#cb36-1210" aria-hidden="true" tabindex="-1"></a><span class="in">  # respond to e-mails and Slack messages (since I was teaching two online</span></span>
<span id="cb36-1211"><a href="#cb36-1211" aria-hidden="true" tabindex="-1"></a><span class="in">  # classes throughout this whole road trip!), and that doesn't technically</span></span>
<span id="cb36-1212"><a href="#cb36-1212" aria-hidden="true" tabindex="-1"></a><span class="in">  # count as part of the road trip, so we need to remove everything after 5 PM</span></span>
<span id="cb36-1213"><a href="#cb36-1213" aria-hidden="true" tabindex="-1"></a><span class="in">  # on that day</span></span>
<span id="cb36-1214"><a href="#cb36-1214" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!(day == 8 &amp; hour(endTimestamp_local) &gt; 17)) %&gt;% </span></span>
<span id="cb36-1215"><a href="#cb36-1215" aria-hidden="true" tabindex="-1"></a><span class="in">  # After arriving at the hotel in Rexburg, we made a late-night milkshake run</span></span>
<span id="cb36-1216"><a href="#cb36-1216" aria-hidden="true" tabindex="-1"></a><span class="in">  # after the kids were in bed, which Google picked up. That doesn't technically</span></span>
<span id="cb36-1217"><a href="#cb36-1217" aria-hidden="true" tabindex="-1"></a><span class="in">  # count as part of the road trip, so we need to remove everything after 6 PM</span></span>
<span id="cb36-1218"><a href="#cb36-1218" aria-hidden="true" tabindex="-1"></a><span class="in">  # on that day</span></span>
<span id="cb36-1219"><a href="#cb36-1219" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!(day == 20 &amp; hour(endTimestamp_local) &gt; 18)) %&gt;% </span></span>
<span id="cb36-1220"><a href="#cb36-1220" aria-hidden="true" tabindex="-1"></a><span class="in">  # Set the timestamps for the final stop of the day (i.e. hotels) to NA and</span></span>
<span id="cb36-1221"><a href="#cb36-1221" aria-hidden="true" tabindex="-1"></a><span class="in">  # then remove those rows for plotting</span></span>
<span id="cb36-1222"><a href="#cb36-1222" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(day) %&gt;% </span></span>
<span id="cb36-1223"><a href="#cb36-1223" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1224"><a href="#cb36-1224" aria-hidden="true" tabindex="-1"></a><span class="in">    across(c(startTimestamp_local, endTimestamp_local), </span></span>
<span id="cb36-1225"><a href="#cb36-1225" aria-hidden="true" tabindex="-1"></a><span class="in">      ~if_else(row_number() == n(), NA, .x))</span></span>
<span id="cb36-1226"><a href="#cb36-1226" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1227"><a href="#cb36-1227" aria-hidden="true" tabindex="-1"></a><span class="in">  drop_na(startTimestamp_local)</span></span>
<span id="cb36-1228"><a href="#cb36-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1229"><a href="#cb36-1229" aria-hidden="true" tabindex="-1"></a><span class="in"># Force all the timestamps to be on the same day for the sake of plotting</span></span>
<span id="cb36-1230"><a href="#cb36-1230" aria-hidden="true" tabindex="-1"></a><span class="in">day(timeline_data$startTimestamp_local) &lt;- 1</span></span>
<span id="cb36-1231"><a href="#cb36-1231" aria-hidden="true" tabindex="-1"></a><span class="in">day(timeline_data$endTimestamp_local) &lt;- 1</span></span>
<span id="cb36-1232"><a href="#cb36-1232" aria-hidden="true" tabindex="-1"></a><span class="in">day(timeline_data$time_mid) &lt;- 1</span></span>
<span id="cb36-1233"><a href="#cb36-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1234"><a href="#cb36-1234" aria-hidden="true" tabindex="-1"></a><span class="in"># Extract just the labels for plotting</span></span>
<span id="cb36-1235"><a href="#cb36-1235" aria-hidden="true" tabindex="-1"></a><span class="in">sightseeing_labels &lt;- timeline_data %&gt;% </span></span>
<span id="cb36-1236"><a href="#cb36-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(stop_type == "Sightseeing") %&gt;% </span></span>
<span id="cb36-1237"><a href="#cb36-1237" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(visit_label) %&gt;% </span></span>
<span id="cb36-1238"><a href="#cb36-1238" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(1) %&gt;% </span></span>
<span id="cb36-1239"><a href="#cb36-1239" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(visit_label != "Yellowstone ")</span></span>
<span id="cb36-1240"><a href="#cb36-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1241"><a href="#cb36-1241" aria-hidden="true" tabindex="-1"></a><span class="in"># Timeline plot</span></span>
<span id="cb36-1242"><a href="#cb36-1242" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(timeline_data) +</span></span>
<span id="cb36-1243"><a href="#cb36-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_rect(</span></span>
<span id="cb36-1244"><a href="#cb36-1244" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb36-1245"><a href="#cb36-1245" aria-hidden="true" tabindex="-1"></a><span class="in">      xmin = startTimestamp_local, xmax = endTimestamp_local, </span></span>
<span id="cb36-1246"><a href="#cb36-1246" aria-hidden="true" tabindex="-1"></a><span class="in">      ymin = 0, ymax = 1, </span></span>
<span id="cb36-1247"><a href="#cb36-1247" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = stop_type, color = tz_change, linetype = tz_change, linewidth = tz_change</span></span>
<span id="cb36-1248"><a href="#cb36-1248" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1249"><a href="#cb36-1249" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1250"><a href="#cb36-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_label(</span></span>
<span id="cb36-1251"><a href="#cb36-1251" aria-hidden="true" tabindex="-1"></a><span class="in">    data = sightseeing_labels,</span></span>
<span id="cb36-1252"><a href="#cb36-1252" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = time_mid, y = 0.5, label = visit_label),</span></span>
<span id="cb36-1253"><a href="#cb36-1253" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = colorspace::lighten(clrs[8], 0.1), color = "white", lineheight = 1,</span></span>
<span id="cb36-1254"><a href="#cb36-1254" aria-hidden="true" tabindex="-1"></a><span class="in">    inherit.aes = FALSE</span></span>
<span id="cb36-1255"><a href="#cb36-1255" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1256"><a href="#cb36-1256" aria-hidden="true" tabindex="-1"></a><span class="in">  # Phew fancy aesthetic and scale work here</span></span>
<span id="cb36-1257"><a href="#cb36-1257" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_datetime(date_breaks = "3 hours", date_labels = "%I:%M %p") +</span></span>
<span id="cb36-1258"><a href="#cb36-1258" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(expand = expansion(0, 0)) +</span></span>
<span id="cb36-1259"><a href="#cb36-1259" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = c(clrs[6], clrs[8], clrs[2]), guide = guide_legend(order = 1)) +</span></span>
<span id="cb36-1260"><a href="#cb36-1260" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_manual(values = c("black", "white")) +</span></span>
<span id="cb36-1261"><a href="#cb36-1261" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_linewidth_discrete(range = c(0.5, 0)) +</span></span>
<span id="cb36-1262"><a href="#cb36-1262" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_linetype_manual(</span></span>
<span id="cb36-1263"><a href="#cb36-1263" aria-hidden="true" tabindex="-1"></a><span class="in">    values = c("21"), breaks = "Time zone change",</span></span>
<span id="cb36-1264"><a href="#cb36-1264" aria-hidden="true" tabindex="-1"></a><span class="in">    guide = guide_legend(override.aes = list(fill = "white", color = "black", linewidth = 0.5), order = 10)</span></span>
<span id="cb36-1265"><a href="#cb36-1265" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1266"><a href="#cb36-1266" aria-hidden="true" tabindex="-1"></a><span class="in">  guides(color = "none", linewidth = "none") +</span></span>
<span id="cb36-1267"><a href="#cb36-1267" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(day_month), ncol = 2, dir = "v") +</span></span>
<span id="cb36-1268"><a href="#cb36-1268" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL, linetype = NULL, fill = NULL) +</span></span>
<span id="cb36-1269"><a href="#cb36-1269" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip() +</span></span>
<span id="cb36-1270"><a href="#cb36-1270" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb36-1271"><a href="#cb36-1271" aria-hidden="true" tabindex="-1"></a><span class="in">    axis.text.y = element_blank(),</span></span>
<span id="cb36-1272"><a href="#cb36-1272" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.grid.major.y = element_blank(),</span></span>
<span id="cb36-1273"><a href="#cb36-1273" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "bottom"</span></span>
<span id="cb36-1274"><a href="#cb36-1274" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb36-1275"><a href="#cb36-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1276"><a href="#cb36-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1277"><a href="#cb36-1277" aria-hidden="true" tabindex="-1"></a><span class="fu">## Driving and breaks</span></span>
<span id="cb36-1278"><a href="#cb36-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1279"><a href="#cb36-1279" aria-hidden="true" tabindex="-1"></a>As seen in @fig-timeline-by-day, we had a pretty good rhythm of driving and taking gas/bathroom breaks—we broke up long stretches of driving with stops for gas and bathrooms.</span>
<span id="cb36-1280"><a href="#cb36-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1281"><a href="#cb36-1281" aria-hidden="true" tabindex="-1"></a>@tbl-driving-longest-shortest shows the top three longest and shortest stretches of driving. The longest stretch was on the final day—we drove 4 hours from Nashville to Atlanta with no bathroom breaks. We apparently just desperately wanted to get home! We did the same push-through-to-the-last-stop approach a few other times too. The third longest stretch was actually our first on the way home, leaving Spanish Fork, Utah to my sister's house outside of Rexburg, Idaho, which we did in 3.5 hours, while the 2nd and 5th longest stretches involved pushing to our final destinations for the day (a hotel in Nauvoo, Illinois and my aunt's cabin in Grover, Utah). The only long stretch that broke this patter was the fourth longest one after Carlsbad Caverns—we spent more than 3 hours on a little state road going all the way from southern New Mexico to a gas station at I-20.</span>
<span id="cb36-1282"><a href="#cb36-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1283"><a href="#cb36-1283" aria-hidden="true" tabindex="-1"></a>The shortest stretches involved going from a main sightseeing stop to a gas station (Mount Rushmore to some Holiday gas station), going between sightseeing stops (the Smith Family Cemetery in Nauvoo to Carthage Jail), or going from a hotel to a sightseeing stop (our hotel in Carlsbad to Carlsbad Caverns National Park).</span>
<span id="cb36-1284"><a href="#cb36-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1285"><a href="#cb36-1285" aria-hidden="true" tabindex="-1"></a>My favorite short stop is number 4 here, on June 4. We got gas in Louisiana somewhere and then had to stop at another gas station in Texas 39 minutes later for an emergency break for little kids who suddenly needed to use the bathroom again. After that particular stop, we instituted a "no drinking soda or juice in the car" rule for the kids and suddenly—like magic—their bladders worked a lot more slowly and we stopped making such frequent stops.</span>
<span id="cb36-1286"><a href="#cb36-1286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1287"><a href="#cb36-1287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r tbl-driving-longest-shortest}</span></span>
<span id="cb36-1288"><a href="#cb36-1288" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-1289"><a href="#cb36-1289" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page-right</span></span>
<span id="cb36-1290"><a href="#cb36-1290" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: Top five longest and shortest stretches of driving during the trip</span></span>
<span id="cb36-1291"><a href="#cb36-1291" aria-hidden="true" tabindex="-1"></a><span class="in">driving_data &lt;- all_stops_activities %&gt;% </span></span>
<span id="cb36-1292"><a href="#cb36-1292" aria-hidden="true" tabindex="-1"></a><span class="in">  # Get rid of the geometry column since we're not doing anything map-related</span></span>
<span id="cb36-1293"><a href="#cb36-1293" aria-hidden="true" tabindex="-1"></a><span class="in">  st_drop_geometry() %&gt;% </span></span>
<span id="cb36-1294"><a href="#cb36-1294" aria-hidden="true" tabindex="-1"></a><span class="in">  # Find the previous and next place visits</span></span>
<span id="cb36-1295"><a href="#cb36-1295" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1296"><a href="#cb36-1296" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_name = lag(name),</span></span>
<span id="cb36-1297"><a href="#cb36-1297" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_address = lag(address),</span></span>
<span id="cb36-1298"><a href="#cb36-1298" aria-hidden="true" tabindex="-1"></a><span class="in">    destination_name = lead(name),</span></span>
<span id="cb36-1299"><a href="#cb36-1299" aria-hidden="true" tabindex="-1"></a><span class="in">    destination_address = lead(address)</span></span>
<span id="cb36-1300"><a href="#cb36-1300" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1301"><a href="#cb36-1301" aria-hidden="true" tabindex="-1"></a><span class="in">  # lag() doesn't work for the first entry, so manually add it</span></span>
<span id="cb36-1302"><a href="#cb36-1302" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1303"><a href="#cb36-1303" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_name = ifelse(id == 1, "Home", origin_name),</span></span>
<span id="cb36-1304"><a href="#cb36-1304" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_address = ifelse(id == 1, "Atlanta, GA, USA", origin_address)</span></span>
<span id="cb36-1305"><a href="#cb36-1305" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1306"><a href="#cb36-1306" aria-hidden="true" tabindex="-1"></a><span class="in">  # Only look at driving activities</span></span>
<span id="cb36-1307"><a href="#cb36-1307" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(activity_type == "IN_PASSENGER_VEHICLE") %&gt;% </span></span>
<span id="cb36-1308"><a href="#cb36-1308" aria-hidden="true" tabindex="-1"></a><span class="in">  # Get rid of empty, place-related columns</span></span>
<span id="cb36-1309"><a href="#cb36-1309" aria-hidden="true" tabindex="-1"></a><span class="in">  select(-c(name, address, driving_stop, tz, geometry_start, geometry_end))</span></span>
<span id="cb36-1310"><a href="#cb36-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1311"><a href="#cb36-1311" aria-hidden="true" tabindex="-1"></a><span class="in"># Longest, shortest stretch of driving</span></span>
<span id="cb36-1312"><a href="#cb36-1312" aria-hidden="true" tabindex="-1"></a><span class="in">driving_data %&gt;% </span></span>
<span id="cb36-1313"><a href="#cb36-1313" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(distance_miles &gt; 10) %&gt;%</span></span>
<span id="cb36-1314"><a href="#cb36-1314" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(duration_rank = rank(-duration)) %&gt;% </span></span>
<span id="cb36-1315"><a href="#cb36-1315" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(top_bottom = case_when(</span></span>
<span id="cb36-1316"><a href="#cb36-1316" aria-hidden="true" tabindex="-1"></a><span class="in">    duration_rank %in% 1:5 ~ "Longest stretches",</span></span>
<span id="cb36-1317"><a href="#cb36-1317" aria-hidden="true" tabindex="-1"></a><span class="in">    duration_rank %in% seq(n() - 4, n(), by = 1) ~ "Shortest stretches"</span></span>
<span id="cb36-1318"><a href="#cb36-1318" aria-hidden="true" tabindex="-1"></a><span class="in">  )) %&gt;% </span></span>
<span id="cb36-1319"><a href="#cb36-1319" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!is.na(top_bottom)) %&gt;% </span></span>
<span id="cb36-1320"><a href="#cb36-1320" aria-hidden="true" tabindex="-1"></a><span class="in">  arrange(</span></span>
<span id="cb36-1321"><a href="#cb36-1321" aria-hidden="true" tabindex="-1"></a><span class="in">    top_bottom, </span></span>
<span id="cb36-1322"><a href="#cb36-1322" aria-hidden="true" tabindex="-1"></a><span class="in">    ifelse(top_bottom == "Shortest stretches", desc(duration_rank), duration_rank)</span></span>
<span id="cb36-1323"><a href="#cb36-1323" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1324"><a href="#cb36-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  # Format time stuff nicely</span></span>
<span id="cb36-1325"><a href="#cb36-1325" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1326"><a href="#cb36-1326" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_time = fmt_difftime(duration),</span></span>
<span id="cb36-1327"><a href="#cb36-1327" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_start_time = paste(strftime(startTimestamp_local, format = "%I:%M %p", tz = "UTC"), tz_start_abb),</span></span>
<span id="cb36-1328"><a href="#cb36-1328" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_end_time = paste(strftime(endTimestamp_local, format = "%I:%M %p", tz = "UTC"), tz_end_abb)</span></span>
<span id="cb36-1329"><a href="#cb36-1329" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1330"><a href="#cb36-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  # Remove leading zeros from hour</span></span>
<span id="cb36-1331"><a href="#cb36-1331" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(across(c(nice_start_time, nice_end_time), ~str_replace(.x, "^0", ""))) %&gt;% </span></span>
<span id="cb36-1332"><a href="#cb36-1332" aria-hidden="true" tabindex="-1"></a><span class="in">  # Make nice origin and destination columns</span></span>
<span id="cb36-1333"><a href="#cb36-1333" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb36-1334"><a href="#cb36-1334" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_nice = glue('{origin_name}&lt;br&gt;&lt;span class="smaller-address"&gt;{origin_address}&lt;/span&gt;'),</span></span>
<span id="cb36-1335"><a href="#cb36-1335" aria-hidden="true" tabindex="-1"></a><span class="in">    destination_nice = glue('{destination_name}&lt;br&gt;&lt;span class="smaller-address"&gt;{destination_address}&lt;/span&gt;')</span></span>
<span id="cb36-1336"><a href="#cb36-1336" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1337"><a href="#cb36-1337" aria-hidden="true" tabindex="-1"></a><span class="in">  select(</span></span>
<span id="cb36-1338"><a href="#cb36-1338" aria-hidden="true" tabindex="-1"></a><span class="in">    top_bottom, day_month, nice_time, nice_start_time, nice_end_time, </span></span>
<span id="cb36-1339"><a href="#cb36-1339" aria-hidden="true" tabindex="-1"></a><span class="in">    distance_miles, origin_nice, destination_nice</span></span>
<span id="cb36-1340"><a href="#cb36-1340" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1341"><a href="#cb36-1341" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(top_bottom) %&gt;% </span></span>
<span id="cb36-1342"><a href="#cb36-1342" aria-hidden="true" tabindex="-1"></a><span class="in">  gt() %&gt;% </span></span>
<span id="cb36-1343"><a href="#cb36-1343" aria-hidden="true" tabindex="-1"></a><span class="in">  cols_label(</span></span>
<span id="cb36-1344"><a href="#cb36-1344" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_time = "Driving time",</span></span>
<span id="cb36-1345"><a href="#cb36-1345" aria-hidden="true" tabindex="-1"></a><span class="in">    day_month = "Day",</span></span>
<span id="cb36-1346"><a href="#cb36-1346" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_start_time = "Start time",</span></span>
<span id="cb36-1347"><a href="#cb36-1347" aria-hidden="true" tabindex="-1"></a><span class="in">    nice_end_time = "End time",</span></span>
<span id="cb36-1348"><a href="#cb36-1348" aria-hidden="true" tabindex="-1"></a><span class="in">    distance_miles = "Miles",</span></span>
<span id="cb36-1349"><a href="#cb36-1349" aria-hidden="true" tabindex="-1"></a><span class="in">    origin_nice = "Origin",</span></span>
<span id="cb36-1350"><a href="#cb36-1350" aria-hidden="true" tabindex="-1"></a><span class="in">    destination_nice = "Destination"</span></span>
<span id="cb36-1351"><a href="#cb36-1351" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1352"><a href="#cb36-1352" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1353"><a href="#cb36-1353" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = list(cells_column_labels(), cells_stubhead()),</span></span>
<span id="cb36-1354"><a href="#cb36-1354" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1355"><a href="#cb36-1355" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_text(weight = "bold"),</span></span>
<span id="cb36-1356"><a href="#cb36-1356" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_fill(color = "grey80")</span></span>
<span id="cb36-1357"><a href="#cb36-1357" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1358"><a href="#cb36-1358" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1359"><a href="#cb36-1359" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_style(</span></span>
<span id="cb36-1360"><a href="#cb36-1360" aria-hidden="true" tabindex="-1"></a><span class="in">    locations = cells_row_groups(),</span></span>
<span id="cb36-1361"><a href="#cb36-1361" aria-hidden="true" tabindex="-1"></a><span class="in">    style = list(</span></span>
<span id="cb36-1362"><a href="#cb36-1362" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_text(weight = "bold"),</span></span>
<span id="cb36-1363"><a href="#cb36-1363" aria-hidden="true" tabindex="-1"></a><span class="in">      cell_fill(color = "grey95")</span></span>
<span id="cb36-1364"><a href="#cb36-1364" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb36-1365"><a href="#cb36-1365" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1366"><a href="#cb36-1366" aria-hidden="true" tabindex="-1"></a><span class="in">  cols_align(</span></span>
<span id="cb36-1367"><a href="#cb36-1367" aria-hidden="true" tabindex="-1"></a><span class="in">    columns = c(day_month, origin_nice, destination_nice),</span></span>
<span id="cb36-1368"><a href="#cb36-1368" aria-hidden="true" tabindex="-1"></a><span class="in">    align = "left"</span></span>
<span id="cb36-1369"><a href="#cb36-1369" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1370"><a href="#cb36-1370" aria-hidden="true" tabindex="-1"></a><span class="in">  fmt_markdown(columns = c(origin_nice, destination_nice)) %&gt;% </span></span>
<span id="cb36-1371"><a href="#cb36-1371" aria-hidden="true" tabindex="-1"></a><span class="in">  fmt_number(columns = distance_miles, decimals = 0) %&gt;% </span></span>
<span id="cb36-1372"><a href="#cb36-1372" aria-hidden="true" tabindex="-1"></a><span class="in">  tab_footnote(</span></span>
<span id="cb36-1373"><a href="#cb36-1373" aria-hidden="true" tabindex="-1"></a><span class="in">    footnote = "Stretches less than 10 miles omitted (like if we had lunch somewhere and drove down the street to get gas)."</span></span>
<span id="cb36-1374"><a href="#cb36-1374" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1375"><a href="#cb36-1375" aria-hidden="true" tabindex="-1"></a><span class="in">  opt_css(</span></span>
<span id="cb36-1376"><a href="#cb36-1376" aria-hidden="true" tabindex="-1"></a><span class="in">    css = "</span></span>
<span id="cb36-1377"><a href="#cb36-1377" aria-hidden="true" tabindex="-1"></a><span class="in">    .smaller-address {</span></span>
<span id="cb36-1378"><a href="#cb36-1378" aria-hidden="true" tabindex="-1"></a><span class="in">      font-size: 0.7em;</span></span>
<span id="cb36-1379"><a href="#cb36-1379" aria-hidden="true" tabindex="-1"></a><span class="in">    }"</span></span>
<span id="cb36-1380"><a href="#cb36-1380" aria-hidden="true" tabindex="-1"></a><span class="in">  ) %&gt;% </span></span>
<span id="cb36-1381"><a href="#cb36-1381" aria-hidden="true" tabindex="-1"></a><span class="in">  opt_table_font(font = "Jost")</span></span>
<span id="cb36-1382"><a href="#cb36-1382" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1383"><a href="#cb36-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1384"><a href="#cb36-1384" aria-hidden="true" tabindex="-1"></a>What about the stops? How long was a typical gas/bathroom break? @fig-stop-duration-dist shows the distribution of the duration of all the non-touristy stops, and it actually reveals a pretty neat trimodal distribution! We had three general types of stops:</span>
<span id="cb36-1385"><a href="#cb36-1385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1386"><a href="#cb36-1386" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Fast** (*10ish minutes*): stops for switching drivers, getting gas right after a sightseeing visit, or letting one kid go to the bathroom</span>
<span id="cb36-1387"><a href="#cb36-1387" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Standard** (*25ish minutes*): stops where we got gas and had everyone go to the bathroom</span>
<span id="cb36-1388"><a href="#cb36-1388" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Meal** (*40ish minutes*): stops where we got gas, went to the bathroom, ate food (typically peanut butter sandwiches that we made in the hotel in the morning), and walked around to stretch</span>
<span id="cb36-1389"><a href="#cb36-1389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1390"><a href="#cb36-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-stop-duration-dist, fig.width=6, fig.height=3.8}</span></span>
<span id="cb36-1391"><a href="#cb36-1391" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-1392"><a href="#cb36-1392" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Distribution of non-sightseeing stops for the first four days of the trip</span></span>
<span id="cb36-1393"><a href="#cb36-1393" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap-location: margin</span></span>
<span id="cb36-1394"><a href="#cb36-1394" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 90%</span></span>
<span id="cb36-1395"><a href="#cb36-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1396"><a href="#cb36-1396" aria-hidden="true" tabindex="-1"></a><span class="in"># Cut duration into three categories</span></span>
<span id="cb36-1397"><a href="#cb36-1397" aria-hidden="true" tabindex="-1"></a><span class="in">places_hist_data &lt;- place_visits %&gt;% </span></span>
<span id="cb36-1398"><a href="#cb36-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(driving_stop == TRUE) %&gt;% </span></span>
<span id="cb36-1399"><a href="#cb36-1399" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(range = cut(as.numeric(duration), breaks = c(0, 15, 35, 50)))</span></span>
<span id="cb36-1400"><a href="#cb36-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1401"><a href="#cb36-1401" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(places_hist_data, aes(x = as.numeric(duration), fill = range)) +</span></span>
<span id="cb36-1402"><a href="#cb36-1402" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 5, boundary = 0, color = "white") +</span></span>
<span id="cb36-1403"><a href="#cb36-1403" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 10, y = 7.75, label = "Fast stop") +</span></span>
<span id="cb36-1404"><a href="#cb36-1404" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 6, xend = 14, y = 7.35, yend = 7.35) +</span></span>
<span id="cb36-1405"><a href="#cb36-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 25, y = 7.75, label = "Standard gas + bathroom") +</span></span>
<span id="cb36-1406"><a href="#cb36-1406" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 16, xend = 34, y = 7.35, yend = 7.35) +</span></span>
<span id="cb36-1407"><a href="#cb36-1407" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "text", x = 42.5, y = 7.75, label = "Gas + bathroom + meal") +</span></span>
<span id="cb36-1408"><a href="#cb36-1408" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(geom = "segment", x = 36, xend = 49, y = 7.35, yend = 7.35) +</span></span>
<span id="cb36-1409"><a href="#cb36-1409" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(breaks = seq(0, 6, by = 2)) +</span></span>
<span id="cb36-1410"><a href="#cb36-1410" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(7, 2, 1)], guide = "none") +</span></span>
<span id="cb36-1411"><a href="#cb36-1411" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Minutes", y = "Count") +</span></span>
<span id="cb36-1412"><a href="#cb36-1412" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip() +</span></span>
<span id="cb36-1413"><a href="#cb36-1413" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(panel.grid.major.x = element_blank())</span></span>
<span id="cb36-1414"><a href="#cb36-1414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1415"><a href="#cb36-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1416"><a href="#cb36-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1417"><a href="#cb36-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">## Elevation over time</span></span>
<span id="cb36-1418"><a href="#cb36-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1419"><a href="#cb36-1419" aria-hidden="true" tabindex="-1"></a>And finally, just for fun since Google tracked this data and we might as well do something neat with it, we can look at how much the elevation changed over the course of the trip. Atlanta is 1,000 feet above sea level, and Utah County is 4,500 feed above sea level, but the 3,500-foot increase in elevation was hardly uniform. We dropped down to below sea level in New Orleans, climbed up to above 4,000 feet in Carlsbad (it turns out that Carlsbad Caverns is on top of a big mountain), and then climbed rapidly up to the Grand Canyon and Southern Utah in general at 7,500ish feet until dropping down to 4,500 feet at our final destination in Utah.</span>
<span id="cb36-1420"><a href="#cb36-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1421"><a href="#cb36-1421" aria-hidden="true" tabindex="-1"></a>On the way back, we stayed at around 4,500ish feet until Yellowstone, where we hit the highest elevation of the whole trip at 8,530 feet. We then gradually worked our way down toward sea level as we traveled further east, finally hitting 1,000ish feet at the Mississippi River at Nauvoo, Illinois, where we mostly stayed until getting home (with a little Appalachian spike near the end).</span>
<span id="cb36-1422"><a href="#cb36-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1423"><a href="#cb36-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r fig-elevation, fig.width=12, fig.height=5, warning=FALSE}</span></span>
<span id="cb36-1424"><a href="#cb36-1424" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb36-1425"><a href="#cb36-1425" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: page-right</span></span>
<span id="cb36-1426"><a href="#cb36-1426" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Elevation over the course of the trip</span></span>
<span id="cb36-1427"><a href="#cb36-1427" aria-hidden="true" tabindex="-1"></a><span class="in">elevation_data &lt;- all_locations %&gt;% </span></span>
<span id="cb36-1428"><a href="#cb36-1428" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(elevation = meters_to_feet(altitude))</span></span>
<span id="cb36-1429"><a href="#cb36-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1430"><a href="#cb36-1430" aria-hidden="true" tabindex="-1"></a><span class="in">elevation_stops &lt;- tribble(</span></span>
<span id="cb36-1431"><a href="#cb36-1431" aria-hidden="true" tabindex="-1"></a><span class="in">  ~id,                       ~direction,  ~nudge_direction, ~stop_label,</span></span>
<span id="cb36-1432"><a href="#cb36-1432" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJv30_Xw-mIIYRpt26QbLBh58", "There", "up", "New Orleans,\nLouisiana",</span></span>
<span id="cb36-1433"><a href="#cb36-1433" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJX4k2TVVfXIYRIsTnhA-P-Rc", "There", "down", "San Antonio,\nTexas",</span></span>
<span id="cb36-1434"><a href="#cb36-1434" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJW9e4xBN544YRvbI7vfc91G4", "There", "down", "Carlsbad Caverns,\nNew Mexico",</span></span>
<span id="cb36-1435"><a href="#cb36-1435" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJrSLbJJIQM4cR4l5HTswDY8k", "There", "up", "The Grand Canyon,\nArizona",</span></span>
<span id="cb36-1436"><a href="#cb36-1436" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJU6LnB_8ASocRB_9PSFPsO94", "There", "up", "Capitol Reef,\nUtah",</span></span>
<span id="cb36-1437"><a href="#cb36-1437" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJz6VI3AMLVFMREvSOw9M0VR4", "Back again", "down", "Rexburg,\nIdaho",</span></span>
<span id="cb36-1438"><a href="#cb36-1438" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJSWHsxv8JTlMR82z8b6wF_BM", "Back again", "up", "Yellowstone,\nWyoming",</span></span>
<span id="cb36-1439"><a href="#cb36-1439" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJ39Y-tdg1fYcRQcZcBb499do", "Back again", "up", "Mount Rushmore,\nSouth Dakota",</span></span>
<span id="cb36-1440"><a href="#cb36-1440" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJDUPPu3Im54cRKj6BG8UkOko", "Back again", "down", "Nauvoo,\nIllinois",</span></span>
<span id="cb36-1441"><a href="#cb36-1441" aria-hidden="true" tabindex="-1"></a><span class="in">  "ChIJtUcJ-n36ZIgRhzY2PM19eWA", "Back again", "up", "Nashville,\nTennessee"</span></span>
<span id="cb36-1442"><a href="#cb36-1442" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb36-1443"><a href="#cb36-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1444"><a href="#cb36-1444" aria-hidden="true" tabindex="-1"></a><span class="in">stops_to_show &lt;- place_visits %&gt;% </span></span>
<span id="cb36-1445"><a href="#cb36-1445" aria-hidden="true" tabindex="-1"></a><span class="in">  st_drop_geometry() %&gt;% </span></span>
<span id="cb36-1446"><a href="#cb36-1446" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(id %in% elevation_stops$id) %&gt;% </span></span>
<span id="cb36-1447"><a href="#cb36-1447" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(elevation_stops, by = join_by(id)) %&gt;% </span></span>
<span id="cb36-1448"><a href="#cb36-1448" aria-hidden="true" tabindex="-1"></a><span class="in">  # Magical new join_by(closest(...)) syntax for inexact, approximate matching</span></span>
<span id="cb36-1449"><a href="#cb36-1449" aria-hidden="true" tabindex="-1"></a><span class="in">  # to get the closest elevation for the stop(!)</span></span>
<span id="cb36-1450"><a href="#cb36-1450" aria-hidden="true" tabindex="-1"></a><span class="in">  left_join(elevation_data, by = join_by(closest(startTimestamp_local &gt;= timestamp))) %&gt;% </span></span>
<span id="cb36-1451"><a href="#cb36-1451" aria-hidden="true" tabindex="-1"></a><span class="in">  # Get rid of duplicate ids</span></span>
<span id="cb36-1452"><a href="#cb36-1452" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(id) %&gt;% </span></span>
<span id="cb36-1453"><a href="#cb36-1453" aria-hidden="true" tabindex="-1"></a><span class="in">  slice(1) %&gt;% </span></span>
<span id="cb36-1454"><a href="#cb36-1454" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup()</span></span>
<span id="cb36-1455"><a href="#cb36-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1456"><a href="#cb36-1456" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(elevation_data, aes(x = timestamp_local, y = elevation)) +</span></span>
<span id="cb36-1457"><a href="#cb36-1457" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.3) +</span></span>
<span id="cb36-1458"><a href="#cb36-1458" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text_repel(</span></span>
<span id="cb36-1459"><a href="#cb36-1459" aria-hidden="true" tabindex="-1"></a><span class="in">    data = filter(stops_to_show, nudge_direction == "up"),</span></span>
<span id="cb36-1460"><a href="#cb36-1460" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = startTimestamp_local, label = stop_label),</span></span>
<span id="cb36-1461"><a href="#cb36-1461" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_y = 2500, direction = "y", lineheight = 1, family = "Overpass ExtraBold",</span></span>
<span id="cb36-1462"><a href="#cb36-1462" aria-hidden="true" tabindex="-1"></a><span class="in">    color = clrs[8], segment.color = clrs[7], seed = 1234</span></span>
<span id="cb36-1463"><a href="#cb36-1463" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1464"><a href="#cb36-1464" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_text_repel(</span></span>
<span id="cb36-1465"><a href="#cb36-1465" aria-hidden="true" tabindex="-1"></a><span class="in">    data = filter(stops_to_show, nudge_direction == "down"),</span></span>
<span id="cb36-1466"><a href="#cb36-1466" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(x = startTimestamp_local, label = stop_label),</span></span>
<span id="cb36-1467"><a href="#cb36-1467" aria-hidden="true" tabindex="-1"></a><span class="in">    nudge_y = -1000, lineheight = 1, family = "Overpass ExtraBold",</span></span>
<span id="cb36-1468"><a href="#cb36-1468" aria-hidden="true" tabindex="-1"></a><span class="in">    color = clrs[8], segment.color = clrs[7], seed = 1234</span></span>
<span id="cb36-1469"><a href="#cb36-1469" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1470"><a href="#cb36-1470" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_datetime(date_breaks = "1 day", date_labels = "%B %e") +</span></span>
<span id="cb36-1471"><a href="#cb36-1471" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_continuous(</span></span>
<span id="cb36-1472"><a href="#cb36-1472" aria-hidden="true" tabindex="-1"></a><span class="in">    breaks = seq(0, 8000, by = 2000),</span></span>
<span id="cb36-1473"><a href="#cb36-1473" aria-hidden="true" tabindex="-1"></a><span class="in">    labels = label_comma(suffix = " ft.")</span></span>
<span id="cb36-1474"><a href="#cb36-1474" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb36-1475"><a href="#cb36-1475" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = "Elevation") +</span></span>
<span id="cb36-1476"><a href="#cb36-1476" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(direction), scales = "free_x") +</span></span>
<span id="cb36-1477"><a href="#cb36-1477" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_roadtrip()</span></span>
<span id="cb36-1478"><a href="#cb36-1478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb36-1479"><a href="#cb36-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1480"><a href="#cb36-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1481"><a href="#cb36-1481" aria-hidden="true" tabindex="-1"></a><span class="fu"># The end</span></span>
<span id="cb36-1482"><a href="#cb36-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-1483"><a href="#cb36-1483" aria-hidden="true" tabindex="-1"></a>This only scratches the surface of what you can do with your Google Location History data. There's a ton of other stuff in those JSON files, including second-by-second data of each <span class="in">`activitySegment`</span> (though those entries seem to use Google's internal <span class="in">`ChIJ********`</span> <span class="co">[</span><span class="ot">Place IDs</span><span class="co">](https://developers.google.com/maps/documentation/places/web-service/place-id)</span> and not latitude and longitude coordinates), sub-visits for <span class="in">`placeVisits`</span>, and lots of other stuff. Smarter people than me can dig through and figure out that data!</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><span class="faux-block">Forked from <a href="https://www.andrewheiss.com/">Andrew Heiss</a></span> # <span class="faux-block"><a href="https://github.com/andrewheiss/ath-quarto">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer>


</body></html>