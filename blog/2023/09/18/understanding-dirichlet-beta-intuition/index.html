<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Andrew Heiss">
<meta name="description" content="Learn about the Dirichlet distribution and explore how it’s just a fancier version of the Beta distribution">
<title>Guide to understanding the intuition behind the Dirichlet distribution | Andrew Heiss – Andrew Heiss</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../../">
<link href="../../../../..//files/favicon-512.png" rel="icon" type="image/png">
<script src="../../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-html/quarto-syntax-highlighting-17c909d5fd25ae21b861c0c7a49b2096.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../../site_libs/bootstrap/bootstrap-5cd0811f461c8271ae6bab49df9501be.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../../../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script src="../../../../../site_libs/quarto-contrib/iconify-2.0.0/iconify-icon.min.js"></script><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-527449-5', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script><style>

      .quarto-title-block .quarto-title-banner {
        background: #170C3A;
      }
</style>
<script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="Guide to understanding the intuition behind the Dirichlet distribution | Andrew Heiss">
<meta property="og:description" content="Learn about the Dirichlet distribution and explore how it’s just a fancier version of the Beta distribution">
<meta property="og:image" content="https://www.andrewheiss.com/blog/2023/09/18/understanding-dirichlet-beta-intuition/index_files/figure-html/plot-3-7-2-betas-1.png">
<meta property="og:site_name" content="Andrew Heiss">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="1584">
<meta property="og:image:width" content="2304">
<meta name="twitter:title" content="Guide to understanding the intuition behind the Dirichlet distribution | Andrew Heiss">
<meta name="twitter:description" content="Learn about the Dirichlet distribution and explore how it’s just a fancier version of the Beta distribution">
<meta name="twitter:image" content="https://www.andrewheiss.com/blog/2023/09/18/understanding-dirichlet-beta-intuition/index_files/figure-html/plot-3-7-2-betas-1.png">
<meta name="twitter:creator" content="@andrewheiss">
<meta name="twitter:site" content="@andrewheiss">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image-height" content="1584">
<meta name="twitter:image-width" content="2304">
</head>
<body class="floating nav-fixed slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../../index.html">
    <span class="navbar-title">Andrew Heiss</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../blog/index.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../research/index.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../now/index.html"> 
<span class="menu-text">Now</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../../uses/index.html"> 
<span class="menu-text">Uses</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="../../../../../atom.xml"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:rss" style="font-size: 1.1em;" aria-label="Icon rss from bi Iconify.design set." title="RSS"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="mailto:aheiss@gsu.edu"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:envelope" style="font-size: 1.1em;" aria-label="Icon envelope from bi Iconify.design set." title="E-mail"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://bsky.app/profile/andrew.heiss.phd" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="fa6-brands:bluesky" style="font-size: 1.1em;" aria-label="Icon bluesky from fa6-brands Iconify.design set." title="Bluesky"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://fediscience.org/users/andrew/" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:mastodon" style="font-size: 1.1em;" aria-label="Icon mastodon from bi Iconify.design set." title="Mastodon"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/andrewheiss" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:github" style="font-size: 1.1em;" aria-label="Icon github from bi Iconify.design set." title="GitHub"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.youtube.com/andrewheiss" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:youtube" style="font-size: 1.1em;" aria-label="Icon youtube from bi Iconify.design set." title="YouTube"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.heissatopia.com/"> 
<span class="menu-text"><iconify-icon inline="" icon="fa6-brands:blogger" style="font-size: 1.15em;" aria-label="Icon blogger from fa6-brands Iconify.design set." title="Blogger"></iconify-icon></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/andrewheiss" rel="me"> 
<span class="menu-text"><iconify-icon inline="" icon="bi:linkedin" style="font-size: 1.1em;" aria-label="Icon linkedin from bi Iconify.design set." title="LinkedIn"></iconify-icon></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default blog-post page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Guide to understanding the intuition behind the Dirichlet distribution</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Learn about the Dirichlet distribution and explore how it’s just a fancier version of the Beta distribution
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">r</div>
                <div class="quarto-category">statistics</div>
                <div class="quarto-category">regression</div>
                <div class="quarto-category">tidyverse</div>
                <div class="quarto-category">ggplot</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.andrewheiss.com/">Andrew Heiss</a> <a href="https://orcid.org/0000-0002-3948-3914" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Monday, September 18, 2023</p>
      </div>
    </div>
    
      
      <div>
      <div class="quarto-title-meta-heading">Doi</div>
      <div class="quarto-title-meta-contents">
        <p class="doi">
          <a href="https://doi.org/10.59350/64j0k-26134">10.59350/64j0k-26134</a>
        </p>
      </div>
    </div>
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Contents</h2>
   
  <ul>
<li><a href="#visualizing-distributions" id="toc-visualizing-distributions" class="nav-link active" data-scroll-target="#visualizing-distributions">Visualizing distributions</a></li>
  <li>
<a href="#the-relationship-between-beta-and-dirichlet-distributions" id="toc-the-relationship-between-beta-and-dirichlet-distributions" class="nav-link" data-scroll-target="#the-relationship-between-beta-and-dirichlet-distributions">The relationship between Beta and Dirichlet distributions</a>
  <ul class="collapse">
<li><a href="#one-beta-distribution-with-two-shapes" id="toc-one-beta-distribution-with-two-shapes" class="nav-link" data-scroll-target="#one-beta-distribution-with-two-shapes">One Beta distribution with two shapes</a></li>
  <li><a href="#lots-of-correlated-beta-distributions-with-lots-of-shapes" id="toc-lots-of-correlated-beta-distributions-with-lots-of-shapes" class="nav-link" data-scroll-target="#lots-of-correlated-beta-distributions-with-lots-of-shapes">Lots of correlated Beta distributions with lots of shapes</a></li>
  </ul>
</li>
  <li><a href="#relationships-between-columns" id="toc-relationships-between-columns" class="nav-link" data-scroll-target="#relationships-between-columns">Relationships between columns</a></li>
  <li>
<a href="#different-column-gravities" id="toc-different-column-gravities" class="nav-link" data-scroll-target="#different-column-gravities">Different column gravities</a>
  <ul class="collapse">
<li><a href="#one-column-with-a-strong-pull" id="toc-one-column-with-a-strong-pull" class="nav-link" data-scroll-target="#one-column-with-a-strong-pull">One column with a strong pull</a></li>
  <li><a href="#uniform-distribution-across-columns" id="toc-uniform-distribution-across-columns" class="nav-link" data-scroll-target="#uniform-distribution-across-columns">Uniform distribution across columns</a></li>
  </ul>
</li>
  <li><a href="#conclusion-stuck-in-three-dimensions" id="toc-conclusion-stuck-in-three-dimensions" class="nav-link" data-scroll-target="#conclusion-stuck-in-three-dimensions">Conclusion: Stuck in three dimensions</a></li>
  <li><a href="#bonus-later-addition-boundaries-between-categories" id="toc-bonus-later-addition-boundaries-between-categories" class="nav-link" data-scroll-target="#bonus-later-addition-boundaries-between-categories">Bonus later addition! Boundaries between categories!</a></li>
  </ul></nav>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block page-columns page-full" id="quarto-document-content"><p>I’ve been <a href="https://stats.andrewheiss.com/compassionate-clam/">finishing up a project</a> that uses <a href="https://www.robertkubinec.com/post/limited_dvs/">ordered Beta regression</a> <span class="citation" data-cites="Kubinec:2022">(<a href="#ref-Kubinec:2022" role="doc-biblioref">Kubinec 2022</a>)</span>, a neat combination of Beta regression and ordered logistic regression that you can use for modeling continuous outcomes that are bounded on either side (in my project, we’re modeling a variable that can only be between 1 and 32, for instance). It’s possible to use something like <a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#zero-inflated-beta-regression-bayesian-style">zero-one-inflated Beta regression</a> for outcomes like this, but that kind of model requires a lot more complexity and computing power (i.e.&nbsp;you need separate simultaneous models to predict if the outcome is (a) zero-or-one vs.&nbsp;not, if it is (b) zero vs.&nbsp;one, and if it is (c) somewhere in between). The magic of ordered Beta regression is that it handles the extremes (i.e.&nbsp;exactly zero and exactly one) using ordered-logit-style cutpoints, so you only have to specify one model + parameters for where those cutpoints fall. <a href="https://stats.andrewheiss.com/compassionate-clam/notebook/ordbeta.html">See here for a quick overview of it all</a>—it’s a really neat kind of model.</p>
<p>While writing up the <a href="https://stats.andrewheiss.com/compassionate-clam/notebook/model-details.html">formal math for the model</a>, digging through <a href="https://github.com/saudiwin/ordbetareg_pack">the <code>ordbetareg()</code> documentation</a> and reading <span class="citation" data-cites="Kubinec:2022">Kubinec (<a href="#ref-Kubinec:2022" role="doc-biblioref">2022</a>)</span>’s paper, I came across a prior distribution that I’ve always been afraid of and have never really fully understood: <strong>the Dirichlet distribution</strong>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Pronunciation
</div>
</div>
<div class="callout-body-container callout-body">
<p>Fun fact! The distribution is named after <a href="https://en.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlet">Peter Gustav Lejeune Dirichlet</a>, who was a German mathematician. Accordingly, he apparently didn’t pronounce his French-looking last name in a French-sounding way. It’s pronounced “dir-ee-klay” [diʁiˈkleː] not “dir-eesh-lay” [diʀiˈʃleː] (though <a href="https://de.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlet">his German Wikipedia page</a> says both are acceptable).</p>
</div>
</div>
<p>By default, <code>ordbetareg()</code> uses a <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span> prior distribution for the cutpoints or probabilities/proportions for its three submodels (i.e.&nbsp;exactly 0, somewhere between 0 and 1, and exactly 1).</p>
<p>But I have no clue what this distribution looks or feels like or even how it works! <a href="https://en.wikipedia.org/wiki/Dirichlet_distribution">Wikipedia has a long and detailed page about</a> it, but it’s exceptionally mathy and beyond my math skills.</p>
<p>So in this post, my goal is to explore the Dirichlet distribution and wrap my head around how it works as mathlessly as possible. This is all focused on intuition.</p>
<p>But first, we need to load some libraries and make some helper functions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/">ggtext</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.ggtern.com">ggtern</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/">tidybayes</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Custom ggplot theme to make pretty plots</span></span>
<span><span class="co"># Get the font at https://fonts.google.com/specimen/Manrope</span></span>
<span><span class="va">theme_nice</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_family <span class="op">=</span> <span class="st">"Manrope"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope Extrabold"</span>, face <span class="op">=</span> <span class="st">"plain"</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.35</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope Medium"</span>, face <span class="op">=</span> <span class="st">"plain"</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope SemiBold"</span>, face <span class="op">=</span> <span class="st">"plain"</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      axis.title.x <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>      axis.title.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope Light"</span>, face <span class="op">=</span> <span class="st">"plain"</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      strip.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span></span>
<span>        family <span class="op">=</span> <span class="st">"Manrope"</span>, face <span class="op">=</span> <span class="st">"bold"</span>,</span>
<span>        size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="fl">0</span></span>
<span>      <span class="op">)</span>,</span>
<span>      strip.background <span class="op">=</span> <span class="fu">element_rect</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey90"</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">theme_nice_dist</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">theme_nice</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.spacing.x <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">10</span>, units <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span>,</span>
<span>      axis.ticks.x <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>      axis.text.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">theme_set</span><span class="op">(</span><span class="fu">theme_nice</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"label"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope SemiBold"</span>, fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu">update_geom_defaults</span><span class="op">(</span><span class="st">"text"</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"Manrope SemiBold"</span>, fontface <span class="op">=</span> <span class="st">"plain"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell page-columns page-full" data-layout-align="center">

<div class="no-row-height column-margin column-container"><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/mcrn.jpg" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>MCRN colors, <a href="https://www.reddit.com/r/TheExpanse/comments/49ta0s/made_a_simple_hd_mcrn_phone_wallpaper_as_i/">via Reddit</a></figcaption></figure>
</div>
</div></div></div>
<p>To help with the intuition behind distributions, I’ll talk about “gravities” of correlated variables throughout this post. Accordingly we’ll use a color scheme from the book series/TV show <a href="https://en.wikipedia.org/wiki/The_Expanse_(TV_series)"><em>The Expanse</em></a>, where gravity is a central element (<a href="https://www.science.org/content/article/how-real-world-science-sets-expanse-apart-other-sci-fi-shows">and</a> <a href="https://www.youtube.com/watch?v=O25-_eEdxaw">accurately</a> <a href="https://www.wired.com/story/the-expanse-gets-artificial-gravity-right-in-this-neat-trick/">depicted</a>!). We’ll use the official colors from the <a href="https://expanse.fandom.com/wiki/Martian_Congressional_Republic">Martian Congressional Republic</a> <a href="https://expanse.fandom.com/wiki/Martian_Congressional_Republic_Navy">Navy</a> (MCRN) since they look neat.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">clrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"#FFBE00"</span>,  <span class="co"># MCRN yellow</span></span>
<span>  <span class="st">"#B92F0A"</span>,  <span class="co"># MCRN red</span></span>
<span>  <span class="st">"#792A26"</span>,  <span class="co"># MCRN maroon</span></span>
<span>  <span class="st">"#54191B"</span>,  <span class="co"># MCRN brown</span></span>
<span>  <span class="st">"#242424"</span>,  <span class="co"># MCRN dark gray</span></span>
<span>  <span class="st">"#2660ae"</span>   <span class="co"># Blue from MCR flag</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/show-mcrn-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<section id="visualizing-distributions" class="level1"><h1>Visualizing distributions</h1>
<p>I ordinarily like to visualize the distributions of all my models’ priors with density plots (see <a href="https://stats.andrewheiss.com/mountainous-mackerel/analysis/analysis_policies.html">here</a> or <a href="https://stats.andrewheiss.com/testy-turtle/notebook/models_total-aid.html#formal-model-and-priors">here</a> for examples) to help with the intuition of how they’re shaped and what their central values are. With things like normal, Beta, exponential, and Student t distributions, this is relatively straightforward. We can plot these distributions by feeding a density function (<code><a href="https://rdrr.io/r/stats/Normal.html">dnorm()</a></code>, <code><a href="https://rdrr.io/r/stats/TDist.html">dt()</a></code>, <code><a href="https://rdrr.io/r/stats/Beta.html">dbeta()</a></code>, <code><a href="https://rdrr.io/r/stats/Exponential.html">dexp()</a></code>, whatever) into <code>geom_function()</code> (or <code>stat_function(geom = "area")</code> to get a filled density instead of a line):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Normal(4, 2)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># R's built-in dt() function for t-distributions doesn't use mu and sigma, but</span></span>
<span><span class="co"># extraDistr::dlst() does</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">extraDistr</span><span class="fu">::</span><span class="fu">dlst</span><span class="op">(</span><span class="va">x</span>, df <span class="op">=</span> <span class="fl">3</span>, mu <span class="op">=</span> <span class="fl">4</span>, sigma <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Student t(ν = 3, µ = 4, σ = 2)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html">dexp</a></span><span class="op">(</span><span class="va">x</span>, rate <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlim</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1000</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Exponential(1/100)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-example-priors-stat-function-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Or we can use the <code>parse_dist()</code> function from {tidybayes} to plot these distributions based on their Stan definition instead of working with R functions:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">student_t</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">b</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">exponential</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sigma</span>, lb <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">priors</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">parse_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>prior <span class="op">=</span> <span class="fu">fct_inorder</span><span class="op">(</span><span class="va">prior</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span>, dist <span class="op">=</span> <span class="va">.dist</span>, args <span class="op">=</span> <span class="va">.args</span>, fill <span class="op">=</span> <span class="va">prior</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_slab</span><span class="op">(</span>normalize <span class="op">=</span> <span class="st">"panels"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">prior</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-example-priors-parse-dist-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>BUT doing this with the Dirichlet distribution is a lot trickier! There’s no built-in <code>ddirichlet()</code> (though there are versions of it in {brms}, {MCMCpack}, and a few other packages). And even if we use something like <code>brms::ddirichlet()</code> or <code>brms::rdirichlet()</code>, the numbers that are generated are wildly different from univariate distributions like normal, Beta, exponential, and all the other more standard families of distributions.</p>
<p>For example, here’s what we get when generating random numbers from the <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span> distribution that <code>ordbetareg()</code> uses by default:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##         [,1]   [,2]    [,3]</span></span>
<span><span class="co">## [1,] 0.04288 0.7043 0.25286</span></span>
<span><span class="co">## [2,] 0.32042 0.6165 0.06312</span></span>
<span><span class="co">## [3,] 0.50982 0.1016 0.38857</span></span>
<span><span class="co">## [4,] 0.21265 0.3994 0.38796</span></span>
<span><span class="co">## [5,] 0.18612 0.7122 0.10167</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It doesn’t return one vector of values—it returns a matrix of multiple values, with a column per parameter. Here we used <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span>, so there are three columns.</p>
<p>How do you work with this kind of distributional data? What do these numbers even mean? How does something like (1, 1, 1) generate numbers that vary so wildly? What happens if we change those numbers to something like (5, 1, 10) or (0.3, 7, 1)? What does that mean in practice?</p>
</section><section id="the-relationship-between-beta-and-dirichlet-distributions" class="level1"><h1>The relationship between Beta and Dirichlet distributions</h1>
<section id="one-beta-distribution-with-two-shapes" class="level2"><h2 class="anchored" data-anchor-id="one-beta-distribution-with-two-shapes">One Beta distribution with two shapes</h2>
<p>To understand these parameters, we need to quickly talk about the Beta distribution’s shape parameters. The Beta distribution uses two parameters <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> (or <code>shape1</code> and <code>shape2</code> in R’s <code>d/p/q/rbeta()</code> functions) to define the shape of a distribution that is bounded between 0 and 1. (<a href="https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#interlude-the-beta-distribution-and-distributional-regression">See here for a longer description of Beta parameters</a>, including how to use a scale/location parameterization instead of these shapes.)</p>
<p>These shape parameters are used to create a ratio that defines the mean or central gravity of the distribution, like so:</p>
<p><span class="math display">\[
\frac{\alpha}{\alpha + \beta} \quad \text{or} \quad \frac{\texttt{shape1}}{\texttt{shape1} + \texttt{shape2}}
\]</span></p>
<p>To quickly illustrate, if <span class="math inline">\(\alpha\)</span> (or <code>shape1</code>) is 3 and <span class="math inline">\(\beta\)</span> (or <code>shape2</code>) is 7, the distribution would have a mean of 0.3:</p>
<p><span class="math display">\[
\frac{3}{3 + 7} = \frac{3}{10} = 0.3
\]</span></p>
<p>We can confirm this with a graph—most of the values are asymmetrically clustered around 0.3:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, </span>
<span>    fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, shape1 <span class="op">=</span> <span class="fl">3</span>, shape2 <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>, </span>
<span>    n <span class="op">=</span> <span class="fl">1000</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Beta(3, 7)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-beta-3-7-density-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="lots-of-correlated-beta-distributions-with-lots-of-shapes" class="level2"><h2 class="anchored" data-anchor-id="lots-of-correlated-beta-distributions-with-lots-of-shapes">Lots of correlated Beta distributions with lots of shapes</h2>
<p>The Dirichlet distribution is just like the Beta distribution, but for multiple variables at the same time. Its parameters are also called “shapes,” just like the regular Beta family parameters, but instead of specifying just shape 1 and shape 2, we use a vector of shapes called <span class="math inline">\(\alpha\)</span>.</p>
<p>To illustrate, we’ll first generate some random numbers from a Dirichlet distribution with <span class="math inline">\(\alpha = (3, 7)\)</span>. We get a matrix with two columns, one for each variable in the distribution. Notice how the first variable is small, roughly around 0.3, while the second column is larger around 0.7. Notice also how each row sums to 1.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total <span class="op">=</span> <span class="va">`1`</span> <span class="op">+</span> <span class="va">`2`</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##          1      2 total</span></span>
<span><span class="co">## 1  0.12540 0.8746     1</span></span>
<span><span class="co">## 2  0.24772 0.7523     1</span></span>
<span><span class="co">## 3  0.33258 0.6674     1</span></span>
<span><span class="co">## 4  0.18422 0.8158     1</span></span>
<span><span class="co">## 5  0.28542 0.7146     1</span></span>
<span><span class="co">## 6  0.25251 0.7475     1</span></span>
<span><span class="co">## 7  0.38559 0.6144     1</span></span>
<span><span class="co">## 8  0.23298 0.7670     1</span></span>
<span><span class="co">## 9  0.21676 0.7832     1</span></span>
<span><span class="co">## 10 0.07216 0.9278     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The reason that’s the case is because <strong>Dirichlet is just a fancy multivariate Beta distribution</strong>. The shape parameters work the same way. And in the case of a 2-parameter Dirichlet distribution, it is identical to a regular old Beta distribution. We just get two forms of it—the Beta distribution and its inverse:</p>
<p><span class="math display">\[
\operatorname{Dirichlet}(3, 7) = \Bigl[\operatorname{Beta}(3, 7),\ \operatorname{Beta}(7, 3)\Bigr]
\]</span></p>
<p>The more general way of thinking about these shapes now is to use something like this formula—the mean for each variable is its value in the <span class="math inline">\(\alpha\)</span> vector divided by the sum of all the values in the the <span class="math inline">\(\alpha\)</span> vector:</p>
<p><span class="math display">\[
\textbf{E}(\alpha_n) = \frac{\alpha_n}{\sum{\alpha}}
\]</span></p>
<p>Here’s what that looks like with the <span class="math inline">\(\operatorname{Dirichlet}(3, 7)\)</span> distribution:</p>
<p><span class="math display">\[
\begin{align}
\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{3}{3 + 7} = \frac{3}{10} = 0.3 \\[8pt]
\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{7}{3 + 7} = \frac{7}{10} = 0.7
\end{align}
\]</span></p>
<p>We can confirm it with a graph too (with <code>rdirichlet()</code> for now instead of <code>ddirichlet()</code> because it’s a little weird to work with). The first variable is the same as <span class="math inline">\(\operatorname{Beta}(3, 7)\)</span> and has an average of 0.3, while the second column is the same as <span class="math inline">\(\operatorname{Beta}(7, 3)\)</span> with an average of 0.7.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"α&lt;sub&gt;"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="st">"&lt;/sub&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Dirichlet(3, 7)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-rdirichlet-3-7-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>With the general intuition that Dirichlet is just fancy Beta, watch what happens as we increase the number of elements in <span class="math inline">\(\alpha\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Three columns</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total <span class="op">=</span> <span class="va">`1`</span> <span class="op">+</span> <span class="va">`2`</span> <span class="op">+</span> <span class="va">`3`</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##        1      2       3 total</span></span>
<span><span class="co">## 1 0.1102 0.5501 0.33970     1</span></span>
<span><span class="co">## 2 0.2580 0.6707 0.07126     1</span></span>
<span><span class="co">## 3 0.3374 0.5568 0.10582     1</span></span>
<span></span>
<span><span class="co"># Six columns</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total <span class="op">=</span> <span class="va">`1`</span> <span class="op">+</span> <span class="va">`2`</span> <span class="op">+</span> <span class="va">`3`</span> <span class="op">+</span> <span class="va">`4`</span> <span class="op">+</span> <span class="va">`5`</span> <span class="op">+</span> <span class="va">`6`</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##         1      2       3        4      5        6 total</span></span>
<span><span class="co">## 1 0.05581 0.2786 0.17205 0.007128 0.4778 0.008593     1</span></span>
<span><span class="co">## 2 0.13464 0.3500 0.03718 0.070399 0.3811 0.026703     1</span></span>
<span><span class="co">## 3 0.13486 0.2226 0.04230 0.126377 0.4646 0.009275     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The values in these columns—both with the three-element <span class="math inline">\(\alpha = (3, 7, 2)\)</span> and with the six-element <span class="math inline">\(\alpha = (3, 7, 2, 2, 9, 1)\)</span>—all sum to 1.</p>
<p>The same <span class="math inline">\(\alpha_n / \sum{\alpha}\)</span> logic also applies here for determining the mean for each of these columns. We just need to work with more than two shapes. For <span class="math inline">\(\alpha = (3, 7, 2)\)</span>, here’s what the means should be:</p>
<p><span class="math display">\[
\begin{align}
\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{3}{3 + 7 + 2} = \frac{3}{12} = 0.25 \\[8pt]
\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{7}{3 + 7 + 2} = \frac{7}{12} = 0.5833 \\[8pt]
\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{2}{3 + 7 + 2} = \frac{2}{12} = 0.1667
\end{align}
\]</span></p>
<p>We can confirm this with code too:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##        1      2      3</span></span>
<span><span class="co">## 1 0.2495 0.5837 0.1667</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Neat!</p>
<p>For fun, we can plot these three distributions too:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_dirichlet_3_7_2</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"α&lt;sub&gt;"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"&lt;/sub&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Dirichlet(3, 7, 2)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">plot_dirichlet_3_7_2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-rdirichlet-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>And just to confirm for sure, here are the individual Beta-based parameterizations of each column:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for combining separate <code>dbeta()</code>-based plots with the Dirichlet components</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">3</span>, <span class="op">(</span><span class="fl">7</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, subtitle <span class="op">=</span> <span class="st">"Columns as Beta distributions"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;1&lt;/sub&gt;: Beta(3, 9 &lt;span style='font-size:7pt'&gt;(7 + 2)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">7</span>, <span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;2&lt;/sub&gt;: Beta(7, 5 &lt;span style='font-size:7pt'&gt;(3 + 2)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="fl">7</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;3&lt;/sub&gt;: Beta(2, 10 &lt;span style='font-size:7pt'&gt;(3 + 7)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">plot_dirichlet_3_7_2</span> <span class="op">+</span> <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, subtitle <span class="op">=</span> <span class="st">"Distribution of 10,000 random draws"</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> </span>
<span>  <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-3-7-2-betas-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>And that’s basically it! Dirichlet distributions are just fancy multivariate Beta distributions with multiple shapes and multiple columns</p>
</section></section><section id="relationships-between-columns" class="level1"><h1>Relationships between columns</h1>
<p>An important feature of the Dirichlet distribution is that these multiple columns are also correlated with each other—these different <span class="math inline">\(\alpha\)</span> values are not independent. Since it’s just a fancy Beta distribution, the Dirichlet distribution is constrained to 0–1, and the sum of all its columns will be 1. If <span class="math inline">\(\alpha_2\)</span> happens to be 0.8, <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_3\)</span> only have 0.2 to split between them. The higher the values of one <span class="math inline">\(\alpha_i\)</span>, the lower the possible values of the other <span class="math inline">\(\alpha_i\)</span> columns by necessity.</p>
<p>We can see this in a scatterplot matrix:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for creating this plot with <code>GGally::ggpairs()</code></summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">points_custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, mapping <span class="op">=</span> <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">scale_y_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dist_custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, mapping <span class="op">=</span> <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span><span class="va">...</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cor_custom</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">ggally_cor</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data</span>, mapping <span class="op">=</span> <span class="va">mapping</span>, <span class="va">...</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">scat_mat</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e4</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"α&lt;sub&gt;"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"&lt;/sub&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggpairs</span><span class="op">(</span></span>
<span>    lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu">wrap</span><span class="op">(</span><span class="va">points_custom</span>, size <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu">wrap</span><span class="op">(</span><span class="va">cor_custom</span>, family <span class="op">=</span> <span class="st">"Manrope"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    diag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>continuous <span class="op">=</span> <span class="fu">wrap</span><span class="op">(</span><span class="va">dist_custom</span>, color <span class="op">=</span> <span class="cn">NA</span>, bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Dirichlet(3, 7, 2)"</span>, subtitle <span class="op">=</span> <span class="st">"Scatterplot matrix of 1,000 random draws"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text.x <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span>, strip.text.y <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">scat_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scat_mat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">scat_mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scat_mat</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">scat_mat</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">scat_mat</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="va">scat_mat</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-scatmat-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>This shows some interesting patterns. <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span> are pretty strongly correlated, and <span class="math inline">\(\alpha_2\)</span> and <span class="math inline">\(\alpha_3\)</span> are also pretty strongly correlated. This is because <span class="math inline">\(\alpha_2\)</span> has fairly strong gravity within the <span class="math inline">\(\alpha\)</span> vector—because its shape creates a larger average (7/12, or 0.6), the other two variables only have 0.4 to split between the two of them. In the first panel on the second row, we can see that low values of <span class="math inline">\(\alpha_1\)</span> appear with high values of <span class="math inline">\(\alpha_2\)</span>. In the second panel on the bottom row, we see the same thing in reverse: high values of <span class="math inline">\(\alpha_2\)</span> are associated with low values of <span class="math inline">\(\alpha_3\)</span>. Because the distributions of <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_3\)</span> are both naturally low, their scatterplot (the first in the last row) is all clustered at low values for both variables.</p>
<p>As an alternative to a scatterplot matrix, we can visualize this relationship with a ternary plot, either as random mostly-invisible points or as a density gradient. I like this because it helps emphasize the gravity of the different <span class="math inline">\(\alpha\)</span> terms (plus, with the MCRN color palette we’re using, the plot gives off <a href="https://lotr.fandom.com/wiki/Eye_of_Sauron">Eye of Sauron</a> and <a href="https://en.wikipedia.org/wiki/HAL_9000">HAL 9000</a> vibes). Here it’s quickly apparent that points tend to cluster around <span class="math inline">\(\alpha_2\)</span> in general (i.e.&nbsp;the top of the triangle), leading to lower values of <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_3\)</span>.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for creating these ternary plots with {ggtern}</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First triangle: random points</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">draws_3_7_2</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern1</span> <span class="op">&lt;-</span> <span class="va">draws_3_7_2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggtern</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Second triangle: actual densities</span></span>
<span><span class="co"># Plotting the results from ddirichlet() is more difficult than using dbeta() or</span></span>
<span><span class="co"># dnorm() or other univariate distributions. We can't just use geom_function().</span></span>
<span><span class="co"># Instead, we need to generate a dataset of all possible combinations of the</span></span>
<span><span class="co"># three columns (x, y, and z here), keep only the rows where they sum to one,</span></span>
<span><span class="co"># and then find the probability density values for those rows with ddirichlet().</span></span>
<span><span class="co"># It's a complex process, but it works :shrug:</span></span>
<span></span>
<span><span class="co"># Create a sequence of values for x, y, and z</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, y <span class="op">=</span> <span class="va">values</span>, z <span class="op">=</span> <span class="va">values</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>density <span class="op">=</span> <span class="fu">pmap_dbl</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span>,</span>
<span>    <span class="op">~</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">ddirichlet</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">..1</span>, <span class="va">..2</span>, <span class="va">..3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern2</span> <span class="op">&lt;-</span> <span class="fu">ggtern</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Mess with the breaks so that the gradient is more visible (basically flatten</span></span>
<span>  <span class="co"># super high values)</span></span>
<span>  <span class="fu">scale_color_gradientn</span><span class="op">(</span></span>
<span>    colors <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">rescale</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">13</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">13</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ggtern objects don't work with {patchwork} or gridExtra::grid.arrange() or</span></span>
<span><span class="co"># {cowplot} or any of the plot-combining packages, but {ggtern} comes with its</span></span>
<span><span class="co"># own version of grid.arrange(), so we can use that</span></span>
<span><span class="fu">ggtern</span><span class="fu">::</span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">tern1</span>, <span class="va">tern2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-ternary-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="different-column-gravities" class="level1"><h1>Different column gravities</h1>
<p>The constellation of <span class="math inline">\(\alpha\)</span> parameters that you feed to the Dirichlet distribution determines how much weight the different columns get. To help illustrate this, we’ll look at two final examples: one where one column has a large average or strong pull, and one where the values in the columns are uniformly distributed with no central gravity.</p>
<section id="one-column-with-a-strong-pull" class="level2"><h2 class="anchored" data-anchor-id="one-column-with-a-strong-pull">One column with a strong pull</h2>
<p>For this example, we’ll work with a distribution with one large shape value:</p>
<p><span class="math display">\[
\operatorname{Dirichlet}(5, 1, 14)
\]</span></p>
<p>Before generating any data or visualizing this distribution, let’s figure out the averages first to help with the intuition. The distribution has 3 <span class="math inline">\(\alpha\)</span> parameters, so it’ll create three different variables with probabilities that sum to one. Since Dirichlet distributions are just fancy Beta distributions, we can find the means (or central gravities) for each of the variables by combining the shapes with <span class="math inline">\(\alpha_n / \sum \alpha\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{5}{5 + 1 + 14} = \frac{5}{20} = 0.25 \\[8pt]
\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{1}{5 + 1 + 14} = \frac{1}{20} = 0.05 \\[8pt]
\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{14}{5 + 1 + 14} = \frac{14}{20} = 0.7
\end{align}
\]</span></p>
<p>The first column should be around 0.25, the second around 0.05, and the third around 0.7, and the third column should have the strongest gravity of the three. Let’s see if that’s the case. Here are 10 random rows from <span class="math inline">\(\operatorname{Dirichlet}(5, 1, 14)\)</span>—they seem to generally follow the expected pattern of low-medium, small, and big values:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##          1        2      3</span></span>
<span><span class="co">## 1  0.19939 0.047312 0.7533</span></span>
<span><span class="co">## 2  0.25775 0.069934 0.6723</span></span>
<span><span class="co">## 3  0.27495 0.022074 0.7030</span></span>
<span><span class="co">## 4  0.15651 0.026037 0.8175</span></span>
<span><span class="co">## 5  0.23192 0.046199 0.7219</span></span>
<span><span class="co">## 6  0.11164 0.004884 0.8835</span></span>
<span><span class="co">## 7  0.43754 0.038405 0.5241</span></span>
<span><span class="co">## 8  0.14935 0.009720 0.8409</span></span>
<span><span class="co">## 9  0.17226 0.024471 0.8033</span></span>
<span><span class="co">## 10 0.09886 0.030168 0.8710</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we generate a bunch of rows and find the column averages, we’ll get the expected averages that we calculated by hand earlier: 0.25, 0.05, and 0.7:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##      1      2      3</span></span>
<span><span class="co">## 1 0.25 0.0501 0.6999</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For fun, we can plot these three individual distributions and their Beta equivalents:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for showing the <code>rdirichlet()</code> and <code>dbeta()</code> plots simultaneously</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_dirichlet_5_1_14</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"α&lt;sub&gt;"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"&lt;/sub&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Dirichlet(5, 1, 14)"</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="st">"Columns as Beta distributions"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">5</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Columns as Beta distributions"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;1&lt;/sub&gt;: Beta(5, 15 &lt;span style='font-size:7pt'&gt;(1 + 14)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="op">(</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;2&lt;/sub&gt;: Beta(1, 19 &lt;span style='font-size:7pt'&gt;(5 + 14)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">14</span>, <span class="op">(</span><span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Beta(14, [5+1])"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;3&lt;/sub&gt;: Beta(14, 6 &lt;span style='font-size:7pt'&gt;(5 + 1)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_dirichlet_5_1_14</span> <span class="op">/</span> </span>
<span>  <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-5-1-14-betas-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>This shows us that <span class="math inline">\(\alpha_3\)</span> has the highest probability of having big values, but it doesn’t show much about the relationships between the three columns. A scatterplot matrix or ternary plot can help with this. Because <span class="math inline">\(\alpha_3\)</span> values are large so often, <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span> necessarily need to be small. Notice how all the points are clustered very strongly in the bottom right corner of the triangle—it is very rare to encounter any low values of <span class="math inline">\(\alpha_3\)</span>, so the other two columns are always tiny.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for creating these ternary plots with {ggtern}</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First triangle: random points</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">draws_5_1_14</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern1</span> <span class="op">&lt;-</span> <span class="va">draws_5_1_14</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggtern</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.2</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Second triangle: actual densities</span></span>
<span><span class="co"># Create a sequence of values for x, y, and z</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, y <span class="op">=</span> <span class="va">values</span>, z <span class="op">=</span> <span class="va">values</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>density <span class="op">=</span> <span class="fu">pmap_dbl</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span>,</span>
<span>    <span class="op">~</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">ddirichlet</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">..1</span>, <span class="va">..2</span>, <span class="va">..3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">14</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern2</span> <span class="op">&lt;-</span> <span class="fu">ggtern</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradientn</span><span class="op">(</span></span>
<span>    colors <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>    values <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu">rescale</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">20</span>, <span class="fl">25</span>, <span class="fl">70</span><span class="op">)</span>, from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">70</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    guide <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggtern</span><span class="fu">::</span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">tern1</span>, <span class="va">tern2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-ternary-5-1-14-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</section><section id="uniform-distribution-across-columns" class="level2"><h2 class="anchored" data-anchor-id="uniform-distribution-across-columns">Uniform distribution across columns</h2>
<p>What happens if all the <span class="math inline">\(\alpha\)</span> values are 1, like this?</p>
<p><span class="math display">\[
\operatorname{Dirichlet}(1, 1, 1)
\]</span></p>
<p>What kind of distributions will these three columns have, and how will they be related to each other?</p>
<p>Again, for the sake of illustration, we’ll first manually find each column’s average by using the <span class="math inline">\(\alpha_n / \sum \alpha\)</span> approach:</p>
<p><span class="math display">\[
\begin{align}
\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333 \\[8pt]
\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333 \\[8pt]
\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333
\end{align}
\]</span></p>
<p>Each column has an equally-likely probability, and since there are 3 columns, each column has an average/central gravity of 0.33. But overall, this is actually a uniform Dirichlet distribution. Check out these 10 random rows from <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span>—they’re all over the place! Some are nearly 0%, some are 95%, some are 30%, some are 70%. None of the columns really have any specific gravity, so their values are free to be whatever.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##           1       2       3</span></span>
<span><span class="co">## 1  0.005967 0.03518 0.95885</span></span>
<span><span class="co">## 2  0.262315 0.05167 0.68601</span></span>
<span><span class="co">## 3  0.537214 0.40944 0.05334</span></span>
<span><span class="co">## 4  0.215604 0.39335 0.39105</span></span>
<span><span class="co">## 5  0.564366 0.30827 0.12736</span></span>
<span><span class="co">## 6  0.064393 0.17315 0.76245</span></span>
<span><span class="co">## 7  0.387843 0.47867 0.13349</span></span>
<span><span class="co">## 8  0.077467 0.54107 0.38146</span></span>
<span><span class="co">## 9  0.105293 0.71618 0.17852</span></span>
<span><span class="co">## 10 0.326226 0.49972 0.17405</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once again, we can verify this with column averages:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##        1     2      3</span></span>
<span><span class="co">## 1 0.3339 0.332 0.3341</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>When I think of a uniform distribution, however, I think of something flat like <code><a href="https://rdrr.io/r/stats/Uniform.html">runif()</a></code> or <span class="math inline">\(\operatorname{Beta}(1, 1)\)</span> where all values of x are equally likely:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">10000</span>, min <span class="op">=</span> <span class="fl">0</span>, max <span class="op">=</span> <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">10</span>, boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Uniform(0, 100)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">rbeta</a></span><span class="op">(</span><span class="fl">10000</span>, shape1 <span class="op">=</span> <span class="fl">1</span>, shape2 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_histogram</span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">0.1</span>, boundary <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"white"</span>, fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span>y <span class="op">=</span> <span class="cn">NULL</span>, x <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Beta(1, 1)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-uniform-examples-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:65.0%"></p>
</figure>
</div>
</div>
</div>
<p>The individual components of a uniform Dirichlet distribution, however, don’t look anything like this! Instead, they’re triangles:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for showing the <code>rdirichlet()</code> and <code>dbeta()</code> plots simultaneously</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_dirichlet_1_1_1</span> <span class="op">&lt;-</span> <span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">10000</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"α&lt;sub&gt;"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">"&lt;/sub&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_density</span><span class="op">(</span>bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">labs</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>      title <span class="op">=</span> <span class="st">"Dirichlet(1, 1, 1)"</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="st">"Distribution of 10,000 random draws"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    subtitle <span class="op">=</span> <span class="st">"Columns as Beta distributions"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;1&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;2&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"α&lt;sub&gt;3&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_dirichlet_1_1_1</span> <span class="op">/</span> </span>
<span>  <span class="op">(</span><span class="va">p1</span> <span class="op">|</span> <span class="va">p2</span> <span class="op">|</span> <span class="va">p3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-1-1-1-betas-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>This is because the three columns are linked together. If all three are perfectly equally likely, they’ll have a probability of 33%. If one is a little higher than 33%, the other two will need to be smaller than 33% to fit in the 100% constraint. If one is really big, the other two will need to be small (e.g.&nbsp;if one is 70%, the other two combined need to be 30%).</p>
<p>The flat shape that you’d expect from a uniform distribution is actually visible in a ternary plot where we can look at the joint distribution of all three variables at the same time. There’s no gravity at all here—each point is equally likely. Notice how all the <code>rdirichlet()</code> points are scattered evenly throughout the left triangle, and the <code>ddirichlet()</code> density gradient in the right triangle is a single color, representing one constant value. It truly is a uniform distribution.</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for creating these ternary plots with {ggtern}</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># First triangle: random points</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">draws_1_1_1</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1e5</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern1</span> <span class="op">&lt;-</span> <span class="va">draws_1_1_1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggtern</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.05</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Second triangle: actual densities</span></span>
<span><span class="co"># Create a sequence of values for x, y, and z</span></span>
<span><span class="va">values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.005</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">values</span>, y <span class="op">=</span> <span class="va">values</span>, z <span class="op">=</span> <span class="va">values</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="va">z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">rowwise</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>density <span class="op">=</span> <span class="fu">pmap_dbl</span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">z</span><span class="op">)</span>,</span>
<span>    <span class="op">~</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">ddirichlet</span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">..1</span>, <span class="va">..2</span>, <span class="va">..3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html">is.nan</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tern2</span> <span class="op">&lt;-</span> <span class="fu">ggtern</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, z <span class="op">=</span> <span class="va">z</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">density</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_gradientn</span><span class="op">(</span>colors <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">5</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_L_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;1&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_T_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;2&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_R_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, labels <span class="op">=</span> <span class="fl">0</span><span class="op">:</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">5</span>, name <span class="op">=</span> <span class="st">"α&lt;sub&gt;3&lt;/sub&gt;"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    tern.axis.title.L <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.T <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    tern.axis.title.R <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span>, color <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, size <span class="op">=</span> <span class="fu">rel</span><span class="op">(</span><span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggtern</span><span class="fu">::</span><span class="fu">grid.arrange</span><span class="op">(</span><span class="va">tern1</span>, <span class="va">tern2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-ternary-1-1-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<hr></section></section><section id="conclusion-stuck-in-three-dimensions" class="level1"><h1>Conclusion: Stuck in three dimensions</h1>
<p>So, the moral of the story is that Dirichlet distributions are just fancy multivariate versions of Beta distributions. They use shape parameters pretty much the same way, and they constrain all the values across all columns to (1) be limited to between 0–1 and (2) sum to 1. They’re not nearly as scary and intimidating as I had thought they were.</p>
<p>In this post, we visualized a bunch of three-element distributions, but you can create distributions with as many <span class="math inline">\(\alpha\)</span> elements as you want. We did that earlier with six parameters in <span class="math inline">\(\operatorname{Dirichlet}(3, 7, 2, 2, 9, 1)\)</span>:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Six columns</span></span>
<span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">set_names</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>total <span class="op">=</span> <span class="va">`1`</span> <span class="op">+</span> <span class="va">`2`</span> <span class="op">+</span> <span class="va">`3`</span> <span class="op">+</span> <span class="va">`4`</span> <span class="op">+</span> <span class="va">`5`</span> <span class="op">+</span> <span class="va">`6`</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">##         1      2       3        4      5        6 total</span></span>
<span><span class="co">## 1 0.05581 0.2786 0.17205 0.007128 0.4778 0.008593     1</span></span>
<span><span class="co">## 2 0.13464 0.3500 0.03718 0.070399 0.3811 0.026703     1</span></span>
<span><span class="co">## 3 0.13486 0.2226 0.04230 0.126377 0.4646 0.009275     1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>But good luck visualizing that ↑. There are six dimensions there—no human plot can show the correlations between all those densities (i.e.&nbsp;there’s no six-dimensional version of a ternary plot). A scatterplot matrix will get you close, but you won’t be able to see how the gravities/central tendencies of the different columns interact with each other. We’re stuck in a three-dimensional world. Alas.</p>
<hr></section><section id="bonus-later-addition-boundaries-between-categories" class="level1"><h1>Bonus later addition! Boundaries between categories!</h1>
<p>The whole reason I wrote this post and had to figure out how Dirichlet distributions worked was because I had to deal with a Dirichlet prior for an <a href="https://www.robertkubinec.com/post/limited_dvs/">ordered Beta regression</a> model <span class="citation" data-cites="Kubinec:2022">(<a href="#ref-Kubinec:2022" role="doc-biblioref">Kubinec 2022</a>)</span>. As mentioned at the beginning (and <a href="https://stats.andrewheiss.com/compassionate-clam/notebook/ordbeta.html">as demonstrated here</a>), this is a neat fusion of regular Beta regression and ordinal logistic regression that predicts three kinds of outcomes with a single set of covariates:</p>
<ol type="1">
<li>Outcomes that are exactly 0</li>
<li>Outcomes that are between 0 and 1</li>
<li>Outcomes that are exactly 1</li>
</ol>
<p>To do this, it treats these outcomes as a kind of ordered category: <em>Exactly 0</em> &lt; <em>Between 0 and 1</em> &lt; <em>Exactly 1</em>. Ordered logistic regression uses cutpoints between categories to determine the shifts in probabilities between one category and the next, and the same thing happens here with <code>ordbetareg::ordbetareg()</code>. There are two cutpoints to worry about:</p>
<ol type="1">
<li>
<span class="math inline">\(k_1\)</span> for the boundary between <em>Exactly 0</em> and <em>Between 0 and 1</em>
</li>
<li>
<span class="math inline">\(k_2\)</span> for the boundary between <em>Between 0 and 1</em> and <em>Exactly 1</em>
</li>
</ol>
<p>When specifying the model, though, <code>ordbetareg()</code> requires a three-element Dirichlet distribution, and defaults to <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span>. At first this threw me off because, as we’ve seen above, a Dirichlet distribution with a three-element <span class="math inline">\(\alpha\)</span> consists of three numbers, but we only have two cutpoints (<span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span>).</p>
<p>After reading <span class="citation" data-cites="Kubinec:2022">Kubinec (<a href="#ref-Kubinec:2022" role="doc-biblioref">2022</a>)</span> more closely and digging through the <a href="https://github.com/saudiwin/ordbetareg_pack/">code at GitHub</a>, I learned that behind the scenes, what <code>ordbetareg()</code> actually does is use the boundaries <em>between</em> the three elements of the a Dirichlet distribution. This is a neat approach since it enforces a natural ordering between cutpoints and it’s more intuitive to think about probabilities of categories directly instead of thinking about latent boundaries.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Induced Dirichlet priors
</div>
</div>
<div class="callout-body-container callout-body">
<p>It’s possible to use Dirichlet-boundary (more officially called <em>induced Dirichlet</em>) priors in other Stan models too, like ordinal logistic regression (<a href="https://betanalpha.github.io/assets/case_studies/ordinal_regression.html#22_Surgical_Cut">see this tutorial by Michael Betancourt</a> and <a href="https://groups.google.com/g/stan-users/c/pYkCZvrrkRg/m/jRdDOUHuSikJ">this 2015 discussion on the early Stan mailing list</a>).</p>
<p>I don’t think <a href="https://discourse.mc-stan.org/t/dirichlet-prior-on-ordinal-regression-cutpoints-in-brms/20640">it’s possible to do with {brms}</a> though (at least <a href="https://discourse.mc-stan.org/t/dirichlet-prior-on-ordinal-regression-cutpoints-in-brms/20640/2">as of February 2021</a>).</p>
</div>
</div>
<p>So let’s briefly look at how to work with and visualize the boundaries between categories.</p>
<p>First, let’s draw a bunch of numbers from the <span class="math inline">\(\operatorname{Dirichlet}(3, 7, 2)\)</span> distribution we worked with earlier. We’ll name these a generic “Category A–C” (in ordered Beta, these would be <em>Exactly 0</em>, <em>Between 0 and 1</em>, and <em>Exactly 1</em>):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">lots_of_draws</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>draw <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lots_of_draws_long</span> <span class="op">&lt;-</span> <span class="va">lots_of_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">draw</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>category_nice <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">category</span>,</span>
<span>    <span class="st">"X1"</span> <span class="op">~</span> <span class="st">"Category A"</span>,</span>
<span>    <span class="st">"X2"</span> <span class="op">~</span> <span class="st">"Category B"</span>,</span>
<span>    <span class="st">"X3"</span> <span class="op">~</span> <span class="st">"Category C"</span>,</span>
<span>    .ptype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Category A"</span>, <span class="st">"Category B"</span>, <span class="st">"Category C"</span><span class="op">)</span>, </span>
<span>      ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The distributions of the probabilities of the individual columns are the same as what we saw earlier in the post, with averages of 25%, 58%, and 17%:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lots_of_draws_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">category_nice</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span>avg_prop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">proportion</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## # A tibble: 3 × 2</span></span>
<span><span class="co">##   category_nice avg_prop</span></span>
<span><span class="co">##   &lt;ord&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">## 1 Category A       0.258</span></span>
<span><span class="co">## 2 Category B       0.576</span></span>
<span><span class="co">## 3 Category C       0.166</span></span>
<span></span>
<span><span class="va">lots_of_draws_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">proportion</span>, fill <span class="op">=</span> <span class="va">category_nice</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_density</span><span class="op">(</span>bounds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, color <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Dirichlet(3, 7, 2)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">category_nice</span><span class="op">)</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-rdirichlet-categories-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>What we care about here, though, are the boundaries between the categories, or <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span>. The boundary between Categories A and B (<span class="math inline">\(k_1\)</span>) is easy—it happens immediately after Category A, so it’s actually equal to Category A, or 25ish%. The boundary between Categories B and C happens immediately after Category B, but because these are ordered categories, we need to include the probability of Category A too, so it’s equal to Category A + Category B, or 83ish%.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cutpoints</span> <span class="op">&lt;-</span> <span class="va">lots_of_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    k1 <span class="op">=</span> <span class="va">X1</span>, </span>
<span>    k2 <span class="op">=</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">summarize</span><span class="op">(</span><span class="fu">across</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">k2</span><span class="op">)</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cutpoints</span></span>
<span><span class="co">##       k1     k2</span></span>
<span><span class="co">## 1 0.2581 0.8336</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I find that it’s easier to visualize these cutpoints. To do this, we’ll plot 100 stacked bar plots and add vertical lines for <span class="math inline">\(k_1\)</span> and <span class="math inline">\(k_2\)</span>. The first yellow bar segment shows the proportion of Category A; the second red segment shows the proportion of Category B; the third segment shows the proportion of Category C; the three categories added together equal 100%. Because these are random draws from a fairly uncertain <span class="math inline">\(\operatorname{Dirichlet}(3, 7, 2)\)</span> distribution, some of the segments fall substantially over or below the different <span class="math inline">\(k\)</span> cutpoints, but on average, the boundaries are at 25% and 83% respectively.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lots_of_draws_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">draw</span> <span class="op">&lt;=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">draw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">draw</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">category_nice</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_fill</span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cutpoints</span><span class="op">$</span><span class="va">k1</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">k2</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"21"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">cutpoints</span><span class="op">$</span><span class="va">k1</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[1]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">cutpoints</span><span class="op">$</span><span class="va">k2</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[2]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">label_percent</span><span class="op">(</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.012</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Dirichlet(3, 7, 2)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.7</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    legend.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.justification <span class="op">=</span> <span class="st">"left"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-cutpoints-bars-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>If we add more precision to the categories by scaling up the <span class="math inline">\(\alpha\)</span> parameters, like <span class="math inline">\(\operatorname{Dirichlet}(30, 70, 20)\)</span>, the boundaries between categories become more defined:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for showing cutpoints for <span class="math inline">\(\operatorname{Dirichlet}(30, 70, 20)\)</span></summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">lots_of_big_draws</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">70</span>, <span class="fl">22</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>draw <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lots_of_big_draws_long</span> <span class="op">&lt;-</span> <span class="va">lots_of_big_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">draw</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>category_nice <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">category</span>,</span>
<span>    <span class="st">"X1"</span> <span class="op">~</span> <span class="st">"Category A"</span>,</span>
<span>    <span class="st">"X2"</span> <span class="op">~</span> <span class="st">"Category B"</span>,</span>
<span>    <span class="st">"X3"</span> <span class="op">~</span> <span class="st">"Category C"</span>,</span>
<span>    .ptype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Category A"</span>, <span class="st">"Category B"</span>, <span class="st">"Category C"</span><span class="op">)</span>, </span>
<span>      ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lots_of_big_draws_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">draw</span> <span class="op">&lt;=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">draw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">draw</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">category_nice</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_fill</span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">cutpoints</span><span class="op">$</span><span class="va">k1</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">k2</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"21"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">cutpoints</span><span class="op">$</span><span class="va">k1</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[1]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="va">cutpoints</span><span class="op">$</span><span class="va">k2</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[2]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">label_percent</span><span class="op">(</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.012</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Dirichlet(30, 70, 20)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.7</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    legend.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.justification <span class="op">=</span> <span class="st">"left"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-cutpoints-bars-30-70-20-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>Because we’re working with a bunch of random Dirichlet draws, we can actually find the full distribution of the boundaries instead of just the averages, and we can see how the uncertainty in the boundary values vary by how precise the underlying Dirichlet distribution is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">lots_of_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>k1 <span class="op">=</span> <span class="va">X1</span>, k2 <span class="op">=</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">k2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>name <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">name</span>,</span>
<span>    <span class="st">"k1"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;1&lt;/sub&gt;"</span>,</span>
<span>    <span class="st">"k2"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_halfeye</span><span class="op">(</span>p_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Cutpoints for Dirichlet(3, 7, 2)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">lots_of_big_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>k1 <span class="op">=</span> <span class="va">X1</span>, k2 <span class="op">=</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">k2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>name <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">name</span>,</span>
<span>    <span class="st">"k1"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;1&lt;/sub&gt;"</span>,</span>
<span>    <span class="st">"k2"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_halfeye</span><span class="op">(</span>p_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, title <span class="op">=</span> <span class="st">"Cutpoints for Dirichlet(30, 70, 20)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">/</span> <span class="fu">plot_spacer</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="va">p2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">plot_layout</span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.48</span>, <span class="fl">0.04</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-cutpoints-dist-3-7-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Those ↑ are what Stan then uses as the latent ordinal cutpoints: somewhere around 0.25 for <span class="math inline">\(k_1\)</span> and around 0.8 for <span class="math inline">\(k_2\)</span>.</p>
<p>Those cutpoints are probably way too precise for Bayesian modeling. The default prior for <code>ordbetareg()</code> is a uniform <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span>. The cutpoints there should be 33% and 66% (<a href="#uniform-distribution-across-columns">as seen earlier</a>, where all three columns have equal 33% probabilities). Here’s what that looks like as a neat sideways stacked bar chart:</p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for showing cutpoints for <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span></summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">withr</span><span class="fu">::</span><span class="fu"><a href="https://withr.r-lib.org/reference/with_seed.html">with_seed</a></span><span class="op">(</span><span class="fl">1234</span>, <span class="op">{</span></span>
<span>  <span class="va">lots_of_uniform_draws</span> <span class="op">&lt;-</span> <span class="fu">brms</span><span class="fu">::</span><span class="fu">rdirichlet</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>draw <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lots_of_uniform_draws_long</span> <span class="op">&lt;-</span> <span class="va">lots_of_uniform_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">draw</span>, names_to <span class="op">=</span> <span class="st">"category"</span>, values_to <span class="op">=</span> <span class="st">"proportion"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>category_nice <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">category</span>,</span>
<span>    <span class="st">"X1"</span> <span class="op">~</span> <span class="st">"Category A"</span>,</span>
<span>    <span class="st">"X2"</span> <span class="op">~</span> <span class="st">"Category B"</span>,</span>
<span>    <span class="st">"X3"</span> <span class="op">~</span> <span class="st">"Category C"</span>,</span>
<span>    .ptype <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span></span>
<span>      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Category A"</span>, <span class="st">"Category B"</span>, <span class="st">"Category C"</span><span class="op">)</span>, </span>
<span>      ordered <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lots_of_uniform_draws_long</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">draw</span> <span class="op">&lt;=</span> <span class="fl">200</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">draw</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">draw</span><span class="op">)</span>, x <span class="op">=</span> <span class="va">proportion</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">category_nice</span><span class="op">)</span>,</span>
<span>    position <span class="op">=</span> <span class="fu">position_fill</span><span class="op">(</span>reverse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0</span>, width <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span></span>
<span>    xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"21"</span>, color <span class="op">=</span> <span class="st">"white"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[1]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">annotate</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"label"</span>, x <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, y <span class="op">=</span> <span class="fl">100</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span>, color <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>, label <span class="op">=</span> <span class="st">"k[2]"</span>, parse <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu">label_percent</span><span class="op">(</span><span class="op">)</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.012</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_y_discrete</span><span class="op">(</span>breaks <span class="op">=</span> <span class="cn">NULL</span>, expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, fill <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Dirichlet(1, 1, 1)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    panel.border <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="st">"top"</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu">unit</span><span class="op">(</span><span class="fl">0.7</span>, <span class="st">"line"</span><span class="op">)</span>,</span>
<span>    legend.margin <span class="op">=</span> <span class="fu">margin</span><span class="op">(</span>b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>    legend.justification <span class="op">=</span> <span class="st">"left"</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-cutpoints-bars-1-1-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
<p>They’re all over the place! Some of the Category A bars make it all the way up into the 90%s; some are way down below 1%. That’s to be expected—it’s a uniform distribution without any central gravity.</p>
<p>And here’s what the distribution of the individual cutpoints looks like. We can actually figure out the precise Beta distributions for each <a href="#one-beta-distribution-with-two-shapes">like we did earlier</a>:</p>
<p><span class="math display">\[
\begin{align}
k_1 &amp;= \textbf{E}(\alpha_1) = \frac{1}{3} &amp; k_2 &amp;= (\textbf{E}(\alpha_2) + \textbf{E}(\alpha_2)) = \frac{2}{3}\\
&amp;= \operatorname{Beta}(1, 2) &amp; &amp;= \operatorname{Beta}(2, 1)
\end{align}
\]</span></p>
<div class="cell" data-layout-align="center">
<details class="code-fold"><summary>Code for showing distribution of cutpoints for <span class="math inline">\(\operatorname{Dirichlet}(1, 1, 1)\)</span></summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">lots_of_uniform_draws</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>k1 <span class="op">=</span> <span class="va">X1</span>, k2 <span class="op">=</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">k1</span>, <span class="va">k2</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">mutate</span><span class="op">(</span>name <span class="op">=</span> <span class="fu">case_match</span><span class="op">(</span><span class="va">name</span>,</span>
<span>    <span class="st">"k1"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;1&lt;/sub&gt;"</span>,</span>
<span>    <span class="st">"k2"</span> <span class="op">~</span> <span class="st">"k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span>  <span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_halfeye</span><span class="op">(</span>p_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Cutpoints for Dirichlet(1, 1, 1)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"1,000 random draws"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2a</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Probability or proportion"</span>, y <span class="op">=</span> <span class="cn">NULL</span>, subtitle <span class="op">=</span> <span class="st">"Exact distribution"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Beta(1, 2)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2b</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">stat_function</span><span class="op">(</span></span>
<span>    geom <span class="op">=</span> <span class="st">"area"</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    fill <span class="op">=</span> <span class="va">clrs</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">facet_wrap</span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="st">"Beta(2, 1)"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_nice_dist</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>strip.text <span class="op">=</span> <span class="fu">element_markdown</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="op">(</span><span class="va">p1</span> <span class="op">/</span> <span class="fu">plot_spacer</span><span class="op">(</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">p2a</span> <span class="op">|</span> <span class="va">p2b</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">plot_layout</span><span class="op">(</span>heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.48</span>, <span class="fl">0.04</span>, <span class="fl">0.48</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="index_files/figure-html/plot-cutpoints-dist-1-1-1-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
<p>Cool cool—these are much less precise uniform priors for the cutpoints, at 33% and 66% respectively.</p>


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Kubinec:2022" class="csl-entry" role="listitem">
Kubinec, Robert. 2022. <span>“Ordered Beta Regression: A Parsimonious, Well-Fitting Model for Continuous Data with Lower and Upper Bounds.”</span> <em>Political Analysis</em> 31 (4): 519–36. <a href="https://doi.org/10.1017/pan.2022.20">https://doi.org/10.1017/pan.2022.20</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{heiss2023,
  author = {Heiss, Andrew},
  title = {Guide to Understanding the Intuition Behind the {Dirichlet}
    Distribution},
  date = {2023-09-18},
  url = {https://www.andrewheiss.com/blog/2023/09/18/understanding-dirichlet-beta-intuition/},
  doi = {10.59350/64j0k-26134},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-heiss2023" class="csl-entry quarto-appendix-citeas" role="listitem">
Heiss, Andrew. 2023. <span>“Guide to Understanding the Intuition Behind
the Dirichlet Distribution.”</span> September 18, 2023. <a href="https://doi.org/10.59350/64j0k-26134">https://doi.org/10.59350/64j0k-26134</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.andrewheiss\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><script src="https://giscus.app/client.js" data-repo="andrewheiss/ath-quarto" data-repo-id="R_kgDOIg6EJQ" data-category="Blog comments" data-category-id="DIC_kwDOIg6EJc4CSz92" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><input type="hidden" id="giscus-base-theme" value="light"><input type="hidden" id="giscus-alt-theme" value="dark"><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb33" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Guide to understanding the intuition behind the Dirichlet distribution"</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2023-09-18</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Learn about the Dirichlet distribution and explore how it's just a fancier version of the Beta distribution"</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> "index_files/figure-html/plot-3-7-2-betas-1.png"</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="an">twitter-card:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co">  image: "index_files/figure-html/plot-3-7-2-betas-1.png"</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="an">open-graph:</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co">  image: "index_files/figure-html/plot-3-7-2-betas-1.png"</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="co">  - r</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="co">  - statistics</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - regression</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyverse</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - ggplot</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="an">doi:</span><span class="co"> 10.59350/64j0k-26134</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: false</span></span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="an">references:</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a><span class="co">- id: Kubinec:2022</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a><span class="co">  author:</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="co">    - family: Kubinec</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a><span class="co">      given: Robert</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a><span class="co">  citation-key: Kubinec:2022</span></span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a><span class="co">  container-title: Political Analysis</span></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a><span class="co">  DOI: 10.1017/pan.2022.20</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="co">  issue: '4'</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="co">  issued:</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="co">    - year: 2022</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a><span class="co">      month: 10</span></span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a><span class="co">  page: 519-536</span></span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="co">  title: &gt;-</span></span>
<span id="cb33-37"><a href="#cb33-37" aria-hidden="true" tabindex="-1"></a><span class="co">    Ordered Beta Regression: A Parsimonious, Well-Fitting Model for Continuous</span></span>
<span id="cb33-38"><a href="#cb33-38" aria-hidden="true" tabindex="-1"></a><span class="co">    Data with Lower and Upper Bounds</span></span>
<span id="cb33-39"><a href="#cb33-39" aria-hidden="true" tabindex="-1"></a><span class="co">  type: article-journal</span></span>
<span id="cb33-40"><a href="#cb33-40" aria-hidden="true" tabindex="-1"></a><span class="co">  volume: '31'</span></span>
<span id="cb33-41"><a href="#cb33-41" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb33-42"><a href="#cb33-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-43"><a href="#cb33-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup, include=FALSE}</span></span>
<span id="cb33-44"><a href="#cb33-44" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb33-45"><a href="#cb33-45" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.width = 6,</span></span>
<span id="cb33-46"><a href="#cb33-46" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.height = 6 * 0.618,</span></span>
<span id="cb33-47"><a href="#cb33-47" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.retina = 3,</span></span>
<span id="cb33-48"><a href="#cb33-48" aria-hidden="true" tabindex="-1"></a><span class="in">  dev = "ragg_png",</span></span>
<span id="cb33-49"><a href="#cb33-49" aria-hidden="true" tabindex="-1"></a><span class="in">  fig.align = "center",</span></span>
<span id="cb33-50"><a href="#cb33-50" aria-hidden="true" tabindex="-1"></a><span class="in">  out.width = "90%",</span></span>
<span id="cb33-51"><a href="#cb33-51" aria-hidden="true" tabindex="-1"></a><span class="in">  collapse = TRUE,</span></span>
<span id="cb33-52"><a href="#cb33-52" aria-hidden="true" tabindex="-1"></a><span class="in">  cache.extra = 1234  # Change number to invalidate cache</span></span>
<span id="cb33-53"><a href="#cb33-53" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb33-54"><a href="#cb33-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-55"><a href="#cb33-55" aria-hidden="true" tabindex="-1"></a><span class="in">options(</span></span>
<span id="cb33-56"><a href="#cb33-56" aria-hidden="true" tabindex="-1"></a><span class="in">  digits = 4,</span></span>
<span id="cb33-57"><a href="#cb33-57" aria-hidden="true" tabindex="-1"></a><span class="in">  width = 300,</span></span>
<span id="cb33-58"><a href="#cb33-58" aria-hidden="true" tabindex="-1"></a><span class="in">  dplyr.summarise.inform = FALSE</span></span>
<span id="cb33-59"><a href="#cb33-59" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb33-60"><a href="#cb33-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-61"><a href="#cb33-61" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(1234)</span></span>
<span id="cb33-62"><a href="#cb33-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-63"><a href="#cb33-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-64"><a href="#cb33-64" aria-hidden="true" tabindex="-1"></a>I've been <span class="co">[</span><span class="ot">finishing up a project</span><span class="co">](https://stats.andrewheiss.com/compassionate-clam/)</span> that uses <span class="co">[</span><span class="ot">ordered Beta regression</span><span class="co">](https://www.robertkubinec.com/post/limited_dvs/)</span> <span class="co">[</span><span class="ot">@Kubinec:2022</span><span class="co">]</span>, a neat combination of Beta regression and ordered logistic regression that you can use for modeling continuous outcomes that are bounded on either side (in my project, we're modeling a variable that can only be between 1 and 32, for instance). It's possible to use something like <span class="co">[</span><span class="ot">zero-one-inflated Beta regression</span><span class="co">](https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#zero-inflated-beta-regression-bayesian-style)</span> for outcomes like this, but that kind of model requires a lot more complexity and computing power (i.e. you need separate simultaneous models to predict if the outcome is (a) zero-or-one vs. not, if it is (b) zero vs. one, and if it is (c) somewhere in between). The magic of ordered Beta regression is that it handles the extremes (i.e. exactly zero and exactly one) using ordered-logit-style cutpoints, so you only have to specify one model + parameters for where those cutpoints fall. <span class="co">[</span><span class="ot">See here for a quick overview of it all</span><span class="co">](https://stats.andrewheiss.com/compassionate-clam/notebook/ordbeta.html)</span>—it's a really neat kind of model.</span>
<span id="cb33-65"><a href="#cb33-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-66"><a href="#cb33-66" aria-hidden="true" tabindex="-1"></a>While writing up the <span class="co">[</span><span class="ot">formal math for the model</span><span class="co">](https://stats.andrewheiss.com/compassionate-clam/notebook/model-details.html)</span>, digging through <span class="co">[</span><span class="ot">the `ordbetareg()` documentation</span><span class="co">](https://github.com/saudiwin/ordbetareg_pack)</span> and reading @Kubinec:2022's paper, I came across a prior distribution that I've always been afraid of and have never really fully understood: **the Dirichlet distribution**.</span>
<span id="cb33-67"><a href="#cb33-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-68"><a href="#cb33-68" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb33-69"><a href="#cb33-69" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pronunciation</span></span>
<span id="cb33-70"><a href="#cb33-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-71"><a href="#cb33-71" aria-hidden="true" tabindex="-1"></a>Fun fact! The distribution is named after <span class="co">[</span><span class="ot">Peter Gustav Lejeune Dirichlet</span><span class="co">](https://en.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlet)</span>, who was a German mathematician. Accordingly, he apparently didn't pronounce his French-looking last name in a French-sounding way. It's pronounced "dir-ee-klay" <span class="co">[</span><span class="ot">diʁiˈkleː</span><span class="co">]</span> not "dir-eesh-lay" <span class="co">[</span><span class="ot">diʀiˈʃleː</span><span class="co">]</span> (though <span class="co">[</span><span class="ot">his German Wikipedia page</span><span class="co">](https://de.wikipedia.org/wiki/Peter_Gustav_Lejeune_Dirichlet)</span> says both are acceptable).</span>
<span id="cb33-72"><a href="#cb33-72" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-73"><a href="#cb33-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-74"><a href="#cb33-74" aria-hidden="true" tabindex="-1"></a>By default, <span class="in">`ordbetareg()`</span> uses a $\operatorname{Dirichlet}(1, 1, 1)$ prior distribution for the cutpoints or probabilities/proportions for its three submodels (i.e. exactly 0, somewhere between 0 and 1, and exactly 1). </span>
<span id="cb33-75"><a href="#cb33-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-76"><a href="#cb33-76" aria-hidden="true" tabindex="-1"></a>But I have no clue what this distribution looks or feels like or even how it works! <span class="co">[</span><span class="ot">Wikipedia has a long and detailed page about</span><span class="co">](https://en.wikipedia.org/wiki/Dirichlet_distribution)</span> it, but it's exceptionally mathy and beyond my math skills.</span>
<span id="cb33-77"><a href="#cb33-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-78"><a href="#cb33-78" aria-hidden="true" tabindex="-1"></a>So in this post, my goal is to explore the Dirichlet distribution and wrap my head around how it works as mathlessly as possible. This is all focused on intuition.</span>
<span id="cb33-79"><a href="#cb33-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-80"><a href="#cb33-80" aria-hidden="true" tabindex="-1"></a>But first, we need to load some libraries and make some helper functions:</span>
<span id="cb33-81"><a href="#cb33-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-82"><a href="#cb33-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r libraries-data, warning=FALSE, message=FALSE}</span></span>
<span id="cb33-83"><a href="#cb33-83" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse)</span></span>
<span id="cb33-84"><a href="#cb33-84" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggtext)</span></span>
<span id="cb33-85"><a href="#cb33-85" aria-hidden="true" tabindex="-1"></a><span class="in">library(GGally)</span></span>
<span id="cb33-86"><a href="#cb33-86" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggtern)</span></span>
<span id="cb33-87"><a href="#cb33-87" aria-hidden="true" tabindex="-1"></a><span class="in">library(scales)</span></span>
<span id="cb33-88"><a href="#cb33-88" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork)</span></span>
<span id="cb33-89"><a href="#cb33-89" aria-hidden="true" tabindex="-1"></a><span class="in">library(brms)</span></span>
<span id="cb33-90"><a href="#cb33-90" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidybayes)</span></span>
<span id="cb33-91"><a href="#cb33-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-92"><a href="#cb33-92" aria-hidden="true" tabindex="-1"></a><span class="in"># Custom ggplot theme to make pretty plots</span></span>
<span id="cb33-93"><a href="#cb33-93" aria-hidden="true" tabindex="-1"></a><span class="in"># Get the font at https://fonts.google.com/specimen/Manrope</span></span>
<span id="cb33-94"><a href="#cb33-94" aria-hidden="true" tabindex="-1"></a><span class="in">theme_nice &lt;- function() {</span></span>
<span id="cb33-95"><a href="#cb33-95" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal(base_family = "Manrope") +</span></span>
<span id="cb33-96"><a href="#cb33-96" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(</span></span>
<span id="cb33-97"><a href="#cb33-97" aria-hidden="true" tabindex="-1"></a><span class="in">      panel.grid.minor = element_blank(),</span></span>
<span id="cb33-98"><a href="#cb33-98" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.title = element_text(family = "Manrope Extrabold", face = "plain", size = rel(1.35)),</span></span>
<span id="cb33-99"><a href="#cb33-99" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.subtitle = element_text(family = "Manrope Medium", face = "plain", size = rel(1.2)),</span></span>
<span id="cb33-100"><a href="#cb33-100" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title = element_text(family = "Manrope SemiBold", face = "plain", size = rel(1)),</span></span>
<span id="cb33-101"><a href="#cb33-101" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.x = element_text(hjust = 0),</span></span>
<span id="cb33-102"><a href="#cb33-102" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.y = element_text(hjust = 1),</span></span>
<span id="cb33-103"><a href="#cb33-103" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.text = element_text(family = "Manrope Light", face = "plain", size = rel(0.8)),</span></span>
<span id="cb33-104"><a href="#cb33-104" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.text = element_text(</span></span>
<span id="cb33-105"><a href="#cb33-105" aria-hidden="true" tabindex="-1"></a><span class="in">        family = "Manrope", face = "bold",</span></span>
<span id="cb33-106"><a href="#cb33-106" aria-hidden="true" tabindex="-1"></a><span class="in">        size = rel(1), hjust = 0</span></span>
<span id="cb33-107"><a href="#cb33-107" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb33-108"><a href="#cb33-108" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.background = element_rect(fill = "grey90", color = NA)</span></span>
<span id="cb33-109"><a href="#cb33-109" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb33-110"><a href="#cb33-110" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-111"><a href="#cb33-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-112"><a href="#cb33-112" aria-hidden="true" tabindex="-1"></a><span class="in">theme_nice_dist &lt;- function() {</span></span>
<span id="cb33-113"><a href="#cb33-113" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice() +</span></span>
<span id="cb33-114"><a href="#cb33-114" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(</span></span>
<span id="cb33-115"><a href="#cb33-115" aria-hidden="true" tabindex="-1"></a><span class="in">      panel.grid = element_blank(),</span></span>
<span id="cb33-116"><a href="#cb33-116" aria-hidden="true" tabindex="-1"></a><span class="in">      panel.spacing.x = unit(10, units = "pt"),</span></span>
<span id="cb33-117"><a href="#cb33-117" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.ticks.x = element_line(linewidth = 0.25),</span></span>
<span id="cb33-118"><a href="#cb33-118" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.text.y = element_blank()</span></span>
<span id="cb33-119"><a href="#cb33-119" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb33-120"><a href="#cb33-120" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-121"><a href="#cb33-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-122"><a href="#cb33-122" aria-hidden="true" tabindex="-1"></a><span class="in">theme_set(theme_nice())</span></span>
<span id="cb33-123"><a href="#cb33-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-124"><a href="#cb33-124" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot2::update_geom_defaults("label", list(family = "Manrope SemiBold", fontface = "plain"))</span></span>
<span id="cb33-125"><a href="#cb33-125" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot2::update_geom_defaults("text", list(family = "Manrope SemiBold", fontface = "plain"))</span></span>
<span id="cb33-126"><a href="#cb33-126" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-127"><a href="#cb33-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-128"><a href="#cb33-128" aria-hidden="true" tabindex="-1"></a><span class="in">```{r color-funs, include=FALSE}</span></span>
<span id="cb33-129"><a href="#cb33-129" aria-hidden="true" tabindex="-1"></a><span class="in">show_nice_pal &lt;- function(pal, nrow = 1, show_text = TRUE) {</span></span>
<span id="cb33-130"><a href="#cb33-130" aria-hidden="true" tabindex="-1"></a><span class="in">  out &lt;- tibble(x = 1:length(pal),</span></span>
<span id="cb33-131"><a href="#cb33-131" aria-hidden="true" tabindex="-1"></a><span class="in">                color = pal) |&gt; </span></span>
<span id="cb33-132"><a href="#cb33-132" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(x_nice = glue::glue("[{x}]")) |&gt; </span></span>
<span id="cb33-133"><a href="#cb33-133" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(across(c(color, x_nice), ~fct_inorder(.))) |&gt; </span></span>
<span id="cb33-134"><a href="#cb33-134" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = color, y = 1, fill = color)) +</span></span>
<span id="cb33-135"><a href="#cb33-135" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_tile() +</span></span>
<span id="cb33-136"><a href="#cb33-136" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_discrete(expand = c(0, 0)) +</span></span>
<span id="cb33-137"><a href="#cb33-137" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_identity() +</span></span>
<span id="cb33-138"><a href="#cb33-138" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars(x_nice), scales = "free_x", nrow = nrow) +</span></span>
<span id="cb33-139"><a href="#cb33-139" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_void(base_family = "Inconsolata") +</span></span>
<span id="cb33-140"><a href="#cb33-140" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(panel.spacing.x = unit(-1, units = "pt"),</span></span>
<span id="cb33-141"><a href="#cb33-141" aria-hidden="true" tabindex="-1"></a><span class="in">          panel.spacing.y = unit(-0.5, units = "lines"),</span></span>
<span id="cb33-142"><a href="#cb33-142" aria-hidden="true" tabindex="-1"></a><span class="in">          strip.text = element_blank())</span></span>
<span id="cb33-143"><a href="#cb33-143" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb33-144"><a href="#cb33-144" aria-hidden="true" tabindex="-1"></a><span class="in">  if (show_text) {</span></span>
<span id="cb33-145"><a href="#cb33-145" aria-hidden="true" tabindex="-1"></a><span class="in">    out &lt;- out + </span></span>
<span id="cb33-146"><a href="#cb33-146" aria-hidden="true" tabindex="-1"></a><span class="in">      theme(axis.text.x = element_text(margin = margin(b = 5)),</span></span>
<span id="cb33-147"><a href="#cb33-147" aria-hidden="true" tabindex="-1"></a><span class="in">            strip.text = element_text(size = rel(1.1), margin = margin(t = 5)),</span></span>
<span id="cb33-148"><a href="#cb33-148" aria-hidden="true" tabindex="-1"></a><span class="in">            panel.spacing.y = unit(0, units = "lines"))</span></span>
<span id="cb33-149"><a href="#cb33-149" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb33-150"><a href="#cb33-150" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb33-151"><a href="#cb33-151" aria-hidden="true" tabindex="-1"></a><span class="in">  return(out)</span></span>
<span id="cb33-152"><a href="#cb33-152" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-153"><a href="#cb33-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-154"><a href="#cb33-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-155"><a href="#cb33-155" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mcrn-margin, echo=FALSE}</span></span>
<span id="cb33-156"><a href="#cb33-156" aria-hidden="true" tabindex="-1"></a><span class="in">#| column: margin</span></span>
<span id="cb33-157"><a href="#cb33-157" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: "MCRN colors, [via Reddit](https://www.reddit.com/r/TheExpanse/comments/49ta0s/made_a_simple_hd_mcrn_phone_wallpaper_as_i/)"</span></span>
<span id="cb33-158"><a href="#cb33-158" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::include_graphics("img/mcrn.jpg")</span></span>
<span id="cb33-159"><a href="#cb33-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-160"><a href="#cb33-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-161"><a href="#cb33-161" aria-hidden="true" tabindex="-1"></a>To help with the intuition behind distributions, I'll talk about "gravities" of correlated variables throughout this post. Accordingly we'll use a color scheme from the book series/TV show <span class="co">[</span><span class="ot">*The Expanse*</span><span class="co">]</span>(https://en.wikipedia.org/wiki/The_Expanse_(TV_series)), where gravity is a central element (<span class="co">[</span><span class="ot">and</span><span class="co">](https://www.science.org/content/article/how-real-world-science-sets-expanse-apart-other-sci-fi-shows)</span> <span class="co">[</span><span class="ot">accurately</span><span class="co">](https://www.youtube.com/watch?v=O25-_eEdxaw)</span> <span class="co">[</span><span class="ot">depicted</span><span class="co">](https://www.wired.com/story/the-expanse-gets-artificial-gravity-right-in-this-neat-trick/)</span>!). We'll use the official colors from the <span class="co">[</span><span class="ot">Martian Congressional Republic</span><span class="co">](https://expanse.fandom.com/wiki/Martian_Congressional_Republic)</span> <span class="co">[</span><span class="ot">Navy</span><span class="co">](https://expanse.fandom.com/wiki/Martian_Congressional_Republic_Navy)</span> (MCRN) since they look neat.</span>
<span id="cb33-162"><a href="#cb33-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-163"><a href="#cb33-163" aria-hidden="true" tabindex="-1"></a><span class="in">```{r colors, fig.width=6, fig.height=1}</span></span>
<span id="cb33-164"><a href="#cb33-164" aria-hidden="true" tabindex="-1"></a><span class="in">clrs &lt;- c(</span></span>
<span id="cb33-165"><a href="#cb33-165" aria-hidden="true" tabindex="-1"></a><span class="in">  "#FFBE00",  # MCRN yellow</span></span>
<span id="cb33-166"><a href="#cb33-166" aria-hidden="true" tabindex="-1"></a><span class="in">  "#B92F0A",  # MCRN red</span></span>
<span id="cb33-167"><a href="#cb33-167" aria-hidden="true" tabindex="-1"></a><span class="in">  "#792A26",  # MCRN maroon</span></span>
<span id="cb33-168"><a href="#cb33-168" aria-hidden="true" tabindex="-1"></a><span class="in">  "#54191B",  # MCRN brown</span></span>
<span id="cb33-169"><a href="#cb33-169" aria-hidden="true" tabindex="-1"></a><span class="in">  "#242424",  # MCRN dark gray</span></span>
<span id="cb33-170"><a href="#cb33-170" aria-hidden="true" tabindex="-1"></a><span class="in">  "#2660ae"   # Blue from MCR flag</span></span>
<span id="cb33-171"><a href="#cb33-171" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb33-172"><a href="#cb33-172" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-173"><a href="#cb33-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-174"><a href="#cb33-174" aria-hidden="true" tabindex="-1"></a><span class="in">```{r show-mcrn, fig.width=8, fig.height=1}</span></span>
<span id="cb33-175"><a href="#cb33-175" aria-hidden="true" tabindex="-1"></a><span class="in">#| out-width: 100%</span></span>
<span id="cb33-176"><a href="#cb33-176" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb33-177"><a href="#cb33-177" aria-hidden="true" tabindex="-1"></a><span class="in">clrs |&gt; show_nice_pal(show_text = TRUE, nrow = 1)</span></span>
<span id="cb33-178"><a href="#cb33-178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-179"><a href="#cb33-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-180"><a href="#cb33-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-181"><a href="#cb33-181" aria-hidden="true" tabindex="-1"></a><span class="fu"># Visualizing distributions</span></span>
<span id="cb33-182"><a href="#cb33-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-183"><a href="#cb33-183" aria-hidden="true" tabindex="-1"></a>I ordinarily like to visualize the distributions of all my models' priors with density plots (see <span class="co">[</span><span class="ot">here</span><span class="co">](https://stats.andrewheiss.com/mountainous-mackerel/analysis/analysis_policies.html)</span> or <span class="co">[</span><span class="ot">here</span><span class="co">](https://stats.andrewheiss.com/testy-turtle/notebook/models_total-aid.html#formal-model-and-priors)</span> for examples) to help with the intuition of how they're shaped and what their central values are. With things like normal, Beta, exponential, and Student t distributions, this is relatively straightforward. We can plot these distributions by feeding a density function (<span class="in">`dnorm()`</span>, <span class="in">`dt()`</span>, <span class="in">`dbeta()`</span>, <span class="in">`dexp()`</span>, whatever) into <span class="in">`geom_function()`</span> (or <span class="in">`stat_function(geom = "area")`</span> to get a filled density instead of a line):</span>
<span id="cb33-184"><a href="#cb33-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-185"><a href="#cb33-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-example-priors-stat-function, fig.width=8, fig.height=3, out.width="100%"}</span></span>
<span id="cb33-186"><a href="#cb33-186" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot() +</span></span>
<span id="cb33-187"><a href="#cb33-187" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-188"><a href="#cb33-188" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fill = clrs[1],</span></span>
<span id="cb33-189"><a href="#cb33-189" aria-hidden="true" tabindex="-1"></a><span class="in">    fun = \(x) dnorm(x, mean = 4, sd = 2)) +</span></span>
<span id="cb33-190"><a href="#cb33-190" aria-hidden="true" tabindex="-1"></a><span class="in">  xlim(c(-4, 12)) +</span></span>
<span id="cb33-191"><a href="#cb33-191" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = NULL) +</span></span>
<span id="cb33-192"><a href="#cb33-192" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Normal(4, 2)")) +</span></span>
<span id="cb33-193"><a href="#cb33-193" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist()</span></span>
<span id="cb33-194"><a href="#cb33-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-195"><a href="#cb33-195" aria-hidden="true" tabindex="-1"></a><span class="in"># R's built-in dt() function for t-distributions doesn't use mu and sigma, but</span></span>
<span id="cb33-196"><a href="#cb33-196" aria-hidden="true" tabindex="-1"></a><span class="in"># extraDistr::dlst() does</span></span>
<span id="cb33-197"><a href="#cb33-197" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- ggplot() +</span></span>
<span id="cb33-198"><a href="#cb33-198" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-199"><a href="#cb33-199" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fill = clrs[2],</span></span>
<span id="cb33-200"><a href="#cb33-200" aria-hidden="true" tabindex="-1"></a><span class="in">    fun = \(x) extraDistr::dlst(x, df = 3, mu = 4, sigma = 2)) +</span></span>
<span id="cb33-201"><a href="#cb33-201" aria-hidden="true" tabindex="-1"></a><span class="in">  xlim(c(-10, 15)) +</span></span>
<span id="cb33-202"><a href="#cb33-202" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = NULL) +</span></span>
<span id="cb33-203"><a href="#cb33-203" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Student t(ν = 3, µ = 4, σ = 2)")) +</span></span>
<span id="cb33-204"><a href="#cb33-204" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist()</span></span>
<span id="cb33-205"><a href="#cb33-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-206"><a href="#cb33-206" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- ggplot() +</span></span>
<span id="cb33-207"><a href="#cb33-207" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-208"><a href="#cb33-208" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fill = clrs[4],</span></span>
<span id="cb33-209"><a href="#cb33-209" aria-hidden="true" tabindex="-1"></a><span class="in">    fun = \(x) dexp(x, rate = 1/100)) +</span></span>
<span id="cb33-210"><a href="#cb33-210" aria-hidden="true" tabindex="-1"></a><span class="in">  xlim(c(0, 1000)) +</span></span>
<span id="cb33-211"><a href="#cb33-211" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(y = NULL) +</span></span>
<span id="cb33-212"><a href="#cb33-212" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Exponential(1/100)")) +</span></span>
<span id="cb33-213"><a href="#cb33-213" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist()</span></span>
<span id="cb33-214"><a href="#cb33-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-215"><a href="#cb33-215" aria-hidden="true" tabindex="-1"></a><span class="in">p1 | p2 | p3</span></span>
<span id="cb33-216"><a href="#cb33-216" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-217"><a href="#cb33-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-218"><a href="#cb33-218" aria-hidden="true" tabindex="-1"></a>Or we can use the <span class="in">`parse_dist()`</span> function from {tidybayes} to plot these distributions based on their Stan definition instead of working with R functions:</span>
<span id="cb33-219"><a href="#cb33-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-220"><a href="#cb33-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-example-priors-parse-dist, fig.width=8, fig.height=3, out.width="100%"}</span></span>
<span id="cb33-221"><a href="#cb33-221" aria-hidden="true" tabindex="-1"></a><span class="in">priors &lt;- c(prior(normal(4, 2), class = Intercept),</span></span>
<span id="cb33-222"><a href="#cb33-222" aria-hidden="true" tabindex="-1"></a><span class="in">            prior(student_t(3, 4, 2), class = b),</span></span>
<span id="cb33-223"><a href="#cb33-223" aria-hidden="true" tabindex="-1"></a><span class="in">            prior(exponential(1/100), class = sigma, lb = 0))</span></span>
<span id="cb33-224"><a href="#cb33-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-225"><a href="#cb33-225" aria-hidden="true" tabindex="-1"></a><span class="in">priors |&gt; </span></span>
<span id="cb33-226"><a href="#cb33-226" aria-hidden="true" tabindex="-1"></a><span class="in">  parse_dist() |&gt; </span></span>
<span id="cb33-227"><a href="#cb33-227" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(prior = fct_inorder(prior)) |&gt; </span></span>
<span id="cb33-228"><a href="#cb33-228" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y = 0, dist = .dist, args = .args, fill = prior)) +</span></span>
<span id="cb33-229"><a href="#cb33-229" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_slab(normalize = "panels") +</span></span>
<span id="cb33-230"><a href="#cb33-230" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(1, 2, 4)], guide = "none") +</span></span>
<span id="cb33-231"><a href="#cb33-231" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-232"><a href="#cb33-232" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(prior), scales = "free_x") +</span></span>
<span id="cb33-233"><a href="#cb33-233" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist()</span></span>
<span id="cb33-234"><a href="#cb33-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-235"><a href="#cb33-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-236"><a href="#cb33-236" aria-hidden="true" tabindex="-1"></a>BUT doing this with the Dirichlet distribution is a lot trickier! There's no built-in <span class="in">`ddirichlet()`</span> (though there are versions of it in {brms}, {MCMCpack}, and a few other packages). And even if we use something like <span class="in">`brms::ddirichlet()`</span> or <span class="in">`brms::rdirichlet()`</span>, the numbers that are generated are wildly different from univariate distributions like normal, Beta, exponential, and all the other more standard families of distributions.</span>
<span id="cb33-237"><a href="#cb33-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-238"><a href="#cb33-238" aria-hidden="true" tabindex="-1"></a>For example, here's what we get when generating random numbers from the $\operatorname{Dirichlet}(1, 1, 1)$ distribution that <span class="in">`ordbetareg()`</span> uses by default:</span>
<span id="cb33-239"><a href="#cb33-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-240"><a href="#cb33-240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-1-1-1-ordbeta}</span></span>
<span id="cb33-241"><a href="#cb33-241" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-242"><a href="#cb33-242" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(5, c(1, 1, 1))</span></span>
<span id="cb33-243"><a href="#cb33-243" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-244"><a href="#cb33-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-245"><a href="#cb33-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-246"><a href="#cb33-246" aria-hidden="true" tabindex="-1"></a>It doesn't return one vector of values—it returns a matrix of multiple values, with a column per parameter. Here we used $\operatorname{Dirichlet}(1, 1, 1)$, so there are three columns.</span>
<span id="cb33-247"><a href="#cb33-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-248"><a href="#cb33-248" aria-hidden="true" tabindex="-1"></a>How do you work with this kind of distributional data? What do these numbers even mean? How does something like (1, 1, 1) generate numbers that vary so wildly? What happens if we change those numbers to something like (5, 1, 10) or (0.3, 7, 1)? What does that mean in practice?</span>
<span id="cb33-249"><a href="#cb33-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-250"><a href="#cb33-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-251"><a href="#cb33-251" aria-hidden="true" tabindex="-1"></a><span class="fu"># The relationship between Beta and Dirichlet distributions</span></span>
<span id="cb33-252"><a href="#cb33-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-253"><a href="#cb33-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## One Beta distribution with two shapes </span></span>
<span id="cb33-254"><a href="#cb33-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-255"><a href="#cb33-255" aria-hidden="true" tabindex="-1"></a>To understand these parameters, we need to quickly talk about the Beta distribution's shape parameters. The Beta distribution uses two parameters $\alpha$ and $\beta$ (or <span class="in">`shape1`</span> and <span class="in">`shape2`</span> in R's <span class="in">`d/p/q/rbeta()`</span> functions) to define the shape of a distribution that is bounded between 0 and 1. (<span class="co">[</span><span class="ot">See here for a longer description of Beta parameters</span><span class="co">](https://www.andrewheiss.com/blog/2021/11/08/beta-regression-guide/#interlude-the-beta-distribution-and-distributional-regression)</span>, including how to use a scale/location parameterization instead of these shapes.)</span>
<span id="cb33-256"><a href="#cb33-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-257"><a href="#cb33-257" aria-hidden="true" tabindex="-1"></a>These shape parameters are used to create a ratio that defines the mean or central gravity of the distribution, like so:</span>
<span id="cb33-258"><a href="#cb33-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-259"><a href="#cb33-259" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-260"><a href="#cb33-260" aria-hidden="true" tabindex="-1"></a>\frac{\alpha}{\alpha + \beta} \quad \text{or} \quad \frac{\texttt{shape1}}{\texttt{shape1} + \texttt{shape2}}</span>
<span id="cb33-261"><a href="#cb33-261" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-262"><a href="#cb33-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-263"><a href="#cb33-263" aria-hidden="true" tabindex="-1"></a>To quickly illustrate, if $\alpha$ (or <span class="in">`shape1`</span>) is 3 and $\beta$ (or <span class="in">`shape2`</span>) is 7, the distribution would have a mean of 0.3:</span>
<span id="cb33-264"><a href="#cb33-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-265"><a href="#cb33-265" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-266"><a href="#cb33-266" aria-hidden="true" tabindex="-1"></a>\frac{3}{3 + 7} = \frac{3}{10} = 0.3</span>
<span id="cb33-267"><a href="#cb33-267" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-268"><a href="#cb33-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-269"><a href="#cb33-269" aria-hidden="true" tabindex="-1"></a>We can confirm this with a graph—most of the values are asymmetrically clustered around 0.3:</span>
<span id="cb33-270"><a href="#cb33-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-271"><a href="#cb33-271" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-beta-3-7-density, fig.width=6, fig.height=3, out.width="60%"}</span></span>
<span id="cb33-272"><a href="#cb33-272" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot() +</span></span>
<span id="cb33-273"><a href="#cb33-273" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-274"><a href="#cb33-274" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", </span></span>
<span id="cb33-275"><a href="#cb33-275" aria-hidden="true" tabindex="-1"></a><span class="in">    fun = \(x) dbeta(x, shape1 = 3, shape2 = 7), </span></span>
<span id="cb33-276"><a href="#cb33-276" aria-hidden="true" tabindex="-1"></a><span class="in">    n = 1000, fill = clrs[1]) +</span></span>
<span id="cb33-277"><a href="#cb33-277" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, title = "Beta(3, 7)") +</span></span>
<span id="cb33-278"><a href="#cb33-278" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist()</span></span>
<span id="cb33-279"><a href="#cb33-279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-280"><a href="#cb33-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-281"><a href="#cb33-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Lots of correlated Beta distributions with lots of shapes</span></span>
<span id="cb33-282"><a href="#cb33-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-283"><a href="#cb33-283" aria-hidden="true" tabindex="-1"></a>The Dirichlet distribution is just like the Beta distribution, but for multiple variables at the same time. Its parameters are also called "shapes," just like the regular Beta family parameters, but instead of specifying just shape 1 and shape 2, we use a vector of shapes called $\alpha$.</span>
<span id="cb33-284"><a href="#cb33-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-285"><a href="#cb33-285" aria-hidden="true" tabindex="-1"></a>To illustrate, we'll first generate some random numbers from a Dirichlet distribution with $\alpha = (3, 7)$. We get a matrix with two columns, one for each variable in the distribution. Notice how the first variable is small, roughly around 0.3, while the second column is larger around 0.7. Notice also how each row sums to 1.</span>
<span id="cb33-286"><a href="#cb33-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-287"><a href="#cb33-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-3-7}</span></span>
<span id="cb33-288"><a href="#cb33-288" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-289"><a href="#cb33-289" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 10, alpha = c(3, 7)) |&gt; </span></span>
<span id="cb33-290"><a href="#cb33-290" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-291"><a href="#cb33-291" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:2) |&gt; </span></span>
<span id="cb33-292"><a href="#cb33-292" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(total = `1` + `2`)</span></span>
<span id="cb33-293"><a href="#cb33-293" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-294"><a href="#cb33-294" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-295"><a href="#cb33-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-296"><a href="#cb33-296" aria-hidden="true" tabindex="-1"></a>The reason that's the case is because **Dirichlet is just a fancy multivariate Beta distribution**. The shape parameters work the same way. And in the case of a 2-parameter Dirichlet distribution, it is identical to a regular old Beta distribution. We just get two forms of it—the Beta distribution and its inverse:</span>
<span id="cb33-297"><a href="#cb33-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-298"><a href="#cb33-298" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-299"><a href="#cb33-299" aria-hidden="true" tabindex="-1"></a>\operatorname{Dirichlet}(3, 7) = \Bigl<span class="co">[</span><span class="ot">\operatorname{Beta}(3, 7),\ \operatorname{Beta}(7, 3)\Bigr</span><span class="co">]</span></span>
<span id="cb33-300"><a href="#cb33-300" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-301"><a href="#cb33-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-302"><a href="#cb33-302" aria-hidden="true" tabindex="-1"></a>The more general way of thinking about these shapes now is to use something like this formula—the mean for each variable is its value in the $\alpha$ vector divided by the sum of all the values in the the $\alpha$ vector:</span>
<span id="cb33-303"><a href="#cb33-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-304"><a href="#cb33-304" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-305"><a href="#cb33-305" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_n) = \frac{\alpha_n}{\sum{\alpha}}</span>
<span id="cb33-306"><a href="#cb33-306" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-307"><a href="#cb33-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-308"><a href="#cb33-308" aria-hidden="true" tabindex="-1"></a>Here's what that looks like with the $\operatorname{Dirichlet}(3, 7)$ distribution:</span>
<span id="cb33-309"><a href="#cb33-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-310"><a href="#cb33-310" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-311"><a href="#cb33-311" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-312"><a href="#cb33-312" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{3}{3 + 7} = \frac{3}{10} = 0.3 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-313"><a href="#cb33-313" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{7}{3 + 7} = \frac{7}{10} = 0.7</span>
<span id="cb33-314"><a href="#cb33-314" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-315"><a href="#cb33-315" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-316"><a href="#cb33-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-317"><a href="#cb33-317" aria-hidden="true" tabindex="-1"></a>We can confirm it with a graph too (with <span class="in">`rdirichlet()`</span> for now instead of <span class="in">`ddirichlet()`</span> because it's a little weird to work with). The first variable is the same as $\operatorname{Beta}(3, 7)$ and has an average of 0.3, while the second column is the same as $\operatorname{Beta}(7, 3)$ with an average of 0.7.</span>
<span id="cb33-318"><a href="#cb33-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-319"><a href="#cb33-319" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-rdirichlet-3-7, fig.width=6, fig.height=3.5, out.width="65%"}</span></span>
<span id="cb33-320"><a href="#cb33-320" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-321"><a href="#cb33-321" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(3, 7)) |&gt; </span></span>
<span id="cb33-322"><a href="#cb33-322" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-323"><a href="#cb33-323" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(paste0("α&lt;sub&gt;", 1:2, "&lt;/sub&gt;")) |&gt; </span></span>
<span id="cb33-324"><a href="#cb33-324" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(everything()) |&gt; </span></span>
<span id="cb33-325"><a href="#cb33-325" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-326"><a href="#cb33-326" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_density(bounds = c(0, 1), color = NA) +</span></span>
<span id="cb33-327"><a href="#cb33-327" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_manual(values = clrs[c(1, 2)], guide = "none") +</span></span>
<span id="cb33-328"><a href="#cb33-328" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(x = "Probability or proportion", y = NULL, title = "Dirichlet(3, 7)") +</span></span>
<span id="cb33-329"><a href="#cb33-329" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars(name)) +</span></span>
<span id="cb33-330"><a href="#cb33-330" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist() +</span></span>
<span id="cb33-331"><a href="#cb33-331" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(strip.text = element_markdown())</span></span>
<span id="cb33-332"><a href="#cb33-332" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-333"><a href="#cb33-333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-334"><a href="#cb33-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-335"><a href="#cb33-335" aria-hidden="true" tabindex="-1"></a>With the general intuition that Dirichlet is just fancy Beta, watch what happens as we increase the number of elements in $\alpha$:</span>
<span id="cb33-336"><a href="#cb33-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-337"><a href="#cb33-337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-3-and-6}</span></span>
<span id="cb33-338"><a href="#cb33-338" aria-hidden="true" tabindex="-1"></a><span class="in"># Three columns</span></span>
<span id="cb33-339"><a href="#cb33-339" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-340"><a href="#cb33-340" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 3, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-341"><a href="#cb33-341" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-342"><a href="#cb33-342" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3) |&gt; </span></span>
<span id="cb33-343"><a href="#cb33-343" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(total = `1` + `2` + `3`)</span></span>
<span id="cb33-344"><a href="#cb33-344" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-345"><a href="#cb33-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-346"><a href="#cb33-346" aria-hidden="true" tabindex="-1"></a><span class="in"># Six columns</span></span>
<span id="cb33-347"><a href="#cb33-347" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-348"><a href="#cb33-348" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 3, alpha = c(3, 7, 2, 2, 9, 1)) |&gt; </span></span>
<span id="cb33-349"><a href="#cb33-349" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-350"><a href="#cb33-350" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:6) |&gt; </span></span>
<span id="cb33-351"><a href="#cb33-351" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(total = `1` + `2` + `3` + `4` + `5` + `6`)</span></span>
<span id="cb33-352"><a href="#cb33-352" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-353"><a href="#cb33-353" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-354"><a href="#cb33-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-355"><a href="#cb33-355" aria-hidden="true" tabindex="-1"></a>The values in these columns—both with the three-element $\alpha = (3, 7, 2)$ and with the six-element $\alpha = (3, 7, 2, 2, 9, 1)$—all sum to 1.</span>
<span id="cb33-356"><a href="#cb33-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-357"><a href="#cb33-357" aria-hidden="true" tabindex="-1"></a>The same $\alpha_n / \sum{\alpha}$ logic also applies here for determining the mean for each of these columns. We just need to work with more than two shapes. For $\alpha = (3, 7, 2)$, here's what the means should be:</span>
<span id="cb33-358"><a href="#cb33-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-359"><a href="#cb33-359" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-360"><a href="#cb33-360" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-361"><a href="#cb33-361" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{3}{3 + 7 + 2} = \frac{3}{12} = 0.25 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-362"><a href="#cb33-362" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{7}{3 + 7 + 2} = \frac{7}{12} = 0.5833 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-363"><a href="#cb33-363" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{2}{3 + 7 + 2} = \frac{2}{12} = 0.1667</span>
<span id="cb33-364"><a href="#cb33-364" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-365"><a href="#cb33-365" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-366"><a href="#cb33-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-367"><a href="#cb33-367" aria-hidden="true" tabindex="-1"></a>We can confirm this with code too:</span>
<span id="cb33-368"><a href="#cb33-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-369"><a href="#cb33-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-mean-3-7-2}</span></span>
<span id="cb33-370"><a href="#cb33-370" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-371"><a href="#cb33-371" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-372"><a href="#cb33-372" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-373"><a href="#cb33-373" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3) |&gt; </span></span>
<span id="cb33-374"><a href="#cb33-374" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(across(everything(), ~ mean(.x)))</span></span>
<span id="cb33-375"><a href="#cb33-375" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-376"><a href="#cb33-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-377"><a href="#cb33-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-378"><a href="#cb33-378" aria-hidden="true" tabindex="-1"></a>Neat!</span>
<span id="cb33-379"><a href="#cb33-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-380"><a href="#cb33-380" aria-hidden="true" tabindex="-1"></a>For fun, we can plot these three distributions too:</span>
<span id="cb33-381"><a href="#cb33-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-382"><a href="#cb33-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-rdirichlet-3-7-2, fig.width=8, fig.height=3, out.width="100%"}</span></span>
<span id="cb33-383"><a href="#cb33-383" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_3_7_2 &lt;- withr::with_seed(1234, {</span></span>
<span id="cb33-384"><a href="#cb33-384" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-385"><a href="#cb33-385" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-386"><a href="#cb33-386" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(paste0("α&lt;sub&gt;", 1:3, "&lt;/sub&gt;")) |&gt; </span></span>
<span id="cb33-387"><a href="#cb33-387" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(everything()) |&gt; </span></span>
<span id="cb33-388"><a href="#cb33-388" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-389"><a href="#cb33-389" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_density(bounds = c(0, 1), color = NA) +</span></span>
<span id="cb33-390"><a href="#cb33-390" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-391"><a href="#cb33-391" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_manual(values = clrs[c(1, 2, 4)], guide = "none") +</span></span>
<span id="cb33-392"><a href="#cb33-392" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(x = "Probability or proportion", y = NULL, title = "Dirichlet(3, 7, 2)") +</span></span>
<span id="cb33-393"><a href="#cb33-393" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars(name), scales = "free_y") +</span></span>
<span id="cb33-394"><a href="#cb33-394" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist() +</span></span>
<span id="cb33-395"><a href="#cb33-395" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(strip.text = element_markdown())</span></span>
<span id="cb33-396"><a href="#cb33-396" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-397"><a href="#cb33-397" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_3_7_2</span></span>
<span id="cb33-398"><a href="#cb33-398" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-399"><a href="#cb33-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-400"><a href="#cb33-400" aria-hidden="true" tabindex="-1"></a>And just to confirm for sure, here are the individual Beta-based parameterizations of each column:</span>
<span id="cb33-401"><a href="#cb33-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-402"><a href="#cb33-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-3-7-2-betas, fig.width=8, fig.height=5.5, out.width="100%"}</span></span>
<span id="cb33-403"><a href="#cb33-403" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-404"><a href="#cb33-404" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for combining separate `dbeta()`-based plots with the Dirichlet components"</span></span>
<span id="cb33-405"><a href="#cb33-405" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot() +</span></span>
<span id="cb33-406"><a href="#cb33-406" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-407"><a href="#cb33-407" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 3, (7 + 2)), n = 1000,</span></span>
<span id="cb33-408"><a href="#cb33-408" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[1]</span></span>
<span id="cb33-409"><a href="#cb33-409" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-410"><a href="#cb33-410" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-411"><a href="#cb33-411" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, subtitle = "Columns as Beta distributions") +</span></span>
<span id="cb33-412"><a href="#cb33-412" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;1&lt;/sub&gt;: Beta(3, 9 &lt;span style='font-size:7pt'&gt;(7 + 2)&lt;/span&gt;)")) +</span></span>
<span id="cb33-413"><a href="#cb33-413" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-414"><a href="#cb33-414" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-415"><a href="#cb33-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-416"><a href="#cb33-416" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- ggplot() +</span></span>
<span id="cb33-417"><a href="#cb33-417" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-418"><a href="#cb33-418" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 7, (3 + 2)), n = 1000,</span></span>
<span id="cb33-419"><a href="#cb33-419" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[2]</span></span>
<span id="cb33-420"><a href="#cb33-420" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-421"><a href="#cb33-421" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-422"><a href="#cb33-422" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-423"><a href="#cb33-423" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;2&lt;/sub&gt;: Beta(7, 5 &lt;span style='font-size:7pt'&gt;(3 + 2)&lt;/span&gt;)")) +</span></span>
<span id="cb33-424"><a href="#cb33-424" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-425"><a href="#cb33-425" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-426"><a href="#cb33-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-427"><a href="#cb33-427" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- ggplot() +</span></span>
<span id="cb33-428"><a href="#cb33-428" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-429"><a href="#cb33-429" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 2, (3 + 7)), n = 1000,</span></span>
<span id="cb33-430"><a href="#cb33-430" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[4]</span></span>
<span id="cb33-431"><a href="#cb33-431" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-432"><a href="#cb33-432" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-433"><a href="#cb33-433" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-434"><a href="#cb33-434" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;3&lt;/sub&gt;: Beta(2, 10 &lt;span style='font-size:7pt'&gt;(3 + 7)&lt;/span&gt;)")) +</span></span>
<span id="cb33-435"><a href="#cb33-435" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-436"><a href="#cb33-436" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-437"><a href="#cb33-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-438"><a href="#cb33-438" aria-hidden="true" tabindex="-1"></a><span class="in">(plot_dirichlet_3_7_2 + labs(x = NULL, subtitle = "Distribution of 10,000 random draws")) / </span></span>
<span id="cb33-439"><a href="#cb33-439" aria-hidden="true" tabindex="-1"></a><span class="in">  (p1 | p2 | p3)</span></span>
<span id="cb33-440"><a href="#cb33-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-441"><a href="#cb33-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-442"><a href="#cb33-442" aria-hidden="true" tabindex="-1"></a>And that's basically it! Dirichlet distributions are just fancy multivariate Beta distributions with multiple shapes and multiple columns</span>
<span id="cb33-443"><a href="#cb33-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-444"><a href="#cb33-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-445"><a href="#cb33-445" aria-hidden="true" tabindex="-1"></a><span class="fu"># Relationships between columns</span></span>
<span id="cb33-446"><a href="#cb33-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-447"><a href="#cb33-447" aria-hidden="true" tabindex="-1"></a>An important feature of the Dirichlet distribution is that these multiple columns are also correlated with each other—these different $\alpha$ values are not independent. Since it's just a fancy Beta distribution, the Dirichlet distribution is constrained to 0–1, and the sum of all its columns will be 1. If $\alpha_2$ happens to be 0.8, $\alpha_1$ and $\alpha_3$ only have 0.2 to split between them. The higher the values of one $\alpha_i$, the lower the possible values of the other $\alpha_i$ columns by necessity. </span>
<span id="cb33-448"><a href="#cb33-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-449"><a href="#cb33-449" aria-hidden="true" tabindex="-1"></a>We can see this in a scatterplot matrix:</span>
<span id="cb33-450"><a href="#cb33-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-451"><a href="#cb33-451" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-scatmat-3-7-2, fig.width=7, fig.height=5, out.width="100%"}</span></span>
<span id="cb33-452"><a href="#cb33-452" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-453"><a href="#cb33-453" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for creating this plot with `GGally::ggpairs()`"</span></span>
<span id="cb33-454"><a href="#cb33-454" aria-hidden="true" tabindex="-1"></a><span class="in">points_custom &lt;- function(data, mapping, ...) {</span></span>
<span id="cb33-455"><a href="#cb33-455" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(data = data, mapping = mapping, ...) + </span></span>
<span id="cb33-456"><a href="#cb33-456" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(...) + </span></span>
<span id="cb33-457"><a href="#cb33-457" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = seq(0, 1, by = 0.2), limits = c(0, 1)) + </span></span>
<span id="cb33-458"><a href="#cb33-458" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_y_continuous(breaks = seq(0, 1, by = 0.2), limits = c(0, 1)) </span></span>
<span id="cb33-459"><a href="#cb33-459" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-460"><a href="#cb33-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-461"><a href="#cb33-461" aria-hidden="true" tabindex="-1"></a><span class="in">dist_custom &lt;- function(data, mapping, ...) {</span></span>
<span id="cb33-462"><a href="#cb33-462" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(data = data, mapping = mapping, ...) +</span></span>
<span id="cb33-463"><a href="#cb33-463" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_density(...) +</span></span>
<span id="cb33-464"><a href="#cb33-464" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(fill = "") +</span></span>
<span id="cb33-465"><a href="#cb33-465" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = seq(0, 1, by = 0.2), limits = c(0, 1)) +</span></span>
<span id="cb33-466"><a href="#cb33-466" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist()</span></span>
<span id="cb33-467"><a href="#cb33-467" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-468"><a href="#cb33-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-469"><a href="#cb33-469" aria-hidden="true" tabindex="-1"></a><span class="in">cor_custom &lt;- function(data, mapping, ...) {</span></span>
<span id="cb33-470"><a href="#cb33-470" aria-hidden="true" tabindex="-1"></a><span class="in">  ggally_cor(data = data, mapping = mapping, ...) +</span></span>
<span id="cb33-471"><a href="#cb33-471" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_void()</span></span>
<span id="cb33-472"><a href="#cb33-472" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb33-473"><a href="#cb33-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-474"><a href="#cb33-474" aria-hidden="true" tabindex="-1"></a><span class="in">scat_mat &lt;- brms::rdirichlet(n = 1e4, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-475"><a href="#cb33-475" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame() |&gt; </span></span>
<span id="cb33-476"><a href="#cb33-476" aria-hidden="true" tabindex="-1"></a><span class="in">  set_names(paste0("α&lt;sub&gt;", 1:3, "&lt;/sub&gt;")) |&gt; </span></span>
<span id="cb33-477"><a href="#cb33-477" aria-hidden="true" tabindex="-1"></a><span class="in">  ggpairs(</span></span>
<span id="cb33-478"><a href="#cb33-478" aria-hidden="true" tabindex="-1"></a><span class="in">    lower = list(continuous = wrap(points_custom, size = 0.2, alpha = 0.1, color = clrs[5])),</span></span>
<span id="cb33-479"><a href="#cb33-479" aria-hidden="true" tabindex="-1"></a><span class="in">    upper = list(continuous = wrap(cor_custom, family = "Manrope")),</span></span>
<span id="cb33-480"><a href="#cb33-480" aria-hidden="true" tabindex="-1"></a><span class="in">    diag = list(continuous = wrap(dist_custom, color = NA, bounds = c(0, 1)))</span></span>
<span id="cb33-481"><a href="#cb33-481" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-482"><a href="#cb33-482" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(title = "Dirichlet(3, 7, 2)", subtitle = "Scatterplot matrix of 1,000 random draws") +</span></span>
<span id="cb33-483"><a href="#cb33-483" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text.x = element_markdown(), strip.text.y = element_markdown())</span></span>
<span id="cb33-484"><a href="#cb33-484" aria-hidden="true" tabindex="-1"></a><span class="in">scat_mat[1, 1] &lt;- scat_mat[1, 1] + scale_fill_manual(values = clrs[1], guide = "none")</span></span>
<span id="cb33-485"><a href="#cb33-485" aria-hidden="true" tabindex="-1"></a><span class="in">scat_mat[2, 2] &lt;- scat_mat[2, 2] + scale_fill_manual(values = clrs[2], guide = "none")</span></span>
<span id="cb33-486"><a href="#cb33-486" aria-hidden="true" tabindex="-1"></a><span class="in">scat_mat[3, 3] &lt;- scat_mat[3, 3] + scale_fill_manual(values = clrs[4], guide = "none")</span></span>
<span id="cb33-487"><a href="#cb33-487" aria-hidden="true" tabindex="-1"></a><span class="in">scat_mat</span></span>
<span id="cb33-488"><a href="#cb33-488" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-489"><a href="#cb33-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-490"><a href="#cb33-490" aria-hidden="true" tabindex="-1"></a>This shows some interesting patterns. $\alpha_1$ and $\alpha_2$ are pretty strongly correlated, and $\alpha_2$ and $\alpha_3$ are also pretty strongly correlated. This is because $\alpha_2$ has fairly strong gravity within the $\alpha$ vector—because its shape creates a larger average (7/12, or 0.6), the other two variables only have 0.4 to split between the two of them. In the first panel on the second row, we can see that low values of $\alpha_1$ appear with high values of $\alpha_2$. In the second panel on the bottom row, we see the same thing in reverse: high values of $\alpha_2$ are associated with low values of $\alpha_3$. Because the distributions of $\alpha_1$ and $\alpha_3$ are both naturally low, their scatterplot (the first in the last row) is all clustered at low values for both variables.</span>
<span id="cb33-491"><a href="#cb33-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-492"><a href="#cb33-492" aria-hidden="true" tabindex="-1"></a>As an alternative to a scatterplot matrix, we can visualize this relationship with a ternary plot, either as random mostly-invisible points or as a density gradient. I like this because it helps emphasize the gravity of the different $\alpha$ terms (plus, with the MCRN color palette we're using, the plot gives off <span class="co">[</span><span class="ot">Eye of Sauron</span><span class="co">](https://lotr.fandom.com/wiki/Eye_of_Sauron)</span> and <span class="co">[</span><span class="ot">HAL 9000</span><span class="co">](https://en.wikipedia.org/wiki/HAL_9000)</span> vibes). Here it's quickly apparent that points tend to cluster around $\alpha_2$ in general (i.e. the top of the triangle), leading to lower values of $\alpha_1$ and $\alpha_3$.</span>
<span id="cb33-493"><a href="#cb33-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-494"><a href="#cb33-494" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-ternary-3-7-2, fig.width=7, fig.height=4, out.width="100%"}</span></span>
<span id="cb33-495"><a href="#cb33-495" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-496"><a href="#cb33-496" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for creating these ternary plots with {ggtern}"</span></span>
<span id="cb33-497"><a href="#cb33-497" aria-hidden="true" tabindex="-1"></a><span class="in"># First triangle: random points</span></span>
<span id="cb33-498"><a href="#cb33-498" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-499"><a href="#cb33-499" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_3_7_2 &lt;- brms::rdirichlet(n = 1e5, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-500"><a href="#cb33-500" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-501"><a href="#cb33-501" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(c("x", "y", "z"))</span></span>
<span id="cb33-502"><a href="#cb33-502" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-503"><a href="#cb33-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-504"><a href="#cb33-504" aria-hidden="true" tabindex="-1"></a><span class="in">tern1 &lt;- draws_3_7_2 |&gt; </span></span>
<span id="cb33-505"><a href="#cb33-505" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtern(aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-506"><a href="#cb33-506" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 0.2, alpha = 0.1, color = clrs[5]) +</span></span>
<span id="cb33-507"><a href="#cb33-507" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-508"><a href="#cb33-508" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-509"><a href="#cb33-509" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-510"><a href="#cb33-510" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-511"><a href="#cb33-511" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-512"><a href="#cb33-512" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-513"><a href="#cb33-513" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-514"><a href="#cb33-514" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-515"><a href="#cb33-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-516"><a href="#cb33-516" aria-hidden="true" tabindex="-1"></a><span class="in"># Second triangle: actual densities</span></span>
<span id="cb33-517"><a href="#cb33-517" aria-hidden="true" tabindex="-1"></a><span class="in"># Plotting the results from ddirichlet() is more difficult than using dbeta() or</span></span>
<span id="cb33-518"><a href="#cb33-518" aria-hidden="true" tabindex="-1"></a><span class="in"># dnorm() or other univariate distributions. We can't just use geom_function().</span></span>
<span id="cb33-519"><a href="#cb33-519" aria-hidden="true" tabindex="-1"></a><span class="in"># Instead, we need to generate a dataset of all possible combinations of the</span></span>
<span id="cb33-520"><a href="#cb33-520" aria-hidden="true" tabindex="-1"></a><span class="in"># three columns (x, y, and z here), keep only the rows where they sum to one,</span></span>
<span id="cb33-521"><a href="#cb33-521" aria-hidden="true" tabindex="-1"></a><span class="in"># and then find the probability density values for those rows with ddirichlet().</span></span>
<span id="cb33-522"><a href="#cb33-522" aria-hidden="true" tabindex="-1"></a><span class="in"># It's a complex process, but it works :shrug:</span></span>
<span id="cb33-523"><a href="#cb33-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-524"><a href="#cb33-524" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a sequence of values for x, y, and z</span></span>
<span id="cb33-525"><a href="#cb33-525" aria-hidden="true" tabindex="-1"></a><span class="in">values &lt;- seq(0, 1, by = 0.005)</span></span>
<span id="cb33-526"><a href="#cb33-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-527"><a href="#cb33-527" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span id="cb33-528"><a href="#cb33-528" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- expand.grid(x = values, y = values, z = values) |&gt;</span></span>
<span id="cb33-529"><a href="#cb33-529" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(x + y + z == 1) |&gt; </span></span>
<span id="cb33-530"><a href="#cb33-530" aria-hidden="true" tabindex="-1"></a><span class="in">  rowwise() |&gt;</span></span>
<span id="cb33-531"><a href="#cb33-531" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = pmap_dbl(</span></span>
<span id="cb33-532"><a href="#cb33-532" aria-hidden="true" tabindex="-1"></a><span class="in">    list(x, y, z),</span></span>
<span id="cb33-533"><a href="#cb33-533" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ brms::ddirichlet(</span></span>
<span id="cb33-534"><a href="#cb33-534" aria-hidden="true" tabindex="-1"></a><span class="in">      as.numeric(c(..1, ..2, ..3)),</span></span>
<span id="cb33-535"><a href="#cb33-535" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = c(3, 7, 2)</span></span>
<span id="cb33-536"><a href="#cb33-536" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb33-537"><a href="#cb33-537" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-538"><a href="#cb33-538" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!is.nan(density))</span></span>
<span id="cb33-539"><a href="#cb33-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-540"><a href="#cb33-540" aria-hidden="true" tabindex="-1"></a><span class="in">tern2 &lt;- ggtern(data = df, aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-541"><a href="#cb33-541" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(color = density)) +</span></span>
<span id="cb33-542"><a href="#cb33-542" aria-hidden="true" tabindex="-1"></a><span class="in">  # Mess with the breaks so that the gradient is more visible (basically flatten</span></span>
<span id="cb33-543"><a href="#cb33-543" aria-hidden="true" tabindex="-1"></a><span class="in">  # super high values)</span></span>
<span id="cb33-544"><a href="#cb33-544" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_gradientn(</span></span>
<span id="cb33-545"><a href="#cb33-545" aria-hidden="true" tabindex="-1"></a><span class="in">    colors = clrs[5:1], </span></span>
<span id="cb33-546"><a href="#cb33-546" aria-hidden="true" tabindex="-1"></a><span class="in">    values = scales::rescale(x = c(0, 1, 3, 8, 13), from = c(0, 13)),</span></span>
<span id="cb33-547"><a href="#cb33-547" aria-hidden="true" tabindex="-1"></a><span class="in">    guide = "none"</span></span>
<span id="cb33-548"><a href="#cb33-548" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-549"><a href="#cb33-549" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-550"><a href="#cb33-550" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-551"><a href="#cb33-551" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-552"><a href="#cb33-552" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-553"><a href="#cb33-553" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-554"><a href="#cb33-554" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-555"><a href="#cb33-555" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-556"><a href="#cb33-556" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-557"><a href="#cb33-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-558"><a href="#cb33-558" aria-hidden="true" tabindex="-1"></a><span class="in"># ggtern objects don't work with {patchwork} or gridExtra::grid.arrange() or</span></span>
<span id="cb33-559"><a href="#cb33-559" aria-hidden="true" tabindex="-1"></a><span class="in"># {cowplot} or any of the plot-combining packages, but {ggtern} comes with its</span></span>
<span id="cb33-560"><a href="#cb33-560" aria-hidden="true" tabindex="-1"></a><span class="in"># own version of grid.arrange(), so we can use that</span></span>
<span id="cb33-561"><a href="#cb33-561" aria-hidden="true" tabindex="-1"></a><span class="in">ggtern::grid.arrange(tern1, tern2, ncol = 2)</span></span>
<span id="cb33-562"><a href="#cb33-562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-563"><a href="#cb33-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-564"><a href="#cb33-564" aria-hidden="true" tabindex="-1"></a><span class="fu"># Different column gravities</span></span>
<span id="cb33-565"><a href="#cb33-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-566"><a href="#cb33-566" aria-hidden="true" tabindex="-1"></a>The constellation of $\alpha$ parameters that you feed to the Dirichlet distribution determines how much weight the different columns get. To help illustrate this, we'll look at two final examples: one where one column has a large average or strong pull, and one where the values in the columns are uniformly distributed with no central gravity.</span>
<span id="cb33-567"><a href="#cb33-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-568"><a href="#cb33-568" aria-hidden="true" tabindex="-1"></a><span class="fu">## One column with a strong pull</span></span>
<span id="cb33-569"><a href="#cb33-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-570"><a href="#cb33-570" aria-hidden="true" tabindex="-1"></a>For this example, we'll work with a distribution with one large shape value:</span>
<span id="cb33-571"><a href="#cb33-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-572"><a href="#cb33-572" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-573"><a href="#cb33-573" aria-hidden="true" tabindex="-1"></a>\operatorname{Dirichlet}(5, 1, 14)</span>
<span id="cb33-574"><a href="#cb33-574" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-575"><a href="#cb33-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-576"><a href="#cb33-576" aria-hidden="true" tabindex="-1"></a>Before generating any data or visualizing this distribution, let's figure out the averages first to help with the intuition. The distribution has 3 $\alpha$ parameters, so it'll create three different variables with probabilities that sum to one. Since Dirichlet distributions are just fancy Beta distributions, we can find the means (or central gravities) for each of the variables by combining the shapes with $\alpha_n / \sum \alpha$:</span>
<span id="cb33-577"><a href="#cb33-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-578"><a href="#cb33-578" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-579"><a href="#cb33-579" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-580"><a href="#cb33-580" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{5}{5 + 1 + 14} = \frac{5}{20} = 0.25 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-581"><a href="#cb33-581" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{1}{5 + 1 + 14} = \frac{1}{20} = 0.05 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-582"><a href="#cb33-582" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{14}{5 + 1 + 14} = \frac{14}{20} = 0.7</span>
<span id="cb33-583"><a href="#cb33-583" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-584"><a href="#cb33-584" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-585"><a href="#cb33-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-586"><a href="#cb33-586" aria-hidden="true" tabindex="-1"></a>The first column should be around 0.25, the second around 0.05, and the third around 0.7, and the third column should have the strongest gravity of the three. Let's see if that's the case. Here are 10 random rows from $\operatorname{Dirichlet}(5, 1, 14)$—they seem to generally follow the expected pattern of low-medium, small, and big values:</span>
<span id="cb33-587"><a href="#cb33-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-588"><a href="#cb33-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-5-1-14}</span></span>
<span id="cb33-589"><a href="#cb33-589" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-590"><a href="#cb33-590" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 10, alpha = c(5, 1, 14)) |&gt; </span></span>
<span id="cb33-591"><a href="#cb33-591" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-592"><a href="#cb33-592" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3)</span></span>
<span id="cb33-593"><a href="#cb33-593" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-594"><a href="#cb33-594" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-595"><a href="#cb33-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-596"><a href="#cb33-596" aria-hidden="true" tabindex="-1"></a>If we generate a bunch of rows and find the column averages, we'll get the expected averages that we calculated by hand earlier: 0.25, 0.05, and 0.7:</span>
<span id="cb33-597"><a href="#cb33-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-598"><a href="#cb33-598" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-mean-5-1-14}</span></span>
<span id="cb33-599"><a href="#cb33-599" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-600"><a href="#cb33-600" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(5, 1, 14)) |&gt; </span></span>
<span id="cb33-601"><a href="#cb33-601" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-602"><a href="#cb33-602" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3) |&gt; </span></span>
<span id="cb33-603"><a href="#cb33-603" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(across(everything(), ~ mean(.x)))</span></span>
<span id="cb33-604"><a href="#cb33-604" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-605"><a href="#cb33-605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-606"><a href="#cb33-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-607"><a href="#cb33-607" aria-hidden="true" tabindex="-1"></a>For fun, we can plot these three individual distributions and their Beta equivalents:</span>
<span id="cb33-608"><a href="#cb33-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-609"><a href="#cb33-609" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-5-1-14-betas, fig.width=8, fig.height=5.5, out.width="100%"}</span></span>
<span id="cb33-610"><a href="#cb33-610" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-611"><a href="#cb33-611" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for showing the `rdirichlet()` and `dbeta()` plots simultaneously"</span></span>
<span id="cb33-612"><a href="#cb33-612" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_5_1_14 &lt;- withr::with_seed(1234, {</span></span>
<span id="cb33-613"><a href="#cb33-613" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(5, 1, 14)) |&gt;</span></span>
<span id="cb33-614"><a href="#cb33-614" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt;</span></span>
<span id="cb33-615"><a href="#cb33-615" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(paste0("α&lt;sub&gt;", 1:3, "&lt;/sub&gt;")) |&gt;</span></span>
<span id="cb33-616"><a href="#cb33-616" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(everything()) |&gt;</span></span>
<span id="cb33-617"><a href="#cb33-617" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-618"><a href="#cb33-618" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_density(bounds = c(0, 1), color = NA) +</span></span>
<span id="cb33-619"><a href="#cb33-619" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-620"><a href="#cb33-620" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_manual(values = clrs[c(1, 2, 4)], guide = "none") +</span></span>
<span id="cb33-621"><a href="#cb33-621" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(</span></span>
<span id="cb33-622"><a href="#cb33-622" aria-hidden="true" tabindex="-1"></a><span class="in">      x = NULL, y = NULL, title = "Dirichlet(5, 1, 14)",</span></span>
<span id="cb33-623"><a href="#cb33-623" aria-hidden="true" tabindex="-1"></a><span class="in">      subtitle = "Columns as Beta distributions"</span></span>
<span id="cb33-624"><a href="#cb33-624" aria-hidden="true" tabindex="-1"></a><span class="in">    ) +</span></span>
<span id="cb33-625"><a href="#cb33-625" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars(name), scales = "free_y") +</span></span>
<span id="cb33-626"><a href="#cb33-626" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist() +</span></span>
<span id="cb33-627"><a href="#cb33-627" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(strip.text = element_markdown())</span></span>
<span id="cb33-628"><a href="#cb33-628" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-629"><a href="#cb33-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-630"><a href="#cb33-630" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot() +</span></span>
<span id="cb33-631"><a href="#cb33-631" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-632"><a href="#cb33-632" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 5, (1 + 14)), n = 1000,</span></span>
<span id="cb33-633"><a href="#cb33-633" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[1]</span></span>
<span id="cb33-634"><a href="#cb33-634" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-635"><a href="#cb33-635" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-636"><a href="#cb33-636" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-637"><a href="#cb33-637" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Probability or proportion", y = NULL,</span></span>
<span id="cb33-638"><a href="#cb33-638" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Columns as Beta distributions"</span></span>
<span id="cb33-639"><a href="#cb33-639" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-640"><a href="#cb33-640" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;1&lt;/sub&gt;: Beta(5, 15 &lt;span style='font-size:7pt'&gt;(1 + 14)&lt;/span&gt;)")) +</span></span>
<span id="cb33-641"><a href="#cb33-641" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-642"><a href="#cb33-642" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-643"><a href="#cb33-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-644"><a href="#cb33-644" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- ggplot() +</span></span>
<span id="cb33-645"><a href="#cb33-645" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-646"><a href="#cb33-646" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 1, (5 + 14)), n = 1000,</span></span>
<span id="cb33-647"><a href="#cb33-647" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[2]</span></span>
<span id="cb33-648"><a href="#cb33-648" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-649"><a href="#cb33-649" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-650"><a href="#cb33-650" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-651"><a href="#cb33-651" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;2&lt;/sub&gt;: Beta(1, 19 &lt;span style='font-size:7pt'&gt;(5 + 14)&lt;/span&gt;)")) +</span></span>
<span id="cb33-652"><a href="#cb33-652" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-653"><a href="#cb33-653" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-654"><a href="#cb33-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-655"><a href="#cb33-655" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- ggplot() +</span></span>
<span id="cb33-656"><a href="#cb33-656" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-657"><a href="#cb33-657" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 14, (5 + 1)), n = 1000,</span></span>
<span id="cb33-658"><a href="#cb33-658" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[4]</span></span>
<span id="cb33-659"><a href="#cb33-659" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-660"><a href="#cb33-660" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-661"><a href="#cb33-661" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-662"><a href="#cb33-662" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Beta(14, [5+1])")) +</span></span>
<span id="cb33-663"><a href="#cb33-663" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;3&lt;/sub&gt;: Beta(14, 6 &lt;span style='font-size:7pt'&gt;(5 + 1)&lt;/span&gt;)")) +</span></span>
<span id="cb33-664"><a href="#cb33-664" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-665"><a href="#cb33-665" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-666"><a href="#cb33-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-667"><a href="#cb33-667" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_5_1_14 / </span></span>
<span id="cb33-668"><a href="#cb33-668" aria-hidden="true" tabindex="-1"></a><span class="in">  (p1 | p2 | p3)</span></span>
<span id="cb33-669"><a href="#cb33-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-670"><a href="#cb33-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-671"><a href="#cb33-671" aria-hidden="true" tabindex="-1"></a>This shows us that $\alpha_3$ has the highest probability of having big values, but it doesn't show much about the relationships between the three columns. A scatterplot matrix or ternary plot can help with this. Because $\alpha_3$ values are large so often, $\alpha_1$ and $\alpha_2$ necessarily need to be small. Notice how all the points are clustered very strongly in the bottom right corner of the triangle—it is very rare to encounter any low values of $\alpha_3$, so the other two columns are always tiny.</span>
<span id="cb33-672"><a href="#cb33-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-673"><a href="#cb33-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-ternary-5-1-14, fig.width=7, fig.height=4}</span></span>
<span id="cb33-674"><a href="#cb33-674" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-675"><a href="#cb33-675" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for creating these ternary plots with {ggtern}"</span></span>
<span id="cb33-676"><a href="#cb33-676" aria-hidden="true" tabindex="-1"></a><span class="in"># First triangle: random points</span></span>
<span id="cb33-677"><a href="#cb33-677" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-678"><a href="#cb33-678" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_5_1_14 &lt;- brms::rdirichlet(n = 1e5, alpha = c(5, 1, 14)) |&gt; </span></span>
<span id="cb33-679"><a href="#cb33-679" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-680"><a href="#cb33-680" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(c("x", "y", "z"))</span></span>
<span id="cb33-681"><a href="#cb33-681" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-682"><a href="#cb33-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-683"><a href="#cb33-683" aria-hidden="true" tabindex="-1"></a><span class="in">tern1 &lt;- draws_5_1_14 |&gt; </span></span>
<span id="cb33-684"><a href="#cb33-684" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtern(aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-685"><a href="#cb33-685" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 0.2, alpha = 0.1, color = clrs[5]) +</span></span>
<span id="cb33-686"><a href="#cb33-686" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-687"><a href="#cb33-687" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-688"><a href="#cb33-688" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-689"><a href="#cb33-689" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-690"><a href="#cb33-690" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-691"><a href="#cb33-691" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-692"><a href="#cb33-692" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-693"><a href="#cb33-693" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-694"><a href="#cb33-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-695"><a href="#cb33-695" aria-hidden="true" tabindex="-1"></a><span class="in"># Second triangle: actual densities</span></span>
<span id="cb33-696"><a href="#cb33-696" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a sequence of values for x, y, and z</span></span>
<span id="cb33-697"><a href="#cb33-697" aria-hidden="true" tabindex="-1"></a><span class="in">values &lt;- seq(0, 1, by = 0.005)</span></span>
<span id="cb33-698"><a href="#cb33-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-699"><a href="#cb33-699" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span id="cb33-700"><a href="#cb33-700" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- expand.grid(x = values, y = values, z = values) |&gt;</span></span>
<span id="cb33-701"><a href="#cb33-701" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(x + y + z == 1) |&gt; </span></span>
<span id="cb33-702"><a href="#cb33-702" aria-hidden="true" tabindex="-1"></a><span class="in">  rowwise() |&gt;</span></span>
<span id="cb33-703"><a href="#cb33-703" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = pmap_dbl(</span></span>
<span id="cb33-704"><a href="#cb33-704" aria-hidden="true" tabindex="-1"></a><span class="in">    list(x, y, z),</span></span>
<span id="cb33-705"><a href="#cb33-705" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ brms::ddirichlet(</span></span>
<span id="cb33-706"><a href="#cb33-706" aria-hidden="true" tabindex="-1"></a><span class="in">      as.numeric(c(..1, ..2, ..3)),</span></span>
<span id="cb33-707"><a href="#cb33-707" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = c(5, 1, 14)</span></span>
<span id="cb33-708"><a href="#cb33-708" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb33-709"><a href="#cb33-709" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-710"><a href="#cb33-710" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!is.nan(density))</span></span>
<span id="cb33-711"><a href="#cb33-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-712"><a href="#cb33-712" aria-hidden="true" tabindex="-1"></a><span class="in">tern2 &lt;- ggtern(data = df, aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-713"><a href="#cb33-713" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(color = density)) +</span></span>
<span id="cb33-714"><a href="#cb33-714" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_gradientn(</span></span>
<span id="cb33-715"><a href="#cb33-715" aria-hidden="true" tabindex="-1"></a><span class="in">    colors = clrs[5:1], </span></span>
<span id="cb33-716"><a href="#cb33-716" aria-hidden="true" tabindex="-1"></a><span class="in">    values = scales::rescale(x = c(0, 1, 20, 25, 70), from = c(0, 70)),</span></span>
<span id="cb33-717"><a href="#cb33-717" aria-hidden="true" tabindex="-1"></a><span class="in">    guide = "none"</span></span>
<span id="cb33-718"><a href="#cb33-718" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-719"><a href="#cb33-719" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-720"><a href="#cb33-720" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-721"><a href="#cb33-721" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-722"><a href="#cb33-722" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-723"><a href="#cb33-723" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-724"><a href="#cb33-724" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-725"><a href="#cb33-725" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-726"><a href="#cb33-726" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-727"><a href="#cb33-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-728"><a href="#cb33-728" aria-hidden="true" tabindex="-1"></a><span class="in">ggtern::grid.arrange(tern1, tern2, ncol = 2)</span></span>
<span id="cb33-729"><a href="#cb33-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-730"><a href="#cb33-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-731"><a href="#cb33-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-732"><a href="#cb33-732" aria-hidden="true" tabindex="-1"></a><span class="fu">## Uniform distribution across columns</span></span>
<span id="cb33-733"><a href="#cb33-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-734"><a href="#cb33-734" aria-hidden="true" tabindex="-1"></a>What happens if all the $\alpha$ values are 1, like this?</span>
<span id="cb33-735"><a href="#cb33-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-736"><a href="#cb33-736" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-737"><a href="#cb33-737" aria-hidden="true" tabindex="-1"></a>\operatorname{Dirichlet}(1, 1, 1)</span>
<span id="cb33-738"><a href="#cb33-738" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-739"><a href="#cb33-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-740"><a href="#cb33-740" aria-hidden="true" tabindex="-1"></a>What kind of distributions will these three columns have, and how will they be related to each other?</span>
<span id="cb33-741"><a href="#cb33-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-742"><a href="#cb33-742" aria-hidden="true" tabindex="-1"></a>Again, for the sake of illustration, we'll first manually find each column's average by using the $\alpha_n / \sum \alpha$ approach:</span>
<span id="cb33-743"><a href="#cb33-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-744"><a href="#cb33-744" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-745"><a href="#cb33-745" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-746"><a href="#cb33-746" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_1) &amp;= \frac{\alpha_1}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-747"><a href="#cb33-747" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_2) &amp;= \frac{\alpha_2}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333 <span class="sc">\\</span><span class="co">[</span><span class="ot">8pt</span><span class="co">]</span></span>
<span id="cb33-748"><a href="#cb33-748" aria-hidden="true" tabindex="-1"></a>\textbf{E}(\alpha_3) &amp;= \frac{\alpha_3}{\sum{\alpha}} = \frac{1}{1 + 1 + 1} = \frac{1}{3} = 0.333</span>
<span id="cb33-749"><a href="#cb33-749" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-750"><a href="#cb33-750" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-751"><a href="#cb33-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-752"><a href="#cb33-752" aria-hidden="true" tabindex="-1"></a>Each column has an equally-likely probability, and since there are 3 columns, each column has an average/central gravity of 0.33. But overall, this is actually a uniform Dirichlet distribution. Check out these 10 random rows from $\operatorname{Dirichlet}(1, 1, 1)$—they're all over the place! Some are nearly 0%, some are 95%, some are 30%, some are 70%. None of the columns really have any specific gravity, so their values are free to be whatever.</span>
<span id="cb33-753"><a href="#cb33-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-754"><a href="#cb33-754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-1-1-1}</span></span>
<span id="cb33-755"><a href="#cb33-755" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-756"><a href="#cb33-756" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 10, alpha = c(1, 1, 1)) |&gt; </span></span>
<span id="cb33-757"><a href="#cb33-757" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-758"><a href="#cb33-758" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3)</span></span>
<span id="cb33-759"><a href="#cb33-759" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-760"><a href="#cb33-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-761"><a href="#cb33-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-762"><a href="#cb33-762" aria-hidden="true" tabindex="-1"></a>Once again, we can verify this with column averages:</span>
<span id="cb33-763"><a href="#cb33-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-764"><a href="#cb33-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-mean-1-1-1}</span></span>
<span id="cb33-765"><a href="#cb33-765" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-766"><a href="#cb33-766" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 1e5, alpha = c(1, 1, 1)) |&gt; </span></span>
<span id="cb33-767"><a href="#cb33-767" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-768"><a href="#cb33-768" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:3) |&gt; </span></span>
<span id="cb33-769"><a href="#cb33-769" aria-hidden="true" tabindex="-1"></a><span class="in">    summarize(across(everything(), ~ mean(.x)))</span></span>
<span id="cb33-770"><a href="#cb33-770" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-771"><a href="#cb33-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-772"><a href="#cb33-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-773"><a href="#cb33-773" aria-hidden="true" tabindex="-1"></a>When I think of a uniform distribution, however, I think of something flat like <span class="in">`runif()`</span> or $\operatorname{Beta}(1, 1)$ where all values of x are equally likely:</span>
<span id="cb33-774"><a href="#cb33-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-775"><a href="#cb33-775" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-uniform-examples, fig.width=6, fig.height=3.5, out.width="65%"}</span></span>
<span id="cb33-776"><a href="#cb33-776" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-777"><a href="#cb33-777" aria-hidden="true" tabindex="-1"></a><span class="in">  p1 &lt;- tibble(x = runif(10000, min = 0, max = 100)) |&gt; </span></span>
<span id="cb33-778"><a href="#cb33-778" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = x)) +</span></span>
<span id="cb33-779"><a href="#cb33-779" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_histogram(binwidth = 10, boundary = 0, color = "white", fill = clrs[3]) +</span></span>
<span id="cb33-780"><a href="#cb33-780" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(y = NULL, x = NULL) +</span></span>
<span id="cb33-781"><a href="#cb33-781" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars("Uniform(0, 100)")) +</span></span>
<span id="cb33-782"><a href="#cb33-782" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist()</span></span>
<span id="cb33-783"><a href="#cb33-783" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb33-784"><a href="#cb33-784" aria-hidden="true" tabindex="-1"></a><span class="in">  p2 &lt;- tibble(x = rbeta(10000, shape1 = 1, shape2 = 1)) |&gt; </span></span>
<span id="cb33-785"><a href="#cb33-785" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = x)) +</span></span>
<span id="cb33-786"><a href="#cb33-786" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_histogram(binwidth = 0.1, boundary = 0, color = "white", fill = clrs[6]) +</span></span>
<span id="cb33-787"><a href="#cb33-787" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(y = NULL, x = NULL) +</span></span>
<span id="cb33-788"><a href="#cb33-788" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars("Beta(1, 1)")) +</span></span>
<span id="cb33-789"><a href="#cb33-789" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist()</span></span>
<span id="cb33-790"><a href="#cb33-790" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb33-791"><a href="#cb33-791" aria-hidden="true" tabindex="-1"></a><span class="in">  p1 | p2</span></span>
<span id="cb33-792"><a href="#cb33-792" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-793"><a href="#cb33-793" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-794"><a href="#cb33-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-795"><a href="#cb33-795" aria-hidden="true" tabindex="-1"></a>The individual components of a uniform Dirichlet distribution, however, don't look anything like this! Instead, they're triangles:</span>
<span id="cb33-796"><a href="#cb33-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-797"><a href="#cb33-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-1-1-1-betas, fig.width=8, fig.height=5.5, out.width="100%"}</span></span>
<span id="cb33-798"><a href="#cb33-798" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-799"><a href="#cb33-799" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for showing the `rdirichlet()` and `dbeta()` plots simultaneously"</span></span>
<span id="cb33-800"><a href="#cb33-800" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_1_1_1 &lt;- withr::with_seed(1234, {</span></span>
<span id="cb33-801"><a href="#cb33-801" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 10000, alpha = c(1, 1, 1)) |&gt; </span></span>
<span id="cb33-802"><a href="#cb33-802" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-803"><a href="#cb33-803" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(paste0("α&lt;sub&gt;", 1:3, "&lt;/sub&gt;")) |&gt; </span></span>
<span id="cb33-804"><a href="#cb33-804" aria-hidden="true" tabindex="-1"></a><span class="in">    pivot_longer(everything()) |&gt; </span></span>
<span id="cb33-805"><a href="#cb33-805" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-806"><a href="#cb33-806" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_density(bounds = c(0, 1), color = NA) +</span></span>
<span id="cb33-807"><a href="#cb33-807" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-808"><a href="#cb33-808" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_manual(values = clrs[c(1, 2, 4)], guide = "none") +</span></span>
<span id="cb33-809"><a href="#cb33-809" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(</span></span>
<span id="cb33-810"><a href="#cb33-810" aria-hidden="true" tabindex="-1"></a><span class="in">      x = NULL, y = NULL, </span></span>
<span id="cb33-811"><a href="#cb33-811" aria-hidden="true" tabindex="-1"></a><span class="in">      title = "Dirichlet(1, 1, 1)",</span></span>
<span id="cb33-812"><a href="#cb33-812" aria-hidden="true" tabindex="-1"></a><span class="in">      subtitle = "Distribution of 10,000 random draws") +</span></span>
<span id="cb33-813"><a href="#cb33-813" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(vars(name), scales = "free_y") +</span></span>
<span id="cb33-814"><a href="#cb33-814" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_nice_dist() +</span></span>
<span id="cb33-815"><a href="#cb33-815" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(strip.text = element_markdown())</span></span>
<span id="cb33-816"><a href="#cb33-816" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-817"><a href="#cb33-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-818"><a href="#cb33-818" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- ggplot() +</span></span>
<span id="cb33-819"><a href="#cb33-819" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-820"><a href="#cb33-820" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 1, (1 + 1)), n = 1000,</span></span>
<span id="cb33-821"><a href="#cb33-821" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[1]</span></span>
<span id="cb33-822"><a href="#cb33-822" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-823"><a href="#cb33-823" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-824"><a href="#cb33-824" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-825"><a href="#cb33-825" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Probability or proportion", y = NULL, </span></span>
<span id="cb33-826"><a href="#cb33-826" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "Columns as Beta distributions"</span></span>
<span id="cb33-827"><a href="#cb33-827" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-828"><a href="#cb33-828" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;1&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)")) +</span></span>
<span id="cb33-829"><a href="#cb33-829" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-830"><a href="#cb33-830" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-831"><a href="#cb33-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-832"><a href="#cb33-832" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- ggplot() +</span></span>
<span id="cb33-833"><a href="#cb33-833" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-834"><a href="#cb33-834" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 1, (1 + 1)), n = 1000,</span></span>
<span id="cb33-835"><a href="#cb33-835" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[2]</span></span>
<span id="cb33-836"><a href="#cb33-836" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-837"><a href="#cb33-837" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-838"><a href="#cb33-838" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-839"><a href="#cb33-839" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;2&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)")) +</span></span>
<span id="cb33-840"><a href="#cb33-840" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-841"><a href="#cb33-841" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-842"><a href="#cb33-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-843"><a href="#cb33-843" aria-hidden="true" tabindex="-1"></a><span class="in">p3 &lt;- ggplot() +</span></span>
<span id="cb33-844"><a href="#cb33-844" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-845"><a href="#cb33-845" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 1, (1 + 1)), n = 1000,</span></span>
<span id="cb33-846"><a href="#cb33-846" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[4]</span></span>
<span id="cb33-847"><a href="#cb33-847" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-848"><a href="#cb33-848" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-849"><a href="#cb33-849" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-850"><a href="#cb33-850" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("α&lt;sub&gt;3&lt;/sub&gt;: Beta(1, 2 &lt;span style='font-size:7pt'&gt;(1 + 1)&lt;/span&gt;)")) +</span></span>
<span id="cb33-851"><a href="#cb33-851" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-852"><a href="#cb33-852" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-853"><a href="#cb33-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-854"><a href="#cb33-854" aria-hidden="true" tabindex="-1"></a><span class="in">plot_dirichlet_1_1_1 / </span></span>
<span id="cb33-855"><a href="#cb33-855" aria-hidden="true" tabindex="-1"></a><span class="in">  (p1 | p2 | p3)</span></span>
<span id="cb33-856"><a href="#cb33-856" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-857"><a href="#cb33-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-858"><a href="#cb33-858" aria-hidden="true" tabindex="-1"></a>This is because the three columns are linked together. If all three are perfectly equally likely, they'll have a probability of 33%. If one is a little higher than 33%, the other two will need to be smaller than 33% to fit in the 100% constraint. If one is really big, the other two will need to be small (e.g. if one is 70%, the other two combined need to be 30%).</span>
<span id="cb33-859"><a href="#cb33-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-860"><a href="#cb33-860" aria-hidden="true" tabindex="-1"></a>The flat shape that you'd expect from a uniform distribution is actually visible in a ternary plot where we can look at the joint distribution of all three variables at the same time. There's no gravity at all here—each point is equally likely. Notice how all the <span class="in">`rdirichlet()`</span> points are scattered evenly throughout the left triangle, and the <span class="in">`ddirichlet()`</span> density gradient in the right triangle is a single color, representing one constant value. It truly is a uniform distribution.</span>
<span id="cb33-861"><a href="#cb33-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-862"><a href="#cb33-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-ternary-1-1-1, fig.width=7, fig.height=4, out.width="100%"}</span></span>
<span id="cb33-863"><a href="#cb33-863" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-864"><a href="#cb33-864" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for creating these ternary plots with {ggtern}"</span></span>
<span id="cb33-865"><a href="#cb33-865" aria-hidden="true" tabindex="-1"></a><span class="in"># First triangle: random points</span></span>
<span id="cb33-866"><a href="#cb33-866" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-867"><a href="#cb33-867" aria-hidden="true" tabindex="-1"></a><span class="in">  draws_1_1_1 &lt;- brms::rdirichlet(n = 1e5, alpha = c(1, 1, 1)) |&gt; </span></span>
<span id="cb33-868"><a href="#cb33-868" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-869"><a href="#cb33-869" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(c("x", "y", "z"))</span></span>
<span id="cb33-870"><a href="#cb33-870" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-871"><a href="#cb33-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-872"><a href="#cb33-872" aria-hidden="true" tabindex="-1"></a><span class="in">tern1 &lt;- draws_1_1_1 |&gt; </span></span>
<span id="cb33-873"><a href="#cb33-873" aria-hidden="true" tabindex="-1"></a><span class="in">  ggtern(aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-874"><a href="#cb33-874" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 0.05, alpha = 0.05, color = clrs[5]) +</span></span>
<span id="cb33-875"><a href="#cb33-875" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-876"><a href="#cb33-876" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-877"><a href="#cb33-877" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-878"><a href="#cb33-878" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-879"><a href="#cb33-879" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-880"><a href="#cb33-880" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-881"><a href="#cb33-881" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-882"><a href="#cb33-882" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-883"><a href="#cb33-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-884"><a href="#cb33-884" aria-hidden="true" tabindex="-1"></a><span class="in"># Second triangle: actual densities</span></span>
<span id="cb33-885"><a href="#cb33-885" aria-hidden="true" tabindex="-1"></a><span class="in"># Create a sequence of values for x, y, and z</span></span>
<span id="cb33-886"><a href="#cb33-886" aria-hidden="true" tabindex="-1"></a><span class="in">values &lt;- seq(0, 1, by = 0.005)</span></span>
<span id="cb33-887"><a href="#cb33-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-888"><a href="#cb33-888" aria-hidden="true" tabindex="-1"></a><span class="in"># Generate all possible combinations of x, y, and z that sum to 1</span></span>
<span id="cb33-889"><a href="#cb33-889" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- expand.grid(x = values, y = values, z = values) |&gt;</span></span>
<span id="cb33-890"><a href="#cb33-890" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(x + y + z == 1) |&gt; </span></span>
<span id="cb33-891"><a href="#cb33-891" aria-hidden="true" tabindex="-1"></a><span class="in">  rowwise() |&gt;</span></span>
<span id="cb33-892"><a href="#cb33-892" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(density = pmap_dbl(</span></span>
<span id="cb33-893"><a href="#cb33-893" aria-hidden="true" tabindex="-1"></a><span class="in">    list(x, y, z),</span></span>
<span id="cb33-894"><a href="#cb33-894" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ brms::ddirichlet(</span></span>
<span id="cb33-895"><a href="#cb33-895" aria-hidden="true" tabindex="-1"></a><span class="in">      as.numeric(c(..1, ..2, ..3)),</span></span>
<span id="cb33-896"><a href="#cb33-896" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = c(1, 1, 1)</span></span>
<span id="cb33-897"><a href="#cb33-897" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb33-898"><a href="#cb33-898" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-899"><a href="#cb33-899" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(!is.nan(density))</span></span>
<span id="cb33-900"><a href="#cb33-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-901"><a href="#cb33-901" aria-hidden="true" tabindex="-1"></a><span class="in">tern2 &lt;- ggtern(data = df, aes(x = x, y = y, z = z)) +</span></span>
<span id="cb33-902"><a href="#cb33-902" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(aes(color = density)) +</span></span>
<span id="cb33-903"><a href="#cb33-903" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_color_gradientn(colors = clrs[5:1], guide = "none") +</span></span>
<span id="cb33-904"><a href="#cb33-904" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_L_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;1&lt;/sub&gt;") +</span></span>
<span id="cb33-905"><a href="#cb33-905" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_T_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;2&lt;/sub&gt;") +</span></span>
<span id="cb33-906"><a href="#cb33-906" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_R_continuous(breaks = 0:5 / 5, labels = 0:5 / 5, name = "α&lt;sub&gt;3&lt;/sub&gt;") +</span></span>
<span id="cb33-907"><a href="#cb33-907" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-908"><a href="#cb33-908" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.L = element_markdown(face = "bold", color = clrs[1], size = rel(1.2)),</span></span>
<span id="cb33-909"><a href="#cb33-909" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.T = element_markdown(face = "bold", color = clrs[2], size = rel(1.2)),</span></span>
<span id="cb33-910"><a href="#cb33-910" aria-hidden="true" tabindex="-1"></a><span class="in">    tern.axis.title.R = element_markdown(face = "bold", color = clrs[4], size = rel(1.2))</span></span>
<span id="cb33-911"><a href="#cb33-911" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-912"><a href="#cb33-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-913"><a href="#cb33-913" aria-hidden="true" tabindex="-1"></a><span class="in">ggtern::grid.arrange(tern1, tern2, ncol = 2)</span></span>
<span id="cb33-914"><a href="#cb33-914" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-915"><a href="#cb33-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-916"><a href="#cb33-916" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb33-917"><a href="#cb33-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-918"><a href="#cb33-918" aria-hidden="true" tabindex="-1"></a><span class="fu"># Conclusion: Stuck in three dimensions</span></span>
<span id="cb33-919"><a href="#cb33-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-920"><a href="#cb33-920" aria-hidden="true" tabindex="-1"></a>So, the moral of the story is that Dirichlet distributions are just fancy multivariate versions of Beta distributions. They use shape parameters pretty much the same way, and they constrain all the values across all columns to (1) be limited to between 0–1 and (2) sum to 1. They're not nearly as scary and intimidating as I had thought they were.</span>
<span id="cb33-921"><a href="#cb33-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-922"><a href="#cb33-922" aria-hidden="true" tabindex="-1"></a>In this post, we visualized a bunch of three-element distributions, but you can create distributions with as many $\alpha$ elements as you want. We did that earlier with six parameters in $\operatorname{Dirichlet}(3, 7, 2, 2, 9, 1)$:</span>
<span id="cb33-923"><a href="#cb33-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-924"><a href="#cb33-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-6}</span></span>
<span id="cb33-925"><a href="#cb33-925" aria-hidden="true" tabindex="-1"></a><span class="in"># Six columns</span></span>
<span id="cb33-926"><a href="#cb33-926" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-927"><a href="#cb33-927" aria-hidden="true" tabindex="-1"></a><span class="in">  brms::rdirichlet(n = 3, alpha = c(3, 7, 2, 2, 9, 1)) |&gt; </span></span>
<span id="cb33-928"><a href="#cb33-928" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-929"><a href="#cb33-929" aria-hidden="true" tabindex="-1"></a><span class="in">    set_names(1:6) |&gt; </span></span>
<span id="cb33-930"><a href="#cb33-930" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(total = `1` + `2` + `3` + `4` + `5` + `6`)</span></span>
<span id="cb33-931"><a href="#cb33-931" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-932"><a href="#cb33-932" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-933"><a href="#cb33-933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-934"><a href="#cb33-934" aria-hidden="true" tabindex="-1"></a>But good luck visualizing that ↑. There are six dimensions there—no human plot can show the correlations between all those densities (i.e. there's no six-dimensional version of a ternary plot). A scatterplot matrix will get you close, but you won't be able to see how the gravities/central tendencies of the different columns interact with each other. We're stuck in a three-dimensional world. Alas.</span>
<span id="cb33-935"><a href="#cb33-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-936"><a href="#cb33-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-937"><a href="#cb33-937" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb33-938"><a href="#cb33-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-939"><a href="#cb33-939" aria-hidden="true" tabindex="-1"></a><span class="fu"># Bonus later addition! Boundaries between categories!</span></span>
<span id="cb33-940"><a href="#cb33-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-941"><a href="#cb33-941" aria-hidden="true" tabindex="-1"></a>The whole reason I wrote this post and had to figure out how Dirichlet distributions worked was because I had to deal with a Dirichlet prior for an <span class="co">[</span><span class="ot">ordered Beta regression</span><span class="co">](https://www.robertkubinec.com/post/limited_dvs/)</span> model <span class="co">[</span><span class="ot">@Kubinec:2022</span><span class="co">]</span>. As mentioned at the beginning (and <span class="co">[</span><span class="ot">as demonstrated here</span><span class="co">](https://stats.andrewheiss.com/compassionate-clam/notebook/ordbeta.html)</span>), this is a neat fusion of regular Beta regression and ordinal logistic regression that predicts three kinds of outcomes with a single set of covariates:</span>
<span id="cb33-942"><a href="#cb33-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-943"><a href="#cb33-943" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Outcomes that are exactly 0</span>
<span id="cb33-944"><a href="#cb33-944" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Outcomes that are between 0 and 1</span>
<span id="cb33-945"><a href="#cb33-945" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Outcomes that are exactly 1</span>
<span id="cb33-946"><a href="#cb33-946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-947"><a href="#cb33-947" aria-hidden="true" tabindex="-1"></a>To do this, it treats these outcomes as a kind of ordered category: *Exactly 0* &lt; *Between 0 and 1* &lt; *Exactly 1*. Ordered logistic regression uses cutpoints between categories to determine the shifts in probabilities between one category and the next, and the same thing happens here with <span class="in">`ordbetareg::ordbetareg()`</span>. There are two cutpoints to worry about:</span>
<span id="cb33-948"><a href="#cb33-948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-949"><a href="#cb33-949" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>$k_1$ for the boundary between *Exactly 0* and *Between 0 and 1*</span>
<span id="cb33-950"><a href="#cb33-950" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>$k_2$ for the boundary between *Between 0 and 1* and *Exactly 1*</span>
<span id="cb33-951"><a href="#cb33-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-952"><a href="#cb33-952" aria-hidden="true" tabindex="-1"></a>When specifying the model, though, <span class="in">`ordbetareg()`</span> requires a three-element Dirichlet distribution, and defaults to $\operatorname{Dirichlet}(1, 1, 1)$. At first this threw me off because, as we've seen above, a Dirichlet distribution with a three-element $\alpha$ consists of three numbers, but we only have two cutpoints ($k_1$ and $k_2$). </span>
<span id="cb33-953"><a href="#cb33-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-954"><a href="#cb33-954" aria-hidden="true" tabindex="-1"></a>After reading @Kubinec:2022 more closely and digging through the <span class="co">[</span><span class="ot">code at GitHub</span><span class="co">](https://github.com/saudiwin/ordbetareg_pack/)</span>, I learned that behind the scenes, what <span class="in">`ordbetareg()`</span> actually does is use the boundaries *between* the three elements of the a Dirichlet distribution. This is a neat approach since it enforces a natural ordering between cutpoints and it's more intuitive to think about probabilities of categories directly instead of thinking about latent boundaries.</span>
<span id="cb33-955"><a href="#cb33-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-956"><a href="#cb33-956" aria-hidden="true" tabindex="-1"></a>::: {.callout-tip}</span>
<span id="cb33-957"><a href="#cb33-957" aria-hidden="true" tabindex="-1"></a><span class="fu">### Induced Dirichlet priors</span></span>
<span id="cb33-958"><a href="#cb33-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-959"><a href="#cb33-959" aria-hidden="true" tabindex="-1"></a>It's possible to use Dirichlet-boundary (more officially called *induced Dirichlet*) priors in other Stan models too, like ordinal logistic regression (<span class="co">[</span><span class="ot">see this tutorial by Michael Betancourt</span><span class="co">](https://betanalpha.github.io/assets/case_studies/ordinal_regression.html#22_Surgical_Cut)</span> and <span class="co">[</span><span class="ot">this 2015 discussion on the early Stan mailing list</span><span class="co">](https://groups.google.com/g/stan-users/c/pYkCZvrrkRg/m/jRdDOUHuSikJ)</span>). </span>
<span id="cb33-960"><a href="#cb33-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-961"><a href="#cb33-961" aria-hidden="true" tabindex="-1"></a>I don't think <span class="co">[</span><span class="ot">it's possible to do with {brms}</span><span class="co">](https://discourse.mc-stan.org/t/dirichlet-prior-on-ordinal-regression-cutpoints-in-brms/20640)</span> though (at least <span class="co">[</span><span class="ot">as of February 2021</span><span class="co">](https://discourse.mc-stan.org/t/dirichlet-prior-on-ordinal-regression-cutpoints-in-brms/20640/2)</span>).</span>
<span id="cb33-962"><a href="#cb33-962" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb33-963"><a href="#cb33-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-964"><a href="#cb33-964" aria-hidden="true" tabindex="-1"></a>So let's briefly look at how to work with and visualize the boundaries between categories.</span>
<span id="cb33-965"><a href="#cb33-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-966"><a href="#cb33-966" aria-hidden="true" tabindex="-1"></a>First, let's draw a bunch of numbers from the $\operatorname{Dirichlet}(3, 7, 2)$ distribution we worked with earlier. We'll name these a generic "Category A–C" (in ordered Beta, these would be *Exactly 0*, *Between 0 and 1*, and *Exactly 1*):</span>
<span id="cb33-967"><a href="#cb33-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-968"><a href="#cb33-968" aria-hidden="true" tabindex="-1"></a><span class="in">```{r rdirichlet-3-7-2-for-cutpoints}</span></span>
<span id="cb33-969"><a href="#cb33-969" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-970"><a href="#cb33-970" aria-hidden="true" tabindex="-1"></a><span class="in">  lots_of_draws &lt;- brms::rdirichlet(n = 1000, alpha = c(3, 7, 2)) |&gt; </span></span>
<span id="cb33-971"><a href="#cb33-971" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-972"><a href="#cb33-972" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(draw = 1:n()) </span></span>
<span id="cb33-973"><a href="#cb33-973" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-974"><a href="#cb33-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-975"><a href="#cb33-975" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_draws_long &lt;- lots_of_draws |&gt; </span></span>
<span id="cb33-976"><a href="#cb33-976" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(-draw, names_to = "category", values_to = "proportion") |&gt; </span></span>
<span id="cb33-977"><a href="#cb33-977" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(category_nice = case_match(category,</span></span>
<span id="cb33-978"><a href="#cb33-978" aria-hidden="true" tabindex="-1"></a><span class="in">    "X1" ~ "Category A",</span></span>
<span id="cb33-979"><a href="#cb33-979" aria-hidden="true" tabindex="-1"></a><span class="in">    "X2" ~ "Category B",</span></span>
<span id="cb33-980"><a href="#cb33-980" aria-hidden="true" tabindex="-1"></a><span class="in">    "X3" ~ "Category C",</span></span>
<span id="cb33-981"><a href="#cb33-981" aria-hidden="true" tabindex="-1"></a><span class="in">    .ptype = factor(</span></span>
<span id="cb33-982"><a href="#cb33-982" aria-hidden="true" tabindex="-1"></a><span class="in">      levels = c("Category A", "Category B", "Category C"), </span></span>
<span id="cb33-983"><a href="#cb33-983" aria-hidden="true" tabindex="-1"></a><span class="in">      ordered = TRUE)</span></span>
<span id="cb33-984"><a href="#cb33-984" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb33-985"><a href="#cb33-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-986"><a href="#cb33-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-987"><a href="#cb33-987" aria-hidden="true" tabindex="-1"></a>The distributions of the probabilities of the individual columns are the same as what we saw earlier in the post, with averages of 25%, 58%, and 17%:</span>
<span id="cb33-988"><a href="#cb33-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-989"><a href="#cb33-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-rdirichlet-categories-3-7-2, fig.width=8, fig.height=3, out.width="100%"}</span></span>
<span id="cb33-990"><a href="#cb33-990" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_draws_long |&gt; </span></span>
<span id="cb33-991"><a href="#cb33-991" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(category_nice) |&gt; </span></span>
<span id="cb33-992"><a href="#cb33-992" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(avg_prop = mean(proportion))</span></span>
<span id="cb33-993"><a href="#cb33-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-994"><a href="#cb33-994" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_draws_long |&gt; </span></span>
<span id="cb33-995"><a href="#cb33-995" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = proportion, fill = category_nice)) +</span></span>
<span id="cb33-996"><a href="#cb33-996" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_density(bounds = c(0, 1), color = NA) +</span></span>
<span id="cb33-997"><a href="#cb33-997" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-998"><a href="#cb33-998" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(1, 2, 4)], guide = "none") +</span></span>
<span id="cb33-999"><a href="#cb33-999" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, title = "Dirichlet(3, 7, 2)") +</span></span>
<span id="cb33-1000"><a href="#cb33-1000" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(category_nice), scales = "free_y") +</span></span>
<span id="cb33-1001"><a href="#cb33-1001" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1002"><a href="#cb33-1002" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1003"><a href="#cb33-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1004"><a href="#cb33-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1005"><a href="#cb33-1005" aria-hidden="true" tabindex="-1"></a>What we care about here, though, are the boundaries between the categories, or $k_1$ and $k_2$. The boundary between Categories A and B ($k_1$) is easy—it happens immediately after Category A, so it's actually equal to Category A, or 25ish%. The boundary between Categories B and C happens immediately after Category B, but because these are ordered categories, we need to include the probability of Category A too, so it's equal to Category A + Category B, or 83ish%.</span>
<span id="cb33-1006"><a href="#cb33-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1007"><a href="#cb33-1007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r cutpoints-3-7-2-means}</span></span>
<span id="cb33-1008"><a href="#cb33-1008" aria-hidden="true" tabindex="-1"></a><span class="in">cutpoints &lt;- lots_of_draws |&gt; </span></span>
<span id="cb33-1009"><a href="#cb33-1009" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb33-1010"><a href="#cb33-1010" aria-hidden="true" tabindex="-1"></a><span class="in">    k1 = X1, </span></span>
<span id="cb33-1011"><a href="#cb33-1011" aria-hidden="true" tabindex="-1"></a><span class="in">    k2 = X1 + X2</span></span>
<span id="cb33-1012"><a href="#cb33-1012" aria-hidden="true" tabindex="-1"></a><span class="in">  ) |&gt; </span></span>
<span id="cb33-1013"><a href="#cb33-1013" aria-hidden="true" tabindex="-1"></a><span class="in">  summarize(across(c(k1, k2), ~mean(.)))</span></span>
<span id="cb33-1014"><a href="#cb33-1014" aria-hidden="true" tabindex="-1"></a><span class="in">cutpoints</span></span>
<span id="cb33-1015"><a href="#cb33-1015" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1016"><a href="#cb33-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1017"><a href="#cb33-1017" aria-hidden="true" tabindex="-1"></a>I find that it's easier to visualize these cutpoints. To do this, we'll plot 100 stacked bar plots and add vertical lines for $k_1$ and $k_2$. The first yellow bar segment shows the proportion of Category A; the second red segment shows the proportion of Category B; the third segment shows the proportion of Category C; the three categories added together equal 100%. Because these are random draws from a fairly uncertain $\operatorname{Dirichlet}(3, 7, 2)$ distribution, some of the segments fall substantially over or below the different $k$ cutpoints, but on average, the boundaries are at 25% and 83% respectively.</span>
<span id="cb33-1018"><a href="#cb33-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1019"><a href="#cb33-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-cutpoints-bars-3-7-2, fig.width=7, fig.height=4, out.width="100%"}</span></span>
<span id="cb33-1020"><a href="#cb33-1020" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_draws_long |&gt;</span></span>
<span id="cb33-1021"><a href="#cb33-1021" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(draw &lt;= 200) |&gt;</span></span>
<span id="cb33-1022"><a href="#cb33-1022" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(draw) |&gt;</span></span>
<span id="cb33-1023"><a href="#cb33-1023" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y = as.character(draw), x = proportion)) +</span></span>
<span id="cb33-1024"><a href="#cb33-1024" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(</span></span>
<span id="cb33-1025"><a href="#cb33-1025" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(fill = category_nice),</span></span>
<span id="cb33-1026"><a href="#cb33-1026" aria-hidden="true" tabindex="-1"></a><span class="in">    position = position_fill(reverse = TRUE), linewidth = 0, width = 1</span></span>
<span id="cb33-1027"><a href="#cb33-1027" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1028"><a href="#cb33-1028" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(</span></span>
<span id="cb33-1029"><a href="#cb33-1029" aria-hidden="true" tabindex="-1"></a><span class="in">    xintercept = c(cutpoints$k1, cutpoints$k2),</span></span>
<span id="cb33-1030"><a href="#cb33-1030" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = 1, linetype = "21", color = "white"</span></span>
<span id="cb33-1031"><a href="#cb33-1031" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1032"><a href="#cb33-1032" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1033"><a href="#cb33-1033" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = cutpoints$k1, y = 100,</span></span>
<span id="cb33-1034"><a href="#cb33-1034" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[3], color = "white",</span></span>
<span id="cb33-1035"><a href="#cb33-1035" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[1]", parse = TRUE</span></span>
<span id="cb33-1036"><a href="#cb33-1036" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1037"><a href="#cb33-1037" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1038"><a href="#cb33-1038" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = cutpoints$k2, y = 100,</span></span>
<span id="cb33-1039"><a href="#cb33-1039" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[6], color = "white",</span></span>
<span id="cb33-1040"><a href="#cb33-1040" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[2]", parse = TRUE</span></span>
<span id="cb33-1041"><a href="#cb33-1041" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1042"><a href="#cb33-1042" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(labels = label_percent(), expand = c(0, 0.012)) +</span></span>
<span id="cb33-1043"><a href="#cb33-1043" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_discrete(breaks = NULL, expand = c(0, 0)) +</span></span>
<span id="cb33-1044"><a href="#cb33-1044" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(1, 2, 4)]) +</span></span>
<span id="cb33-1045"><a href="#cb33-1045" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-1046"><a href="#cb33-1046" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Probability or proportion", y = NULL, fill = NULL, </span></span>
<span id="cb33-1047"><a href="#cb33-1047" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Dirichlet(3, 7, 2)"</span></span>
<span id="cb33-1048"><a href="#cb33-1048" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1049"><a href="#cb33-1049" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-1050"><a href="#cb33-1050" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.grid.major = element_blank(),</span></span>
<span id="cb33-1051"><a href="#cb33-1051" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.border = element_blank(),</span></span>
<span id="cb33-1052"><a href="#cb33-1052" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "top",</span></span>
<span id="cb33-1053"><a href="#cb33-1053" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.key.size = unit(0.7, "line"),</span></span>
<span id="cb33-1054"><a href="#cb33-1054" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.margin = margin(b = -5),</span></span>
<span id="cb33-1055"><a href="#cb33-1055" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.justification = "left"</span></span>
<span id="cb33-1056"><a href="#cb33-1056" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-1057"><a href="#cb33-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1058"><a href="#cb33-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1059"><a href="#cb33-1059" aria-hidden="true" tabindex="-1"></a>If we add more precision to the categories by scaling up the $\alpha$ parameters, like $\operatorname{Dirichlet}(30, 70, 20)$, the boundaries between categories become more defined:</span>
<span id="cb33-1060"><a href="#cb33-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1061"><a href="#cb33-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-cutpoints-bars-30-70-20, fig.width=7, fig.height=4, out.width="100%"}</span></span>
<span id="cb33-1062"><a href="#cb33-1062" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-1063"><a href="#cb33-1063" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for showing cutpoints for $\\operatorname{Dirichlet}(30, 70, 20)$"</span></span>
<span id="cb33-1064"><a href="#cb33-1064" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-1065"><a href="#cb33-1065" aria-hidden="true" tabindex="-1"></a><span class="in">  lots_of_big_draws &lt;- brms::rdirichlet(n = 1000, alpha = c(30, 70, 22)) |&gt; </span></span>
<span id="cb33-1066"><a href="#cb33-1066" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-1067"><a href="#cb33-1067" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(draw = 1:n()) </span></span>
<span id="cb33-1068"><a href="#cb33-1068" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-1069"><a href="#cb33-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1070"><a href="#cb33-1070" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_big_draws_long &lt;- lots_of_big_draws |&gt; </span></span>
<span id="cb33-1071"><a href="#cb33-1071" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(-draw, names_to = "category", values_to = "proportion") |&gt; </span></span>
<span id="cb33-1072"><a href="#cb33-1072" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(category_nice = case_match(category,</span></span>
<span id="cb33-1073"><a href="#cb33-1073" aria-hidden="true" tabindex="-1"></a><span class="in">    "X1" ~ "Category A",</span></span>
<span id="cb33-1074"><a href="#cb33-1074" aria-hidden="true" tabindex="-1"></a><span class="in">    "X2" ~ "Category B",</span></span>
<span id="cb33-1075"><a href="#cb33-1075" aria-hidden="true" tabindex="-1"></a><span class="in">    "X3" ~ "Category C",</span></span>
<span id="cb33-1076"><a href="#cb33-1076" aria-hidden="true" tabindex="-1"></a><span class="in">    .ptype = factor(</span></span>
<span id="cb33-1077"><a href="#cb33-1077" aria-hidden="true" tabindex="-1"></a><span class="in">      levels = c("Category A", "Category B", "Category C"), </span></span>
<span id="cb33-1078"><a href="#cb33-1078" aria-hidden="true" tabindex="-1"></a><span class="in">      ordered = TRUE)</span></span>
<span id="cb33-1079"><a href="#cb33-1079" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb33-1080"><a href="#cb33-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1081"><a href="#cb33-1081" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_big_draws_long |&gt;</span></span>
<span id="cb33-1082"><a href="#cb33-1082" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(draw &lt;= 200) |&gt;</span></span>
<span id="cb33-1083"><a href="#cb33-1083" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(draw) |&gt;</span></span>
<span id="cb33-1084"><a href="#cb33-1084" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y = as.character(draw), x = proportion)) +</span></span>
<span id="cb33-1085"><a href="#cb33-1085" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(</span></span>
<span id="cb33-1086"><a href="#cb33-1086" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(fill = category_nice),</span></span>
<span id="cb33-1087"><a href="#cb33-1087" aria-hidden="true" tabindex="-1"></a><span class="in">    position = position_fill(reverse = TRUE), linewidth = 0, width = 1</span></span>
<span id="cb33-1088"><a href="#cb33-1088" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1089"><a href="#cb33-1089" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(</span></span>
<span id="cb33-1090"><a href="#cb33-1090" aria-hidden="true" tabindex="-1"></a><span class="in">    xintercept = c(cutpoints$k1, cutpoints$k2),</span></span>
<span id="cb33-1091"><a href="#cb33-1091" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = 1, linetype = "21", color = "white"</span></span>
<span id="cb33-1092"><a href="#cb33-1092" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1093"><a href="#cb33-1093" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1094"><a href="#cb33-1094" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = cutpoints$k1, y = 100,</span></span>
<span id="cb33-1095"><a href="#cb33-1095" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[3], color = "white",</span></span>
<span id="cb33-1096"><a href="#cb33-1096" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[1]", parse = TRUE</span></span>
<span id="cb33-1097"><a href="#cb33-1097" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1098"><a href="#cb33-1098" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1099"><a href="#cb33-1099" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = cutpoints$k2, y = 100,</span></span>
<span id="cb33-1100"><a href="#cb33-1100" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[6], color = "white",</span></span>
<span id="cb33-1101"><a href="#cb33-1101" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[2]", parse = TRUE</span></span>
<span id="cb33-1102"><a href="#cb33-1102" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1103"><a href="#cb33-1103" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(labels = label_percent(), expand = c(0, 0.012)) +</span></span>
<span id="cb33-1104"><a href="#cb33-1104" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_discrete(breaks = NULL, expand = c(0, 0)) +</span></span>
<span id="cb33-1105"><a href="#cb33-1105" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(1, 2, 4)]) +</span></span>
<span id="cb33-1106"><a href="#cb33-1106" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-1107"><a href="#cb33-1107" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Probability or proportion", y = NULL, fill = NULL, </span></span>
<span id="cb33-1108"><a href="#cb33-1108" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Dirichlet(30, 70, 20)"</span></span>
<span id="cb33-1109"><a href="#cb33-1109" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1110"><a href="#cb33-1110" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-1111"><a href="#cb33-1111" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.grid.major = element_blank(),</span></span>
<span id="cb33-1112"><a href="#cb33-1112" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.border = element_blank(),</span></span>
<span id="cb33-1113"><a href="#cb33-1113" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "top",</span></span>
<span id="cb33-1114"><a href="#cb33-1114" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.key.size = unit(0.7, "line"),</span></span>
<span id="cb33-1115"><a href="#cb33-1115" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.margin = margin(b = -5),</span></span>
<span id="cb33-1116"><a href="#cb33-1116" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.justification = "left"</span></span>
<span id="cb33-1117"><a href="#cb33-1117" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-1118"><a href="#cb33-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1119"><a href="#cb33-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1120"><a href="#cb33-1120" aria-hidden="true" tabindex="-1"></a>Because we're working with a bunch of random Dirichlet draws, we can actually find the full distribution of the boundaries instead of just the averages, and we can see how the uncertainty in the boundary values vary by how precise the underlying Dirichlet distribution is:</span>
<span id="cb33-1121"><a href="#cb33-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1122"><a href="#cb33-1122" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-cutpoints-dist-3-7-2, fig.width=7, fig.height=5}</span></span>
<span id="cb33-1123"><a href="#cb33-1123" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- lots_of_draws |&gt; </span></span>
<span id="cb33-1124"><a href="#cb33-1124" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(k1 = X1, k2 = X1 + X2) |&gt;</span></span>
<span id="cb33-1125"><a href="#cb33-1125" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(c(k1, k2)) |&gt; </span></span>
<span id="cb33-1126"><a href="#cb33-1126" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(name = case_match(name,</span></span>
<span id="cb33-1127"><a href="#cb33-1127" aria-hidden="true" tabindex="-1"></a><span class="in">    "k1" ~ "k&lt;sub&gt;1&lt;/sub&gt;",</span></span>
<span id="cb33-1128"><a href="#cb33-1128" aria-hidden="true" tabindex="-1"></a><span class="in">    "k2" ~ "k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span id="cb33-1129"><a href="#cb33-1129" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-1130"><a href="#cb33-1130" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-1131"><a href="#cb33-1131" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(p_limits = c(0, 1)) +</span></span>
<span id="cb33-1132"><a href="#cb33-1132" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(3, 6)], guide = "none") +</span></span>
<span id="cb33-1133"><a href="#cb33-1133" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, title = "Cutpoints for Dirichlet(3, 7, 2)") +</span></span>
<span id="cb33-1134"><a href="#cb33-1134" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(name)) +</span></span>
<span id="cb33-1135"><a href="#cb33-1135" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1136"><a href="#cb33-1136" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1137"><a href="#cb33-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1138"><a href="#cb33-1138" aria-hidden="true" tabindex="-1"></a><span class="in">p2 &lt;- lots_of_big_draws |&gt; </span></span>
<span id="cb33-1139"><a href="#cb33-1139" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(k1 = X1, k2 = X1 + X2) |&gt;</span></span>
<span id="cb33-1140"><a href="#cb33-1140" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(c(k1, k2)) |&gt; </span></span>
<span id="cb33-1141"><a href="#cb33-1141" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(name = case_match(name,</span></span>
<span id="cb33-1142"><a href="#cb33-1142" aria-hidden="true" tabindex="-1"></a><span class="in">    "k1" ~ "k&lt;sub&gt;1&lt;/sub&gt;",</span></span>
<span id="cb33-1143"><a href="#cb33-1143" aria-hidden="true" tabindex="-1"></a><span class="in">    "k2" ~ "k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span id="cb33-1144"><a href="#cb33-1144" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-1145"><a href="#cb33-1145" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-1146"><a href="#cb33-1146" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(p_limits = c(0, 1)) +</span></span>
<span id="cb33-1147"><a href="#cb33-1147" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(3, 6)], guide = "none") +</span></span>
<span id="cb33-1148"><a href="#cb33-1148" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, title = "Cutpoints for Dirichlet(30, 70, 20)") +</span></span>
<span id="cb33-1149"><a href="#cb33-1149" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(name)) +</span></span>
<span id="cb33-1150"><a href="#cb33-1150" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1151"><a href="#cb33-1151" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1152"><a href="#cb33-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1153"><a href="#cb33-1153" aria-hidden="true" tabindex="-1"></a><span class="in">(p1 / plot_spacer() / p2) + </span></span>
<span id="cb33-1154"><a href="#cb33-1154" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(heights = c(0.48, 0.04, 0.48))</span></span>
<span id="cb33-1155"><a href="#cb33-1155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1156"><a href="#cb33-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1157"><a href="#cb33-1157" aria-hidden="true" tabindex="-1"></a>Those ↑ are what Stan then uses as the latent ordinal cutpoints: somewhere around 0.25 for $k_1$ and around 0.8 for $k_2$.</span>
<span id="cb33-1158"><a href="#cb33-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1159"><a href="#cb33-1159" aria-hidden="true" tabindex="-1"></a>Those cutpoints are probably way too precise for Bayesian modeling. The default prior for <span class="in">`ordbetareg()`</span> is a uniform $\operatorname{Dirichlet}(1, 1, 1)$. The cutpoints there should be 33% and 66% (<span class="co">[</span><span class="ot">as seen earlier</span><span class="co">](#uniform-distribution-across-columns)</span>, where all three columns have equal 33% probabilities). Here's what that looks like as a neat sideways stacked bar chart:</span>
<span id="cb33-1160"><a href="#cb33-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1161"><a href="#cb33-1161" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-cutpoints-bars-1-1-1, fig.width=7, fig.height=4, out.width="100%"}</span></span>
<span id="cb33-1162"><a href="#cb33-1162" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-1163"><a href="#cb33-1163" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for showing cutpoints for $\\operatorname{Dirichlet}(1, 1, 1)$"</span></span>
<span id="cb33-1164"><a href="#cb33-1164" aria-hidden="true" tabindex="-1"></a><span class="in">withr::with_seed(1234, {</span></span>
<span id="cb33-1165"><a href="#cb33-1165" aria-hidden="true" tabindex="-1"></a><span class="in">  lots_of_uniform_draws &lt;- brms::rdirichlet(n = 1000, alpha = c(1, 1, 1)) |&gt; </span></span>
<span id="cb33-1166"><a href="#cb33-1166" aria-hidden="true" tabindex="-1"></a><span class="in">    data.frame() |&gt; </span></span>
<span id="cb33-1167"><a href="#cb33-1167" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(draw = 1:n()) </span></span>
<span id="cb33-1168"><a href="#cb33-1168" aria-hidden="true" tabindex="-1"></a><span class="in">})</span></span>
<span id="cb33-1169"><a href="#cb33-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1170"><a href="#cb33-1170" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_uniform_draws_long &lt;- lots_of_uniform_draws |&gt; </span></span>
<span id="cb33-1171"><a href="#cb33-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(-draw, names_to = "category", values_to = "proportion") |&gt; </span></span>
<span id="cb33-1172"><a href="#cb33-1172" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(category_nice = case_match(category,</span></span>
<span id="cb33-1173"><a href="#cb33-1173" aria-hidden="true" tabindex="-1"></a><span class="in">    "X1" ~ "Category A",</span></span>
<span id="cb33-1174"><a href="#cb33-1174" aria-hidden="true" tabindex="-1"></a><span class="in">    "X2" ~ "Category B",</span></span>
<span id="cb33-1175"><a href="#cb33-1175" aria-hidden="true" tabindex="-1"></a><span class="in">    "X3" ~ "Category C",</span></span>
<span id="cb33-1176"><a href="#cb33-1176" aria-hidden="true" tabindex="-1"></a><span class="in">    .ptype = factor(</span></span>
<span id="cb33-1177"><a href="#cb33-1177" aria-hidden="true" tabindex="-1"></a><span class="in">      levels = c("Category A", "Category B", "Category C"), </span></span>
<span id="cb33-1178"><a href="#cb33-1178" aria-hidden="true" tabindex="-1"></a><span class="in">      ordered = TRUE)</span></span>
<span id="cb33-1179"><a href="#cb33-1179" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb33-1180"><a href="#cb33-1180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1181"><a href="#cb33-1181" aria-hidden="true" tabindex="-1"></a><span class="in">lots_of_uniform_draws_long |&gt;</span></span>
<span id="cb33-1182"><a href="#cb33-1182" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(draw &lt;= 200) |&gt;</span></span>
<span id="cb33-1183"><a href="#cb33-1183" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(draw) |&gt;</span></span>
<span id="cb33-1184"><a href="#cb33-1184" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(y = as.character(draw), x = proportion)) +</span></span>
<span id="cb33-1185"><a href="#cb33-1185" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_col(</span></span>
<span id="cb33-1186"><a href="#cb33-1186" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(fill = category_nice),</span></span>
<span id="cb33-1187"><a href="#cb33-1187" aria-hidden="true" tabindex="-1"></a><span class="in">    position = position_fill(reverse = TRUE), linewidth = 0, width = 1</span></span>
<span id="cb33-1188"><a href="#cb33-1188" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1189"><a href="#cb33-1189" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_vline(</span></span>
<span id="cb33-1190"><a href="#cb33-1190" aria-hidden="true" tabindex="-1"></a><span class="in">    xintercept = c(1/3, 2/3),</span></span>
<span id="cb33-1191"><a href="#cb33-1191" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = 1, linetype = "21", color = "white"</span></span>
<span id="cb33-1192"><a href="#cb33-1192" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1193"><a href="#cb33-1193" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1194"><a href="#cb33-1194" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = 1/3, y = 100,</span></span>
<span id="cb33-1195"><a href="#cb33-1195" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[3], color = "white",</span></span>
<span id="cb33-1196"><a href="#cb33-1196" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[1]", parse = TRUE</span></span>
<span id="cb33-1197"><a href="#cb33-1197" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1198"><a href="#cb33-1198" aria-hidden="true" tabindex="-1"></a><span class="in">  annotate(</span></span>
<span id="cb33-1199"><a href="#cb33-1199" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "label", x = 2/3, y = 100,</span></span>
<span id="cb33-1200"><a href="#cb33-1200" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[6], color = "white",</span></span>
<span id="cb33-1201"><a href="#cb33-1201" aria-hidden="true" tabindex="-1"></a><span class="in">    size = 5, label = "k[2]", parse = TRUE</span></span>
<span id="cb33-1202"><a href="#cb33-1202" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1203"><a href="#cb33-1203" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(labels = label_percent(), expand = c(0, 0.012)) +</span></span>
<span id="cb33-1204"><a href="#cb33-1204" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_y_discrete(breaks = NULL, expand = c(0, 0)) +</span></span>
<span id="cb33-1205"><a href="#cb33-1205" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(1, 2, 4)]) +</span></span>
<span id="cb33-1206"><a href="#cb33-1206" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-1207"><a href="#cb33-1207" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Probability or proportion", y = NULL, fill = NULL, </span></span>
<span id="cb33-1208"><a href="#cb33-1208" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Dirichlet(1, 1, 1)"</span></span>
<span id="cb33-1209"><a href="#cb33-1209" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1210"><a href="#cb33-1210" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(</span></span>
<span id="cb33-1211"><a href="#cb33-1211" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.grid.major = element_blank(),</span></span>
<span id="cb33-1212"><a href="#cb33-1212" aria-hidden="true" tabindex="-1"></a><span class="in">    panel.border = element_blank(),</span></span>
<span id="cb33-1213"><a href="#cb33-1213" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.position = "top",</span></span>
<span id="cb33-1214"><a href="#cb33-1214" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.key.size = unit(0.7, "line"),</span></span>
<span id="cb33-1215"><a href="#cb33-1215" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.margin = margin(b = -5),</span></span>
<span id="cb33-1216"><a href="#cb33-1216" aria-hidden="true" tabindex="-1"></a><span class="in">    legend.justification = "left"</span></span>
<span id="cb33-1217"><a href="#cb33-1217" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb33-1218"><a href="#cb33-1218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1219"><a href="#cb33-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1220"><a href="#cb33-1220" aria-hidden="true" tabindex="-1"></a>They're all over the place! Some of the Category A bars make it all the way up into the 90%s; some are way down below 1%. That's to be expected—it's a uniform distribution without any central gravity.</span>
<span id="cb33-1221"><a href="#cb33-1221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1222"><a href="#cb33-1222" aria-hidden="true" tabindex="-1"></a>And here's what the distribution of the individual cutpoints looks like. We can actually figure out the precise Beta distributions for each <span class="co">[</span><span class="ot">like we did earlier</span><span class="co">](#one-beta-distribution-with-two-shapes)</span>: </span>
<span id="cb33-1223"><a href="#cb33-1223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1224"><a href="#cb33-1224" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-1225"><a href="#cb33-1225" aria-hidden="true" tabindex="-1"></a>\begin{align}</span>
<span id="cb33-1226"><a href="#cb33-1226" aria-hidden="true" tabindex="-1"></a>k_1 &amp;= \textbf{E}(\alpha_1) = \frac{1}{3} &amp; k_2 &amp;= (\textbf{E}(\alpha_2) + \textbf{E}(\alpha_2)) = \frac{2}{3}<span class="sc">\\</span></span>
<span id="cb33-1227"><a href="#cb33-1227" aria-hidden="true" tabindex="-1"></a>&amp;= \operatorname{Beta}(1, 2) &amp; &amp;= \operatorname{Beta}(2, 1)</span>
<span id="cb33-1228"><a href="#cb33-1228" aria-hidden="true" tabindex="-1"></a>\end{align}</span>
<span id="cb33-1229"><a href="#cb33-1229" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb33-1230"><a href="#cb33-1230" aria-hidden="true" tabindex="-1"></a><span class="in">```{r plot-cutpoints-dist-1-1-1, fig.width=7, fig.height=5.25}</span></span>
<span id="cb33-1231"><a href="#cb33-1231" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb33-1232"><a href="#cb33-1232" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Code for showing distribution of cutpoints for $\\operatorname{Dirichlet}(1, 1, 1)$"</span></span>
<span id="cb33-1233"><a href="#cb33-1233" aria-hidden="true" tabindex="-1"></a><span class="in">p1 &lt;- lots_of_uniform_draws |&gt; </span></span>
<span id="cb33-1234"><a href="#cb33-1234" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(k1 = X1, k2 = X1 + X2) |&gt;</span></span>
<span id="cb33-1235"><a href="#cb33-1235" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(c(k1, k2)) |&gt; </span></span>
<span id="cb33-1236"><a href="#cb33-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(name = case_match(name,</span></span>
<span id="cb33-1237"><a href="#cb33-1237" aria-hidden="true" tabindex="-1"></a><span class="in">    "k1" ~ "k&lt;sub&gt;1&lt;/sub&gt;",</span></span>
<span id="cb33-1238"><a href="#cb33-1238" aria-hidden="true" tabindex="-1"></a><span class="in">    "k2" ~ "k&lt;sub&gt;2&lt;/sub&gt;"</span></span>
<span id="cb33-1239"><a href="#cb33-1239" aria-hidden="true" tabindex="-1"></a><span class="in">  )) |&gt; </span></span>
<span id="cb33-1240"><a href="#cb33-1240" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, fill = name)) +</span></span>
<span id="cb33-1241"><a href="#cb33-1241" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_halfeye(p_limits = c(0, 1)) +</span></span>
<span id="cb33-1242"><a href="#cb33-1242" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_fill_manual(values = clrs[c(3, 6)], guide = "none") +</span></span>
<span id="cb33-1243"><a href="#cb33-1243" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb33-1244"><a href="#cb33-1244" aria-hidden="true" tabindex="-1"></a><span class="in">    x = NULL, y = NULL, </span></span>
<span id="cb33-1245"><a href="#cb33-1245" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Cutpoints for Dirichlet(1, 1, 1)",</span></span>
<span id="cb33-1246"><a href="#cb33-1246" aria-hidden="true" tabindex="-1"></a><span class="in">    subtitle = "1,000 random draws"</span></span>
<span id="cb33-1247"><a href="#cb33-1247" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1248"><a href="#cb33-1248" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars(name)) +</span></span>
<span id="cb33-1249"><a href="#cb33-1249" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1250"><a href="#cb33-1250" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1251"><a href="#cb33-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1252"><a href="#cb33-1252" aria-hidden="true" tabindex="-1"></a><span class="in">p2a &lt;- ggplot() +</span></span>
<span id="cb33-1253"><a href="#cb33-1253" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-1254"><a href="#cb33-1254" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 1, 2), n = 1000,</span></span>
<span id="cb33-1255"><a href="#cb33-1255" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[3]</span></span>
<span id="cb33-1256"><a href="#cb33-1256" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1257"><a href="#cb33-1257" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-1258"><a href="#cb33-1258" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = "Probability or proportion", y = NULL, subtitle = "Exact distribution") +</span></span>
<span id="cb33-1259"><a href="#cb33-1259" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Beta(1, 2)")) +</span></span>
<span id="cb33-1260"><a href="#cb33-1260" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1261"><a href="#cb33-1261" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1262"><a href="#cb33-1262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1263"><a href="#cb33-1263" aria-hidden="true" tabindex="-1"></a><span class="in">p2b &lt;- ggplot() +</span></span>
<span id="cb33-1264"><a href="#cb33-1264" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_function(</span></span>
<span id="cb33-1265"><a href="#cb33-1265" aria-hidden="true" tabindex="-1"></a><span class="in">    geom = "area", fun = \(x) dbeta(x, 2, 1), n = 1000,</span></span>
<span id="cb33-1266"><a href="#cb33-1266" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = clrs[6]</span></span>
<span id="cb33-1267"><a href="#cb33-1267" aria-hidden="true" tabindex="-1"></a><span class="in">  ) +</span></span>
<span id="cb33-1268"><a href="#cb33-1268" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_continuous(breaks = seq(0, 1, by = 0.2)) +</span></span>
<span id="cb33-1269"><a href="#cb33-1269" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(x = NULL, y = NULL) +</span></span>
<span id="cb33-1270"><a href="#cb33-1270" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_wrap(vars("Beta(2, 1)")) +</span></span>
<span id="cb33-1271"><a href="#cb33-1271" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_nice_dist() +</span></span>
<span id="cb33-1272"><a href="#cb33-1272" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(strip.text = element_markdown())</span></span>
<span id="cb33-1273"><a href="#cb33-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1274"><a href="#cb33-1274" aria-hidden="true" tabindex="-1"></a><span class="in">(p1 / plot_spacer() / (p2a | p2b)) + </span></span>
<span id="cb33-1275"><a href="#cb33-1275" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(heights = c(0.48, 0.04, 0.48))</span></span>
<span id="cb33-1276"><a href="#cb33-1276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb33-1277"><a href="#cb33-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-1278"><a href="#cb33-1278" aria-hidden="true" tabindex="-1"></a>Cool cool—these are much less precise uniform priors for the cutpoints, at 33% and 66% respectively.</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> 2007–2024 Andrew Heiss</span> <span class="faux-block">All content licensed under<br><a href="https://creativecommons.org/licenses/by/4.0/"><i class="fa-brands fa-creative-commons" aria-label="creative-commons"></i> <i class="fa-brands fa-creative-commons-by" aria-label="creative-commons-by"></i> Creative Commons CC BY 4.0</a></span></p>
</div>   
    <div class="nav-footer-center">
<p><span class="faux-block"><i class="fa-brands fa-orcid" aria-label="orcid"></i> <strong>ORCID</strong> <a href="https://orcid.org/0000-0002-3948-3914">0000-0002-3948-3914</a></span> <span class="faux-block"><i class="fa-solid fa-key" aria-label="key"></i> <a href="../../../../../pgp_ath.asc.txt">PGP public key</a>   <i class="fa-solid fa-fingerprint" aria-label="fingerprint"></i> Fingerprint:<br><span class="fingerprint">4AA2 FA83 A8B2 05A4 E30F<br> 610D 1382 6216 9178 36AB</span></span></p>
</div>
    <div class="nav-footer-right">
<p><span class="faux-block">Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a></span> <span class="faux-block"><a href="https://github.com/andrewheiss/ath-quarto">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></span></p>
</div>
  </div>
</footer>


</body></html>